angular.module("app",["ngRoute","ngAnimate","ui.slider","720kb.socialshare"]),angular.module("app").controller("ApplicationCtrl",["SessionSvc","UtilSvc","ConfigSvc","$rootScope","$scope","$window","$http","$timeout",function(e,t,n,o,i,a,s,l){window.onbeforeunload=function(t){e.remove(i.guid).success(function(e){})["catch"](function(e){})},window.onpageshow=function(e){i.initSession(),i.map&&i.map.updateAndDrawPosts()},window.onpagehide=function(t){e.remove(i.guid).success(function(e){})["catch"](function(e){})},document.addEventListener("visibilitychange",function(){"visible"==document.visibilityState||"mozVisible"==document.visibilityState||"msVisible"==document.visibilityState||"webkitVisible"==document.visibilityState?(i.initSession(),i.map&&i.map.updateAndDrawPosts()):("hidden"==document.visibilityState||"mozHidden"==document.visibilityState||"msHidden"==document.visibilityState||"webkitHidden"==document.visibilityState)&&e.remove(i.guid).success(function(e){})["catch"](function(e){})}),document.addEventListener("webkitvisibilitychange",function(){document.webkitVisible?(i.initSession(),i.map&&i.map.updateAndDrawPosts()):document.webkitHidden&&e.remove(i.guid).success(function(e){})["catch"](function(e){})},!1),i.initSession=function(){function t(t){var n=t.coords,o=new google.maps.LatLng(n.latitude,n.longitude);i.userLocation={lat:n.latitude,lon:n.longitude};var a={lat:o.lat(),lon:o.lng()},s=JSON.stringify(a),l=i.map.getBounds(),r=l.getNorthEast(),c=l.getSouthWest(),g={lat:r.lat(),lon:c.lng()},p={lat:c.lat(),lon:r.lng()},u={lat:window.localStorage.latitude,lon:window.localStorage.longitude},m={nw_lat:g.lat,nw_lon:g.lon,se_lat:p.lat,se_lon:p.lon,center_lat:u.lat,center_lon:u.lon},d=JSON.stringify(m),f={guidtgt:i.guidtgt,guid:i.guid,location:s,watchloc:d};e.enter(f).success(function(e){})["catch"](function(e){})}function n(e){swal("","Need to turn on location service for proper use.")}if("undefined"!=i.map&&"null"!=i.map&&i.map){var o={enableHighAccuracy:!1,timeout:1e4,maximumAge:3e4};navigator.geolocation.getCurrentPosition(t,n,o),swal({title:"",text:"Retreiving currnet location..",timer:1200,showConfirmButton:!1})}},"undefined"!=window.localStorage.guid&&"null"!=window.localStorage.guid&&window.localStorage.guid||(window.localStorage.guid=t.getGuid()),i.guid=window.localStorage.guid,"undefined"!=window.localStorage.guidtgt&&"null"!=window.localStorage.guidtgt&&window.localStorage.guidtgt||(window.localStorage.guidtgt="0"),i.guidtgt=window.localStorage.guidtgt,i.pageId={post:0},i.navCollapsed=!0,i.timevalue=n.maxInstantLifeSpan,i.userLocation={lat:0,lon:0},i.toggleSearchLocation=!1,i.toggleTimeSlider=!1,l(function(){document.getElementById("map-posting").onkeypress=function(e){"13"==e.which&&$("form#map-posting-form").submit()},document.getElementById("map-posting").onfocus=function(e){i.toggleTimeSlider=!0},document.getElementById("map-posting").onblur=function(e){i.toggleTimeSlider=!1},$(".nav-burger").click(function(){$(".nav-burger").toggleClass("active"),i.toggleSearchLocation=!i.toggleSearchLocation,i.$apply()})});var r,c=document.location.hostname;r=c==n.local?n.web_socket+n.local+":"+n.port:c==n.local_ip?n.web_socket+n.local_ip+":"+n.port:n.web_socket+n.deploy_dns;var g=function(){connection=new WebSocket(r),connection.onopen=function(){connection.send(i.guid)},connection.onclose=function(){l(g,2e3)},connection.onmessage=function(e){var t=JSON.parse(e.data);o.$broadcast("ws:"+t.type,t.data)}};g(),i.$on("ws:new_post",function(e,t){i.map.updateAndDrawPosts(),t.guid==i.guid&&i.map.drawResponses(t)}),i.$on("ws:new_session",function(e,t){var n=angular.fromJson(t.location);i.map.drawCurrLocationMarker(n)}),i.$on("ws:remove_post",function(e,t){i.map.unDrawPost(t)}),i.$on("ws:update_guidtgt",function(e,t){i.map.updateAndDrawPosts()}),i.isInstant=function(e){return e<=n.maxInstantLifeSpan?!0:!1},i.isMobile=function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?!0:!1},i.moveToCurrentLocation=function(){function e(e){if(i.currentPageId==i.pageId.post){var t=e.coords;window.localStorage.latitude=t.latitude,window.localStorage.longitude=t.longitude;var n={lat:t.latitude,lon:t.longitude};i.map.drawCurrLocationMarker(n),i.map.drawXMarker(n);var o=new google.maps.LatLng(n.lat,n.lon);i.map.panTo(o),i.map.updateAndDrawPosts()}}function t(e){swal("","Need to turn on location service for proper use.")}var n={enableHighAccuracy:!0,timeout:1e4,maximumAge:3e4};navigator.geolocation.getCurrentPosition(e,t,n),swal({title:"",text:"Moving to current location..",timer:1e3,showConfirmButton:!1})},i.moveToPostLocation=function(){var e=0;if(i.isMobile()){var t=i.map.getBounds(),n=t.getNorthEast(),o=t.getSouthWest();current_map_nw=new google.maps.LatLng(n.lat(),o.lng()),current_map_se=new google.maps.LatLng(o.lat(),n.lng());var a=.5*Math.abs(i.postLocation.lat-current_map_nw.lat()),s=.5*Math.abs(i.postLocation.lat-current_map_se.lat());e=a>s?s:a}var l=i.map.getCenter(),r=new google.maps.LatLng(i.postLocation.lat+e,l.lng());i.map.panTo(r),i.map.updateAndDrawPosts()},i.collapse=function(){i.navCollapsed=!0},i.$on("set:map",function(e,t){i.map=t,i.initSession()}),i.$on("set:guidtgt",function(e,t){i.guidtgt=t,window.localStorage.guidtgt=t}),i.$on("set:pagechange",function(e,t){i.currentPageId=t}),i.$on("set:loc",function(e,t){var n=t.lat(),o=t.lng();i.postLocation={lat:n,lon:o}}),i.$on("set:place",function(e,t){i.$apply(function(){i.postplace=t})})}]),angular.module("app").constant("ConfigSvc",{web_socket:"ws://",web_socket_secure:"wss://",local:"localhost",local_ip:"192.168.0.4",deploy_dns:"talkipia.com",port:"5000",maxInstantLifeSpan:5e3}),angular.module("app").config(["$routeProvider",function(e){e.when("/",{controller:"PostsCtrl",templateUrl:"/templates/posts.html"}).otherwise({redirectTo:"/"})}]),angular.module("app").service("UtilSvc",function(){var e=this;e.deg2rad=function(e){return e*(Math.PI/180)},e.getDistanceFromLatLonInKm=function(t,n,o,i){var a=6371,s=e.deg2rad(o-t),l=e.deg2rad(i-n),r=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e.deg2rad(t))*Math.cos(e.deg2rad(o))*Math.sin(l/2)*Math.sin(l/2),c=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)),g=a*c;return g},e.mapRange=function(e,t,n,o,i){return o+(i-o)*(e-t)/(n-t)},e.getGuid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}),angular.module("app").run(["$rootScope","$timeout","SessionSvc",function(e,t,n){}]),angular.module("app").directive("appMap",["PostsSvc","UtilSvc","ConfigSvc","SessionSvc","$compile","$timeout",function(e,t,n,o,i,a){var s=function(t,n,s){function l(){window.localStorage.latitude=D.getCenter().lat(),window.localStorage.longitude=D.getCenter().lng()}function r(){var e=D.getBounds(),t=e.getNorthEast(),n=e.getSouthWest();O=new google.maps.LatLng(t.lat(),n.lng()),N=new google.maps.LatLng(n.lat(),t.lng())}function c(){var e=D.getBounds(),n=e.getNorthEast(),i=e.getSouthWest();O={lat:n.lat(),lon:i.lng()},N={lat:i.lat(),lon:n.lng()};var a;a=t.postLocation.lat<O.lat&&t.postLocation.lat>N.lat&&t.postLocation.lon<N.lon&&t.postLocation.lon>O.lon?{lat:t.postLocation.lat,lon:t.postLocation.lon}:{lat:D.getCenter().lat(),lon:D.getCenter().lng()},o.updateWatchLocation(O,N,a,t.guid)}function g(e){function n(n){for(var o=0;o<n.length;o++){var i=n[o];if(i.guid!=t.guid){var s=angular.fromJson(i.watchloc),l=angular.fromJson(e.location);if(r(),s.center_lat<O.lat()&&s.center_lat>N.lat()&&s.center_lon<N.lng()&&s.center_lon>O.lng()&&l.lat<s.nw_lat&&l.lat>s.se_lat&&l.lon<s.se_lon&&l.lon>s.nw_lon){var c=new google.maps.LatLng(s.center_lat,s.center_lon),g=40*Math.random()+40,p="Blink.gif",u={url:p,size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(.5*g+5,.5*g+14),scaledSize:new google.maps.Size(g,g)};!function(e){var t={position:c,map:D,title:"Receiver",icon:e,optimized:!1},n=new google.maps.Marker(t),o=1200;a(function(e){return function(){e.setMap(null),e=null}}(n),o)}(u)}}}}o.fetch().success(n)["catch"](function(e){})}function p(){for(var e,t=0;e=H[t];t++){var n=new Date,o=n.getTime(),i=e.post.lifeend-o;0>=i&&d(e.post._id)}}function u(){function n(n){for(var o=0;o<n.length;o++){var a=n[o],s=angular.fromJson(a.location),l=new google.maps.LatLng(s.lat,s.lon);if(r(),l.lat()<O.lat()&&l.lat()>N.lat()&&l.lng()<N.lng()&&l.lng()>O.lng()){for(var c,g=0;c=H[g];g++){var p=a._id==c.post._id;if(p){if(W){d(a._id);break}if(c.post.guidtgt==a.guidtgt){a=null;break}d(a._id);break}}if(null!=a){var u={position:l,map:D,title:"Bubble",icon:j},c=new google.maps.Marker(u);H.push({marker:c,post:a});var m=v(a.guid,a.guidtgt),f=a.islocal,y=t,w=y.$new(!0),h=function(n,o,a,s,l){return function(){var r={pixelOffset:new google.maps.Size(-39.5,16),disableAutoPan:!0},c=new google.maps.InfoWindow(r),g=new Date,p=g.getTime(),u=a.lifeend-p>=0?a.lifeend-p:0,m=(u/a.lifespan).toFixed(2);o.msg=a.body,o.postlife=u,o.postguid=a.guid,o.postguidtgt=a.guidtgt,o.postcouplestatus=s,o.postlifepercentage=m,o.postlocalstatus=l;var d="<div map-msg></div>",f=i(d)(o);c.setContent(f[0]),google.maps.event.addListener(c,"closeclick",function(){a.guid==t.guid&&swal({title:"Are you sure?",text:"You will not be able to recover this imaginary file!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t)e.remove(a).success(function(e){})["catch"](function(e){}),swal("Deleted!","Your imaginary file has been deleted.","success");else{var i=new Date,s=i.getTime(),l=a.lifeend-s>=0?a.lifeend-s:0,r=(l/a.lifespan).toFixed(2);r>0&&(o.postlifepercentage=r,c.open(D,n))}})}),c.open(D,n)}}(c,w,a,m,f);h()}}}}p(),W=U!=t.guidtgt,U=t.guidtgt,e.fetch().success(n)["catch"](function(e){})}function m(e){var t=new google.maps.LatLng(e.lat,e.lon);if(r(),t.lat()<O.lat()&&t.lat()>N.lat()&&t.lng()<N.lng()&&t.lng()>O.lng()){var n={position:t,map:D,animation:google.maps.Animation.DROP,title:"UserPin",icon:X},o=new google.maps.Marker(n);a(function(e){return function(){e.setMap(null)}}(o),2e3)}}function d(e){for(var t,n=0;t=H[n];n++)if(e==t.post._id){t.marker.setMap(null),H.splice(n,1);break}}function f(e){var t=new google.maps.LatLng(e.lat,e.lon);y(t),w(t),c()}function y(e){for(var t,n=0;t=G[n];n++)t.setMap(null);G=[];var t=new google.maps.Marker({position:e,map:D,icon:V});G.push(t)}function w(e){t.$emit("set:loc",e);var n=new google.maps.Geocoder;n.geocode({latLng:e},function(e,n){try{t.$emit("set:place",e[1].formatted_address)}catch(o){swal("","Location does not exists"),t.$emit("set:place","Location does not exists")}})}function v(e,n){var o=t.guidtgt==e,i=t.guid==n,a=t.guid==e,s="0"!=t.guidtgt;return a&&s?2:o&&i?4:o&&!i?1:!o&&i?2:0}function h(){var e=document.getElementById("map-search-toggle");D.controls[google.maps.ControlPosition.TOP_LEFT].push(e)}function _(){var e=document.getElementById("map-btn-curr");D.controls[google.maps.ControlPosition.TOP_RIGHT].push(e)}function b(){var e=document.getElementById("map-posting");D.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(e)}function T(){var e=document.getElementById("map-btn-submit");D.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(e)}function S(){var e=document.getElementById("map-time-slider");D.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(e)}function L(){var e=document.getElementById("pac-input");D.controls[google.maps.ControlPosition.TOP_LEFT].push(e);var t=new google.maps.places.SearchBox(e);google.maps.event.addListener(t,"places_changed",function(){var e=t.getPlaces();if(0!=e.length){var n=e[0],o={lat:n.geometry.location.lat(),lon:n.geometry.location.lng()};f(o),window.localStorage.latitude=n.geometry.location.latitude,window.localStorage.longitude=n.geometry.location.longitude,D.panTo(n.geometry.location),D.setZoom(16)}})}function k(){google.maps.event.addListener(E,"click",function(e){var t={lat:e.latLng.lat(),lon:e.latLng.lng()};f(t)})}function P(){google.maps.event.addListener(E,"center_changed",function(){l()})}function C(){google.maps.event.addListener(E,"bounds_changed",function(){r()})}function M(){google.maps.event.addListener(E,"dragend",function(){u(),c()})}function $(){google.maps.event.addListener(E,"resize",function(){u(),c()})}function z(){google.maps.event.addListener(E,"zoom_changed",function(){u(),c()})}function x(){J=isNaN(window.localStorage.latitude)||isNaN(window.localStorage.longitude)?0!=t.userLocation.lat&&0!=t.userLocation.lon?new google.maps.LatLng(t.userLocation.lat,t.userLocation.lon):new google.maps.LatLng(34.05,-118.24):new google.maps.LatLng(window.localStorage.latitude,window.localStorage.longitude),R={center:J,zoom:15,scrollwheel:!0,streetViewControl:!1,mapTypeControl:!1,panControl:!1,zoomControl:!1,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,F]},mapTypeId:F}}function A(){function e(e){}function t(e){google.maps.event.trigger(this,"drawXMarker",e)}function o(e){google.maps.event.trigger(this,"drawCurrLocationMarker",e)}function i(){google.maps.event.trigger(this,"updateAndDrawPosts")}function a(e){google.maps.event.trigger(this,"drawResponses",e)}function s(e){google.maps.event.trigger(this,"unDrawPost",e)}E=new google.maps.Map(n[0],R),e.prototype=E,e.prototype.drawXMarker=t,e.prototype.drawCurrLocationMarker=o,e.prototype.updateAndDrawPosts=i,e.prototype.drawResponses=a,e.prototype.unDrawPost=s,D=new e,google.maps.event.addListener(D,"drawXMarker",function(e){f(e)}),google.maps.event.addListener(D,"drawCurrLocationMarker",function(e){m(e)}),google.maps.event.addListener(D,"updateAndDrawPosts",function(){u()}),google.maps.event.addListener(D,"drawResponses",function(e){g(e)}),google.maps.event.addListener(D,"unDrawPost",function(e){d(e)})}function B(){var e,t=[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#6195a0"}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"geometry",stylers:[{lightness:"0"},{saturation:"0"},{color:"#f5f5f2"},{gamma:"1"}]},{featureType:"landscape.man_made",elementType:"all",stylers:[{lightness:"-3"},{gamma:"1.00"}]},{featureType:"landscape.natural.terrain",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#bae5ce"},{visibility:"on"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45},{visibility:"simplified"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#fac9a9"},{visibility:"simplified"}]},{featureType:"road.highway",elementType:"labels.text",stylers:[{color:"#4e4e4e"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#787878"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"transit.station.airport",elementType:"labels.icon",stylers:[{hue:"#0a00ff"},{saturation:"-77"},{gamma:"0.57"},{lightness:"0"}]},{featureType:"transit.station.rail",elementType:"labels.text.fill",stylers:[{color:"#43321e"}]},{featureType:"transit.station.rail",elementType:"labels.icon",stylers:[{hue:"#ff6c00"},{lightness:"4"},{gamma:"0.75"},{saturation:"-68"}]},{featureType:"water",elementType:"all",stylers:[{color:"#eaf6f8"},{visibility:"on"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#c7eced"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{lightness:"-49"},{saturation:"-53"},{gamma:"0.79"}]}],n=[{featureType:"all",elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#3e606f"},{weight:2},{gamma:.84}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry",stylers:[{weight:.6},{color:"#182a3d"},{visibility:"on"}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#1a528b"},{visibility:"simplified"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#406d80"},{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#2c5a71"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#66a9ee"},{lightness:-37},{visibility:"on"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{visibility:"on"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{visibility:"on"}]},{featureType:"road.highway",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"geometry.stroke",stylers:[{lightness:"-11"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#ff7e4e"},{visibility:"simplified"}]},{featureType:"transit.station.airport",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#182a3d"}]}],o=new Date,i=o.getHours();e=4>i||i>19?n:t;var a={name:"Custom Style"},s=new google.maps.StyledMapType(e,a);D.mapTypes.set(F,s)}function I(){void 0===D&&(x(),A(),B()),h(),L(),_(),b(),T(),S(),k(),P(),M(),$(),z(),C(),t.$emit("set:map",D)}var D,E,O,N,R,J,W,F="custom_style",G=[],H=[],U="0",j={url:"Default_Marker.png",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(1,1)},V={url:"X_Marker.png",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)},X={url:"Current_Location_Marker.png",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(20,33)};I(),y(J),w(J)};return{restrict:"A",template:'<div id="map-canvas"></div>',replace:!0,link:s}}]),angular.module("app").directive("mapMsg",["$timeout","SessionSvc","PostsSvc",function(e,t,n){var o=function(o,i,a){function s(){var e=o.postguid,a=o.$parent.guid,s=o.$parent.guidtgt;i.children().on("click",function(){var i=e;if(e==a){if("0"==o.$parent.guidtgt)return;i="0"}e==s&&(i="0"),o.$emit("set:guidtgt",i),t.updateCoupling(a,i).then(function(e){});var l={guid:a,guidtgt:i};n.updateGuidtgt(l).then(function(e){})})}function l(){var e=o.postlife+"ms",t=i.children().children(".postlifebar");t.css("-o-animation-duration",e),t.css("-moz-animation-duration",e),t.css("-ms-animation-duration",e),t.css("-webkit-animation-duration",e),t.css("animation-duration",e),o.postlifepercentage>.95?(t.css("-o-animation-name","postlifeanim_a"),t.css("-moz-animation-name","postlifeanim_a"),t.css("-ms-animation-name","postlifeanim_a"),t.css("-webkit-animation-name","postlifeanim_a"),t.css("animation-name","postlifeanim_a")):o.postlifepercentage<=.95&&o.postlifepercentage>.9?(t.css("-o-animation-name","postlifeanim_b"),t.css("-moz-animation-name","postlifeanim_b"),t.css("-ms-animation-name","postlifeanim_b"),t.css("-webkit-animation-name","postlifeanim_b"),t.css("animation-name","postlifeanim_b")):o.postlifepercentage<=.9&&o.postlifepercentage>.85?(t.css("-o-animation-name","postlifeanim_c"),t.css("-moz-animation-name","postlifeanim_c"),t.css("-ms-animation-name","postlifeanim_c"),postlifebar_css=t.css("-webkit-animation-name","postlifeanim_c"),postlifebar_css=t.css("animation-name","postlifeanim_c")):o.postlifepercentage<=.85&&o.postlifepercentage>.75?(t.css("-o-animation-name","postlifeanim_d"),t.css("-moz-animation-name","postlifeanim_d"),t.css("-ms-animation-name","postlifeanim_d"),t.css("-webkit-animation-name","postlifeanim_d"),t.css("animation-name","postlifeanim_d")):o.postlifepercentage<=.75&&o.postlifepercentage>.6?(t.css("-o-animation-name","postlifeanim_e"),t.css("-moz-animation-name","postlifeanim_e"),t.css("-ms-animation-name","postlifeanim_e"),t.css("-webkit-animation-name","postlifeanim_e"),t.css("animation-name","postlifeanim_e")):o.postlifepercentage<=.6&&o.postlifepercentage>.5?(t.css("-o-animation-name","postlifeanim_f"),t.css("-moz-animation-name","postlifeanim_f"),t.css("-ms-animation-name","postlifeanim_f"),t.css("-webkit-animation-name","postlifeanim_f"),t.css("animation-name","postlifeanim_f")):o.postlifepercentage<=.5&&o.postlifepercentage>.3?(t.css("-o-animation-name","postlifeanim_g"),t.css("-moz-animation-name","postlifeanim_g"),t.css("-ms-animation-name","postlifeanim_g"),t.css("-webkit-animation-name","postlifeanim_g"),t.css("animation-name","postlifeanim_g")):o.postlifepercentage<=.3&&o.postlifepercentage>.2?(t.css("-o-animation-name","postlifeanim_h"),t.css("-moz-animation-name","postlifeanim_h"),t.css("-ms-animation-name","postlifeanim_h"),t.css("-webkit-animation-name","postlifeanim_h"),t.css("animation-name","postlifeanim_h")):o.postlifepercentage<=.2&&o.postlifepercentage>.1?(t.css("-o-animation-name","postlifeanim_i"),t.css("-moz-animation-name","postlifeanim_i"),t.css("-ms-animation-name","postlifeanim_i"),t.css("-webkit-animation-name","postlifeanim_i"),t.css("animation-name","postlifeanim_i")):(t.css("-o-animation-name","postlifeanim_j"),t.css("-moz-animation-name","postlifeanim_j"),t.css("-ms-animation-name","postlifeanim_j"),t.css("-webkit-animation-name","postlifeanim_j"),t.css("animation-name","postlifeanim_j"))}function r(){var e=$(".gm-style-iw"),t=e.prev();t.children(":nth-child(2)").css({display:"none"}),t.children(":nth-child(4)").css({display:"none"}),t.children(":nth-child(3)").find("div").children().css({"box-shadow":"0 1px 6px rgba(178, 178, 178, 0.6)","z-index":"1",border:"0px"})}function c(){var e=$(".gm-style-iw"),t=e.next();t.css({opacity:"0.8",right:"20px",top:"20px"})}o.get_localstatus=function(e){return e?"local-text":"non-local-text"},o.get_coupling=function(e){return 4==e?"coupling coupling-couple":1==e?"coupling coupling-ilikeyou":2==e?"coupling coupling-youlikei":"coupling coupling-none"},angular.element(document).ready(function(){e(s,100),e(l,10),e(r,10),e(c,10)})};return{restrict:"A",templateUrl:"./templates/window.html",link:o}}]),angular.module("app").controller("PostsCtrl",["$rootScope","$scope","ConfigSvc","PostsSvc","UtilSvc","$window","$document","$timeout",function(e,t,n,o,i,a,s,l){t.$emit("set:pagechange",t.pageId.post),t.posts=[],t.$on("ws:new_post",function(e,n){t.requestFetch()}),t.addPost=function(){if(t.content){var e,a=t.postplace,s=t.postLocation,l=i.getDistanceFromLatLonInKm(s.lat,s.lon,t.userLocation.lat,t.userLocation.lon);e=3>l?!0:!1;var r,c=JSON.stringify(s);if(t.timevalue<=n.maxInstantLifeSpan){var g=t.content.length;r=5>g?4e3:g*i.mapRange(g,5,20,700,400)}else r=t.timevalue;o.create({body:t.content,location:c,place:a,guid:t.guid,guidtgt:t.guidtgt,lifespan:r,islocal:e}).success(function(e){t.content=null}).error(function(e,t){swal("Post failed","Please complete the from correctly","error")})["catch"](function(e){})}},t.requestFetch=function(){o.fetch().success(function(e){t.posts=e})["catch"](function(e){})},t.updateGuidtgt=function(e,t){var n={guid:e,guidtgt:t};o.updateGuidtgt(n).success(function(e){})["catch"](function(e){})}}]),angular.module("app").service("PostsSvc",["$http",function(e){this.fetch=function(t){return e.get("/api/posts",t)},this.create=function(t){return t.devicetoken="0",e.post("/api/posts",t)},this.remove=function(t){return e.post("/api/posts/posts_delete",t)},this.updateGuidtgt=function(t){return e.post("/api/posts/update_guidtgt",t)}}]),angular.module("app").service("SessionSvc",["$http",function(e){this.fetch=function(){return e.get("/api/sessions")},this.enter=function(t){return t.devicetoken="0",e.post("/api/sessions",t)},this.remove=function(t){var n={guid:t};return e.post("/api/sessions/delete",n)},this.updateWatchLocation=function(t,n,o,i){var a={nw_lat:t.lat,nw_lon:t.lon,se_lat:n.lat,se_lon:n.lon,center_lat:o.lat,center_lon:o.lon},s=JSON.stringify(a),l={watchloc:s,guid:i};return e.post("/api/sessions/update_session",l)},this.updateCoupling=function(t,n){var o={guid:t,guidtgt:n};return e.post("/api/sessions/update_coupling",o)}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJjb25maWcuc3ZjLmpzIiwicm91dGVzLmpzIiwidXRpbC5zdmMuanMiLCJnZW5lcmFsL21haW4uanMiLCJtYXBzL21hcC5kaXJlY3RpdmUuanMiLCJtYXBzL21zZy5kaXJlY3RpdmUuanMiLCJwb3N0cy9wb3N0cy5jdHJsLmpzIiwicG9zdHMvcG9zdHMuc3ZjLmpzIiwic2Vzc2lvbnMvc2Vzc2lvbnMuc3ZjLmpzIiwic29ja2V0cy93ZWJzb2NrZXRzLmpzIiwiYXBwLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb250cm9sbGVyIiwiU2Vzc2lvblN2YyIsIlV0aWxTdmMiLCJDb25maWdTdmMiLCIkcm9vdFNjb3BlIiwiJHNjb3BlIiwiJHdpbmRvdyIsIiRodHRwIiwiJHRpbWVvdXQiLCJ3aW5kb3ciLCJvbmJlZm9yZXVubG9hZCIsImUiLCJyZW1vdmUiLCJndWlkIiwic3VjY2VzcyIsInJlcyIsImVyciIsIm9ucGFnZXNob3ciLCJpbml0U2Vzc2lvbiIsIm1hcCIsInVwZGF0ZUFuZERyYXdQb3N0cyIsIm9ucGFnZWhpZGUiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJ2aXNpYmlsaXR5U3RhdGUiLCJ3ZWJraXRWaXNpYmxlIiwid2Via2l0SGlkZGVuIiwiZ2V0Q3VyckxvY1N1Y2Nlc3MiLCJwb3MiLCJjcmQiLCJjb29yZHMiLCJnb29nbGVMb2MiLCJnb29nbGUiLCJtYXBzIiwiTGF0TG5nIiwibGF0aXR1ZGUiLCJsb25naXR1ZGUiLCJ1c2VyTG9jYXRpb24iLCJsYXQiLCJsb24iLCJsb2NhdGlvbiIsImxuZyIsImxvY2F0aW9uSlNPTiIsIkpTT04iLCJzdHJpbmdpZnkiLCJib3VuZHMiLCJnZXRCb3VuZHMiLCJuZSIsImdldE5vcnRoRWFzdCIsInN3IiwiZ2V0U291dGhXZXN0IiwiY3VycmVudF9tYXBfbnciLCJjdXJyZW50X21hcF9zZSIsImN1cnJlbnRfbWFwX2NlbnRlciIsImxvY2FsU3RvcmFnZSIsIndhdGNobG9jIiwibndfbGF0IiwibndfbG9uIiwic2VfbGF0Iiwic2VfbG9uIiwiY2VudGVyX2xhdCIsImNlbnRlcl9sb24iLCJ3YXRjaGxvY0pTT04iLCJzZXNzaW9uIiwiZ3VpZHRndCIsImVudGVyIiwiZ2V0Q3VyckxvY0Vycm9yIiwic3dhbCIsIm9wdGlvbnMiLCJlbmFibGVIaWdoQWNjdXJhY3kiLCJ0aW1lb3V0IiwibWF4aW11bUFnZSIsIm5hdmlnYXRvciIsImdlb2xvY2F0aW9uIiwiZ2V0Q3VycmVudFBvc2l0aW9uIiwidGl0bGUiLCJ0ZXh0IiwidGltZXIiLCJzaG93Q29uZmlybUJ1dHRvbiIsImdldEd1aWQiLCJwYWdlSWQiLCJwb3N0IiwibmF2Q29sbGFwc2VkIiwidGltZXZhbHVlIiwibWF4SW5zdGFudExpZmVTcGFuIiwidG9nZ2xlU2VhcmNoTG9jYXRpb24iLCJ0b2dnbGVUaW1lU2xpZGVyIiwiZ2V0RWxlbWVudEJ5SWQiLCJvbmtleXByZXNzIiwiZXZlbnQiLCJ3aGljaCIsIiQiLCJzdWJtaXQiLCJvbmZvY3VzIiwib25ibHVyIiwiY2xpY2siLCJ0b2dnbGVDbGFzcyIsIiRhcHBseSIsInVybCIsImhvc3RuYW1lIiwibG9jYWwiLCJ3ZWJfc29ja2V0IiwicG9ydCIsImxvY2FsX2lwIiwiZGVwbG95X2RucyIsImNvbm5lY3QiLCJjb25uZWN0aW9uIiwiV2ViU29ja2V0Iiwib25vcGVuIiwic2VuZCIsIm9uY2xvc2UiLCJvbm1lc3NhZ2UiLCJwYXlsb2FkIiwicGFyc2UiLCJkYXRhIiwiJGJyb2FkY2FzdCIsInR5cGUiLCIkb24iLCJfIiwiZHJhd1Jlc3BvbnNlcyIsImZyb21Kc29uIiwiZHJhd0N1cnJMb2NhdGlvbk1hcmtlciIsInBvc3RpZCIsInVuRHJhd1Bvc3QiLCJ1cGRhdGVkU2Vzc2lvbiIsImlzSW5zdGFudCIsImlzTW9iaWxlIiwidXNlckFnZW50IiwibWF0Y2giLCJtb3ZlVG9DdXJyZW50TG9jYXRpb24iLCJjdXJyZW50UGFnZUlkIiwiZHJhd1hNYXJrZXIiLCJwYW5UbyIsIm1vdmVUb1Bvc3RMb2NhdGlvbiIsImxhdERlbHRhIiwibGF0RGVsdGFfY2VudGVyMm5vcnRoIiwiTWF0aCIsImFicyIsInBvc3RMb2NhdGlvbiIsImxhdERlbHRhX2NlbnRlcjJzb3V0aCIsImNlbnRlckxvYyIsImdldENlbnRlciIsImNvbGxhcHNlIiwicGxhY2UiLCJwb3N0cGxhY2UiLCJjb25zdGFudCIsIndlYl9zb2NrZXRfc2VjdXJlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwic2VydmljZSIsInN2YyIsInRoaXMiLCJkZWcycmFkIiwiZGVnIiwiUEkiLCJnZXREaXN0YW5jZUZyb21MYXRMb25JbkttIiwibGF0MSIsImxvbjEiLCJsYXQyIiwibG9uMiIsIlIiLCJkTGF0IiwiZExvbiIsImEiLCJzaW4iLCJjb3MiLCJjIiwiYXRhbjIiLCJzcXJ0IiwiZCIsIm1hcFJhbmdlIiwidmFsdWUiLCJsb3cxIiwiaGlnaDEiLCJsb3cyIiwiaGlnaDIiLCJzNCIsImZsb29yIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHJpbmciLCJydW4iLCJkaXJlY3RpdmUiLCJQb3N0c1N2YyIsIiRjb21waWxlIiwibGluayIsInNjb3BlIiwiZWxlbWVudCIsImF0dHJzIiwidXBkYXRlRGVmYXVsdExvY2F0aW9uIiwidXBkYXRlQm91bmRzIiwidXBkYXRlV2F0Y2hMb2NhdGlvbiIsImRyYXdCbGlua3MiLCJzZXNzaW9ucyIsImkiLCJsZW5ndGgiLCJ3YXRjaF9sb2NhdGlvbiIsInBvc3RfbG9jYXRpb24iLCJyYW5kb21TaXplIiwidXJsTmFtZSIsImltYWdlTGlzdGVuZXIiLCJzaXplIiwiU2l6ZSIsIm9yaWdpbiIsIlBvaW50IiwiYW5jaG9yIiwic2NhbGVkU2l6ZSIsIm1hcmtlck9wdGlvbnMiLCJwb3NpdGlvbiIsImljb24iLCJvcHRpbWl6ZWQiLCJtYXJrZXIiLCJNYXJrZXIiLCJyZWNlaXZlcl9tYXJrZXJfbGlmZXNwYW4iLCJvbGRfbWFya2VyIiwic2V0TWFwIiwiZmV0Y2giLCJjbGVhbnVwIiwiaiIsIm1hcmtlcnNPbk1hcCIsImN1cnJlbnREYXRlIiwiRGF0ZSIsImN1cnJlbnRUaW1lTWlsbGkiLCJnZXRUaW1lIiwibGlmZSIsImxpZmVlbmQiLCJfaWQiLCJkcmF3UG9zdHMiLCJwb3N0cyIsImlzQWxyZWFkeURyYXduIiwiaXNHdWlkdGd0Q2hhbmdlZCIsImltYWdlUG9zdCIsInB1c2giLCJjb3VwbGluZ19zdGF0dXMiLCJjYWxjdWxhdGVDb3VwbGluZyIsImxvY2FsX3N0YXR1cyIsImlzbG9jYWwiLCJwYXJlbnQiLCJjaGlsZCIsIiRuZXciLCJvcGVuSW5mb1dpbmRvdyIsImNoaWxkX3Njb3BlIiwiaW5mb1dpbmRvd09wdGlvbnMiLCJwaXhlbE9mZnNldCIsImRpc2FibGVBdXRvUGFuIiwiaW5mb1dpbmRvdyIsIkluZm9XaW5kb3ciLCJwb3N0bGlmZSIsImxpZmVwZXJjZW50YWdlIiwibGlmZXNwYW4iLCJ0b0ZpeGVkIiwibXNnIiwiYm9keSIsInBvc3RndWlkIiwicG9zdGd1aWR0Z3QiLCJwb3N0Y291cGxlc3RhdHVzIiwicG9zdGxpZmVwZXJjZW50YWdlIiwicG9zdGxvY2Fsc3RhdHVzIiwiY29udGVudCIsImNvbXBpbGVkIiwic2V0Q29udGVudCIsImFkZExpc3RlbmVyIiwic2hvd0NhbmNlbEJ1dHRvbiIsImNvbmZpcm1CdXR0b25Db2xvciIsImNvbmZpcm1CdXR0b25UZXh0IiwiY2xvc2VPbkNvbmZpcm0iLCJpc0NvbmZpcm0iLCJvcGVuIiwicHJldkd1aWR0Z3QiLCJkcmF3RHJvcERvd24iLCJhbmltYXRpb24iLCJBbmltYXRpb24iLCJEUk9QIiwiaW1hZ2VVc2VyTG9naW4iLCJrIiwic3BsaWNlIiwiZHJhd0FuZFNldFBsYWNlIiwiZHJhd0hlbHBlck1hcmtlciIsInNldFBsYWNlIiwiaGVscGVyTWFya2VycyIsImltYWdlVGFyZ2V0IiwiJGVtaXQiLCJnZW9jb2RlciIsIkdlb2NvZGVyIiwiZ2VvY29kZSIsImxhdExuZyIsInJlc3VsdHMiLCJzdGF0dXMiLCJmb3JtYXR0ZWRfYWRkcmVzcyIsInBvc3RfZ3VpZCIsInBvc3RfZ3VpZHRndCIsImlzUG9pbnRpbmdZb3UiLCJpc1BvaW50aW5nTWUiLCJpc015UG9zdCIsImlzUG9pbnRpbmdTb21lb25lIiwic2V0VUlTZWFyY2hMb2NhdGlvblRvZ2dsZSIsIm1hcFNlYXJjaFRvZ2dsZSIsImNvbnRyb2xzIiwiQ29udHJvbFBvc2l0aW9uIiwiVE9QX0xFRlQiLCJzZXRVSU1vdmVUb0N1cnJMb2NCdG4iLCJjdXJyTG9jQnRuIiwiVE9QX1JJR0hUIiwic2V0VUlQb3N0Rm9ybSIsInBvc3RGb3JtIiwiQk9UVE9NX0NFTlRFUiIsInNldFVJUG9zdEJ0biIsInBvc3RCdG4iLCJzZXRVSVRpbWVTbGlkZXIiLCJ0aW1lU2xpZGVyIiwic2V0VUlTZWFyY2hCb3giLCJpbnB1dCIsInNlYXJjaEJveCIsInBsYWNlcyIsIlNlYXJjaEJveCIsImdldFBsYWNlcyIsImdlb21ldHJ5Iiwic2V0Wm9vbSIsInNldEV2ZW50Q2xpY2siLCJtYXBfb3JpZ2luIiwic2V0RXZlbnRDZW50ZXJDaGFuZ2VkIiwic2V0RXZlbnRCb3VuZHNDaGFuZ2VkIiwic2V0RXZlbnREcmFnRW5kIiwic2V0RXZlbnRSZXNpemUiLCJzZXRFdmVudFpvb21DaGFuZ2VkIiwiaW5pdGlhbE1hcERhdGEiLCJpbml0aWFsTWFwQ2VudGVyIiwiaXNOYU4iLCJtYXBPcHRpb25zIiwiY2VudGVyIiwiem9vbSIsInNjcm9sbHdoZWVsIiwic3RyZWV0Vmlld0NvbnRyb2wiLCJtYXBUeXBlQ29udHJvbCIsInBhbkNvbnRyb2wiLCJ6b29tQ29udHJvbCIsIm1hcFR5cGVDb250cm9sT3B0aW9ucyIsIm1hcFR5cGVJZHMiLCJNYXBUeXBlSWQiLCJST0FETUFQIiwiQ0xPVURfTUFQX0lEIiwibWFwVHlwZUlkIiwic2V0TWFudWFsRXZlbnRzIiwiQ2xvdWRNYXAiLCJoYW5kbGVEcmF3WE1hcmtlciIsInRyaWdnZXIiLCJoYW5kbGVEcmF3Q3VyckxvY2F0aW9uTWFya2VyIiwiaGFuZGxlVXBkYXRlQW5kRHJhd1Bvc3RzIiwiaGFuZGxlRHJhd1Jlc3BvbnNlcyIsImhhbmRsZVVuRHJhd1Bvc3QiLCJNYXAiLCJwcm90b3R5cGUiLCJzZXRTdHlsZUZvck1hcCIsImZlYXR1cmVPcHRzIiwiZmVhdHVyZU9wdHNfZGF5IiwiZmVhdHVyZVR5cGUiLCJlbGVtZW50VHlwZSIsInN0eWxlcnMiLCJjb2xvciIsInZpc2liaWxpdHkiLCJsaWdodG5lc3MiLCJzYXR1cmF0aW9uIiwiZ2FtbWEiLCJodWUiLCJmZWF0dXJlT3B0c19uaWdodCIsIndlaWdodCIsImN1cnJlbnRUaW1lIiwiY3VycmVudEhvdXIiLCJnZXRIb3VycyIsInN0eWxlZE1hcE9wdGlvbnMiLCJuYW1lIiwiY3VzdG9tTWFwVHlwZSIsIlN0eWxlZE1hcFR5cGUiLCJtYXBUeXBlcyIsInNldCIsImluaXRNYXAiLCJyZXN0cmljdCIsInRlbXBsYXRlIiwicmVwbGFjZSIsInVwZGF0ZUd1aWRUYXJnZXQiLCJteWd1aWQiLCIkcGFyZW50IiwibXlndWlkdGd0IiwiY2hpbGRyZW4iLCJvbiIsInVwZGF0ZV9ndWlkdGd0IiwidXBkYXRlQ291cGxpbmciLCJ0aGVuIiwiZG9jIiwidXBkYXRlcyIsInVwZGF0ZUd1aWR0Z3QiLCJ1cGRhdGVQb3N0VGltZXIiLCJkdXJhdGlvbiIsInBvc3RiYXJsaWZlIiwiY3NzIiwicG9zdGxpZmViYXJfY3NzIiwiY3VzdG9taXplSW5mb1dpbmRvdyIsIml3T3V0ZXIiLCJpd0JhY2tncm91bmQiLCJwcmV2IiwiZGlzcGxheSIsImZpbmQiLCJib3gtc2hhZG93Iiwiei1pbmRleCIsImJvcmRlciIsImN1c3RvbWl6ZUNsb3NlQnRuIiwiaXdDbG9zZUJ0biIsIm5leHQiLCJvcGFjaXR5IiwicmlnaHQiLCJ0b3AiLCJnZXRfbG9jYWxzdGF0dXMiLCJnZXRfY291cGxpbmciLCJyZWFkeSIsIiRkb2N1bWVudCIsInJlcXVlc3RGZXRjaCIsImFkZFBvc3QiLCJwb3N0TG9jYXRpb25Gcm9tVXNlckxvY2F0aW9uIiwicmVsYXRpdmVMaWZlU3BhbiIsImNoYXJMZW4iLCJjcmVhdGUiLCJlcnJvciIsImd1aWRPYmoiLCJnZXQiLCJkZXZpY2V0b2tlbiIsInVwZGF0ZWRzZXNzaW9uIiwidXBkYXRlZGd1aWR0Z3QiXSwibWFwcGluZ3MiOiJBQUNBQSxRQUFBQyxPQUFBLE9BQ0EsVUFDQSxZQUNBLFlBQ0Esc0JDSkFELFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxtQkFBQSxhQUFBLFVBQUEsWUFBQSxhQUFBLFNBQUEsVUFBQSxRQUFBLFdBQUEsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FNQUMsT0FBQUMsZUFBQSxTQUFBQyxHQUNBVixFQUFBVyxPQUFBUCxFQUFBUSxNQUNBQyxRQUFBLFNBQUFDLE1BREFkLFNBSUEsU0FBQWUsT0FLQVAsT0FBQVEsV0FBQSxTQUFBTixHQUNBTixFQUFBYSxjQUNBYixFQUFBYyxLQUNBZCxFQUFBYyxJQUFBQyxzQkFHQVgsT0FBQVksV0FBQSxTQUFBVixHQUNBVixFQUFBVyxPQUFBUCxFQUFBUSxNQUNBQyxRQUFBLFNBQUFDLE1BREFkLFNBSUEsU0FBQWUsT0FNQU0sU0FBQUMsaUJBQUEsbUJBQUEsV0FDQSxXQUFBRCxTQUFBRSxpQkFDQSxjQUFBRixTQUFBRSxpQkFDQSxhQUFBRixTQUFBRSxpQkFDQSxpQkFBQUYsU0FBQUUsaUJBRUFuQixFQUFBYSxjQUNBYixFQUFBYyxLQUNBZCxFQUFBYyxJQUFBQyx1QkFFQSxVQUFBRSxTQUFBRSxpQkFDQSxhQUFBRixTQUFBRSxpQkFDQSxZQUFBRixTQUFBRSxpQkFDQSxnQkFBQUYsU0FBQUUsa0JBRUF2QixFQUFBVyxPQUFBUCxFQUFBUSxNQUNBQyxRQUFBLFNBQUFDLE1BREFkLFNBSUEsU0FBQWUsUUFPQU0sU0FBQUMsaUJBQUEseUJBQUEsV0FDQUQsU0FBQUcsZUFFQXBCLEVBQUFhLGNBQ0FiLEVBQUFjLEtBQ0Fk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LE9BQVMsU0FBU0MsR0FDdEIsR0FBSWtELElBQVdsRCxLQUFNQSxFQUNyQixPQUFPTixHQUFNMEUsS0FBSyx1QkFBd0JsQixJQUczQzRGLEtBQUt3QyxvQkFBc0IsU0FBU2hKLEVBQWdCQyxFQUFnQkMsRUFBb0J4QyxHQUN2RixHQUFJMEMsSUFDTUMsT0FBYUwsRUFBZWIsSUFDNUJtQixPQUFhTixFQUFlWixJQUM1Qm1CLE9BQWFOLEVBQWVkLElBQzVCcUIsT0FBWVAsRUFBZWIsSUFDM0JxQixXQUFhUCxFQUFtQmYsSUFDaEN1QixXQUFhUixFQUFtQmQsS0FHaEN1QixFQUFlbkIsS0FBS0MsVUFBVVcsR0FFOUJzWCxHQUNBdFgsU0FBVU8sRUFDVmpELEtBQVVBLEVBT3BCLE9BQU9OLEdBQU0wRSxLQUFLLCtCQUFnQzRWLElBR25EbFIsS0FBSzJPLGVBQWlCLFNBQVN6WCxFQUFNbUQsR0FFcEMsR0FBSThXLElBQ0hqYSxLQUFTQSxFQUNUbUQsUUFBU0EsRUFNVixPQUFPekQsR0FBTTBFLEtBQUssZ0NBQWlDNlYiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG5hbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuXHQnbmdSb3V0ZScsXG5cdCduZ0FuaW1hdGUnLFxuXHQndWkuc2xpZGVyJyxcblx0JzcyMGtiLnNvY2lhbHNoYXJlJyxcbl0pO1xuIiwiXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkN0cmwnLCBmdW5jdGlvbihTZXNzaW9uU3ZjLCBVdGlsU3ZjLCBDb25maWdTdmMsICRyb290U2NvcGUsICRzY29wZSwgJHdpbmRvdywgJGh0dHAsICR0aW1lb3V0KXtcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gSU5JVElBTFxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICB3aW5kb3cub25iZWZvcmV1bmxvYWQgPSBmdW5jdGlvbihlKSB7XG4gICAgXHRTZXNzaW9uU3ZjLnJlbW92ZSgkc2NvcGUuZ3VpZClcbiAgICBcdC5zdWNjZXNzKGZ1bmN0aW9uKHJlcyl7XG4gICAgXHRcdC8vIGhhbmRsZSBzdWNjZXNzXG4gICAgXHR9KVxuICAgIFx0LmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgXHRcdC8vIGhhbmRsZSBlcnJvclxuICAgIFx0fSk7XG5cdH07XG5cblx0d2luZG93Lm9ucGFnZXNob3cgPSBmdW5jdGlvbihlKSB7XG5cdFx0JHNjb3BlLmluaXRTZXNzaW9uKCk7XG5cdFx0aWYgKCRzY29wZS5tYXApXG5cdCAgXHRcdCRzY29wZS5tYXAudXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cdH07XG5cblx0d2luZG93Lm9ucGFnZWhpZGUgPSBmdW5jdGlvbihlKSB7XG4gICAgXHRTZXNzaW9uU3ZjLnJlbW92ZSgkc2NvcGUuZ3VpZClcbiAgICBcdC5zdWNjZXNzKGZ1bmN0aW9uKHJlcyl7XG4gICAgXHRcdC8vIGhhbmRsZSBzdWNjZXNzXG4gICAgXHR9KVxuICAgIFx0LmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgXHRcdC8vIGhhbmRsZSBlcnJvclxuICAgIFx0fSk7XG5cdH07XG5cblx0Ly8gc2Vzc2lvbiBpbiBhbmQgb3V0IGV2ZW50c1xuXHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwidmlzaWJpbGl0eWNoYW5nZVwiLCBmdW5jdGlvbigpIHtcblx0ICBpZiAoZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09ICd2aXNpYmxlJyB8fCBcblx0ICBcdGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAnbW96VmlzaWJsZScgfHwgXG5cdCAgXHRkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ21zVmlzaWJsZScgfHxcblx0ICBcdGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAnd2Via2l0VmlzaWJsZScpXG5cdCAge1xuXHQgIFx0JHNjb3BlLmluaXRTZXNzaW9uKCk7XG5cdCAgXHRpZiAoJHNjb3BlLm1hcClcblx0ICBcdFx0JHNjb3BlLm1hcC51cGRhdGVBbmREcmF3UG9zdHMoKTtcblx0ICB9IFxuXHQgIGVsc2UgaWYgKGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAnaGlkZGVuJyB8fCBcblx0ICBcdGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAnbW96SGlkZGVuJyB8fCBcblx0ICBcdGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAnbXNIaWRkZW4nIHx8XG5cdCAgXHRkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ3dlYmtpdEhpZGRlbicpXG5cdCAge1xuXHQgIFx0U2Vzc2lvblN2Yy5yZW1vdmUoJHNjb3BlLmd1aWQpXG5cdCAgXHQuc3VjY2VzcyhmdW5jdGlvbihyZXMpe1xuICAgIFx0XHQvLyBoYW5kbGUgc3VjY2Vzc1xuICAgIFx0fSlcbiAgICBcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgIFx0XHQvLyBoYW5kbGUgZXJyb3JcbiAgICBcdH0pO1xuXHQgIH1cblx0fSk7XG5cblx0Ly8gd2Via2l0IHNlc3Npb24gaW4gYW5kIG91dCBldmVudHNcblx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIndlYmtpdHZpc2liaWxpdHljaGFuZ2VcIiwgZnVuY3Rpb24oKSB7XG5cdCAgaWYgKGRvY3VtZW50LndlYmtpdFZpc2libGUpXG5cdCAge1xuXHQgIFx0JHNjb3BlLmluaXRTZXNzaW9uKCk7XG5cdCAgXHRpZiAoJHNjb3BlLm1hcClcblx0ICBcdFx0JHNjb3BlLm1hcC51cGRhdGVBbmREcmF3UG9zdHMoKTtcblx0ICB9IFxuXHQgIGVsc2UgaWYgKGRvY3VtZW50LndlYmtpdEhpZGRlbilcblx0ICB7XG5cdCAgXHRTZXNzaW9uU3ZjLnJlbW92ZSgkc2NvcGUuZ3VpZClcblx0ICBcdC5zdWNjZXNzKGZ1bmN0aW9uKHJlcyl7XG4gICAgXHRcdC8vIGhhbmRsZSBzdWNjZXNzXG4gICAgXHR9KVxuICAgIFx0LmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgXHRcdC8vIGhhbmRsZSBlcnJvclxuICAgIFx0fSk7XG5cdCAgfVxuXHR9LCBmYWxzZSk7XG5cblx0JHNjb3BlLmluaXRTZXNzaW9uID0gZnVuY3Rpb24oKXtcblx0XHRpZiAoJHNjb3BlLm1hcCA9PSAndW5kZWZpbmVkJyB8fCAkc2NvcGUubWFwID09ICdudWxsJyB8fCAhJHNjb3BlLm1hcClcblx0XHRcdHJldHVybjtcblxuXHRcdGZ1bmN0aW9uIGdldEN1cnJMb2NTdWNjZXNzKHBvcykge1x0XG5cdFx0XHQvLy8vLy8vLy8vLy8vLy8vLy8gUEhZU0lDQUwgTE9DQVRJT05cblx0XHRcdC8vIOunqOyymOydjOyXkOuKlCDsnKDsoIDsnZgg7Iuk7KCcIOychOy5mCjslbHsl5Ag7J6F7J6l7ZaI7J2E65WM7J2YIOychOy5mCnsmYAg7IS87YSwIO2PrOyngOyFmOydhCDqsJnsnbQg67O064K06rOgLFxuXHRcdFx0Ly8g7IS87YSwIO2PrOyngOyFmOydgCDqs4Tsho0g7JeF642w7J207Yq4IOuQmOyWtOyVvCDtlZzri6QuXG5cdCAgICAgICAgdmFyIGNyZCA9IHBvcy5jb29yZHM7XG5cblx0ICAgICAgICB2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhjcmQubGF0aXR1ZGUsIGNyZC5sb25naXR1ZGUpO1xuXG5cdCAgICAgICAgLy8gc2F2ZSB0aGUgdXNlciBsb2NhdGlvbiBpbnRvIGFwcGxpY2F0aW9uIHNjb3BlIHZhcmlhYmxlXG5cdCAgICAgICAgJHNjb3BlLnVzZXJMb2NhdGlvbiA9IHtcblx0ICAgICAgICBcdGxhdDogY3JkLmxhdGl0dWRlLFxuXHQgICAgICAgIFx0bG9uOiBjcmQubG9uZ2l0dWRlXG5cdCAgICAgICAgfTtcblxuXHQgICAgICAgIHZhciBsb2NhdGlvbiA9IHtcblx0ICAgIFx0XHRsYXQ6Z29vZ2xlTG9jLmxhdCgpLFxuXHQgICAgXHRcdGxvbjpnb29nbGVMb2MubG5nKClcblx0ICAgIFx0fTtcblx0ICAgIFx0dmFyIGxvY2F0aW9uSlNPTiA9IEpTT04uc3RyaW5naWZ5KGxvY2F0aW9uKTtcblx0ICAgIFx0Ly9jb25zb2xlLmxvZyhcInNldHRpbmcgbG9jYXRpb25cIiwgbG9jYXRpb25KU09OKTtcblxuXHQgICAgXHQvLy8vLy8vLy8vLy8vLy8vLy8gV0FUQ0ggTE9DQVRJT05cblx0ICAgIFx0dmFyIGJvdW5kcyA9ICRzY29wZS5tYXAuZ2V0Qm91bmRzKCk7XG5cdCAgICAgICAgdmFyIG5lID0gYm91bmRzLmdldE5vcnRoRWFzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIG5vcnRoLWVhc3QgY29ybmVyXG5cdCAgICAgICAgdmFyIHN3ID0gYm91bmRzLmdldFNvdXRoV2VzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIHNvdXRoLXdlc3QgY29yZGVyXG5cdCAgICAgICAgLy9Zb3UgZ2V0IG5vcnRoLXdlc3QgYW5kIHNvdXRoLWVhc3QgY29ybmVycyBmcm9tIHRoZSB0d28gYWJvdmU6XG5cblx0ICAgICAgICB2YXIgY3VycmVudF9tYXBfbncgPSB7IFxuXHQgICAgICAgICAgICBsYXQ6IG5lLmxhdCgpLCBcblx0ICAgICAgICAgICAgbG9uOiBzdy5sbmcoKVxuXHQgICAgICAgIH07XG5cdCAgICAgICAgdmFyIGN1cnJlbnRfbWFwX3NlID0ge1xuXHQgICAgICAgICAgICBsYXQ6IHN3LmxhdCgpLCBcblx0ICAgICAgICAgICAgbG9uOiBuZS5sbmcoKVxuXHQgICAgICAgIH07XG5cblx0ICAgICAgICB2YXIgY3VycmVudF9tYXBfY2VudGVyID0ge1xuXHQgICAgICAgIFx0bGF0OndpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUsXG5cdCAgICAgICAgXHRsb246d2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGVcblx0ICAgIFx0fTtcblxuXHQgICAgICAgIHZhciB3YXRjaGxvYyA9IHtcblx0ICAgICAgICAgICAgbndfbGF0ICAgIDogY3VycmVudF9tYXBfbncubGF0LFxuXHQgICAgICAgICAgICBud19sb24gICAgOiBjdXJyZW50X21hcF9udy5sb24sXG5cdCAgICAgICAgICAgIHNlX2xhdCAgICA6IGN1cnJlbnRfbWFwX3NlLmxhdCxcblx0ICAgICAgICAgICAgc2VfbG9uXHQgIDogY3VycmVudF9tYXBfc2UubG9uLFxuXHQgICAgICAgICAgICBjZW50ZXJfbGF0OiBjdXJyZW50X21hcF9jZW50ZXIubGF0LFxuXHQgICAgICAgICAgICBjZW50ZXJfbG9uOiBjdXJyZW50X21hcF9jZW50ZXIubG9uXG5cdCAgICAgICAgfVxuXG4gICAgICAgIFx0dmFyIHdhdGNobG9jSlNPTiA9IEpTT04uc3RyaW5naWZ5KHdhdGNobG9jKTtcbiAgICAgICAgXHQvL2NvbnNvbGUubG9nKFwic2V0dGluZyB3YXRjaGxvY1wiLCB3YXRjaGxvY0pTT04pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8gTE9DQVRJT04gVVBEQVRFIFdJVEggU0VTU0lPTiBFTlRFUlxuICAgICAgICAgICAgLy/sl6zquLDshJwg67mE64+Z6riw7KCB7Jy866GcIOycoOyggOydmCDroZzsvIDsnbTshZjsnYQg7Ja76rOgIOyEuOyFmOydhCDrs7TrgrzsiJgg7J6I64ukLlxuXHRcdFx0dmFyIHNlc3Npb24gPSB7XG5cdFx0XHRcdGd1aWR0Z3QgOiAkc2NvcGUuZ3VpZHRndCxcblx0XHRcdFx0Z3VpZCAgICA6ICRzY29wZS5ndWlkLFxuXHRcdFx0XHRsb2NhdGlvbjogbG9jYXRpb25KU09OLFxuXHRcdFx0XHR3YXRjaGxvYzogd2F0Y2hsb2NKU09OXG5cdFx0XHR9O1xuXHRcdFx0U2Vzc2lvblN2Yy5lbnRlcihzZXNzaW9uKVxuXHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24ocmVzKXtcbiAgICBcdFx0Ly8gaGFuZGxlIHN1Y2Nlc3Ncblx0ICAgIFx0fSlcblx0ICAgIFx0LmNhdGNoKGZ1bmN0aW9uKGVycil7XG5cdCAgICBcdFx0Ly8gaGFuZGxlIGVycm9yXG5cdCAgICBcdH0pOyAvLyDshJzrsoTsl5DshJwg7Jyg7KCA6rCAIOuTpOyWtOyYtOydhCDslYzrprDri6QuXG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIGdldEN1cnJMb2NFcnJvcihlcnIpIHtcbiAgICAgICAgXHRzd2FsKFwiXCIsIFwiTmVlZCB0byB0dXJuIG9uIGxvY2F0aW9uIHNlcnZpY2UgZm9yIHByb3BlciB1c2UuXCIpO1xuICAgICAgICAgICAgLy9jb25zb2xlLndhcm4oJ0VSUk9SKCcgKyBlcnIuY29kZSArICcpOiAnICsgZXJyLm1lc3NhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaW5pdCBtYXAgYW5kIHBsYWNlIHNvbWUgbWFya2Vycywgc28gZXZlcnl0aGluZyBzdGFydCB3aXRoIHRoaXMgZnVuY3Rpb24uXG4gICAgICAgIHZhciBvcHRpb25zID0ge1xuXHRcdCAgZW5hYmxlSGlnaEFjY3VyYWN5OiBmYWxzZSxcblx0XHQgIHRpbWVvdXQ6IDEwMDAwLFxuXHRcdCAgbWF4aW11bUFnZTogMzAwMDAsXG5cdFx0fTtcblx0ICAgIG5hdmlnYXRvci5nZW9sb2NhdGlvbi5nZXRDdXJyZW50UG9zaXRpb24oZ2V0Q3VyckxvY1N1Y2Nlc3MsIGdldEN1cnJMb2NFcnJvciwgb3B0aW9ucyk7XG5cdFx0c3dhbCh7ICAgdGl0bGU6IFwiXCIsICAgdGV4dDogXCJSZXRyZWl2aW5nIGN1cnJuZXQgbG9jYXRpb24uLlwiLCAgIHRpbWVyOiAxMjAwLCAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSB9KTtcblx0fTtcblxuICAgIC8vIGxvYWQgYW5kIHNldCBsYXRlc3QgZ3VpZFxuXHRpZiAod2luZG93LmxvY2FsU3RvcmFnZS5ndWlkID09ICd1bmRlZmluZWQnIHx8IFxuXHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZCA9PSAnbnVsbCcgfHxcblx0XHQhd2luZG93LmxvY2FsU3RvcmFnZS5ndWlkKVxuXHR7XG5cdFx0d2luZG93LmxvY2FsU3RvcmFnZS5ndWlkID0gVXRpbFN2Yy5nZXRHdWlkKCk7XG5cdH1cblx0JHNjb3BlLmd1aWQgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWQ7XG5cblx0Ly8gbG9hZCBhbmQgc2V0IGxhdGVzdCBndWlkdGd0XG5cdGlmICh3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWR0Z3QgPT0gJ3VuZGVmaW5lZCcgfHwgXG5cdFx0d2luZG93LmxvY2FsU3RvcmFnZS5ndWlkdGd0ID09ICdudWxsJyB8fFxuXHRcdCF3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWR0Z3QpXG5cdHtcblx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWR0Z3QgPSBcIjBcIjtcblx0fVxuXHQkc2NvcGUuZ3VpZHRndCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZHRndDsgLy8gaW50ZXJlc3RlZCBvcHBvbmVudCBndWlkIG51bWJlclxuXG5cdCRzY29wZS5wYWdlSWQgPSB7IFxuXHRcdHBvc3QgOiAwLFxuXHR9O1xuXG5cdCRzY29wZS5uYXZDb2xsYXBzZWQgPSB0cnVlO1xuXG5cdC8vIHZhbHVlIGZyb20gdGltZSBzbGlkZXIgaW4gVUlcblx0Ly8gZGVmYXVsdCBpcyBtYXggaW5zdGFudCBsaWZlIHNwYW5cbiAgICAkc2NvcGUudGltZXZhbHVlID0gQ29uZmlnU3ZjLm1heEluc3RhbnRMaWZlU3BhbjtcblxuXHQvLyB1c2VyJ3MgY3VycmVudCBsb2NhdGlvbiBzdG9yYWdlXG5cdCRzY29wZS51c2VyTG9jYXRpb24gPSB7XG5cdFx0bGF0OiAwLjAsXG5cdFx0bG9uOiAwLjBcblx0fTtcblxuXHQkc2NvcGUudG9nZ2xlU2VhcmNoTG9jYXRpb24gPSBmYWxzZTtcblx0JHNjb3BlLnRvZ2dsZVRpbWVTbGlkZXIgPSBmYWxzZTtcblxuXHQvLyBldmVudCBoYW5kZXIgZm9yIG1hcCBVSXNcblx0JHRpbWVvdXQoZnVuY3Rpb24oKXtcblx0XHQvLyBlbmFibGVzIGVudGVyIGtleSB0byBzdWJtaXQgcG9zdCBmb3JtXG5cdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1wb3N0aW5nJykub25rZXlwcmVzcyA9IGZ1bmN0aW9uKGV2ZW50KXtcblx0XHRcdC8vY29uc29sZS5sb2coXCJJbnNpZGUga2V5cHJlc3NcIixldmVudC53aGljaCk7XG5cdFx0XHRpZiAoZXZlbnQud2hpY2ggPT0gJzEzJyl7XG5cdFx0XHRcdC8vY29uc29sZS5sb2coXCJlbnRlciBwcmVzc2VkXCIpO1xuXHRcdFx0XHQkKCdmb3JtI21hcC1wb3N0aW5nLWZvcm0nKS5zdWJtaXQoKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLXBvc3RpbmcnKS5vbmZvY3VzID0gZnVuY3Rpb24oZXZlbnQpe1xuXHRcdFx0Ly9jb25zb2xlLmxvZyhcIm9uIGZvY3VzXCIpO1xuXHRcdFx0JHNjb3BlLnRvZ2dsZVRpbWVTbGlkZXIgPSB0cnVlO1xuXHRcdH1cblxuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtcG9zdGluZycpLm9uYmx1ciA9IGZ1bmN0aW9uKGV2ZW50KXtcblx0XHRcdC8vY29uc29sZS5sb2coXCJvbiBibHVyXCIpO1xuXHRcdFx0JHNjb3BlLnRvZ2dsZVRpbWVTbGlkZXIgPSBmYWxzZTtcblx0XHR9XG5cblx0XHQkKCcubmF2LWJ1cmdlcicpLmNsaWNrKGZ1bmN0aW9uKCkge1xuXHRcdCAgJCgnLm5hdi1idXJnZXInKS50b2dnbGVDbGFzcygnYWN0aXZlJyk7XG5cdFx0ICAvLyQoJy5jb250cm9scycpLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcblx0XHQgICRzY29wZS50b2dnbGVTZWFyY2hMb2NhdGlvbiA9ICEkc2NvcGUudG9nZ2xlU2VhcmNoTG9jYXRpb247XG5cdFx0ICAkc2NvcGUuJGFwcGx5KCk7XG5cdFx0fSk7XG5cblx0fSk7XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFNPQ0tFVFxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdHZhciB1cmw7XG5cdHZhciBob3N0bmFtZSA9IGRvY3VtZW50LmxvY2F0aW9uLmhvc3RuYW1lO1xuXG5cdGlmIChob3N0bmFtZSA9PSBDb25maWdTdmMubG9jYWwpe1xuXHRcdHVybCA9IENvbmZpZ1N2Yy53ZWJfc29ja2V0ICsgQ29uZmlnU3ZjLmxvY2FsICsgJzonICsgQ29uZmlnU3ZjLnBvcnQ7XG5cdH1cblx0ZWxzZSBpZiAoaG9zdG5hbWUgPT0gQ29uZmlnU3ZjLmxvY2FsX2lwKSB7XG5cdFx0dXJsID0gQ29uZmlnU3ZjLndlYl9zb2NrZXQgKyBDb25maWdTdmMubG9jYWxfaXAgKyAnOicgKyBDb25maWdTdmMucG9ydDsgLy8gZGV2ZWxvcG1ldCBvbiBzb2NrZXQgbG9jYWxseSBcblx0fVxuXHRlbHNlIHtcblx0XHR1cmwgPSBDb25maWdTdmMud2ViX3NvY2tldCArIENvbmZpZ1N2Yy5kZXBsb3lfZG5zOyAvLyBwcm9kdWN0aW9uIGRlcGxveSB2ZXJzaW9uIC0gc3RpbGwgZGVidWcgbW9kZVxuXHRcdC8vdXJsID0gQ29uZmlnU3ZjLndlYl9zb2NrZXRfc2VjdXJlICsgQ29uZmlnU3ZjLmRlcGxveV9kbnM7IC8vIHByb2R1Y3Rpb24gZGVwbG95IHZlcnNpb24gLSBzdGlsbCBkZWJ1ZyBtb2RlXG5cdH1cblxuXHQvKiDqsJzrsJzqs7zsoJXsnbQg64Gd64KY6rOgIOuwsO2PrOyLnOyXkOuKlCDsnITrtoDrtoTsnYQg7KeA7Jqw6rOgIOyVhOuemCDsvZTrk5zrp4wg64Ko6rKo64+EIOuQnOuLpC5cblx0dXJsID0gJ3dzczovL2Zyb3plbi1iYWRsYW5kcy04NjQ5Lmhlcm9rdWFwcC5jb20nO1xuXHQqL1xuXHR2YXIgY29ubmVjdCA9IGZ1bmN0aW9uKCkge1xuXHRcdGNvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0KHVybCk7XG5cblx0XHRjb25uZWN0aW9uLm9ub3BlbiA9IGZ1bmN0aW9uKCl7XG5cblx0XHRcdC8vIHNlbmQgZ3VpZCB0byBzZXJ2ZXIgZm9yIHdzIGlkZW50aWZpY2F0aW9uXG5cdFx0XHRjb25uZWN0aW9uLnNlbmQoJHNjb3BlLmd1aWQpO1xuXHRcdFx0Ly9jb25zb2xlLmxvZygnV2ViU29ja2V0IGNvbm5lY3RlZCcpO1xuXHRcdH07XG5cblx0XHRjb25uZWN0aW9uLm9uY2xvc2UgPSBmdW5jdGlvbigpe1xuXG5cdFx0XHQvL2NvbnNvbGUubG9nKCdXZWJTb2NrZXQgY2xvc2VkLiBSZWNvbmVjdGluZy4uLicpO1xuXHRcdFx0JHRpbWVvdXQoY29ubmVjdCwgMjAwMCk7XG5cdFx0fTtcblxuXHRcdGNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24oZSl7XG5cdFx0XHQvL2NvbnNvbGUubG9nKCdicm9hZGNhc3QgbXNnIGZyb20gc2VydmVyOicsIGUpO1xuXHRcdFx0dmFyIHBheWxvYWQgPSBKU09OLnBhcnNlKGUuZGF0YSk7XG5cblx0XHRcdC8qXG5cdFx0XHRcdHdzOm5ld19wb3N0ICAgIC0g7IOI66Gc7Jq0IO2PrOyKpO2KuOqwgCDsmKzrnbzsmZTsnYTrlYwgZnJvbnQtZW5k7JeQ7IScIOunteydtCDri6Tsi5wg7JeF642w7J207Yq4IO2VtOyVvCDrkJzri6Tqs6Ag7JWM66Ck7KSA64ukIVxuXHRcdFx0XHR3czpuZXdfc2Vzc2lvbiAtIHNlc3Npb27snbQg7IOI66GcIOuTpOyWtOyYpOuptCDrkJzri6Tqs6Ag7JWM66Ck7KSA64ukIVxuXHRcdFx0XHR3czpyZW1vdmVfcG9zdCAtIO2PrOyKpO2KuOqwgCDsi5zqsITsnbQg64ukIOuQmOyWtOyEnCDsgqzrnbzsp4jrlYwhXG5cdFx0XHRcdOunpOyasOykkeyalCEgXG5cdFx0XHQqL1xuXHRcdFx0JHJvb3RTY29wZS4kYnJvYWRjYXN0KCd3czonICsgcGF5bG9hZC50eXBlLCBwYXlsb2FkLmRhdGEpO1xuXHRcdH07XG5cdH07XG5cdGNvbm5lY3QoKTtcblxuXHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFNPQ0tFVCBCUk9BRENBU1QgUkVDRUlWRVJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvLyBhcyBzZXJ2ZXIgc29ja2V0IHNlbmQgJ3dzOm5ld19wb3N0JyAsIHdlIGNhbiB1cGRhdGUgdGhlIG1hcCFcblx0JHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbihfLCBwb3N0KXtcblx0XHQvLyB1cGRhdGUgcG9zdHMgb24gbWFwXG5cdFx0JHNjb3BlLm1hcC51cGRhdGVBbmREcmF3UG9zdHMoKTtcblxuXHRcdC8vIHNob3cgcmVzcG9uc2l2ZSB1c2VycyBvbmx5IHRvIHRoZSB1c2VyIHdobyB3cm90ZSB0aGlzIHBvc3Rcblx0XHRpZiAocG9zdC5ndWlkID09ICRzY29wZS5ndWlkKVxuXHRcdHtcblx0XHRcdCRzY29wZS5tYXAuZHJhd1Jlc3BvbnNlcyhwb3N0KTtcblx0XHR9XG5cdH0pO1xuXG5cdC8vIGFzIHNlcnZlciBzb2NrZXQgc2VuZCAnd3M6bmV3X3Bvc3QnICwgd2UgY2FuIHVwZGF0ZSB0aGUgbWFwIVxuXHQkc2NvcGUuJG9uKCd3czpuZXdfc2Vzc2lvbicsIGZ1bmN0aW9uKF8sIHNlc3Npb24pe1xuXHRcdHZhciBsb2NhdGlvbiA9IGFuZ3VsYXIuZnJvbUpzb24oc2Vzc2lvbi5sb2NhdGlvbik7XG5cdFx0JHNjb3BlLm1hcC5kcmF3Q3VyckxvY2F0aW9uTWFya2VyKGxvY2F0aW9uKTtcblxuXHR9KTtcblxuXHQvLyB3aGVuIHNlcnZlciByZW1vdmUgdGhlIHBvc3QgYWZ0ZXIgdGltZSBmb3IgbG9uZ2VyIG9uZXMsIFxuXHQvLyB1cGRhdGUgbWFwIHdpdGggY29yZXNwb25kaW5nIGluZm9cblx0JHNjb3BlLiRvbignd3M6cmVtb3ZlX3Bvc3QnLCBmdW5jdGlvbihfLCBwb3N0aWQpe1xuXHRcdCRzY29wZS5tYXAudW5EcmF3UG9zdChwb3N0aWQpO1xuXHR9KTtcblxuXHQkc2NvcGUuJG9uKCd3czp1cGRhdGVfZ3VpZHRndCcsIGZ1bmN0aW9uKF8sIHVwZGF0ZWRTZXNzaW9uKXtcblx0XHQvLyB1cGRhdGUgcG9zdHMgb24gbWFwXG5cdFx0JHNjb3BlLm1hcC51cGRhdGVBbmREcmF3UG9zdHMoKTtcblx0fSk7XG5cblx0Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBBUFBMSUNBVElPTiBMRVZFTCBGVU5DVElPTlNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIHNlZSBpZiBpdHMgaW5zdGFudFxuICAgICRzY29wZS5pc0luc3RhbnQgPSBmdW5jdGlvbih0aW1ldmFsdWUpe1xuICAgIFx0aWYgKHRpbWV2YWx1ZSA8PSBDb25maWdTdmMubWF4SW5zdGFudExpZmVTcGFuKVxuICAgIFx0XHRyZXR1cm4gdHJ1ZTtcbiAgICBcdHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG5cdC8vIHNlZSBpZiBpdHMgbW9iaWxlIHBob25lXG5cdCRzY29wZS5pc01vYmlsZSA9IGZ1bmN0aW9uKCl7XG5cdFx0aWYoIG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0FuZHJvaWQvaSlcblx0XHQgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvd2ViT1MvaSlcblx0XHQgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBob25lL2kpXG5cdFx0IHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL2lQYWQvaSlcblx0XHQgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBvZC9pKVxuXHRcdCB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9CbGFja0JlcnJ5L2kpXG5cdFx0IHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL1dpbmRvd3MgUGhvbmUvaSlcblx0XHQgKXtcblx0XHQgICAgcmV0dXJuIHRydWU7XG5cdFx0ICB9XG5cdFx0IGVsc2Uge1xuXHRcdCAgICByZXR1cm4gZmFsc2U7XG5cdFx0ICB9XG5cdH07XG5cblx0LyogbW92ZSB0byBjdXJyZW50IGxvY2F0aW9uICovXG5cdCRzY29wZS5tb3ZlVG9DdXJyZW50TG9jYXRpb24gPSBmdW5jdGlvbigpe1xuXHRcdGZ1bmN0aW9uIGdldEN1cnJMb2NTdWNjZXNzKHBvcykge1xuICAgICAgICAgICAgLyogbWFrZSBzdXJlIHRvIGNoZWNrIHdlIGFyZSBvbiBwb3N0IHBhZ2Ugd2l0aCBtYXAgZmlyc3QgKi9cbiAgICAgICAgICAgIGlmICgkc2NvcGUuY3VycmVudFBhZ2VJZCAhPSAkc2NvcGUucGFnZUlkLnBvc3QpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICB2YXIgY3JkID0gcG9zLmNvb3JkcztcblxuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sYXRpdHVkZSA9IGNyZC5sYXRpdHVkZTtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlID0gY3JkLmxvbmdpdHVkZTtcblxuICAgICAgICAgICAgdmFyIGxvY2F0aW9uID0ge1xuICAgICAgICAgICAgXHRsYXQ6IGNyZC5sYXRpdHVkZSwgXG4gICAgICAgICAgICBcdGxvbjogY3JkLmxvbmdpdHVkZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gZHJhdyBkcm9wIGRvd24gdXNlciBwb3NpdGlvblxuICAgICAgICAgICBcdCRzY29wZS5tYXAuZHJhd0N1cnJMb2NhdGlvbk1hcmtlcihsb2NhdGlvbik7XG5cbiAgICAgICAgICAgXHQvLyBkcmF3IHggbWFya2VyXG5cdCAgICAgICAgJHNjb3BlLm1hcC5kcmF3WE1hcmtlcihsb2NhdGlvbik7XG5cblx0ICAgICAgICB2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsb2NhdGlvbi5sYXQsIGxvY2F0aW9uLmxvbik7XG5cblx0ICAgICAgICAvLyBtb3ZlIHRvIHRoZSBsb2NhdGlvbiBhbmQgem9vbSBpbnRvIHJpZ2h0IGFtb3VudFxuICAgICAgICAgICAgJHNjb3BlLm1hcC5wYW5Ubyhnb29nbGVMb2MpO1xuICAgICAgICAgICAgJHNjb3BlLm1hcC51cGRhdGVBbmREcmF3UG9zdHMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEN1cnJMb2NFcnJvcihlcnIpIHtcbiAgICAgICAgXHRzd2FsKFwiXCIsIFwiTmVlZCB0byB0dXJuIG9uIGxvY2F0aW9uIHNlcnZpY2UgZm9yIHByb3BlciB1c2UuXCIpO1xuICAgICAgICAgICAgLy9jb25zb2xlLndhcm4oJ0VSUk9SKCcgKyBlcnIuY29kZSArICcpOiAnICsgZXJyLm1lc3NhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaW5pdCBtYXAgYW5kIHBsYWNlIHNvbWUgbWFya2Vycywgc28gZXZlcnl0aGluZyBzdGFydCB3aXRoIHRoaXMgZnVuY3Rpb24uXG4gICAgICAgIHZhciBvcHRpb25zID0ge1xuXHRcdCAgZW5hYmxlSGlnaEFjY3VyYWN5OiB0cnVlLFxuXHRcdCAgdGltZW91dDogMTAwMDAsXG5cdFx0ICBtYXhpbXVtQWdlOiAzMDAwMCxcblx0XHR9O1xuICAgICAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGdldEN1cnJMb2NTdWNjZXNzLCBnZXRDdXJyTG9jRXJyb3IsIG9wdGlvbnMpO1xuXG4gICAgICAgIHN3YWwoeyAgIHRpdGxlOiBcIlwiLCAgIHRleHQ6IFwiTW92aW5nIHRvIGN1cnJlbnQgbG9jYXRpb24uLlwiLCAgIHRpbWVyOiAxMDAwLCAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSB9KTtcblx0fTtcblxuXHQkc2NvcGUubW92ZVRvUG9zdExvY2F0aW9uID0gZnVuY3Rpb24oKXtcblx0XHR2YXIgbGF0RGVsdGEgPSAwLjA7XG5cblx0XHRpZiAoJHNjb3BlLmlzTW9iaWxlKCkpe1xuXHRcdFx0dmFyIGJvdW5kcyA9ICRzY29wZS5tYXAuZ2V0Qm91bmRzKCk7XG5cdCAgICAgICAgdmFyIG5lID0gYm91bmRzLmdldE5vcnRoRWFzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIG5vcnRoLWVhc3QgY29ybmVyXG5cdCAgICAgICAgdmFyIHN3ID0gYm91bmRzLmdldFNvdXRoV2VzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIHNvdXRoLXdlc3QgY29yZGVyXG5cdCAgICAgICAgY3VycmVudF9tYXBfbncgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKG5lLmxhdCgpLCBzdy5sbmcoKSk7XG5cdCAgICAgICAgY3VycmVudF9tYXBfc2UgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHN3LmxhdCgpLCBuZS5sbmcoKSk7XG5cblx0ICAgICAgICB2YXIgbGF0RGVsdGFfY2VudGVyMm5vcnRoID0gMC41ICogTWF0aC5hYnMoJHNjb3BlLnBvc3RMb2NhdGlvbi5sYXQgLSBjdXJyZW50X21hcF9udy5sYXQoKSk7XG5cdCAgICAgICAgdmFyIGxhdERlbHRhX2NlbnRlcjJzb3V0aCA9IDAuNSAqIE1hdGguYWJzKCRzY29wZS5wb3N0TG9jYXRpb24ubGF0IC0gY3VycmVudF9tYXBfc2UubGF0KCkpO1xuXG5cdCAgICAgICAgaWYgKGxhdERlbHRhX2NlbnRlcjJub3J0aCA+IGxhdERlbHRhX2NlbnRlcjJzb3V0aCl7XG5cdCAgICAgICAgXHRsYXREZWx0YSA9IGxhdERlbHRhX2NlbnRlcjJzb3V0aDtcblx0ICAgICAgICB9XG5cdCAgICAgICAgZWxzZSB7XG5cdCAgICAgICAgXHRsYXREZWx0YSA9IGxhdERlbHRhX2NlbnRlcjJub3J0aDtcblx0ICAgICAgICB9XG5cdFx0fVxuXG5cdFx0dmFyIGNlbnRlckxvYyA9ICRzY29wZS5tYXAuZ2V0Q2VudGVyKCk7XG5cblx0XHR2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZygkc2NvcGUucG9zdExvY2F0aW9uLmxhdCArIGxhdERlbHRhLCBjZW50ZXJMb2MubG5nKCkpO1xuXHRcdCRzY29wZS5tYXAucGFuVG8oZ29vZ2xlTG9jKTtcblx0XHQkc2NvcGUubWFwLnVwZGF0ZUFuZERyYXdQb3N0cygpO1xuXHR9O1xuXG5cdCRzY29wZS5jb2xsYXBzZSA9IGZ1bmN0aW9uKCl7XG5cdFx0JHNjb3BlLm5hdkNvbGxhcHNlZCA9IHRydWU7XG5cdH07XG5cblx0Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBHRU5FUkFMIEJST0FEQ0FTVCBSRUNFSVZFUlxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgJHNjb3BlLiRvbignc2V0Om1hcCcsIGZ1bmN0aW9uKF8sIG1hcCl7XG5cdFx0JHNjb3BlLm1hcCA9IG1hcDtcblx0XHQkc2NvcGUuaW5pdFNlc3Npb24oKTtcblx0fSk7XG5cbiAgICAkc2NvcGUuJG9uKCdzZXQ6Z3VpZHRndCcsIGZ1bmN0aW9uKF8sIGd1aWR0Z3Qpe1xuXHRcdCRzY29wZS5ndWlkdGd0ID0gZ3VpZHRndDtcblxuXHRcdC8vIGl0cyB2ZXJ5IGltcG9yYW50IHRvIHNldCBsb2NhbCBzdG9yYWdlIGd1aWR0Z3Rcblx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWR0Z3QgPSBndWlkdGd0O1xuXHR9KTtcblxuXHQkc2NvcGUuJG9uKCdzZXQ6cGFnZWNoYW5nZScsIGZ1bmN0aW9uKF8sIHBhZ2VJZCl7XG5cdFx0JHNjb3BlLmN1cnJlbnRQYWdlSWQgPSBwYWdlSWQ7XG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ3NldDpsb2MnLCBmdW5jdGlvbihfLCBsb2NhdGlvbil7XG5cdFx0dmFyIGxhdCA9IGxvY2F0aW9uLmxhdCgpO1xuXHRcdHZhciBsb24gPSBsb2NhdGlvbi5sbmcoKTtcblx0XHQkc2NvcGUucG9zdExvY2F0aW9uID0ge1xuXHRcdFx0bGF0OiBsYXQsXG5cdFx0XHRsb246IGxvblxuXHRcdH07XG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ3NldDpwbGFjZScsIGZ1bmN0aW9uKF8sIHBsYWNlKXtcblx0XHQvLyBGb3JjaW5nIHRoZSB1cGRhdGUgd2l0aCAkYXBwbHkoKSBtZXRob2Qgb24gJHNjb3BlXG5cdFx0Ly8gcHJvYmxlbSByZWxhdGVkIG5vdGU6IGh0dHA6Ly93d3cuamVmZnJ5aG91c2VyLmNvbS9pbmRleC5jZm0vMjAxNC82LzIvSG93LWRvLUktcnVuLWNvZGUtd2hlbi1hLXZhcmlhYmxlLWNoYW5nZXMtd2l0aC1Bbmd1bGFySlNcblx0XHQkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XG5cdFx0XHRcdCRzY29wZS5wb3N0cGxhY2UgPSBwbGFjZTtcblx0XHRcdH1cblx0XHQpO1xuXHR9KTtcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnN0YW50KCdDb25maWdTdmMnLCB7XG5cdFwid2ViX3NvY2tldFwiXHRcdDogXCJ3czovL1wiLFxuXHRcIndlYl9zb2NrZXRfc2VjdXJlXCIgOiBcIndzczovL1wiLFxuXHRcImxvY2FsXCJcdFx0XHRcdDogXCJsb2NhbGhvc3RcIixcblx0XCJsb2NhbF9pcFwiXHRcdFx0OiBcIjE5Mi4xNjguMC40XCIsXG5cdC8vXCJkZXBsb3lfZG5zXCJcdFx0OiBcImNsb3VkdGFsay5oZXJva3VhcHAuY29tXCIsXG5cdFwiZGVwbG95X2Ruc1wiXHRcdDogXCJ0YWxraXBpYS5jb21cIixcblx0XCJwb3J0XCJcdFx0XHRcdDogXCI1MDAwXCIsXG5cdFwibWF4SW5zdGFudExpZmVTcGFuXCI6IDUwMDAsXG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbmZpZyhmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIpe1xuXHQkcm91dGVQcm92aWRlclxuXHQud2hlbignLycsIFxuXHRcdHtcblx0XHRcdGNvbnRyb2xsZXI6ICdQb3N0c0N0cmwnLCBcblx0XHRcdHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9wb3N0cy5odG1sJ1xuXHRcdH0pXG5cdC8vIFJlZGlyZWN0IHRvIHRoZSByb290IHBhZ2UuXG5cdC5vdGhlcndpc2UoXG5cdFx0e1xuICAgXHRcdFx0cmVkaXJlY3RUbzogJy8nXG5cdFx0fSk7XG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1V0aWxTdmMnLCBmdW5jdGlvbigpe1xuXHR2YXIgc3ZjID0gdGhpcztcblxuXHRzdmMuZGVnMnJhZCA9IGZ1bmN0aW9uKGRlZykge1xuXHQgIHJldHVybiBkZWcgKiAoTWF0aC5QSS8xODApO1xuXHR9O1xuXG5cdHN2Yy5nZXREaXN0YW5jZUZyb21MYXRMb25JbkttID0gZnVuY3Rpb24gKGxhdDEsbG9uMSxsYXQyLGxvbjIpIHtcblx0ICB2YXIgUiA9IDYzNzE7XG5cdCAgdmFyIGRMYXQgPSBzdmMuZGVnMnJhZChsYXQyLWxhdDEpO1xuXHQgIHZhciBkTG9uID0gc3ZjLmRlZzJyYWQobG9uMi1sb24xKTsgXG5cdCAgdmFyIGEgPSBcblx0ICAgIE1hdGguc2luKGRMYXQvMikgKiBNYXRoLnNpbihkTGF0LzIpICtcblx0ICAgIE1hdGguY29zKHN2Yy5kZWcycmFkKGxhdDEpKSAqIE1hdGguY29zKHN2Yy5kZWcycmFkKGxhdDIpKSAqIFxuXHQgICAgTWF0aC5zaW4oZExvbi8yKSAqIE1hdGguc2luKGRMb24vMilcblx0ICAgIDsgXG5cdCAgdmFyIGMgPSAyICogTWF0aC5hdGFuMihNYXRoLnNxcnQoYSksIE1hdGguc3FydCgxLWEpKTsgXG5cdCAgdmFyIGQgPSBSICogYztcblx0ICByZXR1cm4gZDtcblx0fTtcblxuXHRzdmMubWFwUmFuZ2UgPSBmdW5jdGlvbiAodmFsdWUsIGxvdzEsIGhpZ2gxLCBsb3cyLCBoaWdoMikge1xuXHQgICAgcmV0dXJuIGxvdzIgKyAoaGlnaDIgLSBsb3cyKSAqICh2YWx1ZSAtIGxvdzEpIC8gKGhpZ2gxIC0gbG93MSk7XG5cdH07XG5cblx0c3ZjLmdldEd1aWQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0ZnVuY3Rpb24gczQoKSB7XG5cdFx0ICAgIHJldHVybiBNYXRoLmZsb29yKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKVxuXHRcdCAgICAgIC50b1N0cmluZygxNilcblx0XHQgICAgICAuc3Vic3RyaW5nKDEpO1xuXHRcdH1cblx0ICBcdHJldHVybiBzNCgpICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyBzNCgpICsgczQoKTtcblx0fTtcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnJ1bihmdW5jdGlvbigkcm9vdFNjb3BlLCAkdGltZW91dCwgU2Vzc2lvblN2Yyl7XG5cblxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uZGlyZWN0aXZlKCdhcHBNYXAnLCBmdW5jdGlvbihQb3N0c1N2YywgVXRpbFN2YywgQ29uZmlnU3ZjLCBTZXNzaW9uU3ZjLCAkY29tcGlsZSwgJHRpbWVvdXQpIHtcbiAgICAvLyBkaXJlY3RpdmUgbGluayBmdW5jdGlvblxuICAgIHZhciBsaW5rID0gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gR0xPQkFMIFZBUklBQkxFUyBJTiBMSU5LIEZVTkNUSU9OXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIHZhciBtYXA7IC8vIGV4cGFuZCBmcm9tIGdvb2dsZSBtYXAgZm9yIG1hbnVhbGx5IGNyZWF0ZWQgZXZlbnRzXG4gICAgICAgIHZhciBtYXBfb3JpZ2luOyAvLyBmb3Igb3JpZ2luYWwgZ29vZ2xlIG1hcCBldmVudCBmdW5jdGlvbiBsaW5rc1xuICAgICAgICB2YXIgY3VycmVudF9tYXBfbnc7XG4gICAgICAgIHZhciBjdXJyZW50X21hcF9zZTtcbiAgICAgICAgdmFyIG1hcE9wdGlvbnM7XG4gICAgICAgIHZhciBpbml0aWFsTWFwQ2VudGVyO1xuICAgICAgICB2YXIgQ0xPVURfTUFQX0lEID0gJ2N1c3RvbV9zdHlsZSc7IC8vIG1hcCBzdHlsZVxuICAgICAgICB2YXIgaGVscGVyTWFya2VycyA9IFtdO1xuICAgICAgICB2YXIgbWFya2Vyc09uTWFwID0gW107XG5cbiAgICAgICAgdmFyIHByZXZHdWlkdGd0ID0gJzAnO1xuICAgICAgICB2YXIgaXNHdWlkdGd0Q2hhbmdlZDtcblxuICAgICAgICB2YXIgaW1hZ2VQb3N0ID0ge1xuICAgICAgICAgICAgLy91cmw6ICdodHRwczovL2NhdGNobWUuaWZ5b3VjYW4uY29tL2ltYWdlcy9waWN0dXJlcy9JWUNfSWNvbnMvSVlDX0xvY2F0aW9uX0ljb25fU21hbGwucG5nJyxcbiAgICAgICAgICAgIHVybDogJ0RlZmF1bHRfTWFya2VyLnBuZycsXG4gICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICBvcmlnaW46IG5ldyBnb29nbGUubWFwcy5Qb2ludCgwLCAwKSxcbiAgICAgICAgICAgIGFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDE3LCAzNCksXG4gICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxLCAxKVxuICAgICAgICB9O1xuICAgICAgICB2YXIgaW1hZ2VUYXJnZXQgPSB7XG4gICAgICAgICAgICAvL3VybDogJ2h0dHA6Ly93d3cuY2xrZXIuY29tL2NsaXBhcnRzL1UvUC9qL00vSS9pL3gtbWFyay15ZWxsb3ctbWQucG5nJyxcbiAgICAgICAgICAgIHVybDogJ1hfTWFya2VyLnBuZycsXG4gICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICBvcmlnaW46IG5ldyBnb29nbGUubWFwcy5Qb2ludCgwLCAwKSxcbiAgICAgICAgICAgIGFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDE3LCAzNCksXG4gICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgyNSwgMjUpXG4gICAgICAgIH07XG4gICAgICAgIHZhciBpbWFnZVVzZXJMb2dpbiA9IHtcbiAgICAgICAgICAgIC8vdXJsOiAnaHR0cDovL3d3dy5jbGtlci5jb20vY2xpcGFydHMvcS9vLzIvSy9nL1YvbG9jYXRpb24tc3ltYm9sLW1hcC1tZC5wbmcnLFxuICAgICAgICAgICAgdXJsOiAnQ3VycmVudF9Mb2NhdGlvbl9NYXJrZXIucG5nJyxcbiAgICAgICAgICAgIHNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDEwMCwgMTAwKSxcbiAgICAgICAgICAgIG9yaWdpbjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDAsIDApLFxuICAgICAgICAgICAgYW5jaG9yOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMTcsIDM0KSxcbiAgICAgICAgICAgIHNjYWxlZFNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDIwLCAzMylcbiAgICAgICAgfTtcblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBFVkVOVCBIQU5ETEVSUyAtIFVQREFURVxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVEZWZhdWx0TG9jYXRpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gbWFwLmdldENlbnRlcigpLmxhdCgpO1xuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUgPSBtYXAuZ2V0Q2VudGVyKCkubG5nKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVCb3VuZHMoKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgYm91bmRzID0gbWFwLmdldEJvdW5kcygpO1xuICAgICAgICAgICAgdmFyIG5lID0gYm91bmRzLmdldE5vcnRoRWFzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIG5vcnRoLWVhc3QgY29ybmVyXG4gICAgICAgICAgICB2YXIgc3cgPSBib3VuZHMuZ2V0U291dGhXZXN0KCk7IC8vIExhdExuZyBvZiB0aGUgc291dGgtd2VzdCBjb3JkZXJcbiAgICAgICAgICAgIC8vWW91IGdldCBub3J0aC13ZXN0IGFuZCBzb3V0aC1lYXN0IGNvcm5lcnMgZnJvbSB0aGUgdHdvIGFib3ZlOlxuXG4gICAgICAgICAgICBjdXJyZW50X21hcF9udyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobmUubGF0KCksIHN3LmxuZygpKTtcbiAgICAgICAgICAgIGN1cnJlbnRfbWFwX3NlID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhzdy5sYXQoKSwgbmUubG5nKCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlV2F0Y2hMb2NhdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBib3VuZHMgPSBtYXAuZ2V0Qm91bmRzKCk7XG4gICAgICAgICAgICB2YXIgbmUgPSBib3VuZHMuZ2V0Tm9ydGhFYXN0KCk7IC8vIExhdExuZyBvZiB0aGUgbm9ydGgtZWFzdCBjb3JuZXJcbiAgICAgICAgICAgIHZhciBzdyA9IGJvdW5kcy5nZXRTb3V0aFdlc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBzb3V0aC13ZXN0IGNvcmRlclxuICAgICAgICAgICAgLy9Zb3UgZ2V0IG5vcnRoLXdlc3QgYW5kIHNvdXRoLWVhc3QgY29ybmVycyBmcm9tIHRoZSB0d28gYWJvdmU6XG5cbiAgICAgICAgICAgIGN1cnJlbnRfbWFwX253ID0geyBcbiAgICAgICAgICAgICAgICBsYXQ6IG5lLmxhdCgpLCBcbiAgICAgICAgICAgICAgICBsb246IHN3LmxuZygpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY3VycmVudF9tYXBfc2UgPSB7XG4gICAgICAgICAgICAgICAgbGF0OiBzdy5sYXQoKSwgXG4gICAgICAgICAgICAgICAgbG9uOiBuZS5sbmcoKVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGN1cnJlbnRfbWFwX2NlbnRlciA7XG5cbiAgICAgICAgICAgIC8vIHNlZSBpZiB0aGUgbGF0ZXN0IHggbWFya2VyIG9yIHBvc3QgbG9jYXRpb24gaXMgd2l0aGluIHVzZXIncyB2aWV3XG4gICAgICAgICAgICBpZiAoIShzY29wZS5wb3N0TG9jYXRpb24ubGF0IDwgY3VycmVudF9tYXBfbncubGF0KSB8fFxuICAgICAgICAgICAgICAgICEoc2NvcGUucG9zdExvY2F0aW9uLmxhdCA+IGN1cnJlbnRfbWFwX3NlLmxhdCkgfHxcbiAgICAgICAgICAgICAgICAhKHNjb3BlLnBvc3RMb2NhdGlvbi5sb24gPCBjdXJyZW50X21hcF9zZS5sb24pIHx8XG4gICAgICAgICAgICAgICAgIShzY29wZS5wb3N0TG9jYXRpb24ubG9uID4gY3VycmVudF9tYXBfbncubG9uKSApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gaWYgaXQgaXMgbm90IHdpdGhpbiB1c2VyJ3MgdmlldywgdGhlbiBqdXN0IHVzZSBtYXAgY2VudGVyXG4gICAgICAgICAgICAgICAgY3VycmVudF9tYXBfY2VudGVyID0ge1xuICAgICAgICAgICAgICAgICAgICBsYXQ6IG1hcC5nZXRDZW50ZXIoKS5sYXQoKSxcbiAgICAgICAgICAgICAgICAgICAgbG9uOiBtYXAuZ2V0Q2VudGVyKCkubG5nKClcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vIGlmIGl0IGlzIHdpdGhpbiB1c2VyJ3MgdmlldywgdXNlIHggbWFya2VyIGxvY2F0aW9uIGEuay5hIHBvc3QgbG9jYXRpb25cbiAgICAgICAgICAgICAgICBjdXJyZW50X21hcF9jZW50ZXIgPSB7XG4gICAgICAgICAgICAgICAgICAgIGxhdDogc2NvcGUucG9zdExvY2F0aW9uLmxhdCxcbiAgICAgICAgICAgICAgICAgICAgbG9uOiBzY29wZS5wb3N0TG9jYXRpb24ubG9uXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFNlc3Npb25TdmMudXBkYXRlV2F0Y2hMb2NhdGlvbihjdXJyZW50X21hcF9udywgY3VycmVudF9tYXBfc2UsIGN1cnJlbnRfbWFwX2NlbnRlciwgc2NvcGUuZ3VpZCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBFVkVOVCBIQU5ETEVSUyAtIERSQVdcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gdXBkYXRlIHJlc3BvbnNlcyBzdWNoIGFzIHZpc3VhbGl6YXRpb24gb2YgbGlzdGVuZXJzXG4gICAgICAgIGZ1bmN0aW9uIGRyYXdSZXNwb25zZXMocG9zdCl7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdyZWZlcmVuY2UgcG9zdDonLCBwb3N0KTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gZHJhd0JsaW5rcyhzZXNzaW9ucyl7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlc3Npb25zLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlc3Npb24gPSBzZXNzaW9uc1tpXTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBza2lwIG15IHNlc3Npb24gLSBubyBuZWVkIHRvIGRyYXcg64K0IOyekOyLoOydmCDshLjshZjsnYAg6re466a07ZWE7JqU6rCAIOyXhuuLpC5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlc3Npb24uZ3VpZCA9PSBzY29wZS5ndWlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgICAgICAgICAgICAgIC8vIHNlc3Npb24ncyB3YXRjaCBsb2NhdGlvbiB3aWxsIGJlIGJvdW5jZWQhXG4gICAgICAgICAgICAgICAgICAgIHZhciB3YXRjaF9sb2NhdGlvbiA9IGFuZ3VsYXIuZnJvbUpzb24oc2Vzc2lvbi53YXRjaGxvYyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwb3N0X2xvY2F0aW9uICA9IGFuZ3VsYXIuZnJvbUpzb24ocG9zdC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyDsnKDsoIDqsIAg67O06rOgIOyeiOuKlCDrsJTsmrTrjZTrpqwg7JWI7JeQIOq3uCBzZXNzaW9uKOuLpOuluOycoOyggCkg7LK07YKBXG5cbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhjdXJyZW50X21hcF9zZSwgY3VycmVudF9tYXBfbncpO1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVCb3VuZHMoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEod2F0Y2hfbG9jYXRpb24uY2VudGVyX2xhdCA8IGN1cnJlbnRfbWFwX253LmxhdCgpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgISh3YXRjaF9sb2NhdGlvbi5jZW50ZXJfbGF0ID4gY3VycmVudF9tYXBfc2UubGF0KCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKHdhdGNoX2xvY2F0aW9uLmNlbnRlcl9sb24gPCBjdXJyZW50X21hcF9zZS5sbmcoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEod2F0Y2hfbG9jYXRpb24uY2VudGVyX2xvbiA+IGN1cnJlbnRfbWFwX253LmxuZygpKSApXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gc2Vzc2lvbijri6TrpbjsnKDsoIAp65Ok7J20IOq3uCDtj6zsiqTtirjrpbwg67O06rOgIOyeiOyngCDslYrsnLzrqbQg7Iqk7YK1LlxuICAgICAgICAgICAgICAgICAgICBpZiAoIShwb3N0X2xvY2F0aW9uLmxhdCA8IHdhdGNoX2xvY2F0aW9uLm53X2xhdCkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEocG9zdF9sb2NhdGlvbi5sYXQgPiB3YXRjaF9sb2NhdGlvbi5zZV9sYXQpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKHBvc3RfbG9jYXRpb24ubG9uIDwgd2F0Y2hfbG9jYXRpb24uc2VfbG9uKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIShwb3N0X2xvY2F0aW9uLmxvbiA+IHdhdGNoX2xvY2F0aW9uLm53X2xvbikgKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyh3YXRjaF9sb2NhdGlvbi5jZW50ZXJfbGF0LCB3YXRjaF9sb2NhdGlvbi5jZW50ZXJfbG9uKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciByYW5kb21TaXplID0gTWF0aC5yYW5kb20oKSAqIDQwICsgNDA7IFxuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsTmFtZSAgICA9ICdCbGluay5naWYnO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbWFnZUxpc3RlbmVyID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMTAwLCAxMDApLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMCwgMCksXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludChyYW5kb21TaXplICogMC41ICsgNSwgcmFuZG9tU2l6ZSAqIDAuNSArIDE0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlZFNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKHJhbmRvbVNpemUsIHJhbmRvbVNpemUpXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uKGltYWdlTGlzdGVuZXIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlck9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGdvb2dsZUxvYyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXA6IG1hcCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJSZWNlaXZlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb246IGltYWdlTGlzdGVuZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW1pemVkOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIobWFya2VyT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVjZWl2ZXJfbWFya2VyX2xpZmVzcGFuID0gMTIwMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uKG9sZF9tYXJrZXIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZF9tYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xkX21hcmtlciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfShtYXJrZXIpKSwgXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXZlcl9tYXJrZXJfbGlmZXNwYW4pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0oaW1hZ2VMaXN0ZW5lcikpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFNlc3Npb25TdmMuZmV0Y2goKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZHJhd0JsaW5rcylcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgICAgIC8vaGFuZGxlIGVycm9yc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjaGVjayBpZiB0aGUgcG9zdCBpcyBjb21wbGV0bHkgZGVhZCBhbmQgcmVtb3ZlIHRoYXQgcG9zdFxuICAgICAgICBmdW5jdGlvbiBjbGVhbnVwKCkge1xuICAgICAgICAgICAgIGZvciAodmFyIGogPSAwLCBtYXJrZXI7IG1hcmtlciA9IG1hcmtlcnNPbk1hcFtqXTsgaisrKXtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudERhdGUgICAgICA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lTWlsbGkgPSBjdXJyZW50RGF0ZS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgdmFyIGxpZmUgPSBtYXJrZXIucG9zdC5saWZlZW5kIC0gY3VycmVudFRpbWVNaWxsaTtcblxuICAgICAgICAgICAgICAgIGlmIChsaWZlIDw9IDApe1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdjbGVhbmluZyB1cC4uJywgbWFya2VyLnBvc3QuX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgdW5EcmF3UG9zdChtYXJrZXIucG9zdC5faWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUFuZERyYXdQb3N0cygpe1xuICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBmb3IgY2hlY2tpbmcgbG9jYWwgcG9zdHMgLSBpc1BvaW50aW5nWW91XG4gICAgICAgICAgICBpc0d1aWR0Z3RDaGFuZ2VkID0gcHJldkd1aWR0Z3QgIT0gc2NvcGUuZ3VpZHRndDsgLy8gc2VlIGlmIG15IGd1aWR0Z3QgaGFzIGNoYW5nZWQ7XG4gICAgICAgICAgICBwcmV2R3VpZHRndCA9IHNjb3BlLmd1aWR0Z3Q7IC8vIHVwZGF0ZSBwcmV2aW91cyBndWlkdGd0XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGRyYXdQb3N0cyhwb3N0cyl7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBvc3RzLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvc3QgPSBwb3N0c1tpXTtcblxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNUQVJUIC0gQ0hFQ0sgSUYgSVRTIFdJVEhJTiBWSUVXIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2F0aW9uID0gYW5ndWxhci5mcm9tSnNvbihwb3N0LmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobG9jYXRpb24ubGF0LCBsb2NhdGlvbi5sb24pO1xuXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUJvdW5kcygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIShnb29nbGVMb2MubGF0KCkgPCBjdXJyZW50X21hcF9udy5sYXQoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEoZ29vZ2xlTG9jLmxhdCgpID4gY3VycmVudF9tYXBfc2UubGF0KCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKGdvb2dsZUxvYy5sbmcoKSA8IGN1cnJlbnRfbWFwX3NlLmxuZygpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIShnb29nbGVMb2MubG5nKCkgPiBjdXJyZW50X21hcF9udy5sbmcoKSkgKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsgLy8gc2tpcCB0aGlzIHBvc3QgLSBubyBuZWVkIHRvIGRyYXdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEVORCAtIENIRUNLIElGIElUUyBXSVRISU4gVklFVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNUQVJUIC0gQ0hFQ0sgV0UgSEFWRSBUTyBSRURSQVcgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgbWFya2VycyBwb3N0IGlzIGV4aXNpdGluZyBvbmUsIHdlIGRvbid0IHdhbnQgdG8gZHJhdyBpdCBhZ2Fpbi5cbiAgICAgICAgICAgICAgICAgICAgLy8gb25seSBkcmF3IG5ldyBvbmVzIVxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgbWFya2VyOyBtYXJrZXIgPSBtYXJrZXJzT25NYXBbal07IGorKyl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8v7J2067aA67aEIOuhnOyngeydhCDri6Tsi5wg7Kec7JW87ZWoXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNBbHJlYWR5RHJhd24gPSBwb3N0Ll9pZCA9PSBtYXJrZXIucG9zdC5faWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBbHJlYWR5RHJhd24pIC8vIOydtOuvuCDqt7jroKTsoYzripTsp4Ag7YWM7Iqk7Yq4XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzR3VpZHRndENoYW5nZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bkRyYXdQb3N0KHBvc3QuX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtYXJrZXIucG9zdC5ndWlkdGd0ID09IHBvc3QuZ3VpZHRndCl7ICAvLyDsnbTrr7gg6re466Ck7KeE6rKD7KSRLCBndWlkdGd07J20IOuwlOuAjOyXiOuKlOqwgFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0ID0gbnVsbDsgLy8g7J2066+4IOq3uOugpOynhCDtj6zsiqTtirjrnbzrqbQsIG51bGzroZwuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOyAvLyDsnbQgbG9vcOydgCBwb3N0Ll9pZOunjCDqsoDsgqzsmqnsnoTsnLzroZwsIOunjOyVvSDqsrnsuZjrqbQg67CU66GcIGxvb3DsnYQg66mI7Law64+EIOq0nOywruuLpC59XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5EcmF3UG9zdChwb3N0Ll9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChwb3N0ID09IG51bGwpe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7IC8vIHNraXAgdGhpcyBwb3N0IC0gbm8gbmVlZCB0byBkcmF3XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBFTkQgLSBDSEVDSyBXRSBIQVZFIFRPIFJFRFJBVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNUQVJUIC0gRFJBV0lORyBQT1NUIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgICAgICAgICAgICAgLy8gbWFya2VyIG9wdGlvbiBzZXR0aW5nXG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXJrZXJPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGdvb2dsZUxvYyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcDogbWFwLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwiQnViYmxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uOiBpbWFnZVBvc3RcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIobWFya2VyT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFkZCBtYXJrZXIgdG8gYXJyYXksIHRoaXMgbWVhbnMgdGhhdCBpdCBoYXMgYmVlbiBkcmF3biB0byBtYXBcbiAgICAgICAgICAgICAgICAgICAgbWFya2Vyc09uTWFwLnB1c2goXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyOiBtYXJrZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdCAgOiBwb3N0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNUQVJUIC0gRFJBV0lORyBNRVNTQUdFIFdJTkRPVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb3VwbGluZ19zdGF0dXMgPSBjYWxjdWxhdGVDb3VwbGluZyhwb3N0Lmd1aWQsIHBvc3QuZ3VpZHRndCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcInBvc3QuaXNMb2NhbFwiLCBwb3N0LmlzbG9jYWwpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYWxfc3RhdHVzID0gcG9zdC5pc2xvY2FsO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIOyKpOy9lO2UhOyXkOyEnOu2gO2EsCDsg4jroZzsmrQg7LCo7J2865OcIOyKpOy9lO2UhOulvCDrp4zrk6TslrQgZWFjaCBmb3IgbG9vcOyXkOyEnCDsgqzsmqntlZzri6QuXG4gICAgICAgICAgICAgICAgICAgIC8vIC0tPiDtlbTslbwsIOqwgSBET03snbQg6rCB6rCB7J2YIHNjb3Bl66W8IOqwgOyguOyEnCBwb3N0IG1zZ+qwgCDslYgg6rK57Lmc64ukLlxuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gc2NvcGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9IHBhcmVudC4kbmV3KHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBvcGVuSW5mb1dpbmRvdyA9IChmdW5jdGlvbihtYXJrZXIsIGNoaWxkX3Njb3BlLCBwb3N0LCBjb3VwbGluZ19zdGF0dXMsIGxvY2FsX3N0YXR1cyl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBuZXcgd2luZG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZm9XaW5kb3dPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaXhlbE9mZnNldDogbmV3IGdvb2dsZS5tYXBzLlNpemUoLTM5LjUsIDE2LjApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlQXV0b1BhbjogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZm9XaW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyhpbmZvV2luZG93T3B0aW9ucyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgY3VycmVudCB0aW1lIGFuZCBzdWJ0cmFjdCBpdCBmcm9tIHBvc3QncyBlbmQgdGltZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGF0IHdpbGwgYmUgYWNjdXJhdGUgcG9zdCB0aW1lIGZvciBpbnN0YW50IHBvc3RzIGFuZCBsb25nIHBvc3RzLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50RGF0ZSAgICAgID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudFRpbWVNaWxsaSA9IGN1cnJlbnREYXRlLmdldFRpbWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zdGxpZmUgICAgICAgICA9ICgocG9zdC5saWZlZW5kIC0gY3VycmVudFRpbWVNaWxsaSkgPj0gMCkgPyAocG9zdC5saWZlZW5kIC0gY3VycmVudFRpbWVNaWxsaSkgOiAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxpZmVwZXJjZW50YWdlID0gKHBvc3RsaWZlIC8gcG9zdC5saWZlc3BhbikudG9GaXhlZCgyKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy90byBtYWtlIGRhdGEgYXZhaWxhYmxlIHRvIHRlbXBsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUubXNnICAgICAgICAgICAgICAgID0gcG9zdC5ib2R5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3RsaWZlICAgICAgICAgICA9IHBvc3RsaWZlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3RndWlkICAgICAgICAgICA9IHBvc3QuZ3VpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Z3VpZHRndCAgICAgICAgPSBwb3N0Lmd1aWR0Z3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUucG9zdGNvdXBsZXN0YXR1cyAgID0gY291cGxpbmdfc3RhdHVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA9IGxpZmVwZXJjZW50YWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3Rsb2NhbHN0YXR1cyAgICA9IGxvY2FsX3N0YXR1cztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBlbmFibGVzIGNoYW5naW5nIGNvdXBsaW5nIHZhbHVlIGluc3RhbnRseS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS4kb24oJ3NldDpjb3VwbGluZycsIGZ1bmN0aW9uKF8sIGNvdXBsaW5nX3VwZGF0ZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3Rjb3VwbGVzdGF0dXMgPSBjb3VwbGluZ191cGRhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbXBpbGUgaXQgYmVmb3JlIGxvYWRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50ICA9ICc8ZGl2IG1hcC1tc2c+PC9kaXY+JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29tcGlsZWQgPSAkY29tcGlsZShjb250ZW50KShjaGlsZF9zY29wZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93LnNldENvbnRlbnQoIGNvbXBpbGVkWzBdICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihpbmZvV2luZG93LCdjbG9zZWNsaWNrJyxmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9zdC5ndWlkID09IHNjb3BlLmd1aWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2FsKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIkFyZSB5b3Ugc3VyZT9cIiwgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIllvdSB3aWxsIG5vdCBiZSBhYmxlIHRvIHJlY292ZXIgdGhpcyBpbWFnaW5hcnkgZmlsZSFcIiwgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIndhcm5pbmdcIiwgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLCAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogXCIjREQ2QjU1XCIsICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6IFwiWWVzLCBkZWxldGUgaXQhXCIsICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VPbkNvbmZpcm06IGZhbHNlIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihpc0NvbmZpcm0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NvbmZpcm0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQb3N0c1N2Yy5yZW1vdmUocG9zdClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBzdWNjZXNzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaGFuZGxlIGVycm9yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3YWwoXCJEZWxldGVkIVwiLCBcIllvdXIgaW1hZ2luYXJ5IGZpbGUgaGFzIGJlZW4gZGVsZXRlZC5cIiwgXCJzdWNjZXNzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50RGF0ZSAgICAgID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lTWlsbGkgPSBjdXJyZW50RGF0ZS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3N0bGlmZSAgICAgICAgID0gKChwb3N0LmxpZmVlbmQgLSBjdXJyZW50VGltZU1pbGxpKSA+PSAwKSA/IChwb3N0LmxpZmVlbmQgLSBjdXJyZW50VGltZU1pbGxpKSA6IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsaWZlcGVyY2VudGFnZSA9IChwb3N0bGlmZSAvIHBvc3QubGlmZXNwYW4pLnRvRml4ZWQoMilcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGlmZXBlcmNlbnRhZ2UgPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA9IGxpZmVwZXJjZW50YWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5vcGVuKG1hcCAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93Lm9wZW4obWFwICwgbWFya2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0pKG1hcmtlciwgY2hpbGQsIHBvc3QsIGNvdXBsaW5nX3N0YXR1cywgbG9jYWxfc3RhdHVzKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIG9wZW5JbmZvV2luZG93KCk7XG4gICAgICAgICAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRU5EIC0gRFJBV0lORyBNRVNTQUdFIFdJTkRPVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBFTkQgLSBEUkFXSU5HIFBPU1QgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgICAgICAgICAgfSAvLyBlbmQgb2YgZm9yLWxvb3BcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgUG9zdHNTdmMuZmV0Y2goKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZHJhd1Bvc3RzKSBcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBlcnJvclxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIGVuZCBvZiBwb3N0IGZldGNoIHN1Y2Nlc3NcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGRyYXdEcm9wRG93bihsb2NhdGlvbilcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobG9jYXRpb24ubGF0LCBsb2NhdGlvbi5sb24pO1xuXG4gICAgICAgICAgICB1cGRhdGVCb3VuZHMoKTtcbiAgICAgICAgICAgIC8vIOuwlOyatOuNlOumrCDslYjsl5Ag7J6I64qU7KeA67aA7YSwIOyytO2BrOulvCDtlZjsnqVcbiAgICAgICAgICAgIGlmICghKGdvb2dsZUxvYy5sYXQoKSA8IGN1cnJlbnRfbWFwX253LmxhdCgpKSB8fFxuICAgICAgICAgICAgICAgICEoZ29vZ2xlTG9jLmxhdCgpID4gY3VycmVudF9tYXBfc2UubGF0KCkpIHx8XG4gICAgICAgICAgICAgICAgIShnb29nbGVMb2MubG5nKCkgPCBjdXJyZW50X21hcF9zZS5sbmcoKSkgfHxcbiAgICAgICAgICAgICAgICAhKGdvb2dsZUxvYy5sbmcoKSA+IGN1cnJlbnRfbWFwX253LmxuZygpKSApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBza2lwIHRoaXMgcG9zdCAtIG5vIG5lZWQgdG8gZHJhd1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBtYXJrZXIgb3B0aW9uIHNldHRpbmdcbiAgICAgICAgICAgIHZhciBtYXJrZXJPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBnb29nbGVMb2MsXG4gICAgICAgICAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUCxcbiAgICAgICAgICAgICAgICB0aXRsZTogXCJVc2VyUGluXCIsXG4gICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VVc2VyTG9naW5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKG1hcmtlck9wdGlvbnMpO1xuXG4gICAgICAgICAgICAkdGltZW91dChcbiAgICAgICAgICAgICAgICAoZnVuY3Rpb24ob2xkX21hcmtlcil7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgb2xkX21hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfShtYXJrZXIpKSwgXG4gICAgICAgICAgICAyMDAwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVuRHJhd1Bvc3QocG9zdGlkKVxuICAgICAgICB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwic3RhcnRpbmcgcmVtb3ZlIHBvc3RcIik7XG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMCwgbWFya2VyOyBtYXJrZXIgPSBtYXJrZXJzT25NYXBba107IGsrKykge1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocG9zdGlkKTtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKG1hcmtlci5wb3N0Ll9pZCk7XG4gICAgICAgICAgICAgICAgaWYgKHBvc3RpZCA9PSBtYXJrZXIucG9zdC5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyLm1hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlcnNPbk1hcC5zcGxpY2UoaywgMSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGRyYXdBbmRTZXRQbGFjZShsb2NhdGlvbilcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobG9jYXRpb24ubGF0LCBsb2NhdGlvbi5sb24pO1xuICAgICAgICAgICAgZHJhd0hlbHBlck1hcmtlcihnb29nbGVMb2MpO1xuICAgICAgICAgICAgc2V0UGxhY2UoZ29vZ2xlTG9jKTtcblxuICAgICAgICAgICAgLy8gbWFrZSBzdXJlIHNlcnZlciBnZXRzIHVwZGF0ZWQgd2hlbmV2ZXIgc2V0dGluZyBuZXcgcGxhY2Ugd2l0aCBtYXJrZXJcbiAgICAgICAgICAgIHVwZGF0ZVdhdGNoTG9jYXRpb24oKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGRyYXcgbWFwIHdpdGggaGVscGVyIG1hcmtlcnNcbiAgICAgICAgZnVuY3Rpb24gZHJhd0hlbHBlck1hcmtlcihsb2NhdGlvbil7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbWFya2VyOyBtYXJrZXIgPSBoZWxwZXJNYXJrZXJzW2ldOyBpKyspIHtcbiAgICAgICAgICAgICAgICBtYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGVscGVyTWFya2VycyA9IFtdO1xuICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBsb2NhdGlvbiwgXG4gICAgICAgICAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VUYXJnZXRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaGVscGVyTWFya2Vycy5wdXNoKG1hcmtlcik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1bkRyYXdIZWxwZXJNYXJrZXIoKXtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBtYXJrZXI7IG1hcmtlciA9IGhlbHBlck1hcmtlcnNbaV07IGkrKykge1xuICAgICAgICAgICAgICAgIG1hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBoZWxwZXJNYXJrZXJzID0gW107XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIFVUSUxcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgZnVuY3Rpb24gc2V0UGxhY2UobG9jYXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGJyb2FkY2FzdCBsb2NhdGlvbiBpbmZvcihsb24sbGF0KVxuICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldDpsb2MnLCBsb2NhdGlvbik7XG5cbiAgICAgICAgICAgIHZhciBnZW9jb2RlciA9IG5ldyBnb29nbGUubWFwcy5HZW9jb2RlcigpO1xuXG4gICAgICAgICAgICAvLyBicm9hZGNhc3QgcGxhY2UgZm9ybWF0dGVkX2FkZHJlc3MgYW5kIGRyYXcgaWNvblxuICAgICAgICAgICAgZ2VvY29kZXIuZ2VvY29kZSggeyAnbGF0TG5nJzogbG9jYXRpb24gfSwgZnVuY3Rpb24ocmVzdWx0cywgc3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgLy8gYXMgdXNlciBjbGlja3Mgb24gdGhlIG1hcCxcbiAgICAgICAgICAgICAgICAvLyB3ZSBoYXZlIHRvIHNhdmUgdGhlIGZvcm1hdHRlZCBhZGRyZXNzIGluICRzY29wZSBhbmRcbiAgICAgICAgICAgICAgICAvLyBpdCB3aWxsIGJlIHVzZWQgdGhyb3VnaCBwb3N0cy5jdHJsXG4gICAgICAgICAgICAgICAgLy8gZW1pdCBicm9hZGNhc2UgJ3BsYWNlJyBhbmQgc2VuZCB0aGlzIHRvIGFwcGxpY2F0aW9uLmN0cmxcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyBicm9hZGNhc3QgZm9ybWF0dGVkX2FkZHJlc3NcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldDpwbGFjZScsIHJlc3VsdHNbMV0uZm9ybWF0dGVkX2FkZHJlc3MpOyBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2goZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgc3dhbChcIlwiLFwiTG9jYXRpb24gZG9lcyBub3QgZXhpc3RzXCIpO1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0OnBsYWNlJywgXCJMb2NhdGlvbiBkb2VzIG5vdCBleGlzdHNcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjYWxjdWxhdGVDb3VwbGluZyhwb3N0X2d1aWQsIHBvc3RfZ3VpZHRndClcbiAgICAgICAge1xuICAgICAgICAgICAgLyogY291cGxpbmcgc3RhdHVzXG4gICAgICAgICAgICAgICAgMCAtIG5vIHN0YXR1c1xuICAgICAgICAgICAgICAgIDEgLSBpIGxpa2UgeW91XG4gICAgICAgICAgICAgICAgMiAtIHlvdSBsaWtlIGlcbiAgICAgICAgICAgICAgICA0IC0gd2UgbGlrZSBlYWNoIG90aGVyIC8vIGRpc2FibGVkLlxuICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgdmFyIGlzUG9pbnRpbmdZb3UgICAgID0gc2NvcGUuZ3VpZHRndCA9PSBwb3N0X2d1aWQ7XG4gICAgICAgICAgICB2YXIgaXNQb2ludGluZ01lICAgICAgPSBzY29wZS5ndWlkICAgID09IHBvc3RfZ3VpZHRndDtcbiAgICAgICAgICAgIHZhciBpc015UG9zdCAgICAgICAgICA9IHNjb3BlLmd1aWQgICAgPT0gcG9zdF9ndWlkO1xuICAgICAgICAgICAgdmFyIGlzUG9pbnRpbmdTb21lb25lID0gc2NvcGUuZ3VpZHRndCAhPSAnMCc7XG5cbiAgICAgICAgICAgIGlmIChpc015UG9zdCAmJiBpc1BvaW50aW5nU29tZW9uZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMjsgLy8gZm9yIG15IHZpZXcncyBteSBwb3N0IHRvIGJlIFwiSSBsaWtlIHNvbWVvbmVcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaXNQb2ludGluZ1lvdSAmJiBpc1BvaW50aW5nTWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpc1BvaW50aW5nWW91ICYmICFpc1BvaW50aW5nTWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICghaXNQb2ludGluZ1lvdSAmJiBpc1BvaW50aW5nTWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBVSVxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICBmdW5jdGlvbiBzZXRVSVNlYXJjaExvY2F0aW9uVG9nZ2xlKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIG1hcFNlYXJjaFRvZ2dsZSA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLXNlYXJjaC10b2dnbGUnKSk7XG4gICAgICAgICAgICBtYXAuY29udHJvbHNbZ29vZ2xlLm1hcHMuQ29udHJvbFBvc2l0aW9uLlRPUF9MRUZUXS5wdXNoKG1hcFNlYXJjaFRvZ2dsZSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRVSU1vdmVUb0N1cnJMb2NCdG4oKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgY3VyckxvY0J0biA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLWJ0bi1jdXJyJykpOyBcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uVE9QX1JJR0hUXS5wdXNoKGN1cnJMb2NCdG4pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0VUlQb3N0Rm9ybSgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBwb3N0Rm9ybSA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLXBvc3RpbmcnKSk7IFxuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5CT1RUT01fQ0VOVEVSXS5wdXNoKHBvc3RGb3JtKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldFVJUG9zdEJ0bigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBwb3N0QnRuID0gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtYnRuLXN1Ym1pdCcpKTtcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uQk9UVE9NX0NFTlRFUl0ucHVzaChwb3N0QnRuKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldFVJVGltZVNsaWRlcigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciB0aW1lU2xpZGVyID0gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtdGltZS1zbGlkZXInKSk7XG4gICAgICAgICAgICBtYXAuY29udHJvbHNbZ29vZ2xlLm1hcHMuQ29udHJvbFBvc2l0aW9uLkJPVFRPTV9DRU5URVJdLnB1c2godGltZVNsaWRlcik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRVSVNlYXJjaEJveCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgc2VhcmNoIGJveCBhbmQgbGluayBpdCB0byB0aGUgVUkgZWxlbWVudC5cbiAgICAgICAgICAgIHZhciBpbnB1dCA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFjLWlucHV0JykpOyAvLyBAdHlwZSB7SFRNTElucHV0RWxlbWVudH0gIFxuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5UT1BfTEVGVF0ucHVzaChpbnB1dCk7XG5cbiAgICAgICAgICAgIHZhciBzZWFyY2hCb3ggPSBuZXcgZ29vZ2xlLm1hcHMucGxhY2VzLlNlYXJjaEJveCgoaW5wdXQpKTsgLy8gQHR5cGUge0hUTUxJbnB1dEVsZW1lbnR9IFxuXG4gICAgICAgICAgICAvLyBMaXN0ZW4gZm9yIHRoZSBldmVudCBmaXJlZCB3aGVuIHRoZSB1c2VyIHNlbGVjdHMgYW4gaXRlbSBmcm9tIHRoZVxuICAgICAgICAgICAgLy8gcGljayBsaXN0LiBSZXRyaWV2ZSB0aGUgbWF0Y2hpbmcgcGxhY2VzIGZvciB0aGF0IGl0ZW0uXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihzZWFyY2hCb3gsICdwbGFjZXNfY2hhbmdlZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBwbGFjZXMgPSBzZWFyY2hCb3guZ2V0UGxhY2VzKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAocGxhY2VzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gdGFrZSBvbmx5IDEgc3BvdFxuICAgICAgICAgICAgICAgIHZhciBwbGFjZSA9IHBsYWNlc1swXTtcblxuICAgICAgICAgICAgICAgIC8vIHdoZW4gc2VhcmNoIGhhcHBlbnMsIGxvY2F0aW9uIHdpbGwgYmUgdXBkYXRlZCBhcyB3ZWxsIGZvciBwb3N0XG4gICAgICAgICAgICAgICAgdmFyIGxvY2F0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBsYXQ6IHBsYWNlLmdlb21ldHJ5LmxvY2F0aW9uLmxhdCgpLFxuICAgICAgICAgICAgICAgICAgICBsb246IHBsYWNlLmdlb21ldHJ5LmxvY2F0aW9uLmxuZygpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBkcmF3QW5kU2V0UGxhY2UobG9jYXRpb24pO1xuXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sYXRpdHVkZSA9IHBsYWNlLmdlb21ldHJ5LmxvY2F0aW9uLmxhdGl0dWRlO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlID0gcGxhY2UuZ2VvbWV0cnkubG9jYXRpb24ubG9uZ2l0dWRlO1xuXG4gICAgICAgICAgICAgICAgbWFwLnBhblRvKHBsYWNlLmdlb21ldHJ5LmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICBtYXAuc2V0Wm9vbSgxNik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIEVWRU5UXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIGZ1bmN0aW9uIHNldEV2ZW50Q2xpY2soKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBjbGljayBldmVudCBvbiBtYXAgdG8gZHJhdyBYIG1hcmtlciBhbmQgc2V0IFBvc3QgbG9jYXRpb25cbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcF9vcmlnaW4sICdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIGxvY2F0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBsYXQ6IGV2ZW50LmxhdExuZy5sYXQoKSxcbiAgICAgICAgICAgICAgICAgICAgbG9uOiBldmVudC5sYXRMbmcubG5nKClcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShsb2NhdGlvbik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldEV2ZW50Q2VudGVyQ2hhbmdlZCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcF9vcmlnaW4sICdjZW50ZXJfY2hhbmdlZCcsIGZ1bmN0aW9uKCl7ICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIHdoZW4gbWFwIGNlbnRlciBjaGFuZ2UsIHVwZGF0ZSBsYXN0IGxvY2F0aW9uIGluIG1lbW9yeSxcbiAgICAgICAgICAgICAgICAvLyBzbyBicm93c2VyIHdpbGwgcmVtZW1iZXIgaXQgbmV4dCB0aW1lIHlvdSBjb21lIVxuICAgICAgICAgICAgICAgIHVwZGF0ZURlZmF1bHRMb2NhdGlvbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRFdmVudEJvdW5kc0NoYW5nZWQoKVxuICAgICAgICB7XG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXBfb3JpZ2luLCAnYm91bmRzX2NoYW5nZWQnLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIC8vIHdoZW4gbWFwIGNlbnRlciBjaGFuZ2UsIHVwZGF0ZSBib3VuZHMgaW5mbyBmb3IgbWFwXG4gICAgICAgICAgICAgICAgdXBkYXRlQm91bmRzKCk7ICBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0RXZlbnREcmFnRW5kKClcbiAgICAgICAge1xuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwX29yaWdpbiwgJ2RyYWdlbmQnLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBtYXAgYXMgZHJhZyBlbmRcbiAgICAgICAgICAgICAgICB1cGRhdGVBbmREcmF3UG9zdHMoKTtcblxuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSB3YXRjaGxvYyB3aGVuIGNlbnRlciBjaGFuZ2VkLlxuICAgICAgICAgICAgICAgIHVwZGF0ZVdhdGNoTG9jYXRpb24oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0RXZlbnRSZXNpemUoKVxuICAgICAgICB7XG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXBfb3JpZ2luLCAncmVzaXplJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgbWFwIGFzIGRyYWcgZW5kXG4gICAgICAgICAgICAgICAgdXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgd2F0Y2hsb2Mgd2hlbiBjZW50ZXIgY2hhbmdlZC5cbiAgICAgICAgICAgICAgICB1cGRhdGVXYXRjaExvY2F0aW9uKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldEV2ZW50Wm9vbUNoYW5nZWQoKVxuICAgICAgICB7XG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXBfb3JpZ2luLCAnem9vbV9jaGFuZ2VkJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgbWFwIGFzIGRyYWcgZW5kXG4gICAgICAgICAgICAgICAgdXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgd2F0Y2hsb2Mgd2hlbiBjZW50ZXIgY2hhbmdlZC5cbiAgICAgICAgICAgICAgICB1cGRhdGVXYXRjaExvY2F0aW9uKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIFNFVFVQIEZPUiBNQVBcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gbWFwIGluaXRpYWwgY29uZmlnc1xuICAgICAgICBmdW5jdGlvbiBpbml0aWFsTWFwRGF0YSgpe1xuICAgICAgICAgICAgLy8gaWYgbG9jYWxTdG9yYWdlIHJlbWVtYmVycyBsYXRlc3QgbWFwIGxvY2F0aW9uLCB1c2UgaXQsXG4gICAgICAgICAgICBpZiAoIWlzTmFOKHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUpICYmICFpc05hTih3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaW5pdGlhbE1hcENlbnRlciA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcod2luZG93LmxvY2FsU3RvcmFnZS5sYXRpdHVkZSwgd2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gaWYgdGhlcmUgaXMgbm8gbGF0ZXN0IG1hcCBsb2NhdGlvbiwgZ2V0IGN1cnJlbnQgbG9jYXRpb25cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnVzZXJMb2NhdGlvbi5sYXQgIT0gMC4wICYmIHNjb3BlLnVzZXJMb2NhdGlvbi5sb24gIT0gMC4wKSBcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyB0aGlzIG1heSBub3Qgd29yayBmb3Igbm93IHNpbmNlIGxvY2F0aW9uIGdldHMgc2V0IGFmdGVyIG1hcCBpcyBkZWZpbmVkLi4gKFRPRE86IHJlZmFjdG9yIHRoZSBvcmRlcilcbiAgICAgICAgICAgICAgICBpbml0aWFsTWFwQ2VudGVyID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhzY29wZS51c2VyTG9jYXRpb24ubGF0LCBzY29wZS51c2VyTG9jYXRpb24ubG9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmIG5vbmUgb2YgYWJvdmUgd29ya3MsIHRyeSB0byBzZXQgaXQgdG8gTEEgKD8hKVxuICAgICAgICAgICAgZWxzZSBcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpbml0aWFsTWFwQ2VudGVyID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZygzNC4wNSwgLTExOC4yNCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG1hcE9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNlbnRlciAgICAgIDogaW5pdGlhbE1hcENlbnRlcixcbiAgICAgICAgICAgICAgICAgICAgem9vbSAgICAgICAgOiAxNSxcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsd2hlZWwgOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBzdHJlZXRWaWV3Q29udHJvbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIG1hcFR5cGVDb250cm9sOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgcGFuQ29udHJvbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHpvb21Db250cm9sOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgbWFwVHlwZUNvbnRyb2xPcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgICAgICAgbWFwVHlwZUlkczogW2dvb2dsZS5tYXBzLk1hcFR5cGVJZC5ST0FETUFQLCBDTE9VRF9NQVBfSURdXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG1hcFR5cGVJZDogQ0xPVURfTUFQX0lEXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0TWFudWFsRXZlbnRzKCl7XG4gICAgICAgICAgICBmdW5jdGlvbiBDbG91ZE1hcChvcHRpb25zKXtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIkluaXRpYWxpemluZyBtYXBcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGluc3RhbnRpYXRlIGdvb2dsZSBtYXBcbiAgICAgICAgICAgIG1hcF9vcmlnaW4gPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGVsZW1lbnRbMF0sIG1hcE9wdGlvbnMpO1xuXG4gICAgICAgICAgICAvLyBzZXQgcHJvdG90eXBlIG9mIGN1c3RvbSBtYXAgd2l0aCBvcmlnaW4gbWFwXG4gICAgICAgICAgICBDbG91ZE1hcC5wcm90b3R5cGUgPSBtYXBfb3JpZ2luO1xuXG4gICAgICAgICAgICAvLyBkcmF3IHggbWFya2VyXG4gICAgICAgICAgICBmdW5jdGlvbiBoYW5kbGVEcmF3WE1hcmtlcihsb2NhdGlvbil7XG4gICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcih0aGlzLCAnZHJhd1hNYXJrZXInLCBsb2NhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBDbG91ZE1hcC5wcm90b3R5cGUuZHJhd1hNYXJrZXIgPSBoYW5kbGVEcmF3WE1hcmtlcjtcblxuICAgICAgICAgICAgLy8gZHJhdyBjdXJyZW50IGxvY2F0aW9uIG1hcmtlclxuICAgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlRHJhd0N1cnJMb2NhdGlvbk1hcmtlcihsb2NhdGlvbil7XG4gICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcih0aGlzLCAnZHJhd0N1cnJMb2NhdGlvbk1hcmtlcicsIGxvY2F0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIENsb3VkTWFwLnByb3RvdHlwZS5kcmF3Q3VyckxvY2F0aW9uTWFya2VyID0gaGFuZGxlRHJhd0N1cnJMb2NhdGlvbk1hcmtlcjtcblxuICAgICAgICAgICAgLy8gZHJhdyBwb3N0c1xuICAgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlVXBkYXRlQW5kRHJhd1Bvc3RzKCl7XG4gICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcih0aGlzLCAndXBkYXRlQW5kRHJhd1Bvc3RzJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBDbG91ZE1hcC5wcm90b3R5cGUudXBkYXRlQW5kRHJhd1Bvc3RzID0gaGFuZGxlVXBkYXRlQW5kRHJhd1Bvc3RzO1xuXG4gICAgICAgICAgICAvLyBkcmF3IHJlc3BvbnNlc1xuICAgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlRHJhd1Jlc3BvbnNlcyhwb3N0KXtcbiAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKHRoaXMsICdkcmF3UmVzcG9uc2VzJywgcG9zdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBDbG91ZE1hcC5wcm90b3R5cGUuZHJhd1Jlc3BvbnNlcyA9IGhhbmRsZURyYXdSZXNwb25zZXM7XG5cbiAgICAgICAgICAgIC8vIHVuZHJhdyBwb3N0c1xuICAgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlVW5EcmF3UG9zdChwb3N0aWQpe1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIodGhpcywgJ3VuRHJhd1Bvc3QnLCBwb3N0aWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQ2xvdWRNYXAucHJvdG90eXBlLnVuRHJhd1Bvc3QgPSBoYW5kbGVVbkRyYXdQb3N0O1xuXG4gICAgICAgICAgICAvLyBjcmVhdGUgY3VzdG9tIG1hcCBmb3IgYXBwXG4gICAgICAgICAgICBtYXAgPSBuZXcgQ2xvdWRNYXAoKTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnZHJhd1hNYXJrZXInLCBmdW5jdGlvbihsb2NhdGlvbil7XG4gICAgICAgICAgICAgICAgZHJhd0FuZFNldFBsYWNlKGxvY2F0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICdkcmF3Q3VyckxvY2F0aW9uTWFya2VyJywgZnVuY3Rpb24obG9jYXRpb24pe1xuICAgICAgICAgICAgICAgIGRyYXdEcm9wRG93bihsb2NhdGlvbik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAndXBkYXRlQW5kRHJhd1Bvc3RzJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICB1cGRhdGVBbmREcmF3UG9zdHMoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICdkcmF3UmVzcG9uc2VzJywgZnVuY3Rpb24ocG9zdCl7XG4gICAgICAgICAgICAgICAgZHJhd1Jlc3BvbnNlcyhwb3N0KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICd1bkRyYXdQb3N0JywgZnVuY3Rpb24ocG9zdGlkKXtcbiAgICAgICAgICAgICAgICB1bkRyYXdQb3N0KHBvc3RpZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldFN0eWxlRm9yTWFwKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGZlYXR1cmVPcHRzX2RheSA9IFt7XCJmZWF0dXJlVHlwZVwiOlwiYWRtaW5pc3RyYXRpdmVcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNjE5NWEwXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlLnByb3ZpbmNlXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnkuc3Ryb2tlXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9mZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJsYW5kc2NhcGVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJsaWdodG5lc3NcIjpcIjBcIn0se1wic2F0dXJhdGlvblwiOlwiMFwifSx7XCJjb2xvclwiOlwiI2Y1ZjVmMlwifSx7XCJnYW1tYVwiOlwiMVwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJsYW5kc2NhcGUubWFuX21hZGVcIixcImVsZW1lbnRUeXBlXCI6XCJhbGxcIixcInN0eWxlcnNcIjpbe1wibGlnaHRuZXNzXCI6XCItM1wifSx7XCJnYW1tYVwiOlwiMS4wMFwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJsYW5kc2NhcGUubmF0dXJhbC50ZXJyYWluXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9mZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJwb2lcIixcImVsZW1lbnRUeXBlXCI6XCJhbGxcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib2ZmXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInBvaS5wYXJrXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnkuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2JhZTVjZVwifSx7XCJ2aXNpYmlsaXR5XCI6XCJvblwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJyb2FkXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInNhdHVyYXRpb25cIjotMTAwfSx7XCJsaWdodG5lc3NcIjo0NX0se1widmlzaWJpbGl0eVwiOlwic2ltcGxpZmllZFwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJyb2FkLmhpZ2h3YXlcIixcImVsZW1lbnRUeXBlXCI6XCJhbGxcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwic2ltcGxpZmllZFwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJyb2FkLmhpZ2h3YXlcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjZmFjOWE5XCJ9LHtcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHRcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiM0ZTRlNGVcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5hcnRlcmlhbFwiLFwiZWxlbWVudFR5cGVcIjpcImxhYmVscy50ZXh0LmZpbGxcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiM3ODc4NzhcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5hcnRlcmlhbFwiLFwiZWxlbWVudFR5cGVcIjpcImxhYmVscy5pY29uXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9mZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0XCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdC5zdGF0aW9uLmFpcnBvcnRcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMuaWNvblwiLFwic3R5bGVyc1wiOlt7XCJodWVcIjpcIiMwYTAwZmZcIn0se1wic2F0dXJhdGlvblwiOlwiLTc3XCJ9LHtcImdhbW1hXCI6XCIwLjU3XCJ9LHtcImxpZ2h0bmVzc1wiOlwiMFwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LnN0YXRpb24ucmFpbFwiLFwiZWxlbWVudFR5cGVcIjpcImxhYmVscy50ZXh0LmZpbGxcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiM0MzMyMWVcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdC5zdGF0aW9uLnJhaWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMuaWNvblwiLFwic3R5bGVyc1wiOlt7XCJodWVcIjpcIiNmZjZjMDBcIn0se1wibGlnaHRuZXNzXCI6XCI0XCJ9LHtcImdhbW1hXCI6XCIwLjc1XCJ9LHtcInNhdHVyYXRpb25cIjpcIi02OFwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ3YXRlclwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2VhZjZmOFwifSx7XCJ2aXNpYmlsaXR5XCI6XCJvblwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ3YXRlclwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LmZpbGxcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiNjN2VjZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwid2F0ZXJcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImxpZ2h0bmVzc1wiOlwiLTQ5XCJ9LHtcInNhdHVyYXRpb25cIjpcIi01M1wifSx7XCJnYW1tYVwiOlwiMC43OVwifV19XTtcblxuICAgICAgICAgICAgdmFyIGZlYXR1cmVPcHRzX25pZ2h0ID0gW3tcImZlYXR1cmVUeXBlXCI6XCJhbGxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjZmZmZmZmXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcImFsbFwiLFwiZWxlbWVudFR5cGVcIjpcImxhYmVscy50ZXh0LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvblwifSx7XCJjb2xvclwiOlwiIzNlNjA2ZlwifSx7XCJ3ZWlnaHRcIjoyfSx7XCJnYW1tYVwiOjAuODR9XX0se1wiZmVhdHVyZVR5cGVcIjpcImFsbFwiLFwiZWxlbWVudFR5cGVcIjpcImxhYmVscy5pY29uXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9mZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJhZG1pbmlzdHJhdGl2ZVwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcIndlaWdodFwiOjAuNn0se1wiY29sb3JcIjpcIiMxODJhM2RcIn0se1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwibGFuZHNjYXBlXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiMxYTUyOGJcIn0se1widmlzaWJpbGl0eVwiOlwic2ltcGxpZmllZFwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJwb2lcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzQwNmQ4MFwifSx7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pLnBhcmtcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzJjNWE3MVwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJyb2FkXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiM2NmE5ZWVcIn0se1wibGlnaHRuZXNzXCI6LTM3fSx7XCJ2aXNpYmlsaXR5XCI6XCJvblwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJyb2FkXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnkuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvblwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJyb2FkXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnkuc3Ryb2tlXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9mZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJyb2FkLmhpZ2h3YXlcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvblwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJyb2FkLmhpZ2h3YXlcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5sb2NhbFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJsaWdodG5lc3NcIjpcIi0xMVwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0XCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiNmZjdlNGVcIn0se1widmlzaWJpbGl0eVwiOlwic2ltcGxpZmllZFwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LnN0YXRpb24uYWlycG9ydFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9mZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ3YXRlclwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjMTgyYTNkXCJ9XX1dO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBzZXQgbWFwIGRlcGVuZHMgb24gZGF5dGltZSBvciBuaWdodHRpbWVcbiAgICAgICAgICAgIHZhciBjdXJyZW50VGltZSA9IG5ldyBEYXRlKCk7IC8vIGZvciBub3dcbiAgICAgICAgICAgIHZhciBjdXJyZW50SG91ciA9IGN1cnJlbnRUaW1lLmdldEhvdXJzKCk7XG4gICAgICAgICAgICB2YXIgZmVhdHVyZU9wdHM7XG4gICAgICAgICAgICBpZiAoY3VycmVudEhvdXIgPCA0IHx8IGN1cnJlbnRIb3VyID4gMTkpe1xuICAgICAgICAgICAgICAgIGZlYXR1cmVPcHRzID0gZmVhdHVyZU9wdHNfbmlnaHQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZlYXR1cmVPcHRzID0gZmVhdHVyZU9wdHNfZGF5O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc3R5bGVkTWFwT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnQ3VzdG9tIFN0eWxlJ1xuICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgY3VzdG9tTWFwVHlwZSA9IG5ldyBnb29nbGUubWFwcy5TdHlsZWRNYXBUeXBlKGZlYXR1cmVPcHRzLCBzdHlsZWRNYXBPcHRpb25zKTtcbiAgICAgICAgICAgIG1hcC5tYXBUeXBlcy5zZXQoQ0xPVURfTUFQX0lELCBjdXN0b21NYXBUeXBlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGluaXQgdGhlIG1hcFxuICAgICAgICBmdW5jdGlvbiBpbml0TWFwKCkge1xuICAgICAgICAgICAgaWYgKG1hcCA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICAgICAgaW5pdGlhbE1hcERhdGEoKTtcblxuICAgICAgICAgICAgICAgIHNldE1hbnVhbEV2ZW50cygpO1xuXG4gICAgICAgICAgICAgICAgc2V0U3R5bGVGb3JNYXAoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYWRkIFVJIGVsZW1lbnRzIHRvIG1hcFxuICAgICAgICAgICAgc2V0VUlTZWFyY2hMb2NhdGlvblRvZ2dsZSgpO1xuICAgICAgICAgICAgc2V0VUlTZWFyY2hCb3goKTtcbiAgICAgICAgICAgIHNldFVJTW92ZVRvQ3VyckxvY0J0bigpO1xuICAgICAgICAgICAgc2V0VUlQb3N0Rm9ybSgpO1xuICAgICAgICAgICAgc2V0VUlQb3N0QnRuKCk7XG4gICAgICAgICAgICBzZXRVSVRpbWVTbGlkZXIoKTtcblxuICAgICAgICAgICAgLy8gYWRkIG9yaWdpbiBuYXRpdmUgRXZlbnQgaGFuZGxlcnMgdG8gbWFwXG4gICAgICAgICAgICBzZXRFdmVudENsaWNrKCk7XG4gICAgICAgICAgICBzZXRFdmVudENlbnRlckNoYW5nZWQoKTtcbiAgICAgICAgICAgIHNldEV2ZW50RHJhZ0VuZCgpO1xuICAgICAgICAgICAgc2V0RXZlbnRSZXNpemUoKTtcbiAgICAgICAgICAgIHNldEV2ZW50Wm9vbUNoYW5nZWQoKTtcbiAgICAgICAgICAgIHNldEV2ZW50Qm91bmRzQ2hhbmdlZCgpO1xuXG4gICAgICAgICAgICAvLyBicm9hZGNhc3QgdG8gc2VuZCBtYXAgdG8gYXBwbGljYXRpb24gY3RybFxuICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldDptYXAnLCBtYXApO1xuICAgICAgICB9IFxuXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIEVYRUNVVEVcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgaW5pdE1hcCgpO1xuXG4gICAgICAgIGRyYXdIZWxwZXJNYXJrZXIoaW5pdGlhbE1hcENlbnRlcik7XG4gICAgICAgIHNldFBsYWNlKGluaXRpYWxNYXBDZW50ZXIpO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IGlkPVwibWFwLWNhbnZhc1wiPjwvZGl2PicsXG4gICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgIGxpbms6IGxpbmtcbiAgICB9O1xufSk7XG5cbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmRpcmVjdGl2ZSgnbWFwTXNnJywgZnVuY3Rpb24gKCR0aW1lb3V0LCBTZXNzaW9uU3ZjLCBQb3N0c1N2Yykge1xuXG4gICAgdmFyIGxpbmsgPSBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHsgICBcblxuICAgICAgICBzY29wZS5nZXRfbG9jYWxzdGF0dXMgPSBmdW5jdGlvbihsb2NhbF9zdGF0dXMpe1xuICAgICAgICAgIGlmIChsb2NhbF9zdGF0dXMpXG4gICAgICAgICAgICByZXR1cm4gXCJsb2NhbC10ZXh0XCI7XG4gICAgICAgICAgZWxzZVxuICAgICAgICAgICAgcmV0dXJuIFwibm9uLWxvY2FsLXRleHRcIjtcbiAgICAgICAgfTsgICAgIFxuXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIENPVVBMSU5HIENMQVNTXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8qIGNvdXBsaW5nIHN0YXR1c1xuICAgICAgICAgIDAgLSBubyBzdGF0dXNcbiAgICAgICAgICAxIC0gaSBsaWtlIHlvdVxuICAgICAgICAgIDIgLSB5b3UgbGlrZSBpXG4gICAgICAgICAgNCAtIHdlIGxpa2UgZWFjaCBvdGhlclxuICAgICAgICAqL1xuICAgICAgICBzY29wZS5nZXRfY291cGxpbmcgPSBmdW5jdGlvbihjb3VwbGluZ19zdGF0dXMpe1xuICAgICAgICAgIFxuICAgICAgICAgIGlmIChjb3VwbGluZ19zdGF0dXMgPT0gNCl7XG4gICAgICAgICAgICByZXR1cm4gXCJjb3VwbGluZyBjb3VwbGluZy1jb3VwbGVcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZiAoY291cGxpbmdfc3RhdHVzID09IDEpe1xuICAgICAgICAgICAgcmV0dXJuIFwiY291cGxpbmcgY291cGxpbmctaWxpa2V5b3VcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZiAoY291cGxpbmdfc3RhdHVzID09IDIpe1xuICAgICAgICAgICAgcmV0dXJuIFwiY291cGxpbmcgY291cGxpbmcteW91bGlrZWlcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gXCJjb3VwbGluZyBjb3VwbGluZy1ub25lXCI7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIERPQ1VNRU5UIFJFQURZXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAkdGltZW91dCh1cGRhdGVHdWlkVGFyZ2V0LCAxMDApO1xuXG4gICAgICAgICAgJHRpbWVvdXQodXBkYXRlUG9zdFRpbWVyLCAxMCk7XG5cbiAgICAgICAgICAkdGltZW91dChjdXN0b21pemVJbmZvV2luZG93LCAxMCk7XG5cbiAgICAgICAgICAkdGltZW91dChjdXN0b21pemVDbG9zZUJ0biwgMTApO1xuXG4gICAgICAgICAgLy9jb25zb2xlLmxvZyhcInBvc3QgbG9jYWwgc3RhdHVzOlwiLCBzY29wZS5wb3N0bG9jYWxzdGF0dXMpO1xuICAgICAgICB9KTtcblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVHdWlkVGFyZ2V0KCl7XG4gICAgICAgICAgLy8gdXBkYXRlIHN0YXR1cyBmb3IgZ3VpZCB0YXJnZXRcbiAgICAgICAgICB2YXIgcG9zdGd1aWQgID0gc2NvcGUucG9zdGd1aWQ7XG4gICAgICAgICAgdmFyIG15Z3VpZCAgICA9IHNjb3BlLiRwYXJlbnQuZ3VpZDtcbiAgICAgICAgICB2YXIgbXlndWlkdGd0ID0gc2NvcGUuJHBhcmVudC5ndWlkdGd0O1xuXG4gICAgICAgICAgZWxlbWVudC5jaGlsZHJlbigpLm9uKCdjbGljaycsZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgdmFyIHVwZGF0ZV9ndWlkdGd0ID0gcG9zdGd1aWQ7XG5cbiAgICAgICAgICAgIC8vIGNsaWNraW5nIG15IG1lc3NhZ2Ugd2luZG93XG4gICAgICAgICAgICAvLyBpZiBpdHMgb24gY291cGxpbmcsIGJyZWFrIGl0IVxuICAgICAgICAgICAgaWYgKHBvc3RndWlkID09IG15Z3VpZCl7XG4gICAgICAgICAgICAgIGlmIChzY29wZS4kcGFyZW50Lmd1aWR0Z3QgIT0gJzAnKXtcbiAgICAgICAgICAgICAgICB1cGRhdGVfZ3VpZHRndCA9ICcwJzsgXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGNsaWtpbmcgdGhlIG9uZSB0aGF0IEkgbGlrZWRcbiAgICAgICAgICAgIC8vIHRvIGRpc2xpa2UgdGhlIG1lc3NhZ2Ugd2luZG93XG4gICAgICAgICAgICBpZiAocG9zdGd1aWQgPT0gbXlndWlkdGd0KSB7XG4gICAgICAgICAgICAgIHVwZGF0ZV9ndWlkdGd0ID0gJzAnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBwcm9wYWdhdGUgdG8gdXBwZXIgc2NvcGUgZm9yIGd1aWR0Z3QgdXBkYXRlXG4gICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0Omd1aWR0Z3QnLCB1cGRhdGVfZ3VpZHRndCk7IFxuXG4gICAgICAgICAgICAvLyB1cGRhdGUgc2Vzc2lvbiBpbmZvcm1hdGlvbiBvZiBtaW5lIHNvIG15IHNlc3Npb24gdGVsbHMgbWUgdGhhdCxcbiAgICAgICAgICAgIC8vIEkgbGlrZSB0aGlzIGd1aWQgYXQgdGhpcyBtb21lbnQgaW4gc2VydmVyIGRiXG4gICAgICAgICAgICBTZXNzaW9uU3ZjLnVwZGF0ZUNvdXBsaW5nKG15Z3VpZCwgdXBkYXRlX2d1aWR0Z3QpXG4gICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRvYyl7XG4gICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiU3VjY2Vzc2Z1bGx5IHVkcGF0ZWQgY291cGxpbmdcIiwgZG9jKTtcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gdXBkYXRlIG15IHBvc3QncyBndWlkdGd0IHRvIGJlIHRoaXMgcG9zdCdzIGd1aWQgaW4gc2VydmVyIGRiXG4gICAgICAgICAgICAvLyB0aGlzIHVwZGF0ZSBpcyBmb3IgdGhlIHBlb3BsZSB3aG8gYXJlIGxvb2tpbmcgYXQgbXkgcG9zdHNcbiAgICAgICAgICAgIHZhciB1cGRhdGVzID0ge1xuICAgICAgICAgICAgICBndWlkICAgIDogbXlndWlkLFxuICAgICAgICAgICAgICBndWlkdGd0IDogdXBkYXRlX2d1aWR0Z3RcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBQb3N0c1N2Yy51cGRhdGVHdWlkdGd0KHVwZGF0ZXMpXG4gICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRvYyl7XG4gICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiU3VjY2Vzc2Z1bGx5IHVkcGF0ZWQgcG9zdCdzIGd1aWR0Z3RcIiwgZG9jKTtcbiAgICAgICAgICAgICAgICAgIC8vIGFmdGVyIGNvdXBsaW5nIHVwZGF0ZSwgbWFwIGhhcyB0byBiZSB1cGRhdGVzIGFzIHdlbGxcbiAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgIC8vIE1JR0hUIEhBVkUgVE8gQ09NRSBCQUNLIEZPUiBPUFRJTUlaQVRJT05cbiAgICAgICAgICAgIC8vIHRoaXMgaGF2ZSB0byBiZSB1cGRhdGUgdG8gYmUgY29tbXVuaWNhdGVkIHRocm91Z2ggdGhlIHNlcnZlclxuICAgICAgICAgICAgaWYgKHNjb3BlLiRwYXJlbnQuZ3VpZHRndCA9PSAwKXtcbiAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldDpjb3VwbGluZycsIDEpOyAvLyBwcm9wYWdhdGUgdG8gdXBwZXIgc2NvcGUgZm9yIGNvdXBsaW5nIHVwZGF0ZVxuICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoKTsgLy8gZm9yY2UgdG8gdXBkYXRlIERPTVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGNvdXBsZXN0YXR1cyA9PSAxICYmIHNjb3BlLiRwYXJlbnQuZ3VpZHRndCAhPSAwKXtcbiAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldDpjb3VwbGluZycsIDApOyAvLyBwcm9wYWdhdGUgdG8gdXBwZXIgc2NvcGUgZm9yIGNvdXBsaW5nIHVwZGF0ZVxuICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoKTsgLy8gZm9yY2UgdG8gdXBkYXRlIERPTVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIFxuXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVQb3N0VGltZXIoKXtcbiAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiTGlmZSAlOlwiLCBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UpO1xuICAgICAgICAgICAgdmFyIGR1cmF0aW9uID0gc2NvcGUucG9zdGxpZmUgKyBcIm1zXCI7XG5cbiAgICAgICAgICAgIHZhciBwb3N0YmFybGlmZSA9IGVsZW1lbnQuY2hpbGRyZW4oKS5jaGlsZHJlbihcIi5wb3N0bGlmZWJhclwiKTtcblxuICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tZHVyYXRpb24nLCBkdXJhdGlvbik7XG4gICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLWR1cmF0aW9uJywgZHVyYXRpb24pO1xuICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLWR1cmF0aW9uJywgZHVyYXRpb24pO1xuICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1kdXJhdGlvbicsIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLWR1cmF0aW9uJywgZHVyYXRpb24pO1xuXG4gICAgICAgICAgICBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC45NSl7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9hJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2EnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlIDw9IDAuOTUgJiYgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC45KXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2InKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9iJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9iJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9iJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPD0gMC45ICYmIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuODUpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYycpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2MnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2MnKTtcbiAgICAgICAgICAgICAgcG9zdGxpZmViYXJfY3NzID0gcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9jJyk7XG4gICAgICAgICAgICAgIHBvc3RsaWZlYmFyX2NzcyA9IHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2MnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA8PSAwLjg1ICYmIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuNzUpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZCcpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2QnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2QnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9kJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2QnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA8PSAwLjc1ICYmIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuNil7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9lJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2UnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlIDw9IDAuNiAmJiBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjUpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2YnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2YnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9mJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2YnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA8PSAwLjUgJiYgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC4zKXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2cnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9nJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9nJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZycpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9nJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPD0gMC4zICYmIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuMil7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9oJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faCcpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faCcpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2gnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlIDw9IDAuMiAmJiBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjEpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2knKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2knKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9pJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2knKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9qJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2onKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY3VzdG9taXplSW5mb1dpbmRvdygpe1xuICAgICAgICAgIC8vIFJlZmVyZW5jZSB0byB0aGUgRElWIHRoYXQgd3JhcHMgdGhlIGJvdHRvbSBvZiBpbmZvd2luZG93XG4gICAgICAgICAgdmFyIGl3T3V0ZXIgPSAkKCcuZ20tc3R5bGUtaXcnKTtcbiAgICAgICAgICBcbiAgICAgICAgICB2YXIgaXdCYWNrZ3JvdW5kID0gaXdPdXRlci5wcmV2KCk7XG5cbiAgICAgICAgICAvLyBSZW1vdmUgdGhlIGJhY2tncm91bmQgc2hhZG93IERJVlxuICAgICAgICAgICBpd0JhY2tncm91bmQuY2hpbGRyZW4oJzpudGgtY2hpbGQoMiknKS5jc3MoeydkaXNwbGF5JyA6ICdub25lJ30pO1xuXG4gICAgICAgICAgIC8vIFJlbW92ZSB0aGUgd2hpdGUgYmFja2dyb3VuZCBESVZcbiAgICAgICAgICAgaXdCYWNrZ3JvdW5kLmNoaWxkcmVuKCc6bnRoLWNoaWxkKDQpJykuY3NzKHsnZGlzcGxheScgOiAnbm9uZSd9KTtcblxuICAgICAgICAgIC8vIENoYW5nZXMgdGhlIGRlc2lyZWQgdGFpbCBzaGFkb3cgY29sb3IuXG4gICAgICAgICAgaXdCYWNrZ3JvdW5kLmNoaWxkcmVuKCc6bnRoLWNoaWxkKDMpJykuZmluZCgnZGl2JykuY2hpbGRyZW4oKS5jc3Moe1xuICAgICAgICAgICAgJ2JveC1zaGFkb3cnOiAnMCAxcHggNnB4IHJnYmEoMTc4LCAxNzgsIDE3OCwgMC42KScsIFxuICAgICAgICAgICAgJ3otaW5kZXgnIDogJzEnLFxuICAgICAgICAgICAgJ2JvcmRlcic6ICcwcHgnfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjdXN0b21pemVDbG9zZUJ0bigpe1xuICAgICAgICAgIC8vIFJlZmVyZW5jZSB0byB0aGUgRElWIHRoYXQgd3JhcHMgdGhlIGJvdHRvbSBvZiBpbmZvd2luZG93XG4gICAgICAgICAgdmFyIGl3T3V0ZXIgPSAkKCcuZ20tc3R5bGUtaXcnKTtcblxuICAgICAgICAgIHZhciBpd0Nsb3NlQnRuID0gaXdPdXRlci5uZXh0KCk7XG5cbiAgICAgICAgICAvKlxuICAgICAgICAgIGNvbnNvbGUubG9nKFwicG9zdGxvY2FsIGxlYW50aDpcIiwgaXdPdXRlci5wYXJlbnQoKS5maW5kKCcjcG9zdGxvY2FsJykubGVuZ3RoKTtcbiAgICAgICAgICBpZiAoc2NvcGUucG9zdGxvY2Fsc3RhdHVzID09IGZhbHNlICYmIDAgPT0gaXdPdXRlci5wYXJlbnQoKS5maW5kKCcjcG9zdGxvY2FsJykubGVuZ3RoKXtcbiAgICAgICAgICAgIGl3Q2xvc2VCdG4uYWZ0ZXIoXCI8aW1nIGlkPSdwb3N0bG9jYWwnIHNyYz0naHR0cDovL2Nkbi1pbWcuZWFzeWljb24ubmV0L3BuZy8yNC8yNDQwLnBuZycgd2lkdGg9JzIwJywgaGVpZ2h0PScyMCcvPlwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgKi9cblxuICAgICAgICAgIC8vIEFwcGx5IHRoZSBkZXNpcmVkIGVmZmVjdCB0byB0aGUgY2xvc2UgYnV0dG9uXG4gICAgICAgICAgaXdDbG9zZUJ0bi5jc3Moe1xuICAgICAgICAgICAgb3BhY2l0eTogJzAuOCcsIC8vIGJ5IGRlZmF1bHQgdGhlIGNsb3NlIGJ1dHRvbiBoYXMgYW4gb3BhY2l0eSBvZiAwLjdcbiAgICAgICAgICAgIHJpZ2h0OiAnMjBweCcsIHRvcDogJzIwcHgnLCAvLyBidXR0b24gcmVwb3NpdGlvbmluZ1xuICAgICAgICAgIH0pOyBcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnLi90ZW1wbGF0ZXMvd2luZG93Lmh0bWwnLFxuICAgICAgICBsaW5rOiBsaW5rXG4gICAgfTtcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyLmNvbnRyb2xsZXIoJ1Bvc3RzQ3RybCcsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkc2NvcGUsIENvbmZpZ1N2YywgUG9zdHNTdmMsIFV0aWxTdmMsICR3aW5kb3csICRkb2N1bWVudCwgJHRpbWVvdXQpe1xyXHJcdC8qIGVtaXQgYnJvYWRjYXN0IGZvciBjdXJyZW50IHBhZ2VJZCAqL1xyXHQkc2NvcGUuJGVtaXQoJ3NldDpwYWdlY2hhbmdlJywgJHNjb3BlLnBhZ2VJZC5wb3N0KTtcclxyXHQkc2NvcGUucG9zdHMgPSBbXTtcclxyXHQvKiBhcyBzZXJ2ZXIgdGVsbHMgdGhlcmUgd2FzIG5ldyBwb3N0LCBsZXRzIHJlLWxvYWQgbGlzdCBkYXRhICovXHJcdCRzY29wZS4kb24oJ3dzOm5ld19wb3N0JywgZnVuY3Rpb24oXywgcG9zdCl7XHJcdFx0JHNjb3BlLnJlcXVlc3RGZXRjaCgpO1xyXHR9KTtcclxyXHQkc2NvcGUuYWRkUG9zdCA9IGZ1bmN0aW9uKCkge1xyXHRcdC8qIGNoZWNrIGlmIHRoZSBwb3N0IGNvbnRlbnQgaXMgdGhlcmUgLSBvbmx5IGZvciBXRUIgZm9yIGVudGVyIGJ1dHRvbiB0byBwb3N0ICovXHJcdFx0aWYgKCEkc2NvcGUuY29udGVudCl7XHJcdFx0XHQvKmNvbnNvbGUubG9nKFwiVXNlciBhdHRlbXB0ZWQgdG8gcG9zdCB3aXRoIDAgd29yZHMuXCIpKi9cclx0XHRcdHJldHVybjtcclx0XHR9XHJcclx0XHQvKiBnZXQgYXV0b2NvbXBsZXRlZCBwbGFjZSBhbmQgcmVzZXQoc2V0IHRvIHVuZGVmaW5lZCkgKi9cclx0XHR2YXIgcGxhY2UgICAgPSAkc2NvcGUucG9zdHBsYWNlO1xyXHRcdHZhciBsb2NhdGlvbiA9ICRzY29wZS5wb3N0TG9jYXRpb247XHJcclx0XHR2YXIgbG9jYWxfc3RhdHVzO1xyXHRcdHZhciBwb3N0TG9jYXRpb25Gcm9tVXNlckxvY2F0aW9uID0gVXRpbFN2Yy5nZXREaXN0YW5jZUZyb21MYXRMb25JbkttKGxvY2F0aW9uLmxhdCwgbG9jYXRpb24ubG9uLCAkc2NvcGUudXNlckxvY2F0aW9uLmxhdCwgJHNjb3BlLnVzZXJMb2NhdGlvbi5sb24pO1xyXHRcdC8qIGlmIGxlc3MgdGhhbiAza20gKi9cclx0XHRpZiAocG9zdExvY2F0aW9uRnJvbVVzZXJMb2NhdGlvbiA8IDMpe1xyXHRcdFx0bG9jYWxfc3RhdHVzID0gdHJ1ZTtcclx0XHR9XHJcdFx0ZWxzZSB7XHJcdFx0XHRsb2NhbF9zdGF0dXMgPSBmYWxzZTtcclx0XHR9XHJcdFx0XHJcdFx0dmFyIGxvY2F0aW9uSlNPTiA9IEpTT04uc3RyaW5naWZ5KGxvY2F0aW9uKTtcclxyXHRcdHZhciByZWxhdGl2ZUxpZmVTcGFuO1xyXHRcdGlmICgkc2NvcGUudGltZXZhbHVlIDw9IENvbmZpZ1N2Yy5tYXhJbnN0YW50TGlmZVNwYW4pe1xyXHRcdFx0dmFyIGNoYXJMZW4gPSAkc2NvcGUuY29udGVudC5sZW5ndGg7XHJcdFx0XHRpZiAoY2hhckxlbiA8IDUpXHJcdFx0XHR7XHJcdFx0XHRcdHJlbGF0aXZlTGlmZVNwYW4gPSA0MDAwO1xyXHRcdFx0fVxyXHRcdFx0ZWxzZVxyXHRcdFx0e1xyXHRcdFx0XHRyZWxhdGl2ZUxpZmVTcGFuID0gY2hhckxlbiAqIFV0aWxTdmMubWFwUmFuZ2UoY2hhckxlbiwgNSwgMjAsIDcwMCwgNDAwKTtcclx0XHRcdH1cclx0XHR9XHJcdFx0ZWxzZSB7XHJcdFx0XHRyZWxhdGl2ZUxpZmVTcGFuID0gJHNjb3BlLnRpbWV2YWx1ZTtcclx0XHR9XHJcclx0XHRQb3N0c1N2Yy5jcmVhdGUoXHJcdFx0e1xyXHRcdFx0Ym9keSAgICA6ICAkc2NvcGUuY29udGVudCxcclx0XHRcdGxvY2F0aW9uOiAgbG9jYXRpb25KU09OLFxyXHRcdFx0cGxhY2UgICA6ICBwbGFjZSxcclx0XHRcdGd1aWQgICAgOiAgJHNjb3BlLmd1aWQsXHJcdFx0XHRndWlkdGd0IDogICRzY29wZS5ndWlkdGd0LFxyXHRcdFx0bGlmZXNwYW46ICByZWxhdGl2ZUxpZmVTcGFuLFxyXHRcdFx0aXNsb2NhbCA6ICBsb2NhbF9zdGF0dXMsXHJcdFx0fSlcclx0XHQuc3VjY2VzcyhmdW5jdGlvbihwb3N0KXtcclx0XHRcdFx0XHRcclx0XHRcdC8qIHJlc2V0IGlucHV0IGZvcm1zICovXHJcdFx0XHQkc2NvcGUuY29udGVudCAgPSBudWxsO1xyXHRcdH0pXHJcdFx0LmVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cyl7XHJcdFx0XHRzd2FsKFwiUG9zdCBmYWlsZWRcIiwgXCJQbGVhc2UgY29tcGxldGUgdGhlIGZyb20gY29ycmVjdGx5XCIsIFwiZXJyb3JcIik7XHJcdFx0fSlcclx0XHQuY2F0Y2goZnVuY3Rpb24oZXJyKXtcclx0XHRcdC8qIGhhbmRsZSBlcnJvciAqL1xyXHRcdH0pO1xyXHR9O1xyXHJcdC8qIGFzIHNlcnZlciB0ZWxscyB0aGVyZSB3YXMgbmV3IHBvc3QsIGxldHMgcmUtbG9hZCBsaXN0IGRhdGEgKi9cclx0JHNjb3BlLnJlcXVlc3RGZXRjaCA9IGZ1bmN0aW9uKCkge1xyXHRcdFBvc3RzU3ZjLmZldGNoKClcclx0XHQuc3VjY2VzcyhmdW5jdGlvbihwb3N0cyl7XHJcdFx0XHQvKmNvbnNvbGUubG9nKCdHb3QgUG9zdHM6JywgcG9zdHMpOyAqL1xyXHRcdFx0JHNjb3BlLnBvc3RzID0gcG9zdHM7XHJcdFx0fSlcclx0XHQuY2F0Y2goZnVuY3Rpb24oZXJyKXtcclx0XHRcdC8qIGVycm9yIGhhbmRsZSAqL1xyXHRcdH0pO1xyXHR9O1xyXHJcdC8qIHVwZGF0ZSBndWlkIG9mIHBvc3QgKi9cclx0JHNjb3BlLnVwZGF0ZUd1aWR0Z3QgPSBmdW5jdGlvbihteWd1aWQsIGd1aWR0Z3QpIHtcclx0XHR2YXIgdXBkYXRlcyA9IHtcclx0XHRcdGd1aWQgICAgOiBteWd1aWQsXHJcdFx0XHRndWlkdGd0IDogZ3VpZHRndFxyXHRcdH07XHJcclx0XHQvKmNvbnNvbGUubG9nKFwidWRwYXRlIHRvIHBvc3QgZ3VpZHRndDpcIiwgdXBkYXRlcykqL1xyXHJcdFx0UG9zdHNTdmMudXBkYXRlR3VpZHRndCh1cGRhdGVzKVxyXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKHVwZGF0ZXMpe1xyXHRcdFx0LyogIGRlYnVnIG1zZyAgKi9cclx0XHR9KVxyXHRcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xyXHRcdFx0LyogIGVycm9yIGhhbmRsaW5nICAqL1xyXHRcdH0pO1xyXHR9XHJcclx0Lyokc2NvcGUucmVxdWVzdEZldGNoKCk7Ki9ccn0pO1xyIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnUG9zdHNTdmMnLCBmdW5jdGlvbigkaHR0cCl7XG5cdHRoaXMuZmV0Y2ggPSBmdW5jdGlvbihndWlkT2JqKXtcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJywgZ3VpZE9iaik7XG5cdH07XG5cblx0dGhpcy5jcmVhdGUgPSBmdW5jdGlvbihwb3N0KXtcblx0XHRwb3N0LmRldmljZXRva2VuID0gJzAnOyAvLyBmb3Igd2ViLCB0aGVyZSBpcyBubyBkZXZpY2V0b2tlblxuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Bvc3RzJywgcG9zdCk7XG5cdH07XG5cblx0dGhpcy5yZW1vdmUgPSBmdW5jdGlvbihwb3N0KXtcblx0XHQvL2NvbnNvbGUubG9nKFwiZGVsZXRpbmcgcG9zdGluZ1wiKTtcblx0XHQvL2NvbnNvbGUubG9nKCdwb3N0Ll9pZDonLCBwb3N0Ll9pZCk7XG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcG9zdHMvcG9zdHNfZGVsZXRlJywgcG9zdCk7XG5cdH07XG5cblx0dGhpcy51cGRhdGVHdWlkdGd0ID0gZnVuY3Rpb24odXBkYXRlcyl7XG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcG9zdHMvdXBkYXRlX2d1aWR0Z3QnLCB1cGRhdGVzKTtcblx0fVxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnU2Vzc2lvblN2YycsIGZ1bmN0aW9uKCRodHRwKXtcblx0dGhpcy5mZXRjaCA9IGZ1bmN0aW9uKCl7XG5cdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS9zZXNzaW9ucycpO1xuXHR9O1xuXG5cdHRoaXMuZW50ZXIgPSBmdW5jdGlvbihzZXNzaW9uKXtcblx0XHRzZXNzaW9uLmRldmljZXRva2VuID0gJzAnOyAvLyBmb3Igd2ViLCB0aGVyZSBpcyBubyBkZXZpY2V0b2tlblxuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zJywgc2Vzc2lvbik7XG5cdH07XG5cblx0dGhpcy5yZW1vdmUgPSBmdW5jdGlvbihndWlkKXtcblx0XHR2YXIgc2Vzc2lvbiA9IHtndWlkOiBndWlkfTtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucy9kZWxldGUnLCBzZXNzaW9uKTtcblx0fTtcblxuXHR0aGlzLnVwZGF0ZVdhdGNoTG9jYXRpb24gPSBmdW5jdGlvbihjdXJyZW50X21hcF9udywgY3VycmVudF9tYXBfc2UsIGN1cnJlbnRfbWFwX2NlbnRlciwgZ3VpZCl7XG5cdFx0dmFyIHdhdGNobG9jID0ge1xuICAgICAgICAgICAgbndfbGF0ICAgICA6IGN1cnJlbnRfbWFwX253LmxhdCxcbiAgICAgICAgICAgIG53X2xvbiAgICAgOiBjdXJyZW50X21hcF9udy5sb24sXG4gICAgICAgICAgICBzZV9sYXQgICAgIDogY3VycmVudF9tYXBfc2UubGF0LFxuICAgICAgICAgICAgc2VfbG9uXHQgICA6IGN1cnJlbnRfbWFwX3NlLmxvbixcbiAgICAgICAgICAgIGNlbnRlcl9sYXQgOiBjdXJyZW50X21hcF9jZW50ZXIubGF0LFxuICAgICAgICAgICAgY2VudGVyX2xvbiA6IGN1cnJlbnRfbWFwX2NlbnRlci5sb25cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciB3YXRjaGxvY0pTT04gPSBKU09OLnN0cmluZ2lmeSh3YXRjaGxvYyk7XG5cbiAgICAgICAgdmFyIHVwZGF0ZWRzZXNzaW9uID0ge1xuICAgICAgICAgICAgd2F0Y2hsb2M6IHdhdGNobG9jSlNPTixcbiAgICAgICAgICAgIGd1aWQgICAgOiBndWlkXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gdXBkYXRlIHdhdGNobG9jIHdoZW4gY2VudGVyIGNoYW5nZWQuXG4gICAgICAgIC8vY29uc29sZS5sb2coXCJ1cGRhdGluZyB3YXRjaCBsb2NhdGlvblwiKTtcblxuXHRcdC8vY29uc29sZS5sb2coXCJ1cGRhdGVkc2Vzc2lvbjpcIiwgdXBkYXRlZHNlc3Npb24pO1xuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zL3VwZGF0ZV9zZXNzaW9uJywgdXBkYXRlZHNlc3Npb24pO1xuXHR9O1xuXG5cdHRoaXMudXBkYXRlQ291cGxpbmcgPSBmdW5jdGlvbihndWlkLCBndWlkdGd0KXtcblx0XHRcblx0XHR2YXIgdXBkYXRlZGd1aWR0Z3QgPSB7XG5cdFx0XHRndWlkICAgOiBndWlkLFxuXHRcdFx0Z3VpZHRndDogZ3VpZHRndFxuXHRcdH07XG5cblx0XHQvLyB1cGRhdGUgd2F0Y2hsb2Mgd2hlbiBjZW50ZXIgY2hhbmdlZC5cbiAgICAgICAgLy9jb25zb2xlLmxvZyhcInVwZGF0aW5nIGNvdXBsaW5nXCIpO1xuXG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbnMvdXBkYXRlX2NvdXBsaW5nJywgdXBkYXRlZGd1aWR0Z3QpXG5cdH07XG59KTtcbiIsIiIsIlxuYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcblx0J25nUm91dGUnLFxuXHQnbmdBbmltYXRlJyxcblx0J3VpLnNsaWRlcicsXG5cdCc3MjBrYi5zb2NpYWxzaGFyZScsXG5dKTtcblxuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkN0cmwnLCBmdW5jdGlvbihTZXNzaW9uU3ZjLCBVdGlsU3ZjLCBDb25maWdTdmMsICRyb290U2NvcGUsICRzY29wZSwgJHdpbmRvdywgJGh0dHAsICR0aW1lb3V0KXtcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gSU5JVElBTFxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICB3aW5kb3cub25iZWZvcmV1bmxvYWQgPSBmdW5jdGlvbihlKSB7XG4gICAgXHRTZXNzaW9uU3ZjLnJlbW92ZSgkc2NvcGUuZ3VpZClcbiAgICBcdC5zdWNjZXNzKGZ1bmN0aW9uKHJlcyl7XG4gICAgXHRcdC8vIGhhbmRsZSBzdWNjZXNzXG4gICAgXHR9KVxuICAgIFx0LmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgXHRcdC8vIGhhbmRsZSBlcnJvclxuICAgIFx0fSk7XG5cdH07XG5cblx0d2luZG93Lm9ucGFnZXNob3cgPSBmdW5jdGlvbihlKSB7XG5cdFx0JHNjb3BlLmluaXRTZXNzaW9uKCk7XG5cdFx0aWYgKCRzY29wZS5tYXApXG5cdCAgXHRcdCRzY29wZS5tYXAudXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cdH07XG5cblx0d2luZG93Lm9ucGFnZWhpZGUgPSBmdW5jdGlvbihlKSB7XG4gICAgXHRTZXNzaW9uU3ZjLnJlbW92ZSgkc2NvcGUuZ3VpZClcbiAgICBcdC5zdWNjZXNzKGZ1bmN0aW9uKHJlcyl7XG4gICAgXHRcdC8vIGhhbmRsZSBzdWNjZXNzXG4gICAgXHR9KVxuICAgIFx0LmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgXHRcdC8vIGhhbmRsZSBlcnJvclxuICAgIFx0fSk7XG5cdH07XG5cblx0Ly8gc2Vzc2lvbiBpbiBhbmQgb3V0IGV2ZW50c1xuXHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwidmlzaWJpbGl0eWNoYW5nZVwiLCBmdW5jdGlvbigpIHtcblx0ICBpZiAoZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09ICd2aXNpYmxlJyB8fCBcblx0ICBcdGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAnbW96VmlzaWJsZScgfHwgXG5cdCAgXHRkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ21zVmlzaWJsZScgfHxcblx0ICBcdGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAnd2Via2l0VmlzaWJsZScpXG5cdCAge1xuXHQgIFx0JHNjb3BlLmluaXRTZXNzaW9uKCk7XG5cdCAgXHRpZiAoJHNjb3BlLm1hcClcblx0ICBcdFx0JHNjb3BlLm1hcC51cGRhdGVBbmREcmF3UG9zdHMoKTtcblx0ICB9IFxuXHQgIGVsc2UgaWYgKGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAnaGlkZGVuJyB8fCBcblx0ICBcdGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAnbW96SGlkZGVuJyB8fCBcblx0ICBcdGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAnbXNIaWRkZW4nIHx8XG5cdCAgXHRkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ3dlYmtpdEhpZGRlbicpXG5cdCAge1xuXHQgIFx0U2Vzc2lvblN2Yy5yZW1vdmUoJHNjb3BlLmd1aWQpXG5cdCAgXHQuc3VjY2VzcyhmdW5jdGlvbihyZXMpe1xuICAgIFx0XHQvLyBoYW5kbGUgc3VjY2Vzc1xuICAgIFx0fSlcbiAgICBcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgIFx0XHQvLyBoYW5kbGUgZXJyb3JcbiAgICBcdH0pO1xuXHQgIH1cblx0fSk7XG5cblx0Ly8gd2Via2l0IHNlc3Npb24gaW4gYW5kIG91dCBldmVudHNcblx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIndlYmtpdHZpc2liaWxpdHljaGFuZ2VcIiwgZnVuY3Rpb24oKSB7XG5cdCAgaWYgKGRvY3VtZW50LndlYmtpdFZpc2libGUpXG5cdCAge1xuXHQgIFx0JHNjb3BlLmluaXRTZXNzaW9uKCk7XG5cdCAgXHRpZiAoJHNjb3BlLm1hcClcblx0ICBcdFx0JHNjb3BlLm1hcC51cGRhdGVBbmREcmF3UG9zdHMoKTtcblx0ICB9IFxuXHQgIGVsc2UgaWYgKGRvY3VtZW50LndlYmtpdEhpZGRlbilcblx0ICB7XG5cdCAgXHRTZXNzaW9uU3ZjLnJlbW92ZSgkc2NvcGUuZ3VpZClcblx0ICBcdC5zdWNjZXNzKGZ1bmN0aW9uKHJlcyl7XG4gICAgXHRcdC8vIGhhbmRsZSBzdWNjZXNzXG4gICAgXHR9KVxuICAgIFx0LmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgXHRcdC8vIGhhbmRsZSBlcnJvclxuICAgIFx0fSk7XG5cdCAgfVxuXHR9LCBmYWxzZSk7XG5cblx0JHNjb3BlLmluaXRTZXNzaW9uID0gZnVuY3Rpb24oKXtcblx0XHRpZiAoJHNjb3BlLm1hcCA9PSAndW5kZWZpbmVkJyB8fCAkc2NvcGUubWFwID09ICdudWxsJyB8fCAhJHNjb3BlLm1hcClcblx0XHRcdHJldHVybjtcblxuXHRcdGZ1bmN0aW9uIGdldEN1cnJMb2NTdWNjZXNzKHBvcykge1x0XG5cdFx0XHQvLy8vLy8vLy8vLy8vLy8vLy8gUEhZU0lDQUwgTE9DQVRJT05cblx0XHRcdC8vIOunqOyymOydjOyXkOuKlCDsnKDsoIDsnZgg7Iuk7KCcIOychOy5mCjslbHsl5Ag7J6F7J6l7ZaI7J2E65WM7J2YIOychOy5mCnsmYAg7IS87YSwIO2PrOyngOyFmOydhCDqsJnsnbQg67O064K06rOgLFxuXHRcdFx0Ly8g7IS87YSwIO2PrOyngOyFmOydgCDqs4Tsho0g7JeF642w7J207Yq4IOuQmOyWtOyVvCDtlZzri6QuXG5cdCAgICAgICAgdmFyIGNyZCA9IHBvcy5jb29yZHM7XG5cblx0ICAgICAgICB2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhjcmQubGF0aXR1ZGUsIGNyZC5sb25naXR1ZGUpO1xuXG5cdCAgICAgICAgLy8gc2F2ZSB0aGUgdXNlciBsb2NhdGlvbiBpbnRvIGFwcGxpY2F0aW9uIHNjb3BlIHZhcmlhYmxlXG5cdCAgICAgICAgJHNjb3BlLnVzZXJMb2NhdGlvbiA9IHtcblx0ICAgICAgICBcdGxhdDogY3JkLmxhdGl0dWRlLFxuXHQgICAgICAgIFx0bG9uOiBjcmQubG9uZ2l0dWRlXG5cdCAgICAgICAgfTtcblxuXHQgICAgICAgIHZhciBsb2NhdGlvbiA9IHtcblx0ICAgIFx0XHRsYXQ6Z29vZ2xlTG9jLmxhdCgpLFxuXHQgICAgXHRcdGxvbjpnb29nbGVMb2MubG5nKClcblx0ICAgIFx0fTtcblx0ICAgIFx0dmFyIGxvY2F0aW9uSlNPTiA9IEpTT04uc3RyaW5naWZ5KGxvY2F0aW9uKTtcblx0ICAgIFx0Ly9jb25zb2xlLmxvZyhcInNldHRpbmcgbG9jYXRpb25cIiwgbG9jYXRpb25KU09OKTtcblxuXHQgICAgXHQvLy8vLy8vLy8vLy8vLy8vLy8gV0FUQ0ggTE9DQVRJT05cblx0ICAgIFx0dmFyIGJvdW5kcyA9ICRzY29wZS5tYXAuZ2V0Qm91bmRzKCk7XG5cdCAgICAgICAgdmFyIG5lID0gYm91bmRzLmdldE5vcnRoRWFzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIG5vcnRoLWVhc3QgY29ybmVyXG5cdCAgICAgICAgdmFyIHN3ID0gYm91bmRzLmdldFNvdXRoV2VzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIHNvdXRoLXdlc3QgY29yZGVyXG5cdCAgICAgICAgLy9Zb3UgZ2V0IG5vcnRoLXdlc3QgYW5kIHNvdXRoLWVhc3QgY29ybmVycyBmcm9tIHRoZSB0d28gYWJvdmU6XG5cblx0ICAgICAgICB2YXIgY3VycmVudF9tYXBfbncgPSB7IFxuXHQgICAgICAgICAgICBsYXQ6IG5lLmxhdCgpLCBcblx0ICAgICAgICAgICAgbG9uOiBzdy5sbmcoKVxuXHQgICAgICAgIH07XG5cdCAgICAgICAgdmFyIGN1cnJlbnRfbWFwX3NlID0ge1xuXHQgICAgICAgICAgICBsYXQ6IHN3LmxhdCgpLCBcblx0ICAgICAgICAgICAgbG9uOiBuZS5sbmcoKVxuXHQgICAgICAgIH07XG5cblx0ICAgICAgICB2YXIgY3VycmVudF9tYXBfY2VudGVyID0ge1xuXHQgICAgICAgIFx0bGF0OndpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUsXG5cdCAgICAgICAgXHRsb246d2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGVcblx0ICAgIFx0fTtcblxuXHQgICAgICAgIHZhciB3YXRjaGxvYyA9IHtcblx0ICAgICAgICAgICAgbndfbGF0ICAgIDogY3VycmVudF9tYXBfbncubGF0LFxuXHQgICAgICAgICAgICBud19sb24gICAgOiBjdXJyZW50X21hcF9udy5sb24sXG5cdCAgICAgICAgICAgIHNlX2xhdCAgICA6IGN1cnJlbnRfbWFwX3NlLmxhdCxcblx0ICAgICAgICAgICAgc2VfbG9uXHQgIDogY3VycmVudF9tYXBfc2UubG9uLFxuXHQgICAgICAgICAgICBjZW50ZXJfbGF0OiBjdXJyZW50X21hcF9jZW50ZXIubGF0LFxuXHQgICAgICAgICAgICBjZW50ZXJfbG9uOiBjdXJyZW50X21hcF9jZW50ZXIubG9uXG5cdCAgICAgICAgfVxuXG4gICAgICAgIFx0dmFyIHdhdGNobG9jSlNPTiA9IEpTT04uc3RyaW5naWZ5KHdhdGNobG9jKTtcbiAgICAgICAgXHQvL2NvbnNvbGUubG9nKFwic2V0dGluZyB3YXRjaGxvY1wiLCB3YXRjaGxvY0pTT04pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8gTE9DQVRJT04gVVBEQVRFIFdJVEggU0VTU0lPTiBFTlRFUlxuICAgICAgICAgICAgLy/sl6zquLDshJwg67mE64+Z6riw7KCB7Jy866GcIOycoOyggOydmCDroZzsvIDsnbTshZjsnYQg7Ja76rOgIOyEuOyFmOydhCDrs7TrgrzsiJgg7J6I64ukLlxuXHRcdFx0dmFyIHNlc3Npb24gPSB7XG5cdFx0XHRcdGd1aWR0Z3QgOiAkc2NvcGUuZ3VpZHRndCxcblx0XHRcdFx0Z3VpZCAgICA6ICRzY29wZS5ndWlkLFxuXHRcdFx0XHRsb2NhdGlvbjogbG9jYXRpb25KU09OLFxuXHRcdFx0XHR3YXRjaGxvYzogd2F0Y2hsb2NKU09OXG5cdFx0XHR9O1xuXHRcdFx0U2Vzc2lvblN2Yy5lbnRlcihzZXNzaW9uKVxuXHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24ocmVzKXtcbiAgICBcdFx0Ly8gaGFuZGxlIHN1Y2Nlc3Ncblx0ICAgIFx0fSlcblx0ICAgIFx0LmNhdGNoKGZ1bmN0aW9uKGVycil7XG5cdCAgICBcdFx0Ly8gaGFuZGxlIGVycm9yXG5cdCAgICBcdH0pOyAvLyDshJzrsoTsl5DshJwg7Jyg7KCA6rCAIOuTpOyWtOyYtOydhCDslYzrprDri6QuXG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIGdldEN1cnJMb2NFcnJvcihlcnIpIHtcbiAgICAgICAgXHRzd2FsKFwiXCIsIFwiTmVlZCB0byB0dXJuIG9uIGxvY2F0aW9uIHNlcnZpY2UgZm9yIHByb3BlciB1c2UuXCIpO1xuICAgICAgICAgICAgLy9jb25zb2xlLndhcm4oJ0VSUk9SKCcgKyBlcnIuY29kZSArICcpOiAnICsgZXJyLm1lc3NhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaW5pdCBtYXAgYW5kIHBsYWNlIHNvbWUgbWFya2Vycywgc28gZXZlcnl0aGluZyBzdGFydCB3aXRoIHRoaXMgZnVuY3Rpb24uXG4gICAgICAgIHZhciBvcHRpb25zID0ge1xuXHRcdCAgZW5hYmxlSGlnaEFjY3VyYWN5OiBmYWxzZSxcblx0XHQgIHRpbWVvdXQ6IDEwMDAwLFxuXHRcdCAgbWF4aW11bUFnZTogMzAwMDAsXG5cdFx0fTtcblx0ICAgIG5hdmlnYXRvci5nZW9sb2NhdGlvbi5nZXRDdXJyZW50UG9zaXRpb24oZ2V0Q3VyckxvY1N1Y2Nlc3MsIGdldEN1cnJMb2NFcnJvciwgb3B0aW9ucyk7XG5cdFx0c3dhbCh7ICAgdGl0bGU6IFwiXCIsICAgdGV4dDogXCJSZXRyZWl2aW5nIGN1cnJuZXQgbG9jYXRpb24uLlwiLCAgIHRpbWVyOiAxMjAwLCAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSB9KTtcblx0fTtcblxuICAgIC8vIGxvYWQgYW5kIHNldCBsYXRlc3QgZ3VpZFxuXHRpZiAod2luZG93LmxvY2FsU3RvcmFnZS5ndWlkID09ICd1bmRlZmluZWQnIHx8IFxuXHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZCA9PSAnbnVsbCcgfHxcblx0XHQhd2luZG93LmxvY2FsU3RvcmFnZS5ndWlkKVxuXHR7XG5cdFx0d2luZG93LmxvY2FsU3RvcmFnZS5ndWlkID0gVXRpbFN2Yy5nZXRHdWlkKCk7XG5cdH1cblx0JHNjb3BlLmd1aWQgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWQ7XG5cblx0Ly8gbG9hZCBhbmQgc2V0IGxhdGVzdCBndWlkdGd0XG5cdGlmICh3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWR0Z3QgPT0gJ3VuZGVmaW5lZCcgfHwgXG5cdFx0d2luZG93LmxvY2FsU3RvcmFnZS5ndWlkdGd0ID09ICdudWxsJyB8fFxuXHRcdCF3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWR0Z3QpXG5cdHtcblx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWR0Z3QgPSBcIjBcIjtcblx0fVxuXHQkc2NvcGUuZ3VpZHRndCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZHRndDsgLy8gaW50ZXJlc3RlZCBvcHBvbmVudCBndWlkIG51bWJlclxuXG5cdCRzY29wZS5wYWdlSWQgPSB7IFxuXHRcdHBvc3QgOiAwLFxuXHR9O1xuXG5cdCRzY29wZS5uYXZDb2xsYXBzZWQgPSB0cnVlO1xuXG5cdC8vIHZhbHVlIGZyb20gdGltZSBzbGlkZXIgaW4gVUlcblx0Ly8gZGVmYXVsdCBpcyBtYXggaW5zdGFudCBsaWZlIHNwYW5cbiAgICAkc2NvcGUudGltZXZhbHVlID0gQ29uZmlnU3ZjLm1heEluc3RhbnRMaWZlU3BhbjtcblxuXHQvLyB1c2VyJ3MgY3VycmVudCBsb2NhdGlvbiBzdG9yYWdlXG5cdCRzY29wZS51c2VyTG9jYXRpb24gPSB7XG5cdFx0bGF0OiAwLjAsXG5cdFx0bG9uOiAwLjBcblx0fTtcblxuXHQkc2NvcGUudG9nZ2xlU2VhcmNoTG9jYXRpb24gPSBmYWxzZTtcblx0JHNjb3BlLnRvZ2dsZVRpbWVTbGlkZXIgPSBmYWxzZTtcblxuXHQvLyBldmVudCBoYW5kZXIgZm9yIG1hcCBVSXNcblx0JHRpbWVvdXQoZnVuY3Rpb24oKXtcblx0XHQvLyBlbmFibGVzIGVudGVyIGtleSB0byBzdWJtaXQgcG9zdCBmb3JtXG5cdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1wb3N0aW5nJykub25rZXlwcmVzcyA9IGZ1bmN0aW9uKGV2ZW50KXtcblx0XHRcdC8vY29uc29sZS5sb2coXCJJbnNpZGUga2V5cHJlc3NcIixldmVudC53aGljaCk7XG5cdFx0XHRpZiAoZXZlbnQud2hpY2ggPT0gJzEzJyl7XG5cdFx0XHRcdC8vY29uc29sZS5sb2coXCJlbnRlciBwcmVzc2VkXCIpO1xuXHRcdFx0XHQkKCdmb3JtI21hcC1wb3N0aW5nLWZvcm0nKS5zdWJtaXQoKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLXBvc3RpbmcnKS5vbmZvY3VzID0gZnVuY3Rpb24oZXZlbnQpe1xuXHRcdFx0Ly9jb25zb2xlLmxvZyhcIm9uIGZvY3VzXCIpO1xuXHRcdFx0JHNjb3BlLnRvZ2dsZVRpbWVTbGlkZXIgPSB0cnVlO1xuXHRcdH1cblxuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtcG9zdGluZycpLm9uYmx1ciA9IGZ1bmN0aW9uKGV2ZW50KXtcblx0XHRcdC8vY29uc29sZS5sb2coXCJvbiBibHVyXCIpO1xuXHRcdFx0JHNjb3BlLnRvZ2dsZVRpbWVTbGlkZXIgPSBmYWxzZTtcblx0XHR9XG5cblx0XHQkKCcubmF2LWJ1cmdlcicpLmNsaWNrKGZ1bmN0aW9uKCkge1xuXHRcdCAgJCgnLm5hdi1idXJnZXInKS50b2dnbGVDbGFzcygnYWN0aXZlJyk7XG5cdFx0ICAvLyQoJy5jb250cm9scycpLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcblx0XHQgICRzY29wZS50b2dnbGVTZWFyY2hMb2NhdGlvbiA9ICEkc2NvcGUudG9nZ2xlU2VhcmNoTG9jYXRpb247XG5cdFx0ICAkc2NvcGUuJGFwcGx5KCk7XG5cdFx0fSk7XG5cblx0fSk7XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFNPQ0tFVFxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdHZhciB1cmw7XG5cdHZhciBob3N0bmFtZSA9IGRvY3VtZW50LmxvY2F0aW9uLmhvc3RuYW1lO1xuXG5cdGlmIChob3N0bmFtZSA9PSBDb25maWdTdmMubG9jYWwpe1xuXHRcdHVybCA9IENvbmZpZ1N2Yy53ZWJfc29ja2V0ICsgQ29uZmlnU3ZjLmxvY2FsICsgJzonICsgQ29uZmlnU3ZjLnBvcnQ7XG5cdH1cblx0ZWxzZSBpZiAoaG9zdG5hbWUgPT0gQ29uZmlnU3ZjLmxvY2FsX2lwKSB7XG5cdFx0dXJsID0gQ29uZmlnU3ZjLndlYl9zb2NrZXQgKyBDb25maWdTdmMubG9jYWxfaXAgKyAnOicgKyBDb25maWdTdmMucG9ydDsgLy8gZGV2ZWxvcG1ldCBvbiBzb2NrZXQgbG9jYWxseSBcblx0fVxuXHRlbHNlIHtcblx0XHR1cmwgPSBDb25maWdTdmMud2ViX3NvY2tldCArIENvbmZpZ1N2Yy5kZXBsb3lfZG5zOyAvLyBwcm9kdWN0aW9uIGRlcGxveSB2ZXJzaW9uIC0gc3RpbGwgZGVidWcgbW9kZVxuXHRcdC8vdXJsID0gQ29uZmlnU3ZjLndlYl9zb2NrZXRfc2VjdXJlICsgQ29uZmlnU3ZjLmRlcGxveV9kbnM7IC8vIHByb2R1Y3Rpb24gZGVwbG95IHZlcnNpb24gLSBzdGlsbCBkZWJ1ZyBtb2RlXG5cdH1cblxuXHQvKiDqsJzrsJzqs7zsoJXsnbQg64Gd64KY6rOgIOuwsO2PrOyLnOyXkOuKlCDsnITrtoDrtoTsnYQg7KeA7Jqw6rOgIOyVhOuemCDsvZTrk5zrp4wg64Ko6rKo64+EIOuQnOuLpC5cblx0dXJsID0gJ3dzczovL2Zyb3plbi1iYWRsYW5kcy04NjQ5Lmhlcm9rdWFwcC5jb20nO1xuXHQqL1xuXHR2YXIgY29ubmVjdCA9IGZ1bmN0aW9uKCkge1xuXHRcdGNvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0KHVybCk7XG5cblx0XHRjb25uZWN0aW9uLm9ub3BlbiA9IGZ1bmN0aW9uKCl7XG5cblx0XHRcdC8vIHNlbmQgZ3VpZCB0byBzZXJ2ZXIgZm9yIHdzIGlkZW50aWZpY2F0aW9uXG5cdFx0XHRjb25uZWN0aW9uLnNlbmQoJHNjb3BlLmd1aWQpO1xuXHRcdFx0Ly9jb25zb2xlLmxvZygnV2ViU29ja2V0IGNvbm5lY3RlZCcpO1xuXHRcdH07XG5cblx0XHRjb25uZWN0aW9uLm9uY2xvc2UgPSBmdW5jdGlvbigpe1xuXG5cdFx0XHQvL2NvbnNvbGUubG9nKCdXZWJTb2NrZXQgY2xvc2VkLiBSZWNvbmVjdGluZy4uLicpO1xuXHRcdFx0JHRpbWVvdXQoY29ubmVjdCwgMjAwMCk7XG5cdFx0fTtcblxuXHRcdGNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24oZSl7XG5cdFx0XHQvL2NvbnNvbGUubG9nKCdicm9hZGNhc3QgbXNnIGZyb20gc2VydmVyOicsIGUpO1xuXHRcdFx0dmFyIHBheWxvYWQgPSBKU09OLnBhcnNlKGUuZGF0YSk7XG5cblx0XHRcdC8qXG5cdFx0XHRcdHdzOm5ld19wb3N0ICAgIC0g7IOI66Gc7Jq0IO2PrOyKpO2KuOqwgCDsmKzrnbzsmZTsnYTrlYwgZnJvbnQtZW5k7JeQ7IScIOunteydtCDri6Tsi5wg7JeF642w7J207Yq4IO2VtOyVvCDrkJzri6Tqs6Ag7JWM66Ck7KSA64ukIVxuXHRcdFx0XHR3czpuZXdfc2Vzc2lvbiAtIHNlc3Npb27snbQg7IOI66GcIOuTpOyWtOyYpOuptCDrkJzri6Tqs6Ag7JWM66Ck7KSA64ukIVxuXHRcdFx0XHR3czpyZW1vdmVfcG9zdCAtIO2PrOyKpO2KuOqwgCDsi5zqsITsnbQg64ukIOuQmOyWtOyEnCDsgqzrnbzsp4jrlYwhXG5cdFx0XHRcdOunpOyasOykkeyalCEgXG5cdFx0XHQqL1xuXHRcdFx0JHJvb3RTY29wZS4kYnJvYWRjYXN0KCd3czonICsgcGF5bG9hZC50eXBlLCBwYXlsb2FkLmRhdGEpO1xuXHRcdH07XG5cdH07XG5cdGNvbm5lY3QoKTtcblxuXHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFNPQ0tFVCBCUk9BRENBU1QgUkVDRUlWRVJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvLyBhcyBzZXJ2ZXIgc29ja2V0IHNlbmQgJ3dzOm5ld19wb3N0JyAsIHdlIGNhbiB1cGRhdGUgdGhlIG1hcCFcblx0JHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbihfLCBwb3N0KXtcblx0XHQvLyB1cGRhdGUgcG9zdHMgb24gbWFwXG5cdFx0JHNjb3BlLm1hcC51cGRhdGVBbmREcmF3UG9zdHMoKTtcblxuXHRcdC8vIHNob3cgcmVzcG9uc2l2ZSB1c2VycyBvbmx5IHRvIHRoZSB1c2VyIHdobyB3cm90ZSB0aGlzIHBvc3Rcblx0XHRpZiAocG9zdC5ndWlkID09ICRzY29wZS5ndWlkKVxuXHRcdHtcblx0XHRcdCRzY29wZS5tYXAuZHJhd1Jlc3BvbnNlcyhwb3N0KTtcblx0XHR9XG5cdH0pO1xuXG5cdC8vIGFzIHNlcnZlciBzb2NrZXQgc2VuZCAnd3M6bmV3X3Bvc3QnICwgd2UgY2FuIHVwZGF0ZSB0aGUgbWFwIVxuXHQkc2NvcGUuJG9uKCd3czpuZXdfc2Vzc2lvbicsIGZ1bmN0aW9uKF8sIHNlc3Npb24pe1xuXHRcdHZhciBsb2NhdGlvbiA9IGFuZ3VsYXIuZnJvbUpzb24oc2Vzc2lvbi5sb2NhdGlvbik7XG5cdFx0JHNjb3BlLm1hcC5kcmF3Q3VyckxvY2F0aW9uTWFya2VyKGxvY2F0aW9uKTtcblxuXHR9KTtcblxuXHQvLyB3aGVuIHNlcnZlciByZW1vdmUgdGhlIHBvc3QgYWZ0ZXIgdGltZSBmb3IgbG9uZ2VyIG9uZXMsIFxuXHQvLyB1cGRhdGUgbWFwIHdpdGggY29yZXNwb25kaW5nIGluZm9cblx0JHNjb3BlLiRvbignd3M6cmVtb3ZlX3Bvc3QnLCBmdW5jdGlvbihfLCBwb3N0aWQpe1xuXHRcdCRzY29wZS5tYXAudW5EcmF3UG9zdChwb3N0aWQpO1xuXHR9KTtcblxuXHQkc2NvcGUuJG9uKCd3czp1cGRhdGVfZ3VpZHRndCcsIGZ1bmN0aW9uKF8sIHVwZGF0ZWRTZXNzaW9uKXtcblx0XHQvLyB1cGRhdGUgcG9zdHMgb24gbWFwXG5cdFx0JHNjb3BlLm1hcC51cGRhdGVBbmREcmF3UG9zdHMoKTtcblx0fSk7XG5cblx0Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBBUFBMSUNBVElPTiBMRVZFTCBGVU5DVElPTlNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIHNlZSBpZiBpdHMgaW5zdGFudFxuICAgICRzY29wZS5pc0luc3RhbnQgPSBmdW5jdGlvbih0aW1ldmFsdWUpe1xuICAgIFx0aWYgKHRpbWV2YWx1ZSA8PSBDb25maWdTdmMubWF4SW5zdGFudExpZmVTcGFuKVxuICAgIFx0XHRyZXR1cm4gdHJ1ZTtcbiAgICBcdHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG5cdC8vIHNlZSBpZiBpdHMgbW9iaWxlIHBob25lXG5cdCRzY29wZS5pc01vYmlsZSA9IGZ1bmN0aW9uKCl7XG5cdFx0aWYoIG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0FuZHJvaWQvaSlcblx0XHQgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvd2ViT1MvaSlcblx0XHQgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBob25lL2kpXG5cdFx0IHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL2lQYWQvaSlcblx0XHQgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBvZC9pKVxuXHRcdCB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9CbGFja0JlcnJ5L2kpXG5cdFx0IHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL1dpbmRvd3MgUGhvbmUvaSlcblx0XHQgKXtcblx0XHQgICAgcmV0dXJuIHRydWU7XG5cdFx0ICB9XG5cdFx0IGVsc2Uge1xuXHRcdCAgICByZXR1cm4gZmFsc2U7XG5cdFx0ICB9XG5cdH07XG5cblx0LyogbW92ZSB0byBjdXJyZW50IGxvY2F0aW9uICovXG5cdCRzY29wZS5tb3ZlVG9DdXJyZW50TG9jYXRpb24gPSBmdW5jdGlvbigpe1xuXHRcdGZ1bmN0aW9uIGdldEN1cnJMb2NTdWNjZXNzKHBvcykge1xuICAgICAgICAgICAgLyogbWFrZSBzdXJlIHRvIGNoZWNrIHdlIGFyZSBvbiBwb3N0IHBhZ2Ugd2l0aCBtYXAgZmlyc3QgKi9cbiAgICAgICAgICAgIGlmICgkc2NvcGUuY3VycmVudFBhZ2VJZCAhPSAkc2NvcGUucGFnZUlkLnBvc3QpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICB2YXIgY3JkID0gcG9zLmNvb3JkcztcblxuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sYXRpdHVkZSA9IGNyZC5sYXRpdHVkZTtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlID0gY3JkLmxvbmdpdHVkZTtcblxuICAgICAgICAgICAgdmFyIGxvY2F0aW9uID0ge1xuICAgICAgICAgICAgXHRsYXQ6IGNyZC5sYXRpdHVkZSwgXG4gICAgICAgICAgICBcdGxvbjogY3JkLmxvbmdpdHVkZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gZHJhdyBkcm9wIGRvd24gdXNlciBwb3NpdGlvblxuICAgICAgICAgICBcdCRzY29wZS5tYXAuZHJhd0N1cnJMb2NhdGlvbk1hcmtlcihsb2NhdGlvbik7XG5cbiAgICAgICAgICAgXHQvLyBkcmF3IHggbWFya2VyXG5cdCAgICAgICAgJHNjb3BlLm1hcC5kcmF3WE1hcmtlcihsb2NhdGlvbik7XG5cblx0ICAgICAgICB2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsb2NhdGlvbi5sYXQsIGxvY2F0aW9uLmxvbik7XG5cblx0ICAgICAgICAvLyBtb3ZlIHRvIHRoZSBsb2NhdGlvbiBhbmQgem9vbSBpbnRvIHJpZ2h0IGFtb3VudFxuICAgICAgICAgICAgJHNjb3BlLm1hcC5wYW5Ubyhnb29nbGVMb2MpO1xuICAgICAgICAgICAgJHNjb3BlLm1hcC51cGRhdGVBbmREcmF3UG9zdHMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEN1cnJMb2NFcnJvcihlcnIpIHtcbiAgICAgICAgXHRzd2FsKFwiXCIsIFwiTmVlZCB0byB0dXJuIG9uIGxvY2F0aW9uIHNlcnZpY2UgZm9yIHByb3BlciB1c2UuXCIpO1xuICAgICAgICAgICAgLy9jb25zb2xlLndhcm4oJ0VSUk9SKCcgKyBlcnIuY29kZSArICcpOiAnICsgZXJyLm1lc3NhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaW5pdCBtYXAgYW5kIHBsYWNlIHNvbWUgbWFya2Vycywgc28gZXZlcnl0aGluZyBzdGFydCB3aXRoIHRoaXMgZnVuY3Rpb24uXG4gICAgICAgIHZhciBvcHRpb25zID0ge1xuXHRcdCAgZW5hYmxlSGlnaEFjY3VyYWN5OiB0cnVlLFxuXHRcdCAgdGltZW91dDogMTAwMDAsXG5cdFx0ICBtYXhpbXVtQWdlOiAzMDAwMCxcblx0XHR9O1xuICAgICAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGdldEN1cnJMb2NTdWNjZXNzLCBnZXRDdXJyTG9jRXJyb3IsIG9wdGlvbnMpO1xuXG4gICAgICAgIHN3YWwoeyAgIHRpdGxlOiBcIlwiLCAgIHRleHQ6IFwiTW92aW5nIHRvIGN1cnJlbnQgbG9jYXRpb24uLlwiLCAgIHRpbWVyOiAxMDAwLCAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSB9KTtcblx0fTtcblxuXHQkc2NvcGUubW92ZVRvUG9zdExvY2F0aW9uID0gZnVuY3Rpb24oKXtcblx0XHR2YXIgbGF0RGVsdGEgPSAwLjA7XG5cblx0XHRpZiAoJHNjb3BlLmlzTW9iaWxlKCkpe1xuXHRcdFx0dmFyIGJvdW5kcyA9ICRzY29wZS5tYXAuZ2V0Qm91bmRzKCk7XG5cdCAgICAgICAgdmFyIG5lID0gYm91bmRzLmdldE5vcnRoRWFzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIG5vcnRoLWVhc3QgY29ybmVyXG5cdCAgICAgICAgdmFyIHN3ID0gYm91bmRzLmdldFNvdXRoV2VzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIHNvdXRoLXdlc3QgY29yZGVyXG5cdCAgICAgICAgY3VycmVudF9tYXBfbncgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKG5lLmxhdCgpLCBzdy5sbmcoKSk7XG5cdCAgICAgICAgY3VycmVudF9tYXBfc2UgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHN3LmxhdCgpLCBuZS5sbmcoKSk7XG5cblx0ICAgICAgICB2YXIgbGF0RGVsdGFfY2VudGVyMm5vcnRoID0gMC41ICogTWF0aC5hYnMoJHNjb3BlLnBvc3RMb2NhdGlvbi5sYXQgLSBjdXJyZW50X21hcF9udy5sYXQoKSk7XG5cdCAgICAgICAgdmFyIGxhdERlbHRhX2NlbnRlcjJzb3V0aCA9IDAuNSAqIE1hdGguYWJzKCRzY29wZS5wb3N0TG9jYXRpb24ubGF0IC0gY3VycmVudF9tYXBfc2UubGF0KCkpO1xuXG5cdCAgICAgICAgaWYgKGxhdERlbHRhX2NlbnRlcjJub3J0aCA+IGxhdERlbHRhX2NlbnRlcjJzb3V0aCl7XG5cdCAgICAgICAgXHRsYXREZWx0YSA9IGxhdERlbHRhX2NlbnRlcjJzb3V0aDtcblx0ICAgICAgICB9XG5cdCAgICAgICAgZWxzZSB7XG5cdCAgICAgICAgXHRsYXREZWx0YSA9IGxhdERlbHRhX2NlbnRlcjJub3J0aDtcblx0ICAgICAgICB9XG5cdFx0fVxuXG5cdFx0dmFyIGNlbnRlckxvYyA9ICRzY29wZS5tYXAuZ2V0Q2VudGVyKCk7XG5cblx0XHR2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZygkc2NvcGUucG9zdExvY2F0aW9uLmxhdCArIGxhdERlbHRhLCBjZW50ZXJMb2MubG5nKCkpO1xuXHRcdCRzY29wZS5tYXAucGFuVG8oZ29vZ2xlTG9jKTtcblx0XHQkc2NvcGUubWFwLnVwZGF0ZUFuZERyYXdQb3N0cygpO1xuXHR9O1xuXG5cdCRzY29wZS5jb2xsYXBzZSA9IGZ1bmN0aW9uKCl7XG5cdFx0JHNjb3BlLm5hdkNvbGxhcHNlZCA9IHRydWU7XG5cdH07XG5cblx0Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBHRU5FUkFMIEJST0FEQ0FTVCBSRUNFSVZFUlxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgJHNjb3BlLiRvbignc2V0Om1hcCcsIGZ1bmN0aW9uKF8sIG1hcCl7XG5cdFx0JHNjb3BlLm1hcCA9IG1hcDtcblx0XHQkc2NvcGUuaW5pdFNlc3Npb24oKTtcblx0fSk7XG5cbiAgICAkc2NvcGUuJG9uKCdzZXQ6Z3VpZHRndCcsIGZ1bmN0aW9uKF8sIGd1aWR0Z3Qpe1xuXHRcdCRzY29wZS5ndWlkdGd0ID0gZ3VpZHRndDtcblxuXHRcdC8vIGl0cyB2ZXJ5IGltcG9yYW50IHRvIHNldCBsb2NhbCBzdG9yYWdlIGd1aWR0Z3Rcblx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWR0Z3QgPSBndWlkdGd0O1xuXHR9KTtcblxuXHQkc2NvcGUuJG9uKCdzZXQ6cGFnZWNoYW5nZScsIGZ1bmN0aW9uKF8sIHBhZ2VJZCl7XG5cdFx0JHNjb3BlLmN1cnJlbnRQYWdlSWQgPSBwYWdlSWQ7XG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ3NldDpsb2MnLCBmdW5jdGlvbihfLCBsb2NhdGlvbil7XG5cdFx0dmFyIGxhdCA9IGxvY2F0aW9uLmxhdCgpO1xuXHRcdHZhciBsb24gPSBsb2NhdGlvbi5sbmcoKTtcblx0XHQkc2NvcGUucG9zdExvY2F0aW9uID0ge1xuXHRcdFx0bGF0OiBsYXQsXG5cdFx0XHRsb246IGxvblxuXHRcdH07XG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ3NldDpwbGFjZScsIGZ1bmN0aW9uKF8sIHBsYWNlKXtcblx0XHQvLyBGb3JjaW5nIHRoZSB1cGRhdGUgd2l0aCAkYXBwbHkoKSBtZXRob2Qgb24gJHNjb3BlXG5cdFx0Ly8gcHJvYmxlbSByZWxhdGVkIG5vdGU6IGh0dHA6Ly93d3cuamVmZnJ5aG91c2VyLmNvbS9pbmRleC5jZm0vMjAxNC82LzIvSG93LWRvLUktcnVuLWNvZGUtd2hlbi1hLXZhcmlhYmxlLWNoYW5nZXMtd2l0aC1Bbmd1bGFySlNcblx0XHQkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XG5cdFx0XHRcdCRzY29wZS5wb3N0cGxhY2UgPSBwbGFjZTtcblx0XHRcdH1cblx0XHQpO1xuXHR9KTtcbn0pO1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29uc3RhbnQoJ0NvbmZpZ1N2YycsIHtcblx0XCJ3ZWJfc29ja2V0XCJcdFx0OiBcIndzOi8vXCIsXG5cdFwid2ViX3NvY2tldF9zZWN1cmVcIiA6IFwid3NzOi8vXCIsXG5cdFwibG9jYWxcIlx0XHRcdFx0OiBcImxvY2FsaG9zdFwiLFxuXHRcImxvY2FsX2lwXCJcdFx0XHQ6IFwiMTkyLjE2OC4wLjRcIixcblx0Ly9cImRlcGxveV9kbnNcIlx0XHQ6IFwiY2xvdWR0YWxrLmhlcm9rdWFwcC5jb21cIixcblx0XCJkZXBsb3lfZG5zXCJcdFx0OiBcInRhbGtpcGlhLmNvbVwiLFxuXHRcInBvcnRcIlx0XHRcdFx0OiBcIjUwMDBcIixcblx0XCJtYXhJbnN0YW50TGlmZVNwYW5cIjogNTAwMCxcbn0pO1xuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb25maWcoZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKXtcblx0JHJvdXRlUHJvdmlkZXJcblx0LndoZW4oJy8nLCBcblx0XHR7XG5cdFx0XHRjb250cm9sbGVyOiAnUG9zdHNDdHJsJywgXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvcG9zdHMuaHRtbCdcblx0XHR9KVxuXHQvLyBSZWRpcmVjdCB0byB0aGUgcm9vdCBwYWdlLlxuXHQub3RoZXJ3aXNlKFxuXHRcdHtcbiAgIFx0XHRcdHJlZGlyZWN0VG86ICcvJ1xuXHRcdH0pO1xufSk7XG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1V0aWxTdmMnLCBmdW5jdGlvbigpe1xuXHR2YXIgc3ZjID0gdGhpcztcblxuXHRzdmMuZGVnMnJhZCA9IGZ1bmN0aW9uKGRlZykge1xuXHQgIHJldHVybiBkZWcgKiAoTWF0aC5QSS8xODApO1xuXHR9O1xuXG5cdHN2Yy5nZXREaXN0YW5jZUZyb21MYXRMb25JbkttID0gZnVuY3Rpb24gKGxhdDEsbG9uMSxsYXQyLGxvbjIpIHtcblx0ICB2YXIgUiA9IDYzNzE7XG5cdCAgdmFyIGRMYXQgPSBzdmMuZGVnMnJhZChsYXQyLWxhdDEpO1xuXHQgIHZhciBkTG9uID0gc3ZjLmRlZzJyYWQobG9uMi1sb24xKTsgXG5cdCAgdmFyIGEgPSBcblx0ICAgIE1hdGguc2luKGRMYXQvMikgKiBNYXRoLnNpbihkTGF0LzIpICtcblx0ICAgIE1hdGguY29zKHN2Yy5kZWcycmFkKGxhdDEpKSAqIE1hdGguY29zKHN2Yy5kZWcycmFkKGxhdDIpKSAqIFxuXHQgICAgTWF0aC5zaW4oZExvbi8yKSAqIE1hdGguc2luKGRMb24vMilcblx0ICAgIDsgXG5cdCAgdmFyIGMgPSAyICogTWF0aC5hdGFuMihNYXRoLnNxcnQoYSksIE1hdGguc3FydCgxLWEpKTsgXG5cdCAgdmFyIGQgPSBSICogYztcblx0ICByZXR1cm4gZDtcblx0fTtcblxuXHRzdmMubWFwUmFuZ2UgPSBmdW5jdGlvbiAodmFsdWUsIGxvdzEsIGhpZ2gxLCBsb3cyLCBoaWdoMikge1xuXHQgICAgcmV0dXJuIGxvdzIgKyAoaGlnaDIgLSBsb3cyKSAqICh2YWx1ZSAtIGxvdzEpIC8gKGhpZ2gxIC0gbG93MSk7XG5cdH07XG5cblx0c3ZjLmdldEd1aWQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0ZnVuY3Rpb24gczQoKSB7XG5cdFx0ICAgIHJldHVybiBNYXRoLmZsb29yKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKVxuXHRcdCAgICAgIC50b1N0cmluZygxNilcblx0XHQgICAgICAuc3Vic3RyaW5nKDEpO1xuXHRcdH1cblx0ICBcdHJldHVybiBzNCgpICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyBzNCgpICsgczQoKTtcblx0fTtcbn0pO1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4ucnVuKGZ1bmN0aW9uKCRyb290U2NvcGUsICR0aW1lb3V0LCBTZXNzaW9uU3ZjKXtcblxuXG59KTtcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmRpcmVjdGl2ZSgnYXBwTWFwJywgZnVuY3Rpb24oUG9zdHNTdmMsIFV0aWxTdmMsIENvbmZpZ1N2YywgU2Vzc2lvblN2YywgJGNvbXBpbGUsICR0aW1lb3V0KSB7XG4gICAgLy8gZGlyZWN0aXZlIGxpbmsgZnVuY3Rpb25cbiAgICB2YXIgbGluayA9IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIEdMT0JBTCBWQVJJQUJMRVMgSU4gTElOSyBGVU5DVElPTlxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICB2YXIgbWFwOyAvLyBleHBhbmQgZnJvbSBnb29nbGUgbWFwIGZvciBtYW51YWxseSBjcmVhdGVkIGV2ZW50c1xuICAgICAgICB2YXIgbWFwX29yaWdpbjsgLy8gZm9yIG9yaWdpbmFsIGdvb2dsZSBtYXAgZXZlbnQgZnVuY3Rpb24gbGlua3NcbiAgICAgICAgdmFyIGN1cnJlbnRfbWFwX253O1xuICAgICAgICB2YXIgY3VycmVudF9tYXBfc2U7XG4gICAgICAgIHZhciBtYXBPcHRpb25zO1xuICAgICAgICB2YXIgaW5pdGlhbE1hcENlbnRlcjtcbiAgICAgICAgdmFyIENMT1VEX01BUF9JRCA9ICdjdXN0b21fc3R5bGUnOyAvLyBtYXAgc3R5bGVcbiAgICAgICAgdmFyIGhlbHBlck1hcmtlcnMgPSBbXTtcbiAgICAgICAgdmFyIG1hcmtlcnNPbk1hcCA9IFtdO1xuXG4gICAgICAgIHZhciBwcmV2R3VpZHRndCA9ICcwJztcbiAgICAgICAgdmFyIGlzR3VpZHRndENoYW5nZWQ7XG5cbiAgICAgICAgdmFyIGltYWdlUG9zdCA9IHtcbiAgICAgICAgICAgIC8vdXJsOiAnaHR0cHM6Ly9jYXRjaG1lLmlmeW91Y2FuLmNvbS9pbWFnZXMvcGljdHVyZXMvSVlDX0ljb25zL0lZQ19Mb2NhdGlvbl9JY29uX1NtYWxsLnBuZycsXG4gICAgICAgICAgICB1cmw6ICdEZWZhdWx0X01hcmtlci5wbmcnLFxuICAgICAgICAgICAgc2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMTAwLCAxMDApLFxuICAgICAgICAgICAgb3JpZ2luOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMCwgMCksXG4gICAgICAgICAgICBhbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludCgxNywgMzQpLFxuICAgICAgICAgICAgc2NhbGVkU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMSwgMSlcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGltYWdlVGFyZ2V0ID0ge1xuICAgICAgICAgICAgLy91cmw6ICdodHRwOi8vd3d3LmNsa2VyLmNvbS9jbGlwYXJ0cy9VL1Avai9NL0kvaS94LW1hcmsteWVsbG93LW1kLnBuZycsXG4gICAgICAgICAgICB1cmw6ICdYX01hcmtlci5wbmcnLFxuICAgICAgICAgICAgc2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMTAwLCAxMDApLFxuICAgICAgICAgICAgb3JpZ2luOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMCwgMCksXG4gICAgICAgICAgICBhbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludCgxNywgMzQpLFxuICAgICAgICAgICAgc2NhbGVkU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMjUsIDI1KVxuICAgICAgICB9O1xuICAgICAgICB2YXIgaW1hZ2VVc2VyTG9naW4gPSB7XG4gICAgICAgICAgICAvL3VybDogJ2h0dHA6Ly93d3cuY2xrZXIuY29tL2NsaXBhcnRzL3Evby8yL0svZy9WL2xvY2F0aW9uLXN5bWJvbC1tYXAtbWQucG5nJyxcbiAgICAgICAgICAgIHVybDogJ0N1cnJlbnRfTG9jYXRpb25fTWFya2VyLnBuZycsXG4gICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICBvcmlnaW46IG5ldyBnb29nbGUubWFwcy5Qb2ludCgwLCAwKSxcbiAgICAgICAgICAgIGFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDE3LCAzNCksXG4gICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgyMCwgMzMpXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gRVZFTlQgSEFORExFUlMgLSBVUERBVEVcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlRGVmYXVsdExvY2F0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sYXRpdHVkZSA9IG1hcC5nZXRDZW50ZXIoKS5sYXQoKTtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlID0gbWFwLmdldENlbnRlcigpLmxuZygpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlQm91bmRzKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGJvdW5kcyA9IG1hcC5nZXRCb3VuZHMoKTtcbiAgICAgICAgICAgIHZhciBuZSA9IGJvdW5kcy5nZXROb3J0aEVhc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBub3J0aC1lYXN0IGNvcm5lclxuICAgICAgICAgICAgdmFyIHN3ID0gYm91bmRzLmdldFNvdXRoV2VzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIHNvdXRoLXdlc3QgY29yZGVyXG4gICAgICAgICAgICAvL1lvdSBnZXQgbm9ydGgtd2VzdCBhbmQgc291dGgtZWFzdCBjb3JuZXJzIGZyb20gdGhlIHR3byBhYm92ZTpcblxuICAgICAgICAgICAgY3VycmVudF9tYXBfbncgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKG5lLmxhdCgpLCBzdy5sbmcoKSk7XG4gICAgICAgICAgICBjdXJyZW50X21hcF9zZSA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoc3cubGF0KCksIG5lLmxuZygpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVdhdGNoTG9jYXRpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgYm91bmRzID0gbWFwLmdldEJvdW5kcygpO1xuICAgICAgICAgICAgdmFyIG5lID0gYm91bmRzLmdldE5vcnRoRWFzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIG5vcnRoLWVhc3QgY29ybmVyXG4gICAgICAgICAgICB2YXIgc3cgPSBib3VuZHMuZ2V0U291dGhXZXN0KCk7IC8vIExhdExuZyBvZiB0aGUgc291dGgtd2VzdCBjb3JkZXJcbiAgICAgICAgICAgIC8vWW91IGdldCBub3J0aC13ZXN0IGFuZCBzb3V0aC1lYXN0IGNvcm5lcnMgZnJvbSB0aGUgdHdvIGFib3ZlOlxuXG4gICAgICAgICAgICBjdXJyZW50X21hcF9udyA9IHsgXG4gICAgICAgICAgICAgICAgbGF0OiBuZS5sYXQoKSwgXG4gICAgICAgICAgICAgICAgbG9uOiBzdy5sbmcoKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGN1cnJlbnRfbWFwX3NlID0ge1xuICAgICAgICAgICAgICAgIGxhdDogc3cubGF0KCksIFxuICAgICAgICAgICAgICAgIGxvbjogbmUubG5nKClcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBjdXJyZW50X21hcF9jZW50ZXIgO1xuXG4gICAgICAgICAgICAvLyBzZWUgaWYgdGhlIGxhdGVzdCB4IG1hcmtlciBvciBwb3N0IGxvY2F0aW9uIGlzIHdpdGhpbiB1c2VyJ3Mgdmlld1xuICAgICAgICAgICAgaWYgKCEoc2NvcGUucG9zdExvY2F0aW9uLmxhdCA8IGN1cnJlbnRfbWFwX253LmxhdCkgfHxcbiAgICAgICAgICAgICAgICAhKHNjb3BlLnBvc3RMb2NhdGlvbi5sYXQgPiBjdXJyZW50X21hcF9zZS5sYXQpIHx8XG4gICAgICAgICAgICAgICAgIShzY29wZS5wb3N0TG9jYXRpb24ubG9uIDwgY3VycmVudF9tYXBfc2UubG9uKSB8fFxuICAgICAgICAgICAgICAgICEoc2NvcGUucG9zdExvY2F0aW9uLmxvbiA+IGN1cnJlbnRfbWFwX253LmxvbikgKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vIGlmIGl0IGlzIG5vdCB3aXRoaW4gdXNlcidzIHZpZXcsIHRoZW4ganVzdCB1c2UgbWFwIGNlbnRlclxuICAgICAgICAgICAgICAgIGN1cnJlbnRfbWFwX2NlbnRlciA9IHtcbiAgICAgICAgICAgICAgICAgICAgbGF0OiBtYXAuZ2V0Q2VudGVyKCkubGF0KCksXG4gICAgICAgICAgICAgICAgICAgIGxvbjogbWFwLmdldENlbnRlcigpLmxuZygpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBpZiBpdCBpcyB3aXRoaW4gdXNlcidzIHZpZXcsIHVzZSB4IG1hcmtlciBsb2NhdGlvbiBhLmsuYSBwb3N0IGxvY2F0aW9uXG4gICAgICAgICAgICAgICAgY3VycmVudF9tYXBfY2VudGVyID0ge1xuICAgICAgICAgICAgICAgICAgICBsYXQ6IHNjb3BlLnBvc3RMb2NhdGlvbi5sYXQsXG4gICAgICAgICAgICAgICAgICAgIGxvbjogc2NvcGUucG9zdExvY2F0aW9uLmxvblxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBTZXNzaW9uU3ZjLnVwZGF0ZVdhdGNoTG9jYXRpb24oY3VycmVudF9tYXBfbncsIGN1cnJlbnRfbWFwX3NlLCBjdXJyZW50X21hcF9jZW50ZXIsIHNjb3BlLmd1aWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gRVZFTlQgSEFORExFUlMgLSBEUkFXXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIHVwZGF0ZSByZXNwb25zZXMgc3VjaCBhcyB2aXN1YWxpemF0aW9uIG9mIGxpc3RlbmVyc1xuICAgICAgICBmdW5jdGlvbiBkcmF3UmVzcG9uc2VzKHBvc3Qpe1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygncmVmZXJlbmNlIHBvc3Q6JywgcG9zdCk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGRyYXdCbGlua3Moc2Vzc2lvbnMpe1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZXNzaW9ucy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZXNzaW9uID0gc2Vzc2lvbnNbaV07XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gc2tpcCBteSBzZXNzaW9uIC0gbm8gbmVlZCB0byBkcmF3IOuCtCDsnpDsi6DsnZgg7IS47IWY7J2AIOq3uOumtO2VhOyalOqwgCDsl4bri6QuXG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXNzaW9uLmd1aWQgPT0gc2NvcGUuZ3VpZClcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAvLyBzZXNzaW9uJ3Mgd2F0Y2ggbG9jYXRpb24gd2lsbCBiZSBib3VuY2VkIVxuICAgICAgICAgICAgICAgICAgICB2YXIgd2F0Y2hfbG9jYXRpb24gPSBhbmd1bGFyLmZyb21Kc29uKHNlc3Npb24ud2F0Y2hsb2MpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcG9zdF9sb2NhdGlvbiAgPSBhbmd1bGFyLmZyb21Kc29uKHBvc3QubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8g7Jyg7KCA6rCAIOuztOqzoCDsnojripQg67CU7Jq0642U66asIOyViOyXkCDqt7ggc2Vzc2lvbijri6TrpbjsnKDsoIApIOyytO2CgVxuXG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coY3VycmVudF9tYXBfc2UsIGN1cnJlbnRfbWFwX253KTtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlQm91bmRzKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghKHdhdGNoX2xvY2F0aW9uLmNlbnRlcl9sYXQgPCBjdXJyZW50X21hcF9udy5sYXQoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEod2F0Y2hfbG9jYXRpb24uY2VudGVyX2xhdCA+IGN1cnJlbnRfbWFwX3NlLmxhdCgpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgISh3YXRjaF9sb2NhdGlvbi5jZW50ZXJfbG9uIDwgY3VycmVudF9tYXBfc2UubG5nKCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKHdhdGNoX2xvY2F0aW9uLmNlbnRlcl9sb24gPiBjdXJyZW50X21hcF9udy5sbmcoKSkgKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIHNlc3Npb24o64uk66W47Jyg7KCAKeuTpOydtCDqt7gg7Y+s7Iqk7Yq466W8IOuztOqzoCDsnojsp4Ag7JWK7Jy866m0IOyKpO2CtS5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCEocG9zdF9sb2NhdGlvbi5sYXQgPCB3YXRjaF9sb2NhdGlvbi5ud19sYXQpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKHBvc3RfbG9jYXRpb24ubGF0ID4gd2F0Y2hfbG9jYXRpb24uc2VfbGF0KSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIShwb3N0X2xvY2F0aW9uLmxvbiA8IHdhdGNoX2xvY2F0aW9uLnNlX2xvbikgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEocG9zdF9sb2NhdGlvbi5sb24gPiB3YXRjaF9sb2NhdGlvbi5ud19sb24pIClcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcod2F0Y2hfbG9jYXRpb24uY2VudGVyX2xhdCwgd2F0Y2hfbG9jYXRpb24uY2VudGVyX2xvbik7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB2YXIgcmFuZG9tU2l6ZSA9IE1hdGgucmFuZG9tKCkgKiA0MCArIDQwOyBcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVybE5hbWUgICAgPSAnQmxpbmsuZ2lmJztcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaW1hZ2VMaXN0ZW5lciA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdXJsTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDEwMCwgMTAwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDAsIDApLFxuICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQocmFuZG9tU2l6ZSAqIDAuNSArIDUsIHJhbmRvbVNpemUgKiAwLjUgKyAxNCksXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZShyYW5kb21TaXplLCByYW5kb21TaXplKVxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIChmdW5jdGlvbihpbWFnZUxpc3RlbmVyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYXJrZXJPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBnb29nbGVMb2MsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwiUmVjZWl2ZXJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uOiBpbWFnZUxpc3RlbmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGltaXplZDogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKG1hcmtlck9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlY2VpdmVyX21hcmtlcl9saWZlc3BhbiA9IDEyMDA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChmdW5jdGlvbihvbGRfbWFya2VyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGRfbWFya2VyLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZF9tYXJrZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0obWFya2VyKSksIFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWl2ZXJfbWFya2VyX2xpZmVzcGFuKTtcblxuICAgICAgICAgICAgICAgICAgICB9KGltYWdlTGlzdGVuZXIpKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBTZXNzaW9uU3ZjLmZldGNoKClcbiAgICAgICAgICAgIC5zdWNjZXNzKGRyYXdCbGlua3MpXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICAgICAgICAvL2hhbmRsZSBlcnJvcnNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHBvc3QgaXMgY29tcGxldGx5IGRlYWQgYW5kIHJlbW92ZSB0aGF0IHBvc3RcbiAgICAgICAgZnVuY3Rpb24gY2xlYW51cCgpIHtcbiAgICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgbWFya2VyOyBtYXJrZXIgPSBtYXJrZXJzT25NYXBbal07IGorKyl7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnREYXRlICAgICAgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VGltZU1pbGxpID0gY3VycmVudERhdGUuZ2V0VGltZSgpO1xuICAgICAgICAgICAgICAgIHZhciBsaWZlID0gbWFya2VyLnBvc3QubGlmZWVuZCAtIGN1cnJlbnRUaW1lTWlsbGk7XG5cbiAgICAgICAgICAgICAgICBpZiAobGlmZSA8PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnY2xlYW5pbmcgdXAuLicsIG1hcmtlci5wb3N0Ll9pZCk7XG4gICAgICAgICAgICAgICAgICAgIHVuRHJhd1Bvc3QobWFya2VyLnBvc3QuX2lkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVBbmREcmF3UG9zdHMoKXtcbiAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gZm9yIGNoZWNraW5nIGxvY2FsIHBvc3RzIC0gaXNQb2ludGluZ1lvdVxuICAgICAgICAgICAgaXNHdWlkdGd0Q2hhbmdlZCA9IHByZXZHdWlkdGd0ICE9IHNjb3BlLmd1aWR0Z3Q7IC8vIHNlZSBpZiBteSBndWlkdGd0IGhhcyBjaGFuZ2VkO1xuICAgICAgICAgICAgcHJldkd1aWR0Z3QgPSBzY29wZS5ndWlkdGd0OyAvLyB1cGRhdGUgcHJldmlvdXMgZ3VpZHRndFxuXG4gICAgICAgICAgICBmdW5jdGlvbiBkcmF3UG9zdHMocG9zdHMpe1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb3N0cy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwb3N0ID0gcG9zdHNbaV07XG5cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBTVEFSVCAtIENIRUNLIElGIElUUyBXSVRISU4gVklFVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IGFuZ3VsYXIuZnJvbUpzb24ocG9zdC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxvY2F0aW9uLmxhdCwgbG9jYXRpb24ubG9uKTtcblxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVCb3VuZHMoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoZ29vZ2xlTG9jLmxhdCgpIDwgY3VycmVudF9tYXBfbncubGF0KCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKGdvb2dsZUxvYy5sYXQoKSA+IGN1cnJlbnRfbWFwX3NlLmxhdCgpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIShnb29nbGVMb2MubG5nKCkgPCBjdXJyZW50X21hcF9zZS5sbmcoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEoZ29vZ2xlTG9jLmxuZygpID4gY3VycmVudF9tYXBfbncubG5nKCkpIClcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7IC8vIHNraXAgdGhpcyBwb3N0IC0gbm8gbmVlZCB0byBkcmF3XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBFTkQgLSBDSEVDSyBJRiBJVFMgV0lUSElOIFZJRVcgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBTVEFSVCAtIENIRUNLIFdFIEhBVkUgVE8gUkVEUkFXIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIG1hcmtlcnMgcG9zdCBpcyBleGlzaXRpbmcgb25lLCB3ZSBkb24ndCB3YW50IHRvIGRyYXcgaXQgYWdhaW4uXG4gICAgICAgICAgICAgICAgICAgIC8vIG9ubHkgZHJhdyBuZXcgb25lcyFcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIG1hcmtlcjsgbWFya2VyID0gbWFya2Vyc09uTWFwW2pdOyBqKyspe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL+ydtOu2gOu2hCDroZzsp4HsnYQg64uk7IucIOynnOyVvO2VqFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzQWxyZWFkeURyYXduID0gcG9zdC5faWQgPT0gbWFya2VyLnBvc3QuX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQWxyZWFkeURyYXduKSAvLyDsnbTrr7gg6re466Ck7KGM64qU7KeAIO2FjOyKpO2KuFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0d1aWR0Z3RDaGFuZ2VkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5EcmF3UG9zdChwb3N0Ll9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWFya2VyLnBvc3QuZ3VpZHRndCA9PSBwb3N0Lmd1aWR0Z3QpeyAgLy8g7J2066+4IOq3uOugpOynhOqyg+ykkSwgZ3VpZHRndOydtCDrsJTrgIzsl4jripTqsIBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdCA9IG51bGw7IC8vIOydtOuvuCDqt7jroKTsp4Qg7Y+s7Iqk7Yq4652866m0LCBudWxs66GcLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsgLy8g7J20IGxvb3DsnYAgcG9zdC5faWTrp4wg6rKA7IKs7Jqp7J6E7Jy866GcLCDrp4zslb0g6rK57LmY66m0IOuwlOuhnCBsb29w7J2EIOupiOy2sOuPhCDqtJzssK7ri6QufVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuRHJhd1Bvc3QocG9zdC5faWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAocG9zdCA9PSBudWxsKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOyAvLyBza2lwIHRoaXMgcG9zdCAtIG5vIG5lZWQgdG8gZHJhd1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRU5EIC0gQ0hFQ0sgV0UgSEFWRSBUTyBSRURSQVcgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBTVEFSVCAtIERSQVdJTkcgUE9TVCAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgICAgICAgICAgICAgIC8vIG1hcmtlciBvcHRpb24gc2V0dGluZ1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBnb29nbGVMb2MsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXA6IG1hcCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIkJ1YmJsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VQb3N0XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKG1hcmtlck9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAvLyBhZGQgbWFya2VyIHRvIGFycmF5LCB0aGlzIG1lYW5zIHRoYXQgaXQgaGFzIGJlZW4gZHJhd24gdG8gbWFwXG4gICAgICAgICAgICAgICAgICAgIG1hcmtlcnNPbk1hcC5wdXNoKFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlcjogbWFya2VyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc3QgIDogcG9zdFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBTVEFSVCAtIERSQVdJTkcgTUVTU0FHRSBXSU5ET1cgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgICAgICAgICAgICAgICAgICB2YXIgY291cGxpbmdfc3RhdHVzID0gY2FsY3VsYXRlQ291cGxpbmcocG9zdC5ndWlkLCBwb3N0Lmd1aWR0Z3QpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJwb3N0LmlzTG9jYWxcIiwgcG9zdC5pc2xvY2FsKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2FsX3N0YXR1cyA9IHBvc3QuaXNsb2NhbDtcblxuICAgICAgICAgICAgICAgICAgICAvLyDsiqTsvZTtlITsl5DshJzrtoDthLAg7IOI66Gc7Jq0IOywqOydvOuTnCDsiqTsvZTtlITrpbwg66eM65Ok7Ja0IGVhY2ggZm9yIGxvb3Dsl5DshJwg7IKs7Jqp7ZWc64ukLlxuICAgICAgICAgICAgICAgICAgICAvLyAtLT4g7ZW07JW8LCDqsIEgRE9N7J20IOqwgeqwgeydmCBzY29wZeulvCDqsIDsoLjshJwgcG9zdCBtc2fqsIAg7JWIIOqyuey5nOuLpC5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHNjb3BlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSBwYXJlbnQuJG5ldyh0cnVlKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgb3BlbkluZm9XaW5kb3cgPSAoZnVuY3Rpb24obWFya2VyLCBjaGlsZF9zY29wZSwgcG9zdCwgY291cGxpbmdfc3RhdHVzLCBsb2NhbF9zdGF0dXMpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjcmVhdGUgbmV3IHdpbmRvd1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmZvV2luZG93T3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGl4ZWxPZmZzZXQ6IG5ldyBnb29nbGUubWFwcy5TaXplKC0zOS41LCAxNi4wKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZUF1dG9QYW46IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmZvV2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coaW5mb1dpbmRvd09wdGlvbnMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGN1cnJlbnQgdGltZSBhbmQgc3VidHJhY3QgaXQgZnJvbSBwb3N0J3MgZW5kIHRpbWUuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhhdCB3aWxsIGJlIGFjY3VyYXRlIHBvc3QgdGltZSBmb3IgaW5zdGFudCBwb3N0cyBhbmQgbG9uZyBwb3N0cy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudERhdGUgICAgICA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lTWlsbGkgPSBjdXJyZW50RGF0ZS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvc3RsaWZlICAgICAgICAgPSAoKHBvc3QubGlmZWVuZCAtIGN1cnJlbnRUaW1lTWlsbGkpID49IDApID8gKHBvc3QubGlmZWVuZCAtIGN1cnJlbnRUaW1lTWlsbGkpIDogMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsaWZlcGVyY2VudGFnZSA9IChwb3N0bGlmZSAvIHBvc3QubGlmZXNwYW4pLnRvRml4ZWQoMilcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdG8gbWFrZSBkYXRhIGF2YWlsYWJsZSB0byB0ZW1wbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLm1zZyAgICAgICAgICAgICAgICA9IHBvc3QuYm9keTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0bGlmZSAgICAgICAgICAgPSBwb3N0bGlmZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Z3VpZCAgICAgICAgICAgPSBwb3N0Lmd1aWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUucG9zdGd1aWR0Z3QgICAgICAgID0gcG9zdC5ndWlkdGd0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3Rjb3VwbGVzdGF0dXMgICA9IGNvdXBsaW5nX3N0YXR1cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPSBsaWZlcGVyY2VudGFnZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0bG9jYWxzdGF0dXMgICAgPSBsb2NhbF9zdGF0dXM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgZW5hYmxlcyBjaGFuZ2luZyBjb3VwbGluZyB2YWx1ZSBpbnN0YW50bHkuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUuJG9uKCdzZXQ6Y291cGxpbmcnLCBmdW5jdGlvbihfLCBjb3VwbGluZ191cGRhdGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Y291cGxlc3RhdHVzID0gY291cGxpbmdfdXBkYXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb21waWxlIGl0IGJlZm9yZSBsb2FkZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udGVudCAgPSAnPGRpdiBtYXAtbXNnPjwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXBpbGVkID0gJGNvbXBpbGUoY29udGVudCkoY2hpbGRfc2NvcGUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5zZXRDb250ZW50KCBjb21waWxlZFswXSApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIoaW5mb1dpbmRvdywnY2xvc2VjbGljaycsZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvc3QuZ3VpZCA9PSBzY29wZS5ndWlkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dhbChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJBcmUgeW91IHN1cmU/XCIsICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogXCJZb3Ugd2lsbCBub3QgYmUgYWJsZSB0byByZWNvdmVyIHRoaXMgaW1hZ2luYXJ5IGZpbGUhXCIsICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJ3YXJuaW5nXCIsICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6IFwiI0RENkI1NVwiLCAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiBcIlllcywgZGVsZXRlIGl0IVwiLCAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlT25Db25maXJtOiBmYWxzZSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oaXNDb25maXJtKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDb25maXJtKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUG9zdHNTdmMucmVtb3ZlKHBvc3QpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKHJlcyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBoYW5kbGUgc3VjY2Vzc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBlcnJvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2FsKFwiRGVsZXRlZCFcIiwgXCJZb3VyIGltYWdpbmFyeSBmaWxlIGhhcyBiZWVuIGRlbGV0ZWQuXCIsIFwic3VjY2Vzc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudERhdGUgICAgICA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VGltZU1pbGxpID0gY3VycmVudERhdGUuZ2V0VGltZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zdGxpZmUgICAgICAgICA9ICgocG9zdC5saWZlZW5kIC0gY3VycmVudFRpbWVNaWxsaSkgPj0gMCkgPyAocG9zdC5saWZlZW5kIC0gY3VycmVudFRpbWVNaWxsaSkgOiAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGlmZXBlcmNlbnRhZ2UgPSAocG9zdGxpZmUgLyBwb3N0LmxpZmVzcGFuKS50b0ZpeGVkKDIpXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpZmVwZXJjZW50YWdlID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPSBsaWZlcGVyY2VudGFnZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cub3BlbihtYXAgLCBtYXJrZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5vcGVuKG1hcCAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9KShtYXJrZXIsIGNoaWxkLCBwb3N0LCBjb3VwbGluZ19zdGF0dXMsIGxvY2FsX3N0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBvcGVuSW5mb1dpbmRvdygpO1xuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEVORCAtIERSQVdJTkcgTUVTU0FHRSBXSU5ET1cgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgICAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRU5EIC0gRFJBV0lORyBQT1NUIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICAgICAgICAgIH0gLy8gZW5kIG9mIGZvci1sb29wXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFBvc3RzU3ZjLmZldGNoKClcbiAgICAgICAgICAgIC5zdWNjZXNzKGRyYXdQb3N0cykgXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgZXJyb3JcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBlbmQgb2YgcG9zdCBmZXRjaCBzdWNjZXNzXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkcmF3RHJvcERvd24obG9jYXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxvY2F0aW9uLmxhdCwgbG9jYXRpb24ubG9uKTtcblxuICAgICAgICAgICAgdXBkYXRlQm91bmRzKCk7XG4gICAgICAgICAgICAvLyDrsJTsmrTrjZTrpqwg7JWI7JeQIOyeiOuKlOyngOu2gO2EsCDssrTtgazrpbwg7ZWY7J6lXG4gICAgICAgICAgICBpZiAoIShnb29nbGVMb2MubGF0KCkgPCBjdXJyZW50X21hcF9udy5sYXQoKSkgfHxcbiAgICAgICAgICAgICAgICAhKGdvb2dsZUxvYy5sYXQoKSA+IGN1cnJlbnRfbWFwX3NlLmxhdCgpKSB8fFxuICAgICAgICAgICAgICAgICEoZ29vZ2xlTG9jLmxuZygpIDwgY3VycmVudF9tYXBfc2UubG5nKCkpIHx8XG4gICAgICAgICAgICAgICAgIShnb29nbGVMb2MubG5nKCkgPiBjdXJyZW50X21hcF9udy5sbmcoKSkgKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybjsgLy8gc2tpcCB0aGlzIHBvc3QgLSBubyBuZWVkIHRvIGRyYXdcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gbWFya2VyIG9wdGlvbiBzZXR0aW5nXG4gICAgICAgICAgICB2YXIgbWFya2VyT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogZ29vZ2xlTG9jLFxuICAgICAgICAgICAgICAgIG1hcDogbWFwLFxuICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkRST1AsXG4gICAgICAgICAgICAgICAgdGl0bGU6IFwiVXNlclBpblwiLFxuICAgICAgICAgICAgICAgIGljb246IGltYWdlVXNlckxvZ2luXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcihtYXJrZXJPcHRpb25zKTtcblxuICAgICAgICAgICAgJHRpbWVvdXQoXG4gICAgICAgICAgICAgICAgKGZ1bmN0aW9uKG9sZF9tYXJrZXIpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9sZF9tYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0obWFya2VyKSksIFxuICAgICAgICAgICAgMjAwMCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1bkRyYXdQb3N0KHBvc3RpZClcbiAgICAgICAge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcInN0YXJ0aW5nIHJlbW92ZSBwb3N0XCIpO1xuICAgICAgICAgICAgZm9yICh2YXIgayA9IDAsIG1hcmtlcjsgbWFya2VyID0gbWFya2Vyc09uTWFwW2tdOyBrKyspIHtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHBvc3RpZCk7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhtYXJrZXIucG9zdC5faWQpO1xuICAgICAgICAgICAgICAgIGlmIChwb3N0aWQgPT0gbWFya2VyLnBvc3QuX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlci5tYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICBtYXJrZXJzT25NYXAuc3BsaWNlKGssIDEpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkcmF3QW5kU2V0UGxhY2UobG9jYXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxvY2F0aW9uLmxhdCwgbG9jYXRpb24ubG9uKTtcbiAgICAgICAgICAgIGRyYXdIZWxwZXJNYXJrZXIoZ29vZ2xlTG9jKTtcbiAgICAgICAgICAgIHNldFBsYWNlKGdvb2dsZUxvYyk7XG5cbiAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSBzZXJ2ZXIgZ2V0cyB1cGRhdGVkIHdoZW5ldmVyIHNldHRpbmcgbmV3IHBsYWNlIHdpdGggbWFya2VyXG4gICAgICAgICAgICB1cGRhdGVXYXRjaExvY2F0aW9uKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBkcmF3IG1hcCB3aXRoIGhlbHBlciBtYXJrZXJzXG4gICAgICAgIGZ1bmN0aW9uIGRyYXdIZWxwZXJNYXJrZXIobG9jYXRpb24pe1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG1hcmtlcjsgbWFya2VyID0gaGVscGVyTWFya2Vyc1tpXTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbWFya2VyLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGhlbHBlck1hcmtlcnMgPSBbXTtcbiAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogbG9jYXRpb24sIFxuICAgICAgICAgICAgICAgIG1hcDogbWFwLFxuICAgICAgICAgICAgICAgIGljb246IGltYWdlVGFyZ2V0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGhlbHBlck1hcmtlcnMucHVzaChtYXJrZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdW5EcmF3SGVscGVyTWFya2VyKCl7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbWFya2VyOyBtYXJrZXIgPSBoZWxwZXJNYXJrZXJzW2ldOyBpKyspIHtcbiAgICAgICAgICAgICAgICBtYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGVscGVyTWFya2VycyA9IFtdO1xuICAgICAgICB9XG5cblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBVVElMXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIGZ1bmN0aW9uIHNldFBsYWNlKGxvY2F0aW9uKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBicm9hZGNhc3QgbG9jYXRpb24gaW5mb3IobG9uLGxhdClcbiAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdzZXQ6bG9jJywgbG9jYXRpb24pO1xuXG4gICAgICAgICAgICB2YXIgZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTtcblxuICAgICAgICAgICAgLy8gYnJvYWRjYXN0IHBsYWNlIGZvcm1hdHRlZF9hZGRyZXNzIGFuZCBkcmF3IGljb25cbiAgICAgICAgICAgIGdlb2NvZGVyLmdlb2NvZGUoIHsgJ2xhdExuZyc6IGxvY2F0aW9uIH0sIGZ1bmN0aW9uKHJlc3VsdHMsIHN0YXR1cykge1xuICAgICAgICAgICAgICAgIC8vIGFzIHVzZXIgY2xpY2tzIG9uIHRoZSBtYXAsXG4gICAgICAgICAgICAgICAgLy8gd2UgaGF2ZSB0byBzYXZlIHRoZSBmb3JtYXR0ZWQgYWRkcmVzcyBpbiAkc2NvcGUgYW5kXG4gICAgICAgICAgICAgICAgLy8gaXQgd2lsbCBiZSB1c2VkIHRocm91Z2ggcG9zdHMuY3RybFxuICAgICAgICAgICAgICAgIC8vIGVtaXQgYnJvYWRjYXNlICdwbGFjZScgYW5kIHNlbmQgdGhpcyB0byBhcHBsaWNhdGlvbi5jdHJsXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYnJvYWRjYXN0IGZvcm1hdHRlZF9hZGRyZXNzXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdzZXQ6cGxhY2UnLCByZXN1bHRzWzFdLmZvcm1hdHRlZF9hZGRyZXNzKTsgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoKGVycikge1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgIHN3YWwoXCJcIixcIkxvY2F0aW9uIGRvZXMgbm90IGV4aXN0c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldDpwbGFjZScsIFwiTG9jYXRpb24gZG9lcyBub3QgZXhpc3RzXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2FsY3VsYXRlQ291cGxpbmcocG9zdF9ndWlkLCBwb3N0X2d1aWR0Z3QpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qIGNvdXBsaW5nIHN0YXR1c1xuICAgICAgICAgICAgICAgIDAgLSBubyBzdGF0dXNcbiAgICAgICAgICAgICAgICAxIC0gaSBsaWtlIHlvdVxuICAgICAgICAgICAgICAgIDIgLSB5b3UgbGlrZSBpXG4gICAgICAgICAgICAgICAgNCAtIHdlIGxpa2UgZWFjaCBvdGhlciAvLyBkaXNhYmxlZC5cbiAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIHZhciBpc1BvaW50aW5nWW91ICAgICA9IHNjb3BlLmd1aWR0Z3QgPT0gcG9zdF9ndWlkO1xuICAgICAgICAgICAgdmFyIGlzUG9pbnRpbmdNZSAgICAgID0gc2NvcGUuZ3VpZCAgICA9PSBwb3N0X2d1aWR0Z3Q7XG4gICAgICAgICAgICB2YXIgaXNNeVBvc3QgICAgICAgICAgPSBzY29wZS5ndWlkICAgID09IHBvc3RfZ3VpZDtcbiAgICAgICAgICAgIHZhciBpc1BvaW50aW5nU29tZW9uZSA9IHNjb3BlLmd1aWR0Z3QgIT0gJzAnO1xuXG4gICAgICAgICAgICBpZiAoaXNNeVBvc3QgJiYgaXNQb2ludGluZ1NvbWVvbmUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDI7IC8vIGZvciBteSB2aWV3J3MgbXkgcG9zdCB0byBiZSBcIkkgbGlrZSBzb21lb25lXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGlzUG9pbnRpbmdZb3UgJiYgaXNQb2ludGluZ01lKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiA0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaXNQb2ludGluZ1lvdSAmJiAhaXNQb2ludGluZ01lKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoIWlzUG9pbnRpbmdZb3UgJiYgaXNQb2ludGluZ01lKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gVUlcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgZnVuY3Rpb24gc2V0VUlTZWFyY2hMb2NhdGlvblRvZ2dsZSgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBtYXBTZWFyY2hUb2dnbGUgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1zZWFyY2gtdG9nZ2xlJykpO1xuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5UT1BfTEVGVF0ucHVzaChtYXBTZWFyY2hUb2dnbGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0VUlNb3ZlVG9DdXJyTG9jQnRuKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGN1cnJMb2NCdG4gPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1idG4tY3VycicpKTsgXG4gICAgICAgICAgICBtYXAuY29udHJvbHNbZ29vZ2xlLm1hcHMuQ29udHJvbFBvc2l0aW9uLlRPUF9SSUdIVF0ucHVzaChjdXJyTG9jQnRuKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldFVJUG9zdEZvcm0oKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgcG9zdEZvcm0gPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1wb3N0aW5nJykpOyBcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uQk9UVE9NX0NFTlRFUl0ucHVzaChwb3N0Rm9ybSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRVSVBvc3RCdG4oKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgcG9zdEJ0biA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLWJ0bi1zdWJtaXQnKSk7XG4gICAgICAgICAgICBtYXAuY29udHJvbHNbZ29vZ2xlLm1hcHMuQ29udHJvbFBvc2l0aW9uLkJPVFRPTV9DRU5URVJdLnB1c2gocG9zdEJ0bik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRVSVRpbWVTbGlkZXIoKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgdGltZVNsaWRlciA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLXRpbWUtc2xpZGVyJykpO1xuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5CT1RUT01fQ0VOVEVSXS5wdXNoKHRpbWVTbGlkZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0VUlTZWFyY2hCb3goKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgdGhlIHNlYXJjaCBib3ggYW5kIGxpbmsgaXQgdG8gdGhlIFVJIGVsZW1lbnQuXG4gICAgICAgICAgICB2YXIgaW5wdXQgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhYy1pbnB1dCcpKTsgLy8gQHR5cGUge0hUTUxJbnB1dEVsZW1lbnR9ICBcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uVE9QX0xFRlRdLnB1c2goaW5wdXQpO1xuXG4gICAgICAgICAgICB2YXIgc2VhcmNoQm94ID0gbmV3IGdvb2dsZS5tYXBzLnBsYWNlcy5TZWFyY2hCb3goKGlucHV0KSk7IC8vIEB0eXBlIHtIVE1MSW5wdXRFbGVtZW50fSBcblxuICAgICAgICAgICAgLy8gTGlzdGVuIGZvciB0aGUgZXZlbnQgZmlyZWQgd2hlbiB0aGUgdXNlciBzZWxlY3RzIGFuIGl0ZW0gZnJvbSB0aGVcbiAgICAgICAgICAgIC8vIHBpY2sgbGlzdC4gUmV0cmlldmUgdGhlIG1hdGNoaW5nIHBsYWNlcyBmb3IgdGhhdCBpdGVtLlxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIoc2VhcmNoQm94LCAncGxhY2VzX2NoYW5nZWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGxhY2VzID0gc2VhcmNoQm94LmdldFBsYWNlcygpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHBsYWNlcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIHRha2Ugb25seSAxIHNwb3RcbiAgICAgICAgICAgICAgICB2YXIgcGxhY2UgPSBwbGFjZXNbMF07XG5cbiAgICAgICAgICAgICAgICAvLyB3aGVuIHNlYXJjaCBoYXBwZW5zLCBsb2NhdGlvbiB3aWxsIGJlIHVwZGF0ZWQgYXMgd2VsbCBmb3IgcG9zdFxuICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgbGF0OiBwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sYXQoKSxcbiAgICAgICAgICAgICAgICAgICAgbG9uOiBwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZHJhd0FuZFNldFBsYWNlKGxvY2F0aW9uKTtcblxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUgPSBwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sYXRpdHVkZTtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSA9IHBsYWNlLmdlb21ldHJ5LmxvY2F0aW9uLmxvbmdpdHVkZTtcblxuICAgICAgICAgICAgICAgIG1hcC5wYW5UbyhwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgbWFwLnNldFpvb20oMTYpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBFVkVOVFxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICBmdW5jdGlvbiBzZXRFdmVudENsaWNrKClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gY2xpY2sgZXZlbnQgb24gbWFwIHRvIGRyYXcgWCBtYXJrZXIgYW5kIHNldCBQb3N0IGxvY2F0aW9uXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXBfb3JpZ2luLCAnY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgbGF0OiBldmVudC5sYXRMbmcubGF0KCksXG4gICAgICAgICAgICAgICAgICAgIGxvbjogZXZlbnQubGF0TG5nLmxuZygpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBkcmF3QW5kU2V0UGxhY2UobG9jYXRpb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRFdmVudENlbnRlckNoYW5nZWQoKVxuICAgICAgICB7XG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXBfb3JpZ2luLCAnY2VudGVyX2NoYW5nZWQnLCBmdW5jdGlvbigpeyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyB3aGVuIG1hcCBjZW50ZXIgY2hhbmdlLCB1cGRhdGUgbGFzdCBsb2NhdGlvbiBpbiBtZW1vcnksXG4gICAgICAgICAgICAgICAgLy8gc28gYnJvd3NlciB3aWxsIHJlbWVtYmVyIGl0IG5leHQgdGltZSB5b3UgY29tZSFcbiAgICAgICAgICAgICAgICB1cGRhdGVEZWZhdWx0TG9jYXRpb24oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0RXZlbnRCb3VuZHNDaGFuZ2VkKClcbiAgICAgICAge1xuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwX29yaWdpbiwgJ2JvdW5kc19jaGFuZ2VkJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAvLyB3aGVuIG1hcCBjZW50ZXIgY2hhbmdlLCB1cGRhdGUgYm91bmRzIGluZm8gZm9yIG1hcFxuICAgICAgICAgICAgICAgIHVwZGF0ZUJvdW5kcygpOyAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldEV2ZW50RHJhZ0VuZCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcF9vcmlnaW4sICdkcmFnZW5kJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgbWFwIGFzIGRyYWcgZW5kXG4gICAgICAgICAgICAgICAgdXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgd2F0Y2hsb2Mgd2hlbiBjZW50ZXIgY2hhbmdlZC5cbiAgICAgICAgICAgICAgICB1cGRhdGVXYXRjaExvY2F0aW9uKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldEV2ZW50UmVzaXplKClcbiAgICAgICAge1xuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwX29yaWdpbiwgJ3Jlc2l6ZScsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIG1hcCBhcyBkcmFnIGVuZFxuICAgICAgICAgICAgICAgIHVwZGF0ZUFuZERyYXdQb3N0cygpO1xuXG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIHdhdGNobG9jIHdoZW4gY2VudGVyIGNoYW5nZWQuXG4gICAgICAgICAgICAgICAgdXBkYXRlV2F0Y2hMb2NhdGlvbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRFdmVudFpvb21DaGFuZ2VkKClcbiAgICAgICAge1xuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwX29yaWdpbiwgJ3pvb21fY2hhbmdlZCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIG1hcCBhcyBkcmFnIGVuZFxuICAgICAgICAgICAgICAgIHVwZGF0ZUFuZERyYXdQb3N0cygpO1xuXG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIHdhdGNobG9jIHdoZW4gY2VudGVyIGNoYW5nZWQuXG4gICAgICAgICAgICAgICAgdXBkYXRlV2F0Y2hMb2NhdGlvbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBTRVRVUCBGT1IgTUFQXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIG1hcCBpbml0aWFsIGNvbmZpZ3NcbiAgICAgICAgZnVuY3Rpb24gaW5pdGlhbE1hcERhdGEoKXtcbiAgICAgICAgICAgIC8vIGlmIGxvY2FsU3RvcmFnZSByZW1lbWJlcnMgbGF0ZXN0IG1hcCBsb2NhdGlvbiwgdXNlIGl0LFxuICAgICAgICAgICAgaWYgKCFpc05hTih3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlKSAmJiAhaXNOYU4od2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGluaXRpYWxNYXBDZW50ZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUsIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmIHRoZXJlIGlzIG5vIGxhdGVzdCBtYXAgbG9jYXRpb24sIGdldCBjdXJyZW50IGxvY2F0aW9uXG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS51c2VyTG9jYXRpb24ubGF0ICE9IDAuMCAmJiBzY29wZS51c2VyTG9jYXRpb24ubG9uICE9IDAuMCkgXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gdGhpcyBtYXkgbm90IHdvcmsgZm9yIG5vdyBzaW5jZSBsb2NhdGlvbiBnZXRzIHNldCBhZnRlciBtYXAgaXMgZGVmaW5lZC4uIChUT0RPOiByZWZhY3RvciB0aGUgb3JkZXIpXG4gICAgICAgICAgICAgICAgaW5pdGlhbE1hcENlbnRlciA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoc2NvcGUudXNlckxvY2F0aW9uLmxhdCwgc2NvcGUudXNlckxvY2F0aW9uLmxvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBpZiBub25lIG9mIGFib3ZlIHdvcmtzLCB0cnkgdG8gc2V0IGl0IHRvIExBICg/ISlcbiAgICAgICAgICAgIGVsc2UgXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaW5pdGlhbE1hcENlbnRlciA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoMzQuMDUsIC0xMTguMjQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtYXBPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICBjZW50ZXIgICAgICA6IGluaXRpYWxNYXBDZW50ZXIsXG4gICAgICAgICAgICAgICAgICAgIHpvb20gICAgICAgIDogMTUsXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbHdoZWVsIDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgc3RyZWV0Vmlld0NvbnRyb2w6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBtYXBUeXBlQ29udHJvbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHBhbkNvbnRyb2w6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB6b29tQ29udHJvbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIG1hcFR5cGVDb250cm9sT3B0aW9uczoge1xuICAgICAgICAgICAgICAgICAgICAgIG1hcFR5cGVJZHM6IFtnb29nbGUubWFwcy5NYXBUeXBlSWQuUk9BRE1BUCwgQ0xPVURfTUFQX0lEXVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBtYXBUeXBlSWQ6IENMT1VEX01BUF9JRFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldE1hbnVhbEV2ZW50cygpe1xuICAgICAgICAgICAgZnVuY3Rpb24gQ2xvdWRNYXAob3B0aW9ucyl7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJJbml0aWFsaXppbmcgbWFwXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBpbnN0YW50aWF0ZSBnb29nbGUgbWFwXG4gICAgICAgICAgICBtYXBfb3JpZ2luID0gbmV3IGdvb2dsZS5tYXBzLk1hcChlbGVtZW50WzBdLCBtYXBPcHRpb25zKTtcblxuICAgICAgICAgICAgLy8gc2V0IHByb3RvdHlwZSBvZiBjdXN0b20gbWFwIHdpdGggb3JpZ2luIG1hcFxuICAgICAgICAgICAgQ2xvdWRNYXAucHJvdG90eXBlID0gbWFwX29yaWdpbjtcblxuICAgICAgICAgICAgLy8gZHJhdyB4IG1hcmtlclxuICAgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlRHJhd1hNYXJrZXIobG9jYXRpb24pe1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIodGhpcywgJ2RyYXdYTWFya2VyJywgbG9jYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQ2xvdWRNYXAucHJvdG90eXBlLmRyYXdYTWFya2VyID0gaGFuZGxlRHJhd1hNYXJrZXI7XG5cbiAgICAgICAgICAgIC8vIGRyYXcgY3VycmVudCBsb2NhdGlvbiBtYXJrZXJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYXdDdXJyTG9jYXRpb25NYXJrZXIobG9jYXRpb24pe1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIodGhpcywgJ2RyYXdDdXJyTG9jYXRpb25NYXJrZXInLCBsb2NhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBDbG91ZE1hcC5wcm90b3R5cGUuZHJhd0N1cnJMb2NhdGlvbk1hcmtlciA9IGhhbmRsZURyYXdDdXJyTG9jYXRpb25NYXJrZXI7XG5cbiAgICAgICAgICAgIC8vIGRyYXcgcG9zdHNcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZVVwZGF0ZUFuZERyYXdQb3N0cygpe1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIodGhpcywgJ3VwZGF0ZUFuZERyYXdQb3N0cycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQ2xvdWRNYXAucHJvdG90eXBlLnVwZGF0ZUFuZERyYXdQb3N0cyA9IGhhbmRsZVVwZGF0ZUFuZERyYXdQb3N0cztcblxuICAgICAgICAgICAgLy8gZHJhdyByZXNwb25zZXNcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYXdSZXNwb25zZXMocG9zdCl7XG4gICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcih0aGlzLCAnZHJhd1Jlc3BvbnNlcycsIHBvc3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQ2xvdWRNYXAucHJvdG90eXBlLmRyYXdSZXNwb25zZXMgPSBoYW5kbGVEcmF3UmVzcG9uc2VzO1xuXG4gICAgICAgICAgICAvLyB1bmRyYXcgcG9zdHNcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZVVuRHJhd1Bvc3QocG9zdGlkKXtcbiAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKHRoaXMsICd1bkRyYXdQb3N0JywgcG9zdGlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIENsb3VkTWFwLnByb3RvdHlwZS51bkRyYXdQb3N0ID0gaGFuZGxlVW5EcmF3UG9zdDtcblxuICAgICAgICAgICAgLy8gY3JlYXRlIGN1c3RvbSBtYXAgZm9yIGFwcFxuICAgICAgICAgICAgbWFwID0gbmV3IENsb3VkTWFwKCk7XG5cbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ2RyYXdYTWFya2VyJywgZnVuY3Rpb24obG9jYXRpb24pe1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShsb2NhdGlvbik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnZHJhd0N1cnJMb2NhdGlvbk1hcmtlcicsIGZ1bmN0aW9uKGxvY2F0aW9uKXtcbiAgICAgICAgICAgICAgICBkcmF3RHJvcERvd24obG9jYXRpb24pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ3VwZGF0ZUFuZERyYXdQb3N0cycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgdXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnZHJhd1Jlc3BvbnNlcycsIGZ1bmN0aW9uKHBvc3Qpe1xuICAgICAgICAgICAgICAgIGRyYXdSZXNwb25zZXMocG9zdCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAndW5EcmF3UG9zdCcsIGZ1bmN0aW9uKHBvc3RpZCl7XG4gICAgICAgICAgICAgICAgdW5EcmF3UG9zdChwb3N0aWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRTdHlsZUZvck1hcCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBmZWF0dXJlT3B0c19kYXkgPSBbe1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzYxOTVhMFwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJhZG1pbmlzdHJhdGl2ZS5wcm92aW5jZVwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwibGFuZHNjYXBlXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wibGlnaHRuZXNzXCI6XCIwXCJ9LHtcInNhdHVyYXRpb25cIjpcIjBcIn0se1wiY29sb3JcIjpcIiNmNWY1ZjJcIn0se1wiZ2FtbWFcIjpcIjFcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwibGFuZHNjYXBlLm1hbl9tYWRlXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcImxpZ2h0bmVzc1wiOlwiLTNcIn0se1wiZ2FtbWFcIjpcIjEuMDBcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwibGFuZHNjYXBlLm5hdHVyYWwudGVycmFpblwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9mZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJwb2kucGFya1wiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LmZpbGxcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiNiYWU1Y2VcIn0se1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJzYXR1cmF0aW9uXCI6LTEwMH0se1wibGlnaHRuZXNzXCI6NDV9LHtcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnkuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2ZhYzlhOVwifSx7XCJ2aXNpYmlsaXR5XCI6XCJzaW1wbGlmaWVkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuaGlnaHdheVwiLFwiZWxlbWVudFR5cGVcIjpcImxhYmVscy50ZXh0XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNGU0ZTRlXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNzg3ODc4XCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMuaWNvblwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJzaW1wbGlmaWVkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInRyYW5zaXQuc3RhdGlvbi5haXJwb3J0XCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLmljb25cIixcInN0eWxlcnNcIjpbe1wiaHVlXCI6XCIjMGEwMGZmXCJ9LHtcInNhdHVyYXRpb25cIjpcIi03N1wifSx7XCJnYW1tYVwiOlwiMC41N1wifSx7XCJsaWdodG5lc3NcIjpcIjBcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdC5zdGF0aW9uLnJhaWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNDMzMjFlXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInRyYW5zaXQuc3RhdGlvbi5yYWlsXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLmljb25cIixcInN0eWxlcnNcIjpbe1wiaHVlXCI6XCIjZmY2YzAwXCJ9LHtcImxpZ2h0bmVzc1wiOlwiNFwifSx7XCJnYW1tYVwiOlwiMC43NVwifSx7XCJzYXR1cmF0aW9uXCI6XCItNjhcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwid2F0ZXJcIixcImVsZW1lbnRUeXBlXCI6XCJhbGxcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiNlYWY2ZjhcIn0se1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwid2F0ZXJcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjYzdlY2VkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcIndhdGVyXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJsaWdodG5lc3NcIjpcIi00OVwifSx7XCJzYXR1cmF0aW9uXCI6XCItNTNcIn0se1wiZ2FtbWFcIjpcIjAuNzlcIn1dfV07XG5cbiAgICAgICAgICAgIHZhciBmZWF0dXJlT3B0c19uaWdodCA9IFt7XCJmZWF0dXJlVHlwZVwiOlwiYWxsXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2ZmZmZmZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJhbGxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5zdHJva2VcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn0se1wiY29sb3JcIjpcIiMzZTYwNmZcIn0se1wid2VpZ2h0XCI6Mn0se1wiZ2FtbWFcIjowLjg0fV19LHtcImZlYXR1cmVUeXBlXCI6XCJhbGxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMuaWNvblwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwiYWRtaW5pc3RyYXRpdmVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJ3ZWlnaHRcIjowLjZ9LHtcImNvbG9yXCI6XCIjMTgyYTNkXCJ9LHtcInZpc2liaWxpdHlcIjpcIm9uXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcImxhbmRzY2FwZVwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjMWE1MjhiXCJ9LHtcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiM0MDZkODBcIn0se1widmlzaWJpbGl0eVwiOlwib2ZmXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInBvaS5wYXJrXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiMyYzVhNzFcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNjZhOWVlXCJ9LHtcImxpZ2h0bmVzc1wiOi0zN30se1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LmZpbGxcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHRcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib2ZmXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQubG9jYWxcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5zdHJva2VcIixcInN0eWxlcnNcIjpbe1wibGlnaHRuZXNzXCI6XCItMTFcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjZmY3ZTRlXCJ9LHtcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdC5zdGF0aW9uLmFpcnBvcnRcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwid2F0ZXJcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzE4MmEzZFwifV19XTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gc2V0IG1hcCBkZXBlbmRzIG9uIGRheXRpbWUgb3IgbmlnaHR0aW1lXG4gICAgICAgICAgICB2YXIgY3VycmVudFRpbWUgPSBuZXcgRGF0ZSgpOyAvLyBmb3Igbm93XG4gICAgICAgICAgICB2YXIgY3VycmVudEhvdXIgPSBjdXJyZW50VGltZS5nZXRIb3VycygpO1xuICAgICAgICAgICAgdmFyIGZlYXR1cmVPcHRzO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRIb3VyIDwgNCB8fCBjdXJyZW50SG91ciA+IDE5KXtcbiAgICAgICAgICAgICAgICBmZWF0dXJlT3B0cyA9IGZlYXR1cmVPcHRzX25pZ2h0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmZWF0dXJlT3B0cyA9IGZlYXR1cmVPcHRzX2RheTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHN0eWxlZE1hcE9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ0N1c3RvbSBTdHlsZSdcbiAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGN1c3RvbU1hcFR5cGUgPSBuZXcgZ29vZ2xlLm1hcHMuU3R5bGVkTWFwVHlwZShmZWF0dXJlT3B0cywgc3R5bGVkTWFwT3B0aW9ucyk7XG4gICAgICAgICAgICBtYXAubWFwVHlwZXMuc2V0KENMT1VEX01BUF9JRCwgY3VzdG9tTWFwVHlwZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpbml0IHRoZSBtYXBcbiAgICAgICAgZnVuY3Rpb24gaW5pdE1hcCgpIHtcbiAgICAgICAgICAgIGlmIChtYXAgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIGluaXRpYWxNYXBEYXRhKCk7XG5cbiAgICAgICAgICAgICAgICBzZXRNYW51YWxFdmVudHMoKTtcblxuICAgICAgICAgICAgICAgIHNldFN0eWxlRm9yTWFwKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGFkZCBVSSBlbGVtZW50cyB0byBtYXBcbiAgICAgICAgICAgIHNldFVJU2VhcmNoTG9jYXRpb25Ub2dnbGUoKTtcbiAgICAgICAgICAgIHNldFVJU2VhcmNoQm94KCk7XG4gICAgICAgICAgICBzZXRVSU1vdmVUb0N1cnJMb2NCdG4oKTtcbiAgICAgICAgICAgIHNldFVJUG9zdEZvcm0oKTtcbiAgICAgICAgICAgIHNldFVJUG9zdEJ0bigpO1xuICAgICAgICAgICAgc2V0VUlUaW1lU2xpZGVyKCk7XG5cbiAgICAgICAgICAgIC8vIGFkZCBvcmlnaW4gbmF0aXZlIEV2ZW50IGhhbmRsZXJzIHRvIG1hcFxuICAgICAgICAgICAgc2V0RXZlbnRDbGljaygpO1xuICAgICAgICAgICAgc2V0RXZlbnRDZW50ZXJDaGFuZ2VkKCk7XG4gICAgICAgICAgICBzZXRFdmVudERyYWdFbmQoKTtcbiAgICAgICAgICAgIHNldEV2ZW50UmVzaXplKCk7XG4gICAgICAgICAgICBzZXRFdmVudFpvb21DaGFuZ2VkKCk7XG4gICAgICAgICAgICBzZXRFdmVudEJvdW5kc0NoYW5nZWQoKTtcblxuICAgICAgICAgICAgLy8gYnJvYWRjYXN0IHRvIHNlbmQgbWFwIHRvIGFwcGxpY2F0aW9uIGN0cmxcbiAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdzZXQ6bWFwJywgbWFwKTtcbiAgICAgICAgfSBcblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBFWEVDVVRFXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIGluaXRNYXAoKTtcblxuICAgICAgICBkcmF3SGVscGVyTWFya2VyKGluaXRpYWxNYXBDZW50ZXIpO1xuICAgICAgICBzZXRQbGFjZShpbml0aWFsTWFwQ2VudGVyKTtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgIHRlbXBsYXRlOiAnPGRpdiBpZD1cIm1hcC1jYW52YXNcIj48L2Rpdj4nLFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICBsaW5rOiBsaW5rXG4gICAgfTtcbn0pO1xuXG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmRpcmVjdGl2ZSgnbWFwTXNnJywgZnVuY3Rpb24gKCR0aW1lb3V0LCBTZXNzaW9uU3ZjLCBQb3N0c1N2Yykge1xuXG4gICAgdmFyIGxpbmsgPSBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHsgICBcblxuICAgICAgICBzY29wZS5nZXRfbG9jYWxzdGF0dXMgPSBmdW5jdGlvbihsb2NhbF9zdGF0dXMpe1xuICAgICAgICAgIGlmIChsb2NhbF9zdGF0dXMpXG4gICAgICAgICAgICByZXR1cm4gXCJsb2NhbC10ZXh0XCI7XG4gICAgICAgICAgZWxzZVxuICAgICAgICAgICAgcmV0dXJuIFwibm9uLWxvY2FsLXRleHRcIjtcbiAgICAgICAgfTsgICAgIFxuXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIENPVVBMSU5HIENMQVNTXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8qIGNvdXBsaW5nIHN0YXR1c1xuICAgICAgICAgIDAgLSBubyBzdGF0dXNcbiAgICAgICAgICAxIC0gaSBsaWtlIHlvdVxuICAgICAgICAgIDIgLSB5b3UgbGlrZSBpXG4gICAgICAgICAgNCAtIHdlIGxpa2UgZWFjaCBvdGhlclxuICAgICAgICAqL1xuICAgICAgICBzY29wZS5nZXRfY291cGxpbmcgPSBmdW5jdGlvbihjb3VwbGluZ19zdGF0dXMpe1xuICAgICAgICAgIFxuICAgICAgICAgIGlmIChjb3VwbGluZ19zdGF0dXMgPT0gNCl7XG4gICAgICAgICAgICByZXR1cm4gXCJjb3VwbGluZyBjb3VwbGluZy1jb3VwbGVcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZiAoY291cGxpbmdfc3RhdHVzID09IDEpe1xuICAgICAgICAgICAgcmV0dXJuIFwiY291cGxpbmcgY291cGxpbmctaWxpa2V5b3VcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZiAoY291cGxpbmdfc3RhdHVzID09IDIpe1xuICAgICAgICAgICAgcmV0dXJuIFwiY291cGxpbmcgY291cGxpbmcteW91bGlrZWlcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gXCJjb3VwbGluZyBjb3VwbGluZy1ub25lXCI7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIERPQ1VNRU5UIFJFQURZXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAkdGltZW91dCh1cGRhdGVHdWlkVGFyZ2V0LCAxMDApO1xuXG4gICAgICAgICAgJHRpbWVvdXQodXBkYXRlUG9zdFRpbWVyLCAxMCk7XG5cbiAgICAgICAgICAkdGltZW91dChjdXN0b21pemVJbmZvV2luZG93LCAxMCk7XG5cbiAgICAgICAgICAkdGltZW91dChjdXN0b21pemVDbG9zZUJ0biwgMTApO1xuXG4gICAgICAgICAgLy9jb25zb2xlLmxvZyhcInBvc3QgbG9jYWwgc3RhdHVzOlwiLCBzY29wZS5wb3N0bG9jYWxzdGF0dXMpO1xuICAgICAgICB9KTtcblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVHdWlkVGFyZ2V0KCl7XG4gICAgICAgICAgLy8gdXBkYXRlIHN0YXR1cyBmb3IgZ3VpZCB0YXJnZXRcbiAgICAgICAgICB2YXIgcG9zdGd1aWQgID0gc2NvcGUucG9zdGd1aWQ7XG4gICAgICAgICAgdmFyIG15Z3VpZCAgICA9IHNjb3BlLiRwYXJlbnQuZ3VpZDtcbiAgICAgICAgICB2YXIgbXlndWlkdGd0ID0gc2NvcGUuJHBhcmVudC5ndWlkdGd0O1xuXG4gICAgICAgICAgZWxlbWVudC5jaGlsZHJlbigpLm9uKCdjbGljaycsZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgdmFyIHVwZGF0ZV9ndWlkdGd0ID0gcG9zdGd1aWQ7XG5cbiAgICAgICAgICAgIC8vIGNsaWNraW5nIG15IG1lc3NhZ2Ugd2luZG93XG4gICAgICAgICAgICAvLyBpZiBpdHMgb24gY291cGxpbmcsIGJyZWFrIGl0IVxuICAgICAgICAgICAgaWYgKHBvc3RndWlkID09IG15Z3VpZCl7XG4gICAgICAgICAgICAgIGlmIChzY29wZS4kcGFyZW50Lmd1aWR0Z3QgIT0gJzAnKXtcbiAgICAgICAgICAgICAgICB1cGRhdGVfZ3VpZHRndCA9ICcwJzsgXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGNsaWtpbmcgdGhlIG9uZSB0aGF0IEkgbGlrZWRcbiAgICAgICAgICAgIC8vIHRvIGRpc2xpa2UgdGhlIG1lc3NhZ2Ugd2luZG93XG4gICAgICAgICAgICBpZiAocG9zdGd1aWQgPT0gbXlndWlkdGd0KSB7XG4gICAgICAgICAgICAgIHVwZGF0ZV9ndWlkdGd0ID0gJzAnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBwcm9wYWdhdGUgdG8gdXBwZXIgc2NvcGUgZm9yIGd1aWR0Z3QgdXBkYXRlXG4gICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0Omd1aWR0Z3QnLCB1cGRhdGVfZ3VpZHRndCk7IFxuXG4gICAgICAgICAgICAvLyB1cGRhdGUgc2Vzc2lvbiBpbmZvcm1hdGlvbiBvZiBtaW5lIHNvIG15IHNlc3Npb24gdGVsbHMgbWUgdGhhdCxcbiAgICAgICAgICAgIC8vIEkgbGlrZSB0aGlzIGd1aWQgYXQgdGhpcyBtb21lbnQgaW4gc2VydmVyIGRiXG4gICAgICAgICAgICBTZXNzaW9uU3ZjLnVwZGF0ZUNvdXBsaW5nKG15Z3VpZCwgdXBkYXRlX2d1aWR0Z3QpXG4gICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRvYyl7XG4gICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiU3VjY2Vzc2Z1bGx5IHVkcGF0ZWQgY291cGxpbmdcIiwgZG9jKTtcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gdXBkYXRlIG15IHBvc3QncyBndWlkdGd0IHRvIGJlIHRoaXMgcG9zdCdzIGd1aWQgaW4gc2VydmVyIGRiXG4gICAgICAgICAgICAvLyB0aGlzIHVwZGF0ZSBpcyBmb3IgdGhlIHBlb3BsZSB3aG8gYXJlIGxvb2tpbmcgYXQgbXkgcG9zdHNcbiAgICAgICAgICAgIHZhciB1cGRhdGVzID0ge1xuICAgICAgICAgICAgICBndWlkICAgIDogbXlndWlkLFxuICAgICAgICAgICAgICBndWlkdGd0IDogdXBkYXRlX2d1aWR0Z3RcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBQb3N0c1N2Yy51cGRhdGVHdWlkdGd0KHVwZGF0ZXMpXG4gICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRvYyl7XG4gICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiU3VjY2Vzc2Z1bGx5IHVkcGF0ZWQgcG9zdCdzIGd1aWR0Z3RcIiwgZG9jKTtcbiAgICAgICAgICAgICAgICAgIC8vIGFmdGVyIGNvdXBsaW5nIHVwZGF0ZSwgbWFwIGhhcyB0byBiZSB1cGRhdGVzIGFzIHdlbGxcbiAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgIC8vIE1JR0hUIEhBVkUgVE8gQ09NRSBCQUNLIEZPUiBPUFRJTUlaQVRJT05cbiAgICAgICAgICAgIC8vIHRoaXMgaGF2ZSB0byBiZSB1cGRhdGUgdG8gYmUgY29tbXVuaWNhdGVkIHRocm91Z2ggdGhlIHNlcnZlclxuICAgICAgICAgICAgaWYgKHNjb3BlLiRwYXJlbnQuZ3VpZHRndCA9PSAwKXtcbiAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldDpjb3VwbGluZycsIDEpOyAvLyBwcm9wYWdhdGUgdG8gdXBwZXIgc2NvcGUgZm9yIGNvdXBsaW5nIHVwZGF0ZVxuICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoKTsgLy8gZm9yY2UgdG8gdXBkYXRlIERPTVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGNvdXBsZXN0YXR1cyA9PSAxICYmIHNjb3BlLiRwYXJlbnQuZ3VpZHRndCAhPSAwKXtcbiAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldDpjb3VwbGluZycsIDApOyAvLyBwcm9wYWdhdGUgdG8gdXBwZXIgc2NvcGUgZm9yIGNvdXBsaW5nIHVwZGF0ZVxuICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoKTsgLy8gZm9yY2UgdG8gdXBkYXRlIERPTVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIFxuXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVQb3N0VGltZXIoKXtcbiAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiTGlmZSAlOlwiLCBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UpO1xuICAgICAgICAgICAgdmFyIGR1cmF0aW9uID0gc2NvcGUucG9zdGxpZmUgKyBcIm1zXCI7XG5cbiAgICAgICAgICAgIHZhciBwb3N0YmFybGlmZSA9IGVsZW1lbnQuY2hpbGRyZW4oKS5jaGlsZHJlbihcIi5wb3N0bGlmZWJhclwiKTtcblxuICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tZHVyYXRpb24nLCBkdXJhdGlvbik7XG4gICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLWR1cmF0aW9uJywgZHVyYXRpb24pO1xuICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLWR1cmF0aW9uJywgZHVyYXRpb24pO1xuICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1kdXJhdGlvbicsIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLWR1cmF0aW9uJywgZHVyYXRpb24pO1xuXG4gICAgICAgICAgICBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC45NSl7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9hJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2EnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlIDw9IDAuOTUgJiYgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC45KXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2InKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9iJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9iJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9iJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPD0gMC45ICYmIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuODUpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYycpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2MnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2MnKTtcbiAgICAgICAgICAgICAgcG9zdGxpZmViYXJfY3NzID0gcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9jJyk7XG4gICAgICAgICAgICAgIHBvc3RsaWZlYmFyX2NzcyA9IHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2MnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA8PSAwLjg1ICYmIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuNzUpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZCcpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2QnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2QnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9kJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2QnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA8PSAwLjc1ICYmIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuNil7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9lJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2UnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlIDw9IDAuNiAmJiBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjUpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2YnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2YnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9mJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2YnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA8PSAwLjUgJiYgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC4zKXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2cnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9nJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9nJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZycpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9nJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPD0gMC4zICYmIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuMil7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9oJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faCcpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faCcpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2gnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlIDw9IDAuMiAmJiBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjEpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2knKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2knKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9pJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2knKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9qJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2onKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY3VzdG9taXplSW5mb1dpbmRvdygpe1xuICAgICAgICAgIC8vIFJlZmVyZW5jZSB0byB0aGUgRElWIHRoYXQgd3JhcHMgdGhlIGJvdHRvbSBvZiBpbmZvd2luZG93XG4gICAgICAgICAgdmFyIGl3T3V0ZXIgPSAkKCcuZ20tc3R5bGUtaXcnKTtcbiAgICAgICAgICBcbiAgICAgICAgICB2YXIgaXdCYWNrZ3JvdW5kID0gaXdPdXRlci5wcmV2KCk7XG5cbiAgICAgICAgICAvLyBSZW1vdmUgdGhlIGJhY2tncm91bmQgc2hhZG93IERJVlxuICAgICAgICAgICBpd0JhY2tncm91bmQuY2hpbGRyZW4oJzpudGgtY2hpbGQoMiknKS5jc3MoeydkaXNwbGF5JyA6ICdub25lJ30pO1xuXG4gICAgICAgICAgIC8vIFJlbW92ZSB0aGUgd2hpdGUgYmFja2dyb3VuZCBESVZcbiAgICAgICAgICAgaXdCYWNrZ3JvdW5kLmNoaWxkcmVuKCc6bnRoLWNoaWxkKDQpJykuY3NzKHsnZGlzcGxheScgOiAnbm9uZSd9KTtcblxuICAgICAgICAgIC8vIENoYW5nZXMgdGhlIGRlc2lyZWQgdGFpbCBzaGFkb3cgY29sb3IuXG4gICAgICAgICAgaXdCYWNrZ3JvdW5kLmNoaWxkcmVuKCc6bnRoLWNoaWxkKDMpJykuZmluZCgnZGl2JykuY2hpbGRyZW4oKS5jc3Moe1xuICAgICAgICAgICAgJ2JveC1zaGFkb3cnOiAnMCAxcHggNnB4IHJnYmEoMTc4LCAxNzgsIDE3OCwgMC42KScsIFxuICAgICAgICAgICAgJ3otaW5kZXgnIDogJzEnLFxuICAgICAgICAgICAgJ2JvcmRlcic6ICcwcHgnfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjdXN0b21pemVDbG9zZUJ0bigpe1xuICAgICAgICAgIC8vIFJlZmVyZW5jZSB0byB0aGUgRElWIHRoYXQgd3JhcHMgdGhlIGJvdHRvbSBvZiBpbmZvd2luZG93XG4gICAgICAgICAgdmFyIGl3T3V0ZXIgPSAkKCcuZ20tc3R5bGUtaXcnKTtcblxuICAgICAgICAgIHZhciBpd0Nsb3NlQnRuID0gaXdPdXRlci5uZXh0KCk7XG5cbiAgICAgICAgICAvKlxuICAgICAgICAgIGNvbnNvbGUubG9nKFwicG9zdGxvY2FsIGxlYW50aDpcIiwgaXdPdXRlci5wYXJlbnQoKS5maW5kKCcjcG9zdGxvY2FsJykubGVuZ3RoKTtcbiAgICAgICAgICBpZiAoc2NvcGUucG9zdGxvY2Fsc3RhdHVzID09IGZhbHNlICYmIDAgPT0gaXdPdXRlci5wYXJlbnQoKS5maW5kKCcjcG9zdGxvY2FsJykubGVuZ3RoKXtcbiAgICAgICAgICAgIGl3Q2xvc2VCdG4uYWZ0ZXIoXCI8aW1nIGlkPSdwb3N0bG9jYWwnIHNyYz0naHR0cDovL2Nkbi1pbWcuZWFzeWljb24ubmV0L3BuZy8yNC8yNDQwLnBuZycgd2lkdGg9JzIwJywgaGVpZ2h0PScyMCcvPlwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgKi9cblxuICAgICAgICAgIC8vIEFwcGx5IHRoZSBkZXNpcmVkIGVmZmVjdCB0byB0aGUgY2xvc2UgYnV0dG9uXG4gICAgICAgICAgaXdDbG9zZUJ0bi5jc3Moe1xuICAgICAgICAgICAgb3BhY2l0eTogJzAuOCcsIC8vIGJ5IGRlZmF1bHQgdGhlIGNsb3NlIGJ1dHRvbiBoYXMgYW4gb3BhY2l0eSBvZiAwLjdcbiAgICAgICAgICAgIHJpZ2h0OiAnMjBweCcsIHRvcDogJzIwcHgnLCAvLyBidXR0b24gcmVwb3NpdGlvbmluZ1xuICAgICAgICAgIH0pOyBcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnLi90ZW1wbGF0ZXMvd2luZG93Lmh0bWwnLFxuICAgICAgICBsaW5rOiBsaW5rXG4gICAgfTtcbn0pO1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHIuY29udHJvbGxlcignUG9zdHNDdHJsJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICRzY29wZSwgQ29uZmlnU3ZjLCBQb3N0c1N2YywgVXRpbFN2YywgJHdpbmRvdywgJGRvY3VtZW50LCAkdGltZW91dCl7XHJcclx0LyogZW1pdCBicm9hZGNhc3QgZm9yIGN1cnJlbnQgcGFnZUlkICovXHJcdCRzY29wZS4kZW1pdCgnc2V0OnBhZ2VjaGFuZ2UnLCAkc2NvcGUucGFnZUlkLnBvc3QpO1xyXHJcdCRzY29wZS5wb3N0cyA9IFtdO1xyXHJcdC8qIGFzIHNlcnZlciB0ZWxscyB0aGVyZSB3YXMgbmV3IHBvc3QsIGxldHMgcmUtbG9hZCBsaXN0IGRhdGEgKi9cclx0JHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbihfLCBwb3N0KXtcclx0XHQkc2NvcGUucmVxdWVzdEZldGNoKCk7XHJcdH0pO1xyXHJcdCRzY29wZS5hZGRQb3N0ID0gZnVuY3Rpb24oKSB7XHJcdFx0LyogY2hlY2sgaWYgdGhlIHBvc3QgY29udGVudCBpcyB0aGVyZSAtIG9ubHkgZm9yIFdFQiBmb3IgZW50ZXIgYnV0dG9uIHRvIHBvc3QgKi9cclx0XHRpZiAoISRzY29wZS5jb250ZW50KXtcclx0XHRcdC8qY29uc29sZS5sb2coXCJVc2VyIGF0dGVtcHRlZCB0byBwb3N0IHdpdGggMCB3b3Jkcy5cIikqL1xyXHRcdFx0cmV0dXJuO1xyXHRcdH1cclxyXHRcdC8qIGdldCBhdXRvY29tcGxldGVkIHBsYWNlIGFuZCByZXNldChzZXQgdG8gdW5kZWZpbmVkKSAqL1xyXHRcdHZhciBwbGFjZSAgICA9ICRzY29wZS5wb3N0cGxhY2U7XHJcdFx0dmFyIGxvY2F0aW9uID0gJHNjb3BlLnBvc3RMb2NhdGlvbjtcclxyXHRcdHZhciBsb2NhbF9zdGF0dXM7XHJcdFx0dmFyIHBvc3RMb2NhdGlvbkZyb21Vc2VyTG9jYXRpb24gPSBVdGlsU3ZjLmdldERpc3RhbmNlRnJvbUxhdExvbkluS20obG9jYXRpb24ubGF0LCBsb2NhdGlvbi5sb24sICRzY29wZS51c2VyTG9jYXRpb24ubGF0LCAkc2NvcGUudXNlckxvY2F0aW9uLmxvbik7XHJcdFx0LyogaWYgbGVzcyB0aGFuIDNrbSAqL1xyXHRcdGlmIChwb3N0TG9jYXRpb25Gcm9tVXNlckxvY2F0aW9uIDwgMyl7XHJcdFx0XHRsb2NhbF9zdGF0dXMgPSB0cnVlO1xyXHRcdH1cclx0XHRlbHNlIHtcclx0XHRcdGxvY2FsX3N0YXR1cyA9IGZhbHNlO1xyXHRcdH1cclx0XHRcclx0XHR2YXIgbG9jYXRpb25KU09OID0gSlNPTi5zdHJpbmdpZnkobG9jYXRpb24pO1xyXHJcdFx0dmFyIHJlbGF0aXZlTGlmZVNwYW47XHJcdFx0aWYgKCRzY29wZS50aW1ldmFsdWUgPD0gQ29uZmlnU3ZjLm1heEluc3RhbnRMaWZlU3Bhbil7XHJcdFx0XHR2YXIgY2hhckxlbiA9ICRzY29wZS5jb250ZW50Lmxlbmd0aDtcclx0XHRcdGlmIChjaGFyTGVuIDwgNSlcclx0XHRcdHtcclx0XHRcdFx0cmVsYXRpdmVMaWZlU3BhbiA9IDQwMDA7XHJcdFx0XHR9XHJcdFx0XHRlbHNlXHJcdFx0XHR7XHJcdFx0XHRcdHJlbGF0aXZlTGlmZVNwYW4gPSBjaGFyTGVuICogVXRpbFN2Yy5tYXBSYW5nZShjaGFyTGVuLCA1LCAyMCwgNzAwLCA0MDApO1xyXHRcdFx0fVxyXHRcdH1cclx0XHRlbHNlIHtcclx0XHRcdHJlbGF0aXZlTGlmZVNwYW4gPSAkc2NvcGUudGltZXZhbHVlO1xyXHRcdH1cclxyXHRcdFBvc3RzU3ZjLmNyZWF0ZShcclx0XHR7XHJcdFx0XHRib2R5ICAgIDogICRzY29wZS5jb250ZW50LFxyXHRcdFx0bG9jYXRpb246ICBsb2NhdGlvbkpTT04sXHJcdFx0XHRwbGFjZSAgIDogIHBsYWNlLFxyXHRcdFx0Z3VpZCAgICA6ICAkc2NvcGUuZ3VpZCxcclx0XHRcdGd1aWR0Z3QgOiAgJHNjb3BlLmd1aWR0Z3QsXHJcdFx0XHRsaWZlc3BhbjogIHJlbGF0aXZlTGlmZVNwYW4sXHJcdFx0XHRpc2xvY2FsIDogIGxvY2FsX3N0YXR1cyxcclx0XHR9KVxyXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKHBvc3Qpe1xyXHRcdFx0XHRcdFxyXHRcdFx0LyogcmVzZXQgaW5wdXQgZm9ybXMgKi9cclx0XHRcdCRzY29wZS5jb250ZW50ICA9IG51bGw7XHJcdFx0fSlcclx0XHQuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKXtcclx0XHRcdHN3YWwoXCJQb3N0IGZhaWxlZFwiLCBcIlBsZWFzZSBjb21wbGV0ZSB0aGUgZnJvbSBjb3JyZWN0bHlcIiwgXCJlcnJvclwiKTtcclx0XHR9KVxyXHRcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xyXHRcdFx0LyogaGFuZGxlIGVycm9yICovXHJcdFx0fSk7XHJcdH07XHJcclx0LyogYXMgc2VydmVyIHRlbGxzIHRoZXJlIHdhcyBuZXcgcG9zdCwgbGV0cyByZS1sb2FkIGxpc3QgZGF0YSAqL1xyXHQkc2NvcGUucmVxdWVzdEZldGNoID0gZnVuY3Rpb24oKSB7XHJcdFx0UG9zdHNTdmMuZmV0Y2goKVxyXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKHBvc3RzKXtcclx0XHRcdC8qY29uc29sZS5sb2coJ0dvdCBQb3N0czonLCBwb3N0cyk7ICovXHJcdFx0XHQkc2NvcGUucG9zdHMgPSBwb3N0cztcclx0XHR9KVxyXHRcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xyXHRcdFx0LyogZXJyb3IgaGFuZGxlICovXHJcdFx0fSk7XHJcdH07XHJcclx0LyogdXBkYXRlIGd1aWQgb2YgcG9zdCAqL1xyXHQkc2NvcGUudXBkYXRlR3VpZHRndCA9IGZ1bmN0aW9uKG15Z3VpZCwgZ3VpZHRndCkge1xyXHRcdHZhciB1cGRhdGVzID0ge1xyXHRcdFx0Z3VpZCAgICA6IG15Z3VpZCxcclx0XHRcdGd1aWR0Z3QgOiBndWlkdGd0XHJcdFx0fTtcclxyXHRcdC8qY29uc29sZS5sb2coXCJ1ZHBhdGUgdG8gcG9zdCBndWlkdGd0OlwiLCB1cGRhdGVzKSovXHJcclx0XHRQb3N0c1N2Yy51cGRhdGVHdWlkdGd0KHVwZGF0ZXMpXHJcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24odXBkYXRlcyl7XHJcdFx0XHQvKiAgZGVidWcgbXNnICAqL1xyXHRcdH0pXHJcdFx0LmNhdGNoKGZ1bmN0aW9uKGVycil7XHJcdFx0XHQvKiAgZXJyb3IgaGFuZGxpbmcgICovXHJcdFx0fSk7XHJcdH1cclxyXHQvKiRzY29wZS5yZXF1ZXN0RmV0Y2goKTsqL1xyfSk7XHJcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1Bvc3RzU3ZjJywgZnVuY3Rpb24oJGh0dHApe1xuXHR0aGlzLmZldGNoID0gZnVuY3Rpb24oZ3VpZE9iail7XG5cdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS9wb3N0cycsIGd1aWRPYmopO1xuXHR9O1xuXG5cdHRoaXMuY3JlYXRlID0gZnVuY3Rpb24ocG9zdCl7XG5cdFx0cG9zdC5kZXZpY2V0b2tlbiA9ICcwJzsgLy8gZm9yIHdlYiwgdGhlcmUgaXMgbm8gZGV2aWNldG9rZW5cblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHBvc3QpO1xuXHR9O1xuXG5cdHRoaXMucmVtb3ZlID0gZnVuY3Rpb24ocG9zdCl7XG5cdFx0Ly9jb25zb2xlLmxvZyhcImRlbGV0aW5nIHBvc3RpbmdcIik7XG5cdFx0Ly9jb25zb2xlLmxvZygncG9zdC5faWQ6JywgcG9zdC5faWQpO1xuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Bvc3RzL3Bvc3RzX2RlbGV0ZScsIHBvc3QpO1xuXHR9O1xuXG5cdHRoaXMudXBkYXRlR3VpZHRndCA9IGZ1bmN0aW9uKHVwZGF0ZXMpe1xuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Bvc3RzL3VwZGF0ZV9ndWlkdGd0JywgdXBkYXRlcyk7XG5cdH1cbn0pO1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnU2Vzc2lvblN2YycsIGZ1bmN0aW9uKCRodHRwKXtcblx0dGhpcy5mZXRjaCA9IGZ1bmN0aW9uKCl7XG5cdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS9zZXNzaW9ucycpO1xuXHR9O1xuXG5cdHRoaXMuZW50ZXIgPSBmdW5jdGlvbihzZXNzaW9uKXtcblx0XHRzZXNzaW9uLmRldmljZXRva2VuID0gJzAnOyAvLyBmb3Igd2ViLCB0aGVyZSBpcyBubyBkZXZpY2V0b2tlblxuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zJywgc2Vzc2lvbik7XG5cdH07XG5cblx0dGhpcy5yZW1vdmUgPSBmdW5jdGlvbihndWlkKXtcblx0XHR2YXIgc2Vzc2lvbiA9IHtndWlkOiBndWlkfTtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucy9kZWxldGUnLCBzZXNzaW9uKTtcblx0fTtcblxuXHR0aGlzLnVwZGF0ZVdhdGNoTG9jYXRpb24gPSBmdW5jdGlvbihjdXJyZW50X21hcF9udywgY3VycmVudF9tYXBfc2UsIGN1cnJlbnRfbWFwX2NlbnRlciwgZ3VpZCl7XG5cdFx0dmFyIHdhdGNobG9jID0ge1xuICAgICAgICAgICAgbndfbGF0ICAgICA6IGN1cnJlbnRfbWFwX253LmxhdCxcbiAgICAgICAgICAgIG53X2xvbiAgICAgOiBjdXJyZW50X21hcF9udy5sb24sXG4gICAgICAgICAgICBzZV9sYXQgICAgIDogY3VycmVudF9tYXBfc2UubGF0LFxuICAgICAgICAgICAgc2VfbG9uXHQgICA6IGN1cnJlbnRfbWFwX3NlLmxvbixcbiAgICAgICAgICAgIGNlbnRlcl9sYXQgOiBjdXJyZW50X21hcF9jZW50ZXIubGF0LFxuICAgICAgICAgICAgY2VudGVyX2xvbiA6IGN1cnJlbnRfbWFwX2NlbnRlci5sb25cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciB3YXRjaGxvY0pTT04gPSBKU09OLnN0cmluZ2lmeSh3YXRjaGxvYyk7XG5cbiAgICAgICAgdmFyIHVwZGF0ZWRzZXNzaW9uID0ge1xuICAgICAgICAgICAgd2F0Y2hsb2M6IHdhdGNobG9jSlNPTixcbiAgICAgICAgICAgIGd1aWQgICAgOiBndWlkXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gdXBkYXRlIHdhdGNobG9jIHdoZW4gY2VudGVyIGNoYW5nZWQuXG4gICAgICAgIC8vY29uc29sZS5sb2coXCJ1cGRhdGluZyB3YXRjaCBsb2NhdGlvblwiKTtcblxuXHRcdC8vY29uc29sZS5sb2coXCJ1cGRhdGVkc2Vzc2lvbjpcIiwgdXBkYXRlZHNlc3Npb24pO1xuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zL3VwZGF0ZV9zZXNzaW9uJywgdXBkYXRlZHNlc3Npb24pO1xuXHR9O1xuXG5cdHRoaXMudXBkYXRlQ291cGxpbmcgPSBmdW5jdGlvbihndWlkLCBndWlkdGd0KXtcblx0XHRcblx0XHR2YXIgdXBkYXRlZGd1aWR0Z3QgPSB7XG5cdFx0XHRndWlkICAgOiBndWlkLFxuXHRcdFx0Z3VpZHRndDogZ3VpZHRndFxuXHRcdH07XG5cblx0XHQvLyB1cGRhdGUgd2F0Y2hsb2Mgd2hlbiBjZW50ZXIgY2hhbmdlZC5cbiAgICAgICAgLy9jb25zb2xlLmxvZyhcInVwZGF0aW5nIGNvdXBsaW5nXCIpO1xuXG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbnMvdXBkYXRlX2NvdXBsaW5nJywgdXBkYXRlZGd1aWR0Z3QpXG5cdH07XG59KTtcblxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9