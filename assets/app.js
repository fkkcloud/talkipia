angular.module("app",["ngRoute","duScroll"]),angular.module("app").controller("ApplicationCtrl",["$rootScope","$scope","$window","$http",function(o,t,n,e){function a(){function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}t.isMobile=function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?!0:!1},t.guid=a(),t.guidtgt="0",t.$on("set:guidtgt",function(o,n){console.log("setting guidtgt",n),t.guidtgt=n}),t.pageId={post:0},t.navCollapsed=!0,t.collapse=function(){t.navCollapsed=!0},t.$on("ws:new_post",function(o,n){google.maps.event.trigger(t.map,"maptypeid_changed")}),t.moveToCurrentLocation=function(){function o(o){if(t.currentPageId==t.pageId.post){var n=o.coords;window.localStorage.latitude=n.latitude,window.localStorage.longitude=n.longitude;var e=new google.maps.LatLng(n.latitude,n.longitude);google.maps.event.trigger(t.map,"heading_changed",e),t.map.panTo(e),t.map.setZoom(15)}}function n(o){console.warn("ERROR("+o.code+"): "+o.message)}navigator.geolocation.getCurrentPosition(o,n),swal({title:"",text:"Moving to current location..",timer:1500,showConfirmButton:!1})},t.moveToPostLocation=function(){var o=0;if(t.isMobile()){var n=t.map.getBounds(),e=n.getNorthEast(),a=n.getSouthWest();current_map_nw=new google.maps.LatLng(e.lat(),a.lng()),current_map_se=new google.maps.LatLng(a.lat(),e.lng());var i=.5*Math.abs(t.postLocation.lat-current_map_nw.lat()),l=.5*Math.abs(t.postLocation.lat-current_map_se.lat());o=i>l?l:i}var s=new google.maps.LatLng(t.postLocation.lat+o,t.postLocation.lon);t.map.panTo(s)},t.$on("pagechange",function(o,n){t.currentPageId=n}),t.$on("loc",function(o,n){var e=n.lat(),a=n.lng();t.postLocation={lat:e,lon:a}}),t.$on("place",function(o,n){t.$apply(function(){t.postplace=n})}),t.$on("mapInit",function(o,n){t.map=n,google.maps.event.trigger(t.map,"center_changed")})}]),angular.module("app").config(["$routeProvider",function(o){o.when("/",{controller:"PostsCtrl",templateUrl:"/templates/posts.html"}).otherwise({redirectTo:"/"})}]),angular.module("app").service("UtilSvc",function(){var o=this;o.deg2rad=function(o){return o*(Math.PI/180)},o.getDistanceFromLatLonInKm=function(t,n,e,a){var i=6371,l=o.deg2rad(e-t),s=o.deg2rad(a-n),c=Math.sin(l/2)*Math.sin(l/2)+Math.cos(o.deg2rad(t))*Math.cos(o.deg2rad(e))*Math.sin(s/2)*Math.sin(s/2),g=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),r=i*g;return r}}),angular.module("app").directive("appMap",["PostsSvc","UtilSvc","$compile","$timeout",function(o,t,n,e){var a=function(t,a,i,l){function s(o){for(var t,n=0;t=k[n];n++)t.setMap(null);k=[];var t=new google.maps.Marker({position:o,map:_,icon:T});k.push(t)}function c(){for(var o,t=0;o=k[t];t++)o.setMap(null);k=[]}function g(o){t.$emit("loc",o);var n=new google.maps.Geocoder;n.geocode({latLng:o},function(o,n){try{t.$emit("place",o[1].formatted_address)}catch(e){console.log(e),swal("","Location does not exists"),t.$emit("place","Location does not exists")}})}function r(o){s(o),g(o)}function u(){o.fetch().success(function(o){for(var e=0;e<o.length;e++){for(var a,i=o[e],l=0;a=O[l];l++)if(i._id==a.post._id){i=null;break}if(i&&i.hasOwnProperty("location")){var s=angular.fromJson(i.location),c=new google.maps.LatLng(s.lat,s.lon),g=0,r=t.guidtgt==i.guid,u=t.guid==i.guidtgt;if(g=r&&u?4:r&&!u?1:!r&&u?2:0,c.lat()<$.lat()&&c.lat()>M.lat()&&c.lng()<M.lng()&&c.lng()>$.lng()){var p={position:c,map:_,title:"Bubble",icon:y},a=new google.maps.Marker(p);setTimeout(function(o,t){return function(){o.setMap(null);for(var n,e=0;n=O[e];e++)t._id==n.post._id&&O.splice(e,1)}}(a,i),i.lifespan),O.push({marker:a,post:i});var d=t,m=d.$new(!0),f=function(o,t,e,a){return function(){var i={pixelOffset:new google.maps.Size(-41.5,10)},l=new google.maps.InfoWindow(i),s="<div map-msg></div>",c=n(s)(t);t.msg=e.body,t.postlife=e.lifespan,t.postguid=e.guid,t.postguidtgt=e.guidtgt,t.postcouplestatus=a,console.log("coupling_status",t.postcouplestatus),l.setContent(c[0]),l.open(_,o)}}(a,m,i,g);f()}}}})}function p(){var o=document.getElementById("btn-curr");_.controls[google.maps.ControlPosition.TOP_RIGHT].push(o)}function d(){var o=document.getElementById("posting");_.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(o)}function m(){var o=document.getElementById("btn-submit");_.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(o)}function f(){var o=document.getElementById("pac-input");_.controls[google.maps.ControlPosition.TOP_LEFT].push(o);var t=new google.maps.places.SearchBox(o);google.maps.event.addListener(t,"places_changed",function(){var o=t.getPlaces();if(0!=o.length){var n=o[0];r(n.geometry.location),window.localStorage.latitude=n.geometry.location.latitude,window.localStorage.longitude=n.geometry.location.longitude,_.panTo(n.geometry.location),_.setZoom(16)}})}function v(){google.maps.event.addListener(_,"click",function(o){r(o.latLng)})}function h(){google.maps.event.addListener(_,"heading_changed",function(o){r(o)})}function w(){google.maps.event.addListener(_,"center_changed",function(){window.localStorage.latitude=_.getCenter().lat(),window.localStorage.longitude=_.getCenter().lng(),P()})}function b(){google.maps.event.addListener(_,"dragend",function(){u()})}function P(){var o=_.getBounds(),t=o.getNorthEast(),n=o.getSouthWest();$=new google.maps.LatLng(t.lat(),n.lng()),M=new google.maps.LatLng(n.lat(),t.lng())}function L(){google.maps.event.addListener(_,"maptypeid_changed",function(){c(),u()})}function S(){void 0===_&&(_=new google.maps.Map(a[0],I)),L(),t.$emit("mapInit",_),v(),f(),p(),d(),m(),w(),h(),b(),u(),e(function(){P()},800)}var _,$,M,y={url:"https://catchme.ifyoucan.com/images/pictures/IYC_Icons/IYC_Location_Icon_Small.png",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(17,25)},T={url:"http://www.clker.com/cliparts/U/P/j/M/I/i/x-mark-yellow-md.png",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)},C=new google.maps.LatLng(34.05,-118.24);isNaN(window.localStorage.latitude)||isNaN(window.localStorage.longitude)||(C=new google.maps.LatLng(window.localStorage.latitude,window.localStorage.longitude)),g(C);var I={center:C,zoom:15,MapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!0,streetViewControl:!1,mapTypeControl:!1,panControl:!1,zoomControl:!1},k=[],O=[];S()};return{restrict:"A",template:'<div id="map-canvas"></div>',replace:!0,link:a}}]),angular.module("app").directive("mapMsg",["$timeout",function(o){return{restrict:"A",templateUrl:"./templates/window.html",link:function(t,n){var e=t.postlife+"ms",a=t.postguid,i=t.msg;t.get_coupling=function(o){return 4==o?"bubblePost bubblePost_couple":1==o?"bubblePost bubblePost_ilikeyou":2==o?"bubblePost bubblePost_youlikei":"bubblePost bubblePost_none"},angular.element(document).ready(function(){o(function(){$("div div .postlifebar").css("animation-duration",e),console.log("Jquery called :"+e+" and msg:"+i),$("div div #bubbleClick").click(function(){a==t.guid&&console.log(""),t.postcouplestatus=1,console.log("emit set:guidtgt",a),t.$emit("set:guidtgt",a)})},2)})}}}]),angular.module("app").controller("PostsCtrl",["$rootScope","$scope","PostsSvc","$window","$document",function(o,t,n,e,a){t.$emit("pagechange",t.pageId.post),t.posts=[],t.$on("ws:new_post",function(o,n){t.requestFetch()}),t.moveToLoc=function(o){var n=t.posts[o],e=angular.fromJson(n.location),i=new google.maps.LatLng(e.lat,e.lon);t.map.panTo(i),t.map.setZoom(16);var l=0,s=480;a.scrollTop(l,s).then(function(){console&&console.log("You just scrolled to the top!")})},t.addPost=function(){var o=t.postplace,e=t.postLocation,a=JSON.stringify(e);console.log("POST location:",a),console.log("POST place:",o),console.log("POST guid:",t.guid),console.log("POST guidtgt:",t.guidtgt),n.create({body:t.content,location:a,place:o,guid:t.guid,guidtgt:t.guidtgt}).success(function(o){google.maps.event.trigger(t.map,"maptypeid_changed"),t.posts.unshift(o);var n=function(){for(var n=0;n<t.posts.length;++n)o._id==t.posts[n]._id&&t.posts.splice(n,1)};setTimeout(n,o.lifespan),t.content=null}).error(function(o,t){swal("Post failed","Please complete the from correctly","error")})},t.requestFetch=function(){n.fetch().success(function(o){t.posts=o})},t.requestFetch()}]),angular.module("app").service("PostsSvc",["$http",function(o){this.fetch=function(){return o.get("/api/posts")},this.create=function(t){return o.post("/api/posts",t)},this.remove=function(t){return console.log("deleting posting"),console.log("post._id:",t._id),o.put("/api/posts",t)}}]),angular.module("app").run(["$rootScope","$timeout",function(o,t){var n,e=document.location.hostname,a="192.168.0.4";n="localhost"==e?"ws://localhost:5000":e==a?"ws://192.168.0.4:5000":"wss://frozen-badlands-8649.herokuapp.com";var i=function(){connection=new WebSocket(n),connection.onopen=function(){console.log("WebSocket connected")},connection.onclose=function(){console.log("WebSocket closed. Reconecting..."),t(i,2e3)},connection.onmessage=function(t){console.log(t);var n=JSON.parse(t.data);o.$broadcast("ws:"+n.type,n.data)}};i()}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1dGlsLnN2Yy5qcyIsIm1hcHMvbWFwLmRpcmVjdGl2ZS5qcyIsIm1hcHMvbXNnLmRpcmVjdGl2ZS5qcyIsInBvc3RzL3Bvc3RzLmN0cmwuanMiLCJwb3N0cy9wb3N0cy5zdmMuanMiLCJhcHAuanMiLCJzb2NrZXRzL3dlYnNvY2tldHMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkcm9vdFNjb3BlIiwiJHNjb3BlIiwiJHdpbmRvdyIsIiRodHRwIiwiZ3VpZCIsInM0IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHJpbmciLCJpc01vYmlsZSIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsIm1hdGNoIiwiZ3VpZHRndCIsIiRvbiIsIl8iLCJjb25zb2xlIiwibG9nIiwicGFnZUlkIiwicG9zdCIsIm5hdkNvbGxhcHNlZCIsImNvbGxhcHNlIiwiZ29vZ2xlIiwibWFwcyIsImV2ZW50IiwidHJpZ2dlciIsIm1hcCIsIm1vdmVUb0N1cnJlbnRMb2NhdGlvbiIsImdldEN1cnJMb2NTdWNjZXNzIiwicG9zIiwiY3VycmVudFBhZ2VJZCIsImNyZCIsImNvb3JkcyIsIndpbmRvdyIsImxvY2FsU3RvcmFnZSIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiZ29vZ2xlTG9jIiwiTGF0TG5nIiwicGFuVG8iLCJzZXRab29tIiwiZ2V0Q3VyckxvY0Vycm9yIiwiZXJyIiwid2FybiIsImNvZGUiLCJtZXNzYWdlIiwiZ2VvbG9jYXRpb24iLCJnZXRDdXJyZW50UG9zaXRpb24iLCJzd2FsIiwidGl0bGUiLCJ0ZXh0IiwidGltZXIiLCJzaG93Q29uZmlybUJ1dHRvbiIsIm1vdmVUb1Bvc3RMb2NhdGlvbiIsImxhdERlbHRhIiwiYm91bmRzIiwiZ2V0Qm91bmRzIiwibmUiLCJnZXROb3J0aEVhc3QiLCJzdyIsImdldFNvdXRoV2VzdCIsImN1cnJlbnRfbWFwX253IiwibGF0IiwibG5nIiwiY3VycmVudF9tYXBfc2UiLCJsYXREZWx0YV9jZW50ZXIybm9ydGgiLCJhYnMiLCJwb3N0TG9jYXRpb24iLCJsYXREZWx0YV9jZW50ZXIyc291dGgiLCJsb24iLCJsb2NhdGlvbiIsInBsYWNlIiwiJGFwcGx5IiwicG9zdHBsYWNlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwic2VydmljZSIsInN2YyIsInRoaXMiLCJkZWcycmFkIiwiZGVnIiwiUEkiLCJnZXREaXN0YW5jZUZyb21MYXRMb25JbkttIiwibGF0MSIsImxvbjEiLCJsYXQyIiwibG9uMiIsIlIiLCJkTGF0IiwiZExvbiIsImEiLCJzaW4iLCJjb3MiLCJjIiwiYXRhbjIiLCJzcXJ0IiwiZCIsImRpcmVjdGl2ZSIsIlBvc3RzU3ZjIiwiVXRpbFN2YyIsIiRjb21waWxlIiwiJHRpbWVvdXQiLCJsaW5rIiwic2NvcGUiLCJlbGVtZW50IiwiYXR0cnMiLCJyb290U2NvcGUiLCJkcmF3SGVscGVyTWFya2VyIiwibWFya2VyIiwiaSIsImhlbHBlck1hcmtlcnMiLCJzZXRNYXAiLCJNYXJrZXIiLCJwb3NpdGlvbiIsImljb24iLCJpbWFnZVRhcmdldCIsInB1c2giLCJyZW1vdmVIZWxwZXJNYXJrZXIiLCJzZXRQbGFjZSIsIiRlbWl0IiwiZ2VvY29kZXIiLCJHZW9jb2RlciIsImdlb2NvZGUiLCJsYXRMbmciLCJyZXN1bHRzIiwic3RhdHVzIiwiZm9ybWF0dGVkX2FkZHJlc3MiLCJkcmF3QW5kU2V0UGxhY2UiLCJ1cGRhdGVNYXAiLCJmZXRjaCIsInN1Y2Nlc3MiLCJwb3N0cyIsImxlbmd0aCIsImoiLCJtYXJrZXJzIiwiX2lkIiwiaGFzT3duUHJvcGVydHkiLCJmcm9tSnNvbiIsImNvdXBsaW5nX3N0YXR1cyIsImlsaWtleW91IiwieW91bGlrZWkiLCJtYXJrZXJPcHRpb25zIiwiaW1hZ2VQb3N0Iiwic2V0VGltZW91dCIsIm9sZF9tYXJrZXIiLCJvbGRfcG9zdCIsImsiLCJzcGxpY2UiLCJsaWZlc3BhbiIsInBhcmVudCIsImNoaWxkIiwiJG5ldyIsIm9wZW5JbmZvV2luZG93IiwiY2hpbGRfc2NvcGUiLCJpbmZvV2luZG93T3B0aW9ucyIsInBpeGVsT2Zmc2V0IiwiU2l6ZSIsImluZm9XaW5kb3ciLCJJbmZvV2luZG93IiwiY29udGVudCIsImNvbXBpbGVkIiwibXNnIiwiYm9keSIsInBvc3RsaWZlIiwicG9zdGd1aWQiLCJwb3N0Z3VpZHRndCIsInBvc3Rjb3VwbGVzdGF0dXMiLCJzZXRDb250ZW50Iiwib3BlbiIsInNldE1vdmVUb0N1cnJMb2NCdG4iLCJjdXJyTG9jQnRuIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNvbnRyb2xzIiwiQ29udHJvbFBvc2l0aW9uIiwiVE9QX1JJR0hUIiwic2V0UG9zdEZvcm0iLCJwb3N0Rm9ybSIsIkJPVFRPTV9DRU5URVIiLCJzZXRQb3N0QnRuIiwicG9zdEJ0biIsInNldFNlYXJjaEJveCIsImlucHV0IiwiVE9QX0xFRlQiLCJzZWFyY2hCb3giLCJwbGFjZXMiLCJTZWFyY2hCb3giLCJhZGRMaXN0ZW5lciIsImdldFBsYWNlcyIsImdlb21ldHJ5Iiwic2V0Q2xpY2tNYXAiLCJzZXRNb3ZlVG9DdXJyZW50TG9jYXRpb24iLCJzZXRDZW50ZXJDaGFuZ2VkIiwiZ2V0Q2VudGVyIiwidXBkYXRlQm91bmRzIiwic2V0TWFwRHJhZ0VuZCIsInNldExvYWRQb3N0TWFya2VycyIsImluaXRNYXAiLCJNYXAiLCJtYXBPcHRpb25zIiwidXJsIiwic2l6ZSIsIm9yaWdpbiIsIlBvaW50IiwiYW5jaG9yIiwic2NhbGVkU2l6ZSIsImluaXRpYWxNYXBDZW50ZXIiLCJpc05hTiIsImNlbnRlciIsInpvb20iLCJNYXBUeXBlSWQiLCJST0FETUFQIiwic2Nyb2xsd2hlZWwiLCJzdHJlZXRWaWV3Q29udHJvbCIsIm1hcFR5cGVDb250cm9sIiwicGFuQ29udHJvbCIsInpvb21Db250cm9sIiwicmVzdHJpY3QiLCJ0ZW1wbGF0ZSIsInJlcGxhY2UiLCJkdXJhdGlvbiIsImdldF9jb3VwbGluZyIsInJlYWR5IiwiJCIsImNzcyIsImNsaWNrIiwiJGRvY3VtZW50IiwicmVxdWVzdEZldGNoIiwibW92ZVRvTG9jIiwiaWQiLCJ0b3AiLCJzY3JvbGxUb3AiLCJ0aGVuIiwiYWRkUG9zdCIsImxvY2F0aW9uSlNPTiIsIkpTT04iLCJzdHJpbmdpZnkiLCJjcmVhdGUiLCJ1bnNoaWZ0IiwiZnJvbnRFbmRQb3N0UmVtb3ZlIiwiZXJyb3IiLCJkYXRhIiwiZ2V0IiwicmVtb3ZlIiwicHV0IiwicnVuIiwiaG9zdG5hbWUiLCJkZXZlbG9wbWVudElQIiwiY29ubmVjdCIsImNvbm5lY3Rpb24iLCJXZWJTb2NrZXQiLCJvbm9wZW4iLCJvbmNsb3NlIiwib25tZXNzYWdlIiwiZSIsInBheWxvYWQiLCJwYXJzZSIsIiRicm9hZGNhc3QiLCJ0eXBlIl0sIm1hcHBpbmdzIjoiQUFDQUEsUUFBQUMsT0FBQSxPQUNBLFVBQ0EsYUNGQUQsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLG1CQUFBLGFBQUEsU0FBQSxVQUFBLFFBQUEsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FtQkEsUUFBQUMsS0FDQSxRQUFBQyxLQUNBLE1BQUFDLE1BQUFDLE1BQUEsT0FBQSxFQUFBRCxLQUFBRSxXQUNBQyxTQUFBLElBQ0FDLFVBQUEsR0FFQSxNQUFBTCxLQUFBQSxJQUFBLElBQUFBLElBQUEsSUFBQUEsSUFBQSxJQUFBQSxJQUFBLElBQUFBLElBQUFBLElBQUFBLElBdkJBSixFQUFBVSxTQUFBLFdBQ0EsTUFBQUMsV0FBQUMsVUFBQUMsTUFBQSxhQUNBRixVQUFBQyxVQUFBQyxNQUFBLFdBQ0FGLFVBQUFDLFVBQUFDLE1BQUEsWUFDQUYsVUFBQUMsVUFBQUMsTUFBQSxVQUNBRixVQUFBQyxVQUFBQyxNQUFBLFVBQ0FGLFVBQUFDLFVBQUFDLE1BQUEsZ0JBQ0FGLFVBQUFDLFVBQUFDLE1BQUEsbUJBRUEsR0FHQSxHQWNB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bkNPIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcblx0J25nUm91dGUnLFxuXHQnZHVTY3JvbGwnXG5dKTtcbiIsIlxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignQXBwbGljYXRpb25DdHJsJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCAkd2luZG93LCAkaHR0cCl7XG5cdC8vIHNlZSBpZiBpdHMgbW9iaWxlIHBob25lXG5cdCRzY29wZS5pc01vYmlsZSA9IGZ1bmN0aW9uKCl7XG5cdFx0aWYoIG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0FuZHJvaWQvaSlcblx0XHQgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvd2ViT1MvaSlcblx0XHQgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBob25lL2kpXG5cdFx0IHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL2lQYWQvaSlcblx0XHQgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBvZC9pKVxuXHRcdCB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9CbGFja0JlcnJ5L2kpXG5cdFx0IHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL1dpbmRvd3MgUGhvbmUvaSlcblx0XHQgKXtcblx0XHQgICAgcmV0dXJuIHRydWU7XG5cdFx0ICB9XG5cdFx0IGVsc2Uge1xuXHRcdCAgICByZXR1cm4gZmFsc2U7XG5cdFx0ICB9XG5cdH07XG5cblx0Ly8g7KeA6riI7J2AIOuCnOyImOulvCDrp4zrk6Tqs6Ag7J6I7Jy864KYIEdVSUTsnpDssrTrpbwgZ3JhYu2VtOyEnCDsk7jsiJgg7J6I64+E66GdIOuwlOq+uOuKlOqyjCDsoovsnYTrk68g7ZWY64ukLlxuXHRmdW5jdGlvbiBndWlkKCkge1xuXHRcdGZ1bmN0aW9uIHM0KCkge1xuXHRcdCAgICByZXR1cm4gTWF0aC5mbG9vcigoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMClcblx0XHQgICAgICAudG9TdHJpbmcoMTYpXG5cdFx0ICAgICAgLnN1YnN0cmluZygxKTtcblx0XHR9XG5cdCAgXHRyZXR1cm4gczQoKSArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgczQoKSArIHM0KCk7XG5cdH1cblxuXHQkc2NvcGUuZ3VpZCA9IGd1aWQoKTtcblxuXHQkc2NvcGUuZ3VpZHRndCA9IFwiMFwiOyAvLyDquLDrs7jqsJLsnYAgMOycvOuhnCDtlbTshJwgMOydtOuptCDqtIDsi6zsg4HrjIBndWlk6rCAIOyXhuuKlCDsg4Htg5zsnbTri6QuIFxuXG5cdCRzY29wZS4kb24oJ3NldDpndWlkdGd0JywgZnVuY3Rpb24oXywgZ3VpZHRndCl7XG5cdFx0Y29uc29sZS5sb2coXCJzZXR0aW5nIGd1aWR0Z3RcIiwgZ3VpZHRndCk7XG5cdFx0JHNjb3BlLmd1aWR0Z3QgPSBndWlkdGd0O1xuXHR9KTtcblxuXHQkc2NvcGUucGFnZUlkID0geyBcblx0XHRwb3N0IDogMCxcblx0fTtcblxuXHQkc2NvcGUubmF2Q29sbGFwc2VkID0gdHJ1ZTtcblx0JHNjb3BlLmNvbGxhcHNlID0gZnVuY3Rpb24oKXtcblx0XHQkc2NvcGUubmF2Q29sbGFwc2VkID0gdHJ1ZTtcblx0fTtcblxuXHQvLyBhcyBzZXJ2ZXIgc29ja2V0IHNlbmQgJ3dzOm5ld19wb3N0JyAsIHdlIGNhbiB1cGRhdGUgdGhlIG1hcCFcblx0JHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbihfLCBwb3N0KXtcblx0XHRnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKCRzY29wZS5tYXAsICdtYXB0eXBlaWRfY2hhbmdlZCcpO1xuXHR9KTtcblxuXHQvKiBtb3ZlIHRvIGN1cnJlbnQgbG9jYXRpb24gKi9cblx0JHNjb3BlLm1vdmVUb0N1cnJlbnRMb2NhdGlvbiA9IGZ1bmN0aW9uKCl7XG5cdFx0ZnVuY3Rpb24gZ2V0Q3VyckxvY1N1Y2Nlc3MocG9zKSB7XG4gICAgICAgICAgICAvKiBtYWtlIHN1cmUgdG8gY2hlY2sgd2UgYXJlIG9uIHBvc3QgcGFnZSB3aXRoIG1hcCBmaXJzdCAqL1xuICAgICAgICAgICAgaWYgKCRzY29wZS5jdXJyZW50UGFnZUlkICE9ICRzY29wZS5wYWdlSWQucG9zdClcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIHZhciBjcmQgPSBwb3MuY29vcmRzO1xuXG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gY3JkLmxhdGl0dWRlO1xuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUgPSBjcmQubG9uZ2l0dWRlO1xuXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdMYXRpdHVkZSA6ICcgKyBjcmQubGF0aXR1ZGUpO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnTG9uZ2l0dWRlOiAnICsgY3JkLmxvbmdpdHVkZSk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdNb3JlIG9yIGxlc3MgJyArIGNyZC5hY2N1cmFjeSArICcgbWV0ZXJzLicpO1xuICAgICAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoY3JkLmxhdGl0dWRlLCBjcmQubG9uZ2l0dWRlKTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcigkc2NvcGUubWFwLCAnaGVhZGluZ19jaGFuZ2VkJywgZ29vZ2xlTG9jKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJHNjb3BlLm1hcC5wYW5Ubyhnb29nbGVMb2MpXG4gICAgICAgICAgICAkc2NvcGUubWFwLnNldFpvb20oMTUpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0Q3VyckxvY0Vycm9yKGVycikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdFUlJPUignICsgZXJyLmNvZGUgKyAnKTogJyArIGVyci5tZXNzYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGluaXQgbWFwIGFuZCBwbGFjZSBzb21lIG1hcmtlcnMsIHNvIGV2ZXJ5dGhpbmcgc3RhcnQgd2l0aCB0aGlzIGZ1bmN0aW9uLiAqL1xuICAgICAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGdldEN1cnJMb2NTdWNjZXNzLCBnZXRDdXJyTG9jRXJyb3IpO1xuXG4gICAgICAgIHN3YWwoeyAgIHRpdGxlOiBcIlwiLCAgIHRleHQ6IFwiTW92aW5nIHRvIGN1cnJlbnQgbG9jYXRpb24uLlwiLCAgIHRpbWVyOiAxNTAwLCAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSB9KTtcblx0fTtcblxuXHQkc2NvcGUubW92ZVRvUG9zdExvY2F0aW9uID0gZnVuY3Rpb24oKXtcblx0XHR2YXIgbGF0RGVsdGEgPSAwLjA7XG5cblx0XHRpZiAoJHNjb3BlLmlzTW9iaWxlKCkpe1xuXHRcdFx0dmFyIGJvdW5kcyA9ICRzY29wZS5tYXAuZ2V0Qm91bmRzKCk7XG5cdCAgICAgICAgdmFyIG5lID0gYm91bmRzLmdldE5vcnRoRWFzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIG5vcnRoLWVhc3QgY29ybmVyXG5cdCAgICAgICAgdmFyIHN3ID0gYm91bmRzLmdldFNvdXRoV2VzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIHNvdXRoLXdlc3QgY29yZGVyXG5cdCAgICAgICAgY3VycmVudF9tYXBfbncgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKG5lLmxhdCgpLCBzdy5sbmcoKSk7XG5cdCAgICAgICAgY3VycmVudF9tYXBfc2UgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHN3LmxhdCgpLCBuZS5sbmcoKSk7XG5cblx0ICAgICAgICB2YXIgbGF0RGVsdGFfY2VudGVyMm5vcnRoID0gMC41ICogTWF0aC5hYnMoJHNjb3BlLnBvc3RMb2NhdGlvbi5sYXQgLSBjdXJyZW50X21hcF9udy5sYXQoKSk7XG5cdCAgICAgICAgdmFyIGxhdERlbHRhX2NlbnRlcjJzb3V0aCA9IDAuNSAqIE1hdGguYWJzKCRzY29wZS5wb3N0TG9jYXRpb24ubGF0IC0gY3VycmVudF9tYXBfc2UubGF0KCkpO1xuXG5cdCAgICAgICAgaWYgKGxhdERlbHRhX2NlbnRlcjJub3J0aCA+IGxhdERlbHRhX2NlbnRlcjJzb3V0aCl7XG5cdCAgICAgICAgXHRsYXREZWx0YSA9IGxhdERlbHRhX2NlbnRlcjJzb3V0aDtcblx0ICAgICAgICB9XG5cdCAgICAgICAgZWxzZSB7XG5cdCAgICAgICAgXHRsYXREZWx0YSA9IGxhdERlbHRhX2NlbnRlcjJub3J0aDtcblx0ICAgICAgICB9XG5cdFx0fVxuXG5cdFx0dmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoJHNjb3BlLnBvc3RMb2NhdGlvbi5sYXQgKyBsYXREZWx0YSwgJHNjb3BlLnBvc3RMb2NhdGlvbi5sb24pO1xuXHRcdCRzY29wZS5tYXAucGFuVG8oZ29vZ2xlTG9jKTtcblx0fTtcblxuXHQkc2NvcGUuJG9uKCdwYWdlY2hhbmdlJywgZnVuY3Rpb24oXywgcGFnZUlkKXtcblx0XHQkc2NvcGUuY3VycmVudFBhZ2VJZCA9IHBhZ2VJZDtcblx0fSk7XG5cblx0JHNjb3BlLiRvbignbG9jJywgZnVuY3Rpb24oXywgbG9jYXRpb24pe1xuXHRcdHZhciBsYXQgPSBsb2NhdGlvbi5sYXQoKTtcblx0XHR2YXIgbG9uID0gbG9jYXRpb24ubG5nKCk7XG5cdFx0JHNjb3BlLnBvc3RMb2NhdGlvbiA9IHtcblx0XHRcdGxhdDogbGF0LFxuXHRcdFx0bG9uOiBsb25cblx0XHR9O1xuXHR9KTtcblxuXHQkc2NvcGUuJG9uKCdwbGFjZScsIGZ1bmN0aW9uKF8sIHBsYWNlKXtcblx0XHQvLyBGb3JjaW5nIHRoZSB1cGRhdGUgd2l0aCAkYXBwbHkoKSBtZXRob2Qgb24gJHNjb3BlXG5cdFx0Ly8gcHJvYmxlbSByZWxhdGVkIG5vdGU6IGh0dHA6Ly93d3cuamVmZnJ5aG91c2VyLmNvbS9pbmRleC5jZm0vMjAxNC82LzIvSG93LWRvLUktcnVuLWNvZGUtd2hlbi1hLXZhcmlhYmxlLWNoYW5nZXMtd2l0aC1Bbmd1bGFySlNcblx0XHQkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XG5cdFx0XHRcdCRzY29wZS5wb3N0cGxhY2UgPSBwbGFjZTtcblx0XHRcdH1cblx0XHQpO1xuXHR9KTtcblxuXHQkc2NvcGUuJG9uKCdtYXBJbml0JywgZnVuY3Rpb24oXywgbWFwKXtcblx0XHQkc2NvcGUubWFwID0gbWFwO1xuXHRcdFxuXHRcdC8vIHVwZGF0ZSBtYXAgYm91bmRzIGFzIGFwcCBsYXVuY2hlc1xuXHRcdGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIoJHNjb3BlLm1hcCwgJ2NlbnRlcl9jaGFuZ2VkJyk7XG5cdH0pO1xuXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb25maWcoZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKXtcblx0JHJvdXRlUHJvdmlkZXJcblx0LndoZW4oJy8nLCBcblx0XHR7XG5cdFx0XHRjb250cm9sbGVyOiAnUG9zdHNDdHJsJywgXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvcG9zdHMuaHRtbCdcblx0XHR9KVxuXHQvLyBSZWRpcmVjdCB0byB0aGUgcm9vdCBwYWdlLlxuXHQub3RoZXJ3aXNlKFxuXHRcdHtcbiAgIFx0XHRcdHJlZGlyZWN0VG86ICcvJ1xuXHRcdH0pO1xufSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdVdGlsU3ZjJywgZnVuY3Rpb24oKXtcblx0dmFyIHN2YyA9IHRoaXM7XG5cblx0c3ZjLmRlZzJyYWQgPSBmdW5jdGlvbihkZWcpIHtcblx0ICByZXR1cm4gZGVnICogKE1hdGguUEkvMTgwKTtcblx0fTtcblxuXHRzdmMuZ2V0RGlzdGFuY2VGcm9tTGF0TG9uSW5LbSA9IGZ1bmN0aW9uIChsYXQxLGxvbjEsbGF0Mixsb24yKSB7XG5cdCAgdmFyIFIgPSA2MzcxO1xuXHQgIHZhciBkTGF0ID0gc3ZjLmRlZzJyYWQobGF0Mi1sYXQxKTtcblx0ICB2YXIgZExvbiA9IHN2Yy5kZWcycmFkKGxvbjItbG9uMSk7IFxuXHQgIHZhciBhID0gXG5cdCAgICBNYXRoLnNpbihkTGF0LzIpICogTWF0aC5zaW4oZExhdC8yKSArXG5cdCAgICBNYXRoLmNvcyhzdmMuZGVnMnJhZChsYXQxKSkgKiBNYXRoLmNvcyhzdmMuZGVnMnJhZChsYXQyKSkgKiBcblx0ICAgIE1hdGguc2luKGRMb24vMikgKiBNYXRoLnNpbihkTG9uLzIpXG5cdCAgICA7IFxuXHQgIHZhciBjID0gMiAqIE1hdGguYXRhbjIoTWF0aC5zcXJ0KGEpLCBNYXRoLnNxcnQoMS1hKSk7IFxuXHQgIHZhciBkID0gUiAqIGM7XG5cdCAgcmV0dXJuIGQ7XG5cdH07XG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5kaXJlY3RpdmUoJ2FwcE1hcCcsIGZ1bmN0aW9uKFBvc3RzU3ZjLCBVdGlsU3ZjLCAkY29tcGlsZSwgJHRpbWVvdXQpIHtcbiAgICAvLyBkaXJlY3RpdmUgbGluayBmdW5jdGlvblxuICAgIHZhciBsaW5rID0gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCByb290U2NvcGUpIHtcbiAgICAgICAgdmFyIG1hcDtcbiAgICAgICAgdmFyIGN1cnJlbnRfbWFwX253O1xuICAgICAgICB2YXIgY3VycmVudF9tYXBfc2U7XG4gICAgICAgIFxuICAgICAgICB2YXIgaW1hZ2VQb3N0ID0ge1xuICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9jYXRjaG1lLmlmeW91Y2FuLmNvbS9pbWFnZXMvcGljdHVyZXMvSVlDX0ljb25zL0lZQ19Mb2NhdGlvbl9JY29uX1NtYWxsLnBuZycsXG4gICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICBvcmlnaW46IG5ldyBnb29nbGUubWFwcy5Qb2ludCgwLCAwKSxcbiAgICAgICAgICAgIGFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDE3LCAzNCksXG4gICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxNywgMjUpXG4gICAgICAgIH07XG5cbiAgICAgICAgIHZhciBpbWFnZVRhcmdldCA9IHtcbiAgICAgICAgICAgIHVybDogJ2h0dHA6Ly93d3cuY2xrZXIuY29tL2NsaXBhcnRzL1UvUC9qL00vSS9pL3gtbWFyay15ZWxsb3ctbWQucG5nJyxcbiAgICAgICAgICAgIHNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDEwMCwgMTAwKSxcbiAgICAgICAgICAgIG9yaWdpbjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDAsIDApLFxuICAgICAgICAgICAgYW5jaG9yOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMTcsIDM0KSxcbiAgICAgICAgICAgIHNjYWxlZFNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDI1LCAyNSlcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBtYXAgY29uZmlnXG4gICAgICAgIHZhciBpbml0aWFsTWFwQ2VudGVyID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZygzNC4wNSwgLTExOC4yNCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWlzTmFOKHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUpICYmICFpc05hTih3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGluaXRpYWxNYXBDZW50ZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUsIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNldFBsYWNlKGluaXRpYWxNYXBDZW50ZXIpO1xuXG4gICAgICAgIHZhciBtYXBPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIGNlbnRlciAgICAgIDogaW5pdGlhbE1hcENlbnRlcixcbiAgICAgICAgICAgICAgICB6b29tICAgICAgICA6IDE1LFxuICAgICAgICAgICAgICAgIE1hcFR5cGVJZCAgIDogZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlJPQURNQVAsXG4gICAgICAgICAgICAgICAgc2Nyb2xsd2hlZWwgOiB0cnVlLFxuICAgICAgICAgICAgICAgIHN0cmVldFZpZXdDb250cm9sOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBtYXBUeXBlQ29udHJvbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgcGFuQ29udHJvbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgem9vbUNvbnRyb2w6IGZhbHNlXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgXG4gICAgICAgIC8vIGRyYXcgbWFwIHdpdGggaGVscGVyIG1hcmtlcnNcbiAgICAgICAgdmFyIGhlbHBlck1hcmtlcnMgPSBbXTtcbiAgICAgICAgZnVuY3Rpb24gZHJhd0hlbHBlck1hcmtlcihsb2NhdGlvbil7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbWFya2VyOyBtYXJrZXIgPSBoZWxwZXJNYXJrZXJzW2ldOyBpKyspIHtcbiAgICAgICAgICAgICAgICBtYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGVscGVyTWFya2VycyA9IFtdO1xuICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBsb2NhdGlvbiwgXG4gICAgICAgICAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VUYXJnZXRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaGVscGVyTWFya2Vycy5wdXNoKG1hcmtlcik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZW1vdmVIZWxwZXJNYXJrZXIoKXtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBtYXJrZXI7IG1hcmtlciA9IGhlbHBlck1hcmtlcnNbaV07IGkrKykge1xuICAgICAgICAgICAgICAgIG1hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBoZWxwZXJNYXJrZXJzID0gW107XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRQbGFjZShsb2NhdGlvbilcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gYnJvYWRjYXN0IGxvY2F0aW9uIGluZm9yKGxvbixsYXQpXG4gICAgICAgICAgICBzY29wZS4kZW1pdCgnbG9jJywgbG9jYXRpb24pO1xuXG4gICAgICAgICAgICB2YXIgZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTtcblxuICAgICAgICAgICAgLy8gYnJvYWRjYXN0IHBsYWNlIGZvcm1hdHRlZF9hZGRyZXNzIGFuZCBkcmF3IGljb25cbiAgICAgICAgICAgIGdlb2NvZGVyLmdlb2NvZGUoIHsgJ2xhdExuZyc6IGxvY2F0aW9uIH0sIGZ1bmN0aW9uKHJlc3VsdHMsIHN0YXR1cykge1xuICAgICAgICAgICAgICAgIC8vIGFzIHVzZXIgY2xpY2tzIG9uIHRoZSBtYXAsXG4gICAgICAgICAgICAgICAgLy8gd2UgaGF2ZSB0byBzYXZlIHRoZSBmb3JtYXR0ZWQgYWRkcmVzcyBpbiAkc2NvcGUgYW5kXG4gICAgICAgICAgICAgICAgLy8gaXQgd2lsbCBiZSB1c2VkIHRocm91Z2ggcG9zdHMuY3RybFxuICAgICAgICAgICAgICAgIC8vIGVtaXQgYnJvYWRjYXNlICdwbGFjZScgYW5kIHNlbmQgdGhpcyB0byBhcHBsaWNhdGlvbi5jdHJsXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYnJvYWRjYXN0IGZvcm1hdHRlZF9hZGRyZXNzXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdwbGFjZScsIHJlc3VsdHNbMV0uZm9ybWF0dGVkX2FkZHJlc3MpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2goZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgIHN3YWwoXCJcIixcIkxvY2F0aW9uIGRvZXMgbm90IGV4aXN0c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3BsYWNlJywgXCJMb2NhdGlvbiBkb2VzIG5vdCBleGlzdHNcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkcmF3QW5kU2V0UGxhY2UobG9jYXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRyYXdIZWxwZXJNYXJrZXIobG9jYXRpb24pO1xuICAgICAgICAgICAgc2V0UGxhY2UobG9jYXRpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcGxhY2UgYSBtYXJrZXIgYW5kIGluZm9XaW5kb3dcbiAgICAgICAgdmFyIG1hcmtlcnMgPSBbXTtcbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlTWFwKCkgeyAgIFxuICAgICAgICAgICAgUG9zdHNTdmMuZmV0Y2goKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocG9zdHMpe1xuXG4gICAgICAgICAgICAgICAgLy8gZHJhdyBsYXRlc3QgdXBkYXRlXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb3N0cy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwb3N0ID0gcG9zdHNbaV07XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIG1hcmtlcnMgcG9zdCBpcyBleGlzaXRpbmcgb25lLCB3ZSBkb24ndCB3YW50IHRvIGRyYXcgaXQgYWdhaW4uXG4gICAgICAgICAgICAgICAgICAgIC8vIG9ubHkgZHJhdyBuZXcgb25lcyFcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIG1hcmtlcjsgbWFya2VyID0gbWFya2Vyc1tqXTsgaisrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb3N0Ll9pZCA9PSBtYXJrZXIucG9zdC5faWQpXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdCA9IG51bGw7IC8vIOydtOuvuCDqt7jroKTsp4Qg7Y+s7Iqk7Yq4652866m0LCBudWxs66GcLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOyAvLyDsnbQgbG9vcOydgCBwb3N0Ll9pZOunjCDqsoDsgqzsmqnsnoTsnLzroZwsIOunjOyVvSDqsrnsuZjrqbQg67CU66GcIGxvb3DsnYQg66mI7Law64+EIOq0nOywruuLpC5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIHBvc3TqsIAg7JuQ656YIOyeiOyXh+uNmOqyg+ydtOuptCBwb3N06rCAIG51bGzroZwg7IWLIOuQmOyXiOydhOqyg+ydtOqzoCwgbG9jYXRpb27tlITroZztjbzti7Drj4Qg7J6I64qU7KeAIO2ZleyduO2VmOyekFxuICAgICAgICAgICAgICAgICAgICBpZiAoIXBvc3QgfHwgIXBvc3QuaGFzT3duUHJvcGVydHkoJ2xvY2F0aW9uJykpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsgLy8gc2tpcCB0aGlzIHBvc3QgLSBubyBuZWVkIHRvIGRyYXdcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb24gPSBhbmd1bGFyLmZyb21Kc29uKHBvc3QubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsb2NhdGlvbi5sYXQsIGxvY2F0aW9uLmxvbik7XG5cbiAgICAgICAgICAgICAgICAgICAgLyogY291cGxpbmcgc3RhdHVzXG4gICAgICAgICAgICAgICAgICAgICAgICAwIC0gbm8gc3RhdHVzXG4gICAgICAgICAgICAgICAgICAgICAgICAxIC0gaSBsaWtlIHlvdVxuICAgICAgICAgICAgICAgICAgICAgICAgMiAtIHlvdSBsaWtlIGlcbiAgICAgICAgICAgICAgICAgICAgICAgIDQgLSB3ZSBsaWtlIGVhY2ggb3RoZXJcbiAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyAoXCJzY29wZS5ndWlkdGd0OlwiLCBzY29wZS5ndWlkdGd0KTtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyAoXCJzY29wZS5ndWlkOlwiLCBzY29wZS5ndWlkKTtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyAoXCJwb3N0Lmd1aWR0Z3Q6XCIsIHBvc3QuZ3VpZHRndCk7XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cgKFwicG9zdC5ndWlkOlwiLCBwb3N0Lmd1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb3VwbGluZ19zdGF0dXMgPSAwO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaWxpa2V5b3UgPSBzY29wZS5ndWlkdGd0ID09IHBvc3QuZ3VpZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHlvdWxpa2VpID0gc2NvcGUuZ3VpZCA9PSBwb3N0Lmd1aWR0Z3Q7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbGlrZXlvdSAmJiB5b3VsaWtlaSkgLy8gNFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VwbGluZ19zdGF0dXMgPSA0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGlsaWtleW91ICYmICF5b3VsaWtlaSlcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY291cGxpbmdfc3RhdHVzID0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICghaWxpa2V5b3UgJiYgeW91bGlrZWkpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdXBsaW5nX3N0YXR1cyA9IDI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VwbGluZ19zdGF0dXMgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8g67CU7Jq0642U66asIOyViOyXkCDsnojripTsp4DrtoDthLAg7LK07YGs66W8IO2VmOyepSBcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoZ29vZ2xlTG9jLmxhdCgpIDwgY3VycmVudF9tYXBfbncubGF0KCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKGdvb2dsZUxvYy5sYXQoKSA+IGN1cnJlbnRfbWFwX3NlLmxhdCgpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIShnb29nbGVMb2MubG5nKCkgPCBjdXJyZW50X21hcF9zZS5sbmcoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEoZ29vZ2xlTG9jLmxuZygpID4gY3VycmVudF9tYXBfbncubG5nKCkpIClcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7IC8vIHNraXAgdGhpcyBwb3N0IC0gbm8gbmVlZCB0byBkcmF3XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIG1hcmtlciBvcHRpb24gc2V0dGluZ1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBnb29nbGVMb2MsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXA6IG1hcCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIkJ1YmJsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VQb3N0XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKG1hcmtlck9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gc2V0IHVwIHNlbGYgcmVtb3ZlIGZvciBtYXJrZXIgaXRzZWxmIGFuZCBmcm9tIG1hcmtlcnMgY29sbGVjdGlvbiBhdCBmcm9udC1lbmRcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChcbiAgICAgICAgICAgICAgICAgICAgICAgIChmdW5jdGlvbihvbGRfbWFya2VyLCBvbGRfcG9zdCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZF9tYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMCwgbWFya2VyOyBtYXJrZXIgPSBtYXJrZXJzW2tdOyBrKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9sZF9wb3N0Ll9pZCA9PSBtYXJrZXIucG9zdC5faWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2Vycy5zcGxpY2UoaywgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0obWFya2VyLCBwb3N0KSksIFxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zdC5saWZlc3Bhbik7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBhZGQgbWFya2VyIHRvIGFycmF5LCB0aGlzIG1lYW5zIHRoYXQgaXQgaGFzIGJlZW4gZHJhd24gdG8gbWFwXG4gICAgICAgICAgICAgICAgICAgIG1hcmtlcnMucHVzaChcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXI6IG1hcmtlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0ICA6IHBvc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRFJBV0lORyBNRVNTQUdFIFdJTkRPVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gJzxkaXYgaWQ9XCJidWJibGVQb3N0XCI+JyArIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0LmJvZHkgKyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvZGl2PjxkaXYgaWQ9XCJidWJibGVMaWZlQmFyXCI+PC9kaXY+JztcbiAgICAgICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgICAgICAvLyDsiqTsvZTtlITsl5DshJzrtoDthLAg7IOI66Gc7Jq0IOywqOydvOuTnCDsiqTsvZTtlITrpbwg66eM65Ok7Ja0IGVhY2ggZm9yIGxvb3Dsl5DshJwg7IKs7Jqp7ZWc64ukLlxuICAgICAgICAgICAgICAgICAgICAvLyAtLT4g7ZW07JW8LCDqsIEgRE9N7J20IOqwgeqwgeydmCBzY29wZeulvCDqsIDsoLjshJwgcG9zdCBtc2fqsIAg7JWIIOqyuey5nOuLpC5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHNjb3BlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSBwYXJlbnQuJG5ldyh0cnVlKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgb3BlbkluZm9XaW5kb3cgPSAoZnVuY3Rpb24obWFya2VyLCBjaGlsZF9zY29wZSwgcG9zdCwgY291cGxpbmdfc3RhdHVzKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY3JlYXRlIG5ldyB3aW5kb3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5mb1dpbmRvd09wdGlvbnMgPSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaXhlbE9mZnNldDogbmV3IGdvb2dsZS5tYXBzLlNpemUoLTQxLjUsIDEwLjApLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmZvV2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coaW5mb1dpbmRvd09wdGlvbnMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29tcGlsZSBpdCBiZWZvcmUgbG9hZGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSAnPGRpdiBtYXAtbXNnPjwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXBpbGVkID0gJGNvbXBpbGUoY29udGVudCkoY2hpbGRfc2NvcGUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy90byBtYWtlIGRhdGEgYXZhaWxhYmxlIHRvIHRlbXBsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUubXNnID0gcG9zdC5ib2R5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3RsaWZlID0gcG9zdC5saWZlc3BhbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Z3VpZCA9IHBvc3QuZ3VpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Z3VpZHRndCA9IHBvc3QuZ3VpZHRndDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Y291cGxlc3RhdHVzID0gY291cGxpbmdfc3RhdHVzO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjb3VwbGluZ19zdGF0dXNcIiwgY2hpbGRfc2NvcGUucG9zdGNvdXBsZXN0YXR1cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZy5kaXJlY3RpdmXsl5DshJwg7ZWY64qUIOqzvOygleydhCDsl6zquLDshJzrj4Qg7ZWg7IiYIOyeiOuLpC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihpbmZvV2luZG93LCAnZG9tcmVhZHknLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJ2RpdiBkaXYgLnBvc3RsaWZlYmFyJykuY3NzKFwiYW5pbWF0aW9uLWR1cmF0aW9uXCIsIHBvc3QubGlmZXNwYW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJKcXVlcnkgY2FsbGVkIDpcIiArICBwb3N0LmxpZmVzcGFuICsgXCIgYW5kIG1zZzpcIiArIHBvc3QuYm9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnZGl2ICNidWJibGVQb3N0JykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic2VuZGluZyAkZW1pdCAtIHNldF9ndWlkdGd0XCIsIHBvc3QuZ3VpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0X2d1aWR0Z3QnLCBwb3N0Lmd1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93LnNldENvbnRlbnQoIGNvbXBpbGVkWzBdICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5vcGVuKG1hcCAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9KShtYXJrZXIsIGNoaWxkLCBwb3N0LCBjb3VwbGluZ19zdGF0dXMpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgb3BlbkluZm9XaW5kb3coKTtcbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBFTkQgb2YgRFJBV0lORyBNRVNTQUdFIFdJTkRPVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgICAgICAgICB9IC8vIGVuZCBvZiBmb3ItbG9vcFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRNb3ZlVG9DdXJyTG9jQnRuKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGN1cnJMb2NCdG4gPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1jdXJyJykpOyBcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uVE9QX1JJR0hUXS5wdXNoKGN1cnJMb2NCdG4pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0UG9zdEZvcm0oKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgcG9zdEZvcm0gPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bvc3RpbmcnKSk7IFxuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5CT1RUT01fQ0VOVEVSXS5wdXNoKHBvc3RGb3JtKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldFBvc3RCdG4oKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgcG9zdEJ0biA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuLXN1Ym1pdCcpKTtcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uQk9UVE9NX0NFTlRFUl0ucHVzaChwb3N0QnRuKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldFNlYXJjaEJveCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgc2VhcmNoIGJveCBhbmQgbGluayBpdCB0byB0aGUgVUkgZWxlbWVudC5cbiAgICAgICAgICAgIHZhciBpbnB1dCA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFjLWlucHV0JykpOyAvLyBAdHlwZSB7SFRNTElucHV0RWxlbWVudH0gIFxuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5UT1BfTEVGVF0ucHVzaChpbnB1dCk7XG5cbiAgICAgICAgICAgIHZhciBzZWFyY2hCb3ggPSBuZXcgZ29vZ2xlLm1hcHMucGxhY2VzLlNlYXJjaEJveCgoaW5wdXQpKTsgLy8gQHR5cGUge0hUTUxJbnB1dEVsZW1lbnR9IFxuXG4gICAgICAgICAgICAvLyBMaXN0ZW4gZm9yIHRoZSBldmVudCBmaXJlZCB3aGVuIHRoZSB1c2VyIHNlbGVjdHMgYW4gaXRlbSBmcm9tIHRoZVxuICAgICAgICAgICAgLy8gcGljayBsaXN0LiBSZXRyaWV2ZSB0aGUgbWF0Y2hpbmcgcGxhY2VzIGZvciB0aGF0IGl0ZW0uXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihzZWFyY2hCb3gsICdwbGFjZXNfY2hhbmdlZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBwbGFjZXMgPSBzZWFyY2hCb3guZ2V0UGxhY2VzKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAocGxhY2VzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gdGFrZSBvbmx5IDEgc3BvdFxuICAgICAgICAgICAgICAgIHZhciBwbGFjZSA9IHBsYWNlc1swXTtcblxuICAgICAgICAgICAgICAgIC8vIHdoZW4gc2VhcmNoIGhhcHBlbnMsIGxvY2F0aW9uIHdpbGwgYmUgdXBkYXRlZCBhcyB3ZWxsIGZvciBwb3N0XG4gICAgICAgICAgICAgICAgLy8gc2NvcGUuJGVtaXQoJ3BsYWNlJywgcGxhY2UuZm9ybWF0dGVkX2FkZHJlc3MpO1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbik7XG5cbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gcGxhY2UuZ2VvbWV0cnkubG9jYXRpb24ubGF0aXR1ZGU7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUgPSBwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sb25naXR1ZGU7XG5cbiAgICAgICAgICAgICAgICBtYXAucGFuVG8ocGxhY2UuZ2VvbWV0cnkubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgIG1hcC5zZXRab29tKDE2KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0Q2xpY2tNYXAoKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBjbGljayBldmVudCBvbiBtYXAgdG8gZHJhdyBtYXJrZXJcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBkcmF3QW5kU2V0UGxhY2UoZXZlbnQubGF0TG5nKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0TW92ZVRvQ3VycmVudExvY2F0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gbW92aW5nIHRvIGEgcG9zdCdzIGxvY2F0aW9uIGFuZCBkcmF3IGEgbWFya2VyIHRoZXJlXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICdoZWFkaW5nX2NoYW5nZWQnLCBmdW5jdGlvbihsb2NhdGlvbikge1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShsb2NhdGlvbik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldENlbnRlckNoYW5nZWQoKVxuICAgICAgICB7XG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICdjZW50ZXJfY2hhbmdlZCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sYXRpdHVkZSA9IG1hcC5nZXRDZW50ZXIoKS5sYXQoKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSA9IG1hcC5nZXRDZW50ZXIoKS5sbmcoKTtcblxuICAgICAgICAgICAgICAgIHVwZGF0ZUJvdW5kcygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldE1hcERyYWdFbmQoKVxuICAgICAgICB7XG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICdkcmFnZW5kJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICB1cGRhdGVNYXAoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVCb3VuZHMoKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgYm91bmRzID0gbWFwLmdldEJvdW5kcygpO1xuICAgICAgICAgICAgdmFyIG5lID0gYm91bmRzLmdldE5vcnRoRWFzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIG5vcnRoLWVhc3QgY29ybmVyXG4gICAgICAgICAgICB2YXIgc3cgPSBib3VuZHMuZ2V0U291dGhXZXN0KCk7IC8vIExhdExuZyBvZiB0aGUgc291dGgtd2VzdCBjb3JkZXJcbiAgICAgICAgICAgIC8vWW91IGdldCBub3J0aC13ZXN0IGFuZCBzb3V0aC1lYXN0IGNvcm5lcnMgZnJvbSB0aGUgdHdvIGFib3ZlOlxuXG4gICAgICAgICAgICBjdXJyZW50X21hcF9udyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobmUubGF0KCksIHN3LmxuZygpKTtcbiAgICAgICAgICAgIGN1cnJlbnRfbWFwX3NlID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhzdy5sYXQoKSwgbmUubG5nKCkpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBmdW5jdGlvbiBzZXRMb2FkUG9zdE1hcmtlcnMoKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBtYW51YWxseSByZWxvYWQgbWFya2VycyAvIFJFRlJFU0hcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ21hcHR5cGVpZF9jaGFuZ2VkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlSGVscGVyTWFya2VyKCk7XG4gICAgICAgICAgICAgICAgdXBkYXRlTWFwKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGluaXQgdGhlIG1hcFxuICAgICAgICBmdW5jdGlvbiBpbml0TWFwKCkge1xuICAgICAgICAgICAgaWYgKG1hcCA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICAgICAgbWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChlbGVtZW50WzBdLCBtYXBPcHRpb25zKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc2V0TG9hZFBvc3RNYXJrZXJzKCk7XG5cbiAgICAgICAgICAgIC8vIGJyb2FkY2FzdCB0byBzZW5kIG1hcCB0byBhcHBsaWNhdGlvbiBjdHJsXG4gICAgICAgICAgICBzY29wZS4kZW1pdCgnbWFwSW5pdCcsIG1hcCk7XG5cbiAgICAgICAgICAgIHNldENsaWNrTWFwKCk7XG5cbiAgICAgICAgICAgIHNldFNlYXJjaEJveCgpO1xuXG4gICAgICAgICAgICBzZXRNb3ZlVG9DdXJyTG9jQnRuKCk7XG5cbiAgICAgICAgICAgIHNldFBvc3RGb3JtKCk7XG5cbiAgICAgICAgICAgIHNldFBvc3RCdG4oKTtcblxuICAgICAgICAgICAgc2V0Q2VudGVyQ2hhbmdlZCgpO1xuXG4gICAgICAgICAgICBzZXRNb3ZlVG9DdXJyZW50TG9jYXRpb24oKTtcblxuICAgICAgICAgICAgc2V0TWFwRHJhZ0VuZCgpO1xuXG4gICAgICAgICAgICB1cGRhdGVNYXAoKTtcblxuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICB1cGRhdGVCb3VuZHMoKTtcbiAgICAgICAgICAgIH0sIDgwMCk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSBcblxuICAgICAgICBpbml0TWFwKCk7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgaWQ9XCJtYXAtY2FudmFzXCI+PC9kaXY+JyxcbiAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgbGluazogbGlua1xuICAgIH07XG59KTtcblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uZGlyZWN0aXZlKCdtYXBNc2cnLCBmdW5jdGlvbiAoJHRpbWVvdXQpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIHRlbXBsYXRlVXJsOiAnLi90ZW1wbGF0ZXMvd2luZG93Lmh0bWwnLFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBhdHRycykgeyAgICAgICAgXG4gICAgICAgIHZhciBkdXJhdGlvbiA9IHNjb3BlLnBvc3RsaWZlICsgXCJtc1wiO1xuICAgICAgICB2YXIgcG9zdGd1aWQgPSBzY29wZS5wb3N0Z3VpZDtcbiAgICAgICAgdmFyIG1zZyA9IHNjb3BlLm1zZztcblxuICAgICAgICAvKiBjb3VwbGluZyBzdGF0dXNcbiAgICAgICAgICAwIC0gbm8gc3RhdHVzXG4gICAgICAgICAgMSAtIGkgbGlrZSB5b3VcbiAgICAgICAgICAyIC0geW91IGxpa2UgaVxuICAgICAgICAgIDQgLSB3ZSBsaWtlIGVhY2ggb3RoZXJcbiAgICAgICAgKi9cbiAgICAgICAgc2NvcGUuZ2V0X2NvdXBsaW5nID0gZnVuY3Rpb24oY291cGxpbmdfc3RhdHVzKXtcbiAgICAgICAgICBpZiAoY291cGxpbmdfc3RhdHVzID09IDQpe1xuICAgICAgICAgICAgcmV0dXJuIFwiYnViYmxlUG9zdCBidWJibGVQb3N0X2NvdXBsZVwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmIChjb3VwbGluZ19zdGF0dXMgPT0gMSl7XG4gICAgICAgICAgICByZXR1cm4gXCJidWJibGVQb3N0IGJ1YmJsZVBvc3RfaWxpa2V5b3VcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZiAoY291cGxpbmdfc3RhdHVzID09IDIpe1xuICAgICAgICAgICAgcmV0dXJuIFwiYnViYmxlUG9zdCBidWJibGVQb3N0X3lvdWxpa2VpXCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFwiYnViYmxlUG9zdCBidWJibGVQb3N0X25vbmVcIjtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gYXMgdGVtcGxhdGVVcmwgRE9NIGlzIGxvYWRlZCwgdGhpcyBmdW5jdGlvbiB3aWxsIGdldCBjYWxsZWQuXG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICQoJ2RpdiBkaXYgLnBvc3RsaWZlYmFyJykuY3NzKFwiYW5pbWF0aW9uLWR1cmF0aW9uXCIsIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSnF1ZXJ5IGNhbGxlZCA6XCIgKyAgZHVyYXRpb24gKyBcIiBhbmQgbXNnOlwiICsgbXNnKTtcblxuICAgICAgICAgICAgJCgnZGl2IGRpdiAjYnViYmxlQ2xpY2snKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgICBpZiAocG9zdGd1aWQgPT0gc2NvcGUuZ3VpZCl7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJcIilcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHNjb3BlLnBvc3Rjb3VwbGVzdGF0dXMgPSAxOyAvLyAxLSBpbGlrZXlvdVxuICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZW1pdCBzZXQ6Z3VpZHRndCcsIHBvc3RndWlkKTtcbiAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldDpndWlkdGd0JywgcG9zdGd1aWQpO1xuICAgICAgICAgICAgfSk7ICAgIFxuICAgICAgICAgIH0sIDIpOyAgICBcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgfVxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHIuY29udHJvbGxlcignUG9zdHNDdHJsJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICRzY29wZSwgUG9zdHNTdmMsICR3aW5kb3csICRkb2N1bWVudCl7XHJcclx0LyogZW1pdCBicm9hZGNhc3QgZm9yIGN1cnJlbnQgcGFnZUlkICovXHJcdCRzY29wZS4kZW1pdCgncGFnZWNoYW5nZScsICRzY29wZS5wYWdlSWQucG9zdCk7XHJcclx0JHNjb3BlLnBvc3RzID0gW107XHJcci8qIOqwleyVhOyngCBHRVTrlYwg7ZWE7JqU7ZaI7JeH7J2MLlxyXHQkc2NvcGUuJG9uKCdyZWZldGNoJywgZnVuY3Rpb24oXywgb2JqKXtcclx0XHQkc2NvcGUucmVxdWVzdEZldGNoKCk7XHJcdH0pO1xyKi9cclx0XHJcdC8qIGFzIHNlcnZlciB0ZWxscyB0aGVyZSB3YXMgbmV3IHBvc3QsIGxldHMgcmUtbG9hZCBsaXN0IGRhdGEgKi9cclx0JHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbihfLCBwb3N0KXtcclx0XHQkc2NvcGUucmVxdWVzdEZldGNoKCk7XHJcdH0pO1xyXHJcdC8qIG1vdmUgdG8gcG9zdCdzIGxvY2F0aW9uICovXHJcdCRzY29wZS5tb3ZlVG9Mb2MgPSBmdW5jdGlvbihpZCl7XHJcdFx0dmFyIHBvc3QgPSAoJHNjb3BlLnBvc3RzW2lkXSk7XHJcclx0XHR2YXIgbG9jYXRpb24gPSBhbmd1bGFyLmZyb21Kc29uKHBvc3QubG9jYXRpb24pO1xyXHRcdHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxvY2F0aW9uLmxhdCwgbG9jYXRpb24ubG9uKTtcclxyXHRcdCRzY29wZS5tYXAucGFuVG8oZ29vZ2xlTG9jKTtcclx0XHQkc2NvcGUubWFwLnNldFpvb20oMTYpO1xyXHJcdFx0LyogdXNpbmcgYW5ndWxhci1zY3JvbGwgdG8gbW92ZSB0byB0aGUgdG9wIHNtb290aGx5ICovXHJcdFx0dmFyIHRvcCA9IDA7XHIgICAgXHR2YXIgZHVyYXRpb24gPSA0ODA7XHIgICAgXHQkZG9jdW1lbnQuc2Nyb2xsVG9wKHRvcCwgZHVyYXRpb24pLnRoZW4oZnVuY3Rpb24oKSB7XHIgICAgIFx0XHQgY29uc29sZSAmJiBjb25zb2xlLmxvZygnWW91IGp1c3Qgc2Nyb2xsZWQgdG8gdGhlIHRvcCEnKTtcciAgICBcdH0pO1xyXHJcdH07XHJcclx0JHNjb3BlLmFkZFBvc3QgPSBmdW5jdGlvbigpIHtcclx0XHQvKiBnZXQgYXV0b2NvbXBsZXRlZCBwbGFjZSBhbmQgcmVzZXQoc2V0IHRvIHVuZGVmaW5lZCkgKi9cclx0XHR2YXIgcGxhY2UgPSAkc2NvcGUucG9zdHBsYWNlO1xyXHRcdHZhciBsb2NhdGlvbiA9ICRzY29wZS5wb3N0TG9jYXRpb247XHJcclx0XHR2YXIgbG9jYXRpb25KU09OID0gSlNPTi5zdHJpbmdpZnkobG9jYXRpb24pO1xyXHJcdFx0Y29uc29sZS5sb2coXCJQT1NUIGxvY2F0aW9uOlwiLCBsb2NhdGlvbkpTT04pO1xyXHRcdGNvbnNvbGUubG9nKFwiUE9TVCBwbGFjZTpcIiwgcGxhY2UpO1xyXHRcdGNvbnNvbGUubG9nKFwiUE9TVCBndWlkOlwiLCAkc2NvcGUuZ3VpZCk7XHJcdFx0Y29uc29sZS5sb2coXCJQT1NUIGd1aWR0Z3Q6XCIsICRzY29wZS5ndWlkdGd0KTtcclxyXHRcdFBvc3RzU3ZjLmNyZWF0ZShcclx0XHR7XHJcdFx0XHRib2R5ICAgIDogICRzY29wZS5jb250ZW50LFxyXHRcdFx0bG9jYXRpb246ICBsb2NhdGlvbkpTT04sXHJcdFx0XHRwbGFjZSAgIDogIHBsYWNlLFxyXHRcdFx0Z3VpZCAgICA6ICAkc2NvcGUuZ3VpZCxcclx0XHRcdGd1aWR0Z3QgOiAgJHNjb3BlLmd1aWR0Z3Rcclx0XHR9KVxyXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKHBvc3Qpe1xyXHRcdFx0LyogbWFudWFsbHkgcmVsb2FkIG1hcmtlcnMgXHJcdFx0XHR1c2luZyBtYXB0eXBlaWQgc2luY2UgaXRzIG1vc3QgbGVhc3QgdXNlZCBldmVudCwgLSBraW5kIG9mIGhhY2t5IHdheSB0byBkbyBpdFxyXHRcdFx0Ki9cclx0XHRcdGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIoJHNjb3BlLm1hcCwgJ21hcHR5cGVpZF9jaGFuZ2VkJyk7XHJcclx0XHRcdCRzY29wZS5wb3N0cy51bnNoaWZ0KHBvc3QpO1xyXHJcdFx0XHQvKiBmcm9udCBlbmQgc2lkZSBsaXN0IHBvc3QgcmVtb3ZlICovXHJcdFx0XHR2YXIgZnJvbnRFbmRQb3N0UmVtb3ZlID0gZnVuY3Rpb24oKXsgXHJcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgJHNjb3BlLnBvc3RzLmxlbmd0aDsgKytpKXtcclx0XHRcdFx0aWYgKHBvc3QuX2lkID09ICRzY29wZS5wb3N0c1tpXS5faWQpXHJcdFx0XHRcdFx0JHNjb3BlLnBvc3RzLnNwbGljZShpLCAxKTtcclx0XHRcdFx0fVxyXHRcdFx0fTtcclx0XHRcdHNldFRpbWVvdXQoZnJvbnRFbmRQb3N0UmVtb3ZlLCBwb3N0LmxpZmVzcGFuKTtcclxyXHRcdFx0LyogcmVzZXQgaW5wdXQgZm9ybXMgKi9cclx0XHRcdCRzY29wZS5jb250ZW50ICA9IG51bGw7XHJcdFx0fSlcclx0XHQuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKXtcclx0XHRcdHN3YWwoXCJQb3N0IGZhaWxlZFwiLCBcIlBsZWFzZSBjb21wbGV0ZSB0aGUgZnJvbSBjb3JyZWN0bHlcIiwgXCJlcnJvclwiKTtcclx0XHR9KTtcclxyXHR9O1xyXHJcdC8qIGFzIHNlcnZlciB0ZWxscyB0aGVyZSB3YXMgbmV3IHBvc3QsIGxldHMgcmUtbG9hZCBsaXN0IGRhdGEgKi9cclx0JHNjb3BlLnJlcXVlc3RGZXRjaCA9IGZ1bmN0aW9uKCkge1xyXHRcdFBvc3RzU3ZjLmZldGNoKClcclx0XHQuc3VjY2VzcyhmdW5jdGlvbihwb3N0cyl7XHJcdFx0XHQkc2NvcGUucG9zdHMgPSBwb3N0cztcclx0XHR9KTtcclx0fTtcclxyXHQkc2NvcGUucmVxdWVzdEZldGNoKCk7XHJ9KTtcciIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1Bvc3RzU3ZjJywgZnVuY3Rpb24oJGh0dHApe1xuXHR0aGlzLmZldGNoID0gZnVuY3Rpb24oKXtcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJyk7XG5cdH07XG5cblx0dGhpcy5jcmVhdGUgPSBmdW5jdGlvbihwb3N0KXtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHBvc3QpO1xuXHR9O1xuXG5cdHRoaXMucmVtb3ZlID0gZnVuY3Rpb24ocG9zdCl7XG5cdFx0Y29uc29sZS5sb2coXCJkZWxldGluZyBwb3N0aW5nXCIpO1xuXHRcdGNvbnNvbGUubG9nKCdwb3N0Ll9pZDonLCBwb3N0Ll9pZCk7XG5cdFx0cmV0dXJuICRodHRwLnB1dCgnL2FwaS9wb3N0cycsIHBvc3QpO1xuXHR9O1xufSk7IiwiXG5hbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuXHQnbmdSb3V0ZScsXG5cdCdkdVNjcm9sbCdcbl0pO1xuXG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uQ3RybCcsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJHdpbmRvdywgJGh0dHApe1xuXHQvLyBzZWUgaWYgaXRzIG1vYmlsZSBwaG9uZVxuXHQkc2NvcGUuaXNNb2JpbGUgPSBmdW5jdGlvbigpe1xuXHRcdGlmKCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9BbmRyb2lkL2kpXG5cdFx0IHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL3dlYk9TL2kpXG5cdFx0IHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL2lQaG9uZS9pKVxuXHRcdCB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUGFkL2kpXG5cdFx0IHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL2lQb2QvaSlcblx0XHQgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvQmxhY2tCZXJyeS9pKVxuXHRcdCB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9XaW5kb3dzIFBob25lL2kpXG5cdFx0ICl7XG5cdFx0ICAgIHJldHVybiB0cnVlO1xuXHRcdCAgfVxuXHRcdCBlbHNlIHtcblx0XHQgICAgcmV0dXJuIGZhbHNlO1xuXHRcdCAgfVxuXHR9O1xuXG5cdC8vIOyngOq4iOydgCDrgpzsiJjrpbwg66eM65Ok6rOgIOyeiOycvOuCmCBHVUlE7J6Q7LK066W8IGdyYWLtlbTshJwg7JO47IiYIOyeiOuPhOuhnSDrsJTqvrjripTqsowg7KKL7J2E65OvIO2VmOuLpC5cblx0ZnVuY3Rpb24gZ3VpZCgpIHtcblx0XHRmdW5jdGlvbiBzNCgpIHtcblx0XHQgICAgcmV0dXJuIE1hdGguZmxvb3IoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApXG5cdFx0ICAgICAgLnRvU3RyaW5nKDE2KVxuXHRcdCAgICAgIC5zdWJzdHJpbmcoMSk7XG5cdFx0fVxuXHQgIFx0cmV0dXJuIHM0KCkgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArIHM0KCkgKyBzNCgpO1xuXHR9XG5cblx0JHNjb3BlLmd1aWQgPSBndWlkKCk7XG5cblx0JHNjb3BlLmd1aWR0Z3QgPSBcIjBcIjsgLy8g6riw67O46rCS7J2AIDDsnLzroZwg7ZW07IScIDDsnbTrqbQg6rSA7Ius7IOB64yAZ3VpZOqwgCDsl4bripQg7IOB7YOc7J2064ukLiBcblxuXHQkc2NvcGUuJG9uKCdzZXQ6Z3VpZHRndCcsIGZ1bmN0aW9uKF8sIGd1aWR0Z3Qpe1xuXHRcdGNvbnNvbGUubG9nKFwic2V0dGluZyBndWlkdGd0XCIsIGd1aWR0Z3QpO1xuXHRcdCRzY29wZS5ndWlkdGd0ID0gZ3VpZHRndDtcblx0fSk7XG5cblx0JHNjb3BlLnBhZ2VJZCA9IHsgXG5cdFx0cG9zdCA6IDAsXG5cdH07XG5cblx0JHNjb3BlLm5hdkNvbGxhcHNlZCA9IHRydWU7XG5cdCRzY29wZS5jb2xsYXBzZSA9IGZ1bmN0aW9uKCl7XG5cdFx0JHNjb3BlLm5hdkNvbGxhcHNlZCA9IHRydWU7XG5cdH07XG5cblx0Ly8gYXMgc2VydmVyIHNvY2tldCBzZW5kICd3czpuZXdfcG9zdCcgLCB3ZSBjYW4gdXBkYXRlIHRoZSBtYXAhXG5cdCRzY29wZS4kb24oJ3dzOm5ld19wb3N0JywgZnVuY3Rpb24oXywgcG9zdCl7XG5cdFx0Z29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcigkc2NvcGUubWFwLCAnbWFwdHlwZWlkX2NoYW5nZWQnKTtcblx0fSk7XG5cblx0LyogbW92ZSB0byBjdXJyZW50IGxvY2F0aW9uICovXG5cdCRzY29wZS5tb3ZlVG9DdXJyZW50TG9jYXRpb24gPSBmdW5jdGlvbigpe1xuXHRcdGZ1bmN0aW9uIGdldEN1cnJMb2NTdWNjZXNzKHBvcykge1xuICAgICAgICAgICAgLyogbWFrZSBzdXJlIHRvIGNoZWNrIHdlIGFyZSBvbiBwb3N0IHBhZ2Ugd2l0aCBtYXAgZmlyc3QgKi9cbiAgICAgICAgICAgIGlmICgkc2NvcGUuY3VycmVudFBhZ2VJZCAhPSAkc2NvcGUucGFnZUlkLnBvc3QpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICB2YXIgY3JkID0gcG9zLmNvb3JkcztcblxuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sYXRpdHVkZSA9IGNyZC5sYXRpdHVkZTtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlID0gY3JkLmxvbmdpdHVkZTtcblxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnTGF0aXR1ZGUgOiAnICsgY3JkLmxhdGl0dWRlKTtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ0xvbmdpdHVkZTogJyArIGNyZC5sb25naXR1ZGUpO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnTW9yZSBvciBsZXNzICcgKyBjcmQuYWNjdXJhY3kgKyAnIG1ldGVycy4nKTtcbiAgICAgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGNyZC5sYXRpdHVkZSwgY3JkLmxvbmdpdHVkZSk7XG5cbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIoJHNjb3BlLm1hcCwgJ2hlYWRpbmdfY2hhbmdlZCcsIGdvb2dsZUxvYyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICRzY29wZS5tYXAucGFuVG8oZ29vZ2xlTG9jKVxuICAgICAgICAgICAgJHNjb3BlLm1hcC5zZXRab29tKDE1KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEN1cnJMb2NFcnJvcihlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRVJST1IoJyArIGVyci5jb2RlICsgJyk6ICcgKyBlcnIubWVzc2FnZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBpbml0IG1hcCBhbmQgcGxhY2Ugc29tZSBtYXJrZXJzLCBzbyBldmVyeXRoaW5nIHN0YXJ0IHdpdGggdGhpcyBmdW5jdGlvbi4gKi9cbiAgICAgICAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihnZXRDdXJyTG9jU3VjY2VzcywgZ2V0Q3VyckxvY0Vycm9yKTtcblxuICAgICAgICBzd2FsKHsgICB0aXRsZTogXCJcIiwgICB0ZXh0OiBcIk1vdmluZyB0byBjdXJyZW50IGxvY2F0aW9uLi5cIiwgICB0aW1lcjogMTUwMCwgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UgfSk7XG5cdH07XG5cblx0JHNjb3BlLm1vdmVUb1Bvc3RMb2NhdGlvbiA9IGZ1bmN0aW9uKCl7XG5cdFx0dmFyIGxhdERlbHRhID0gMC4wO1xuXG5cdFx0aWYgKCRzY29wZS5pc01vYmlsZSgpKXtcblx0XHRcdHZhciBib3VuZHMgPSAkc2NvcGUubWFwLmdldEJvdW5kcygpO1xuXHQgICAgICAgIHZhciBuZSA9IGJvdW5kcy5nZXROb3J0aEVhc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBub3J0aC1lYXN0IGNvcm5lclxuXHQgICAgICAgIHZhciBzdyA9IGJvdW5kcy5nZXRTb3V0aFdlc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBzb3V0aC13ZXN0IGNvcmRlclxuXHQgICAgICAgIGN1cnJlbnRfbWFwX253ID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhuZS5sYXQoKSwgc3cubG5nKCkpO1xuXHQgICAgICAgIGN1cnJlbnRfbWFwX3NlID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhzdy5sYXQoKSwgbmUubG5nKCkpO1xuXG5cdCAgICAgICAgdmFyIGxhdERlbHRhX2NlbnRlcjJub3J0aCA9IDAuNSAqIE1hdGguYWJzKCRzY29wZS5wb3N0TG9jYXRpb24ubGF0IC0gY3VycmVudF9tYXBfbncubGF0KCkpO1xuXHQgICAgICAgIHZhciBsYXREZWx0YV9jZW50ZXIyc291dGggPSAwLjUgKiBNYXRoLmFicygkc2NvcGUucG9zdExvY2F0aW9uLmxhdCAtIGN1cnJlbnRfbWFwX3NlLmxhdCgpKTtcblxuXHQgICAgICAgIGlmIChsYXREZWx0YV9jZW50ZXIybm9ydGggPiBsYXREZWx0YV9jZW50ZXIyc291dGgpe1xuXHQgICAgICAgIFx0bGF0RGVsdGEgPSBsYXREZWx0YV9jZW50ZXIyc291dGg7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgIFx0bGF0RGVsdGEgPSBsYXREZWx0YV9jZW50ZXIybm9ydGg7XG5cdCAgICAgICAgfVxuXHRcdH1cblxuXHRcdHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKCRzY29wZS5wb3N0TG9jYXRpb24ubGF0ICsgbGF0RGVsdGEsICRzY29wZS5wb3N0TG9jYXRpb24ubG9uKTtcblx0XHQkc2NvcGUubWFwLnBhblRvKGdvb2dsZUxvYyk7XG5cdH07XG5cblx0JHNjb3BlLiRvbigncGFnZWNoYW5nZScsIGZ1bmN0aW9uKF8sIHBhZ2VJZCl7XG5cdFx0JHNjb3BlLmN1cnJlbnRQYWdlSWQgPSBwYWdlSWQ7XG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ2xvYycsIGZ1bmN0aW9uKF8sIGxvY2F0aW9uKXtcblx0XHR2YXIgbGF0ID0gbG9jYXRpb24ubGF0KCk7XG5cdFx0dmFyIGxvbiA9IGxvY2F0aW9uLmxuZygpO1xuXHRcdCRzY29wZS5wb3N0TG9jYXRpb24gPSB7XG5cdFx0XHRsYXQ6IGxhdCxcblx0XHRcdGxvbjogbG9uXG5cdFx0fTtcblx0fSk7XG5cblx0JHNjb3BlLiRvbigncGxhY2UnLCBmdW5jdGlvbihfLCBwbGFjZSl7XG5cdFx0Ly8gRm9yY2luZyB0aGUgdXBkYXRlIHdpdGggJGFwcGx5KCkgbWV0aG9kIG9uICRzY29wZVxuXHRcdC8vIHByb2JsZW0gcmVsYXRlZCBub3RlOiBodHRwOi8vd3d3LmplZmZyeWhvdXNlci5jb20vaW5kZXguY2ZtLzIwMTQvNi8yL0hvdy1kby1JLXJ1bi1jb2RlLXdoZW4tYS12YXJpYWJsZS1jaGFuZ2VzLXdpdGgtQW5ndWxhckpTXG5cdFx0JHNjb3BlLiRhcHBseShmdW5jdGlvbigpe1xuXHRcdFx0XHQkc2NvcGUucG9zdHBsYWNlID0gcGxhY2U7XG5cdFx0XHR9XG5cdFx0KTtcblx0fSk7XG5cblx0JHNjb3BlLiRvbignbWFwSW5pdCcsIGZ1bmN0aW9uKF8sIG1hcCl7XG5cdFx0JHNjb3BlLm1hcCA9IG1hcDtcblx0XHRcblx0XHQvLyB1cGRhdGUgbWFwIGJvdW5kcyBhcyBhcHAgbGF1bmNoZXNcblx0XHRnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKCRzY29wZS5tYXAsICdjZW50ZXJfY2hhbmdlZCcpO1xuXHR9KTtcblxufSk7XG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb25maWcoZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKXtcblx0JHJvdXRlUHJvdmlkZXJcblx0LndoZW4oJy8nLCBcblx0XHR7XG5cdFx0XHRjb250cm9sbGVyOiAnUG9zdHNDdHJsJywgXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvcG9zdHMuaHRtbCdcblx0XHR9KVxuXHQvLyBSZWRpcmVjdCB0byB0aGUgcm9vdCBwYWdlLlxuXHQub3RoZXJ3aXNlKFxuXHRcdHtcbiAgIFx0XHRcdHJlZGlyZWN0VG86ICcvJ1xuXHRcdH0pO1xufSk7XG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1V0aWxTdmMnLCBmdW5jdGlvbigpe1xuXHR2YXIgc3ZjID0gdGhpcztcblxuXHRzdmMuZGVnMnJhZCA9IGZ1bmN0aW9uKGRlZykge1xuXHQgIHJldHVybiBkZWcgKiAoTWF0aC5QSS8xODApO1xuXHR9O1xuXG5cdHN2Yy5nZXREaXN0YW5jZUZyb21MYXRMb25JbkttID0gZnVuY3Rpb24gKGxhdDEsbG9uMSxsYXQyLGxvbjIpIHtcblx0ICB2YXIgUiA9IDYzNzE7XG5cdCAgdmFyIGRMYXQgPSBzdmMuZGVnMnJhZChsYXQyLWxhdDEpO1xuXHQgIHZhciBkTG9uID0gc3ZjLmRlZzJyYWQobG9uMi1sb24xKTsgXG5cdCAgdmFyIGEgPSBcblx0ICAgIE1hdGguc2luKGRMYXQvMikgKiBNYXRoLnNpbihkTGF0LzIpICtcblx0ICAgIE1hdGguY29zKHN2Yy5kZWcycmFkKGxhdDEpKSAqIE1hdGguY29zKHN2Yy5kZWcycmFkKGxhdDIpKSAqIFxuXHQgICAgTWF0aC5zaW4oZExvbi8yKSAqIE1hdGguc2luKGRMb24vMilcblx0ICAgIDsgXG5cdCAgdmFyIGMgPSAyICogTWF0aC5hdGFuMihNYXRoLnNxcnQoYSksIE1hdGguc3FydCgxLWEpKTsgXG5cdCAgdmFyIGQgPSBSICogYztcblx0ICByZXR1cm4gZDtcblx0fTtcbn0pO1xuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5kaXJlY3RpdmUoJ2FwcE1hcCcsIGZ1bmN0aW9uKFBvc3RzU3ZjLCBVdGlsU3ZjLCAkY29tcGlsZSwgJHRpbWVvdXQpIHtcbiAgICAvLyBkaXJlY3RpdmUgbGluayBmdW5jdGlvblxuICAgIHZhciBsaW5rID0gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCByb290U2NvcGUpIHtcbiAgICAgICAgdmFyIG1hcDtcbiAgICAgICAgdmFyIGN1cnJlbnRfbWFwX253O1xuICAgICAgICB2YXIgY3VycmVudF9tYXBfc2U7XG4gICAgICAgIFxuICAgICAgICB2YXIgaW1hZ2VQb3N0ID0ge1xuICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9jYXRjaG1lLmlmeW91Y2FuLmNvbS9pbWFnZXMvcGljdHVyZXMvSVlDX0ljb25zL0lZQ19Mb2NhdGlvbl9JY29uX1NtYWxsLnBuZycsXG4gICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICBvcmlnaW46IG5ldyBnb29nbGUubWFwcy5Qb2ludCgwLCAwKSxcbiAgICAgICAgICAgIGFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDE3LCAzNCksXG4gICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxNywgMjUpXG4gICAgICAgIH07XG5cbiAgICAgICAgIHZhciBpbWFnZVRhcmdldCA9IHtcbiAgICAgICAgICAgIHVybDogJ2h0dHA6Ly93d3cuY2xrZXIuY29tL2NsaXBhcnRzL1UvUC9qL00vSS9pL3gtbWFyay15ZWxsb3ctbWQucG5nJyxcbiAgICAgICAgICAgIHNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDEwMCwgMTAwKSxcbiAgICAgICAgICAgIG9yaWdpbjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDAsIDApLFxuICAgICAgICAgICAgYW5jaG9yOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMTcsIDM0KSxcbiAgICAgICAgICAgIHNjYWxlZFNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDI1LCAyNSlcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBtYXAgY29uZmlnXG4gICAgICAgIHZhciBpbml0aWFsTWFwQ2VudGVyID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZygzNC4wNSwgLTExOC4yNCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWlzTmFOKHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUpICYmICFpc05hTih3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGluaXRpYWxNYXBDZW50ZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUsIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNldFBsYWNlKGluaXRpYWxNYXBDZW50ZXIpO1xuXG4gICAgICAgIHZhciBtYXBPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIGNlbnRlciAgICAgIDogaW5pdGlhbE1hcENlbnRlcixcbiAgICAgICAgICAgICAgICB6b29tICAgICAgICA6IDE1LFxuICAgICAgICAgICAgICAgIE1hcFR5cGVJZCAgIDogZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlJPQURNQVAsXG4gICAgICAgICAgICAgICAgc2Nyb2xsd2hlZWwgOiB0cnVlLFxuICAgICAgICAgICAgICAgIHN0cmVldFZpZXdDb250cm9sOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBtYXBUeXBlQ29udHJvbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgcGFuQ29udHJvbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgem9vbUNvbnRyb2w6IGZhbHNlXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgXG4gICAgICAgIC8vIGRyYXcgbWFwIHdpdGggaGVscGVyIG1hcmtlcnNcbiAgICAgICAgdmFyIGhlbHBlck1hcmtlcnMgPSBbXTtcbiAgICAgICAgZnVuY3Rpb24gZHJhd0hlbHBlck1hcmtlcihsb2NhdGlvbil7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbWFya2VyOyBtYXJrZXIgPSBoZWxwZXJNYXJrZXJzW2ldOyBpKyspIHtcbiAgICAgICAgICAgICAgICBtYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGVscGVyTWFya2VycyA9IFtdO1xuICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBsb2NhdGlvbiwgXG4gICAgICAgICAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VUYXJnZXRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaGVscGVyTWFya2Vycy5wdXNoKG1hcmtlcik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZW1vdmVIZWxwZXJNYXJrZXIoKXtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBtYXJrZXI7IG1hcmtlciA9IGhlbHBlck1hcmtlcnNbaV07IGkrKykge1xuICAgICAgICAgICAgICAgIG1hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBoZWxwZXJNYXJrZXJzID0gW107XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRQbGFjZShsb2NhdGlvbilcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gYnJvYWRjYXN0IGxvY2F0aW9uIGluZm9yKGxvbixsYXQpXG4gICAgICAgICAgICBzY29wZS4kZW1pdCgnbG9jJywgbG9jYXRpb24pO1xuXG4gICAgICAgICAgICB2YXIgZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTtcblxuICAgICAgICAgICAgLy8gYnJvYWRjYXN0IHBsYWNlIGZvcm1hdHRlZF9hZGRyZXNzIGFuZCBkcmF3IGljb25cbiAgICAgICAgICAgIGdlb2NvZGVyLmdlb2NvZGUoIHsgJ2xhdExuZyc6IGxvY2F0aW9uIH0sIGZ1bmN0aW9uKHJlc3VsdHMsIHN0YXR1cykge1xuICAgICAgICAgICAgICAgIC8vIGFzIHVzZXIgY2xpY2tzIG9uIHRoZSBtYXAsXG4gICAgICAgICAgICAgICAgLy8gd2UgaGF2ZSB0byBzYXZlIHRoZSBmb3JtYXR0ZWQgYWRkcmVzcyBpbiAkc2NvcGUgYW5kXG4gICAgICAgICAgICAgICAgLy8gaXQgd2lsbCBiZSB1c2VkIHRocm91Z2ggcG9zdHMuY3RybFxuICAgICAgICAgICAgICAgIC8vIGVtaXQgYnJvYWRjYXNlICdwbGFjZScgYW5kIHNlbmQgdGhpcyB0byBhcHBsaWNhdGlvbi5jdHJsXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYnJvYWRjYXN0IGZvcm1hdHRlZF9hZGRyZXNzXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdwbGFjZScsIHJlc3VsdHNbMV0uZm9ybWF0dGVkX2FkZHJlc3MpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2goZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgIHN3YWwoXCJcIixcIkxvY2F0aW9uIGRvZXMgbm90IGV4aXN0c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3BsYWNlJywgXCJMb2NhdGlvbiBkb2VzIG5vdCBleGlzdHNcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkcmF3QW5kU2V0UGxhY2UobG9jYXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRyYXdIZWxwZXJNYXJrZXIobG9jYXRpb24pO1xuICAgICAgICAgICAgc2V0UGxhY2UobG9jYXRpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcGxhY2UgYSBtYXJrZXIgYW5kIGluZm9XaW5kb3dcbiAgICAgICAgdmFyIG1hcmtlcnMgPSBbXTtcbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlTWFwKCkgeyAgIFxuICAgICAgICAgICAgUG9zdHNTdmMuZmV0Y2goKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocG9zdHMpe1xuXG4gICAgICAgICAgICAgICAgLy8gZHJhdyBsYXRlc3QgdXBkYXRlXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb3N0cy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwb3N0ID0gcG9zdHNbaV07XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIG1hcmtlcnMgcG9zdCBpcyBleGlzaXRpbmcgb25lLCB3ZSBkb24ndCB3YW50IHRvIGRyYXcgaXQgYWdhaW4uXG4gICAgICAgICAgICAgICAgICAgIC8vIG9ubHkgZHJhdyBuZXcgb25lcyFcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIG1hcmtlcjsgbWFya2VyID0gbWFya2Vyc1tqXTsgaisrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb3N0Ll9pZCA9PSBtYXJrZXIucG9zdC5faWQpXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdCA9IG51bGw7IC8vIOydtOuvuCDqt7jroKTsp4Qg7Y+s7Iqk7Yq4652866m0LCBudWxs66GcLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOyAvLyDsnbQgbG9vcOydgCBwb3N0Ll9pZOunjCDqsoDsgqzsmqnsnoTsnLzroZwsIOunjOyVvSDqsrnsuZjrqbQg67CU66GcIGxvb3DsnYQg66mI7Law64+EIOq0nOywruuLpC5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIHBvc3TqsIAg7JuQ656YIOyeiOyXh+uNmOqyg+ydtOuptCBwb3N06rCAIG51bGzroZwg7IWLIOuQmOyXiOydhOqyg+ydtOqzoCwgbG9jYXRpb27tlITroZztjbzti7Drj4Qg7J6I64qU7KeAIO2ZleyduO2VmOyekFxuICAgICAgICAgICAgICAgICAgICBpZiAoIXBvc3QgfHwgIXBvc3QuaGFzT3duUHJvcGVydHkoJ2xvY2F0aW9uJykpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsgLy8gc2tpcCB0aGlzIHBvc3QgLSBubyBuZWVkIHRvIGRyYXdcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb24gPSBhbmd1bGFyLmZyb21Kc29uKHBvc3QubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsb2NhdGlvbi5sYXQsIGxvY2F0aW9uLmxvbik7XG5cbiAgICAgICAgICAgICAgICAgICAgLyogY291cGxpbmcgc3RhdHVzXG4gICAgICAgICAgICAgICAgICAgICAgICAwIC0gbm8gc3RhdHVzXG4gICAgICAgICAgICAgICAgICAgICAgICAxIC0gaSBsaWtlIHlvdVxuICAgICAgICAgICAgICAgICAgICAgICAgMiAtIHlvdSBsaWtlIGlcbiAgICAgICAgICAgICAgICAgICAgICAgIDQgLSB3ZSBsaWtlIGVhY2ggb3RoZXJcbiAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyAoXCJzY29wZS5ndWlkdGd0OlwiLCBzY29wZS5ndWlkdGd0KTtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyAoXCJzY29wZS5ndWlkOlwiLCBzY29wZS5ndWlkKTtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyAoXCJwb3N0Lmd1aWR0Z3Q6XCIsIHBvc3QuZ3VpZHRndCk7XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cgKFwicG9zdC5ndWlkOlwiLCBwb3N0Lmd1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb3VwbGluZ19zdGF0dXMgPSAwO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaWxpa2V5b3UgPSBzY29wZS5ndWlkdGd0ID09IHBvc3QuZ3VpZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHlvdWxpa2VpID0gc2NvcGUuZ3VpZCA9PSBwb3N0Lmd1aWR0Z3Q7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbGlrZXlvdSAmJiB5b3VsaWtlaSkgLy8gNFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VwbGluZ19zdGF0dXMgPSA0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGlsaWtleW91ICYmICF5b3VsaWtlaSlcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY291cGxpbmdfc3RhdHVzID0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICghaWxpa2V5b3UgJiYgeW91bGlrZWkpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdXBsaW5nX3N0YXR1cyA9IDI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VwbGluZ19zdGF0dXMgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8g67CU7Jq0642U66asIOyViOyXkCDsnojripTsp4DrtoDthLAg7LK07YGs66W8IO2VmOyepSBcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoZ29vZ2xlTG9jLmxhdCgpIDwgY3VycmVudF9tYXBfbncubGF0KCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKGdvb2dsZUxvYy5sYXQoKSA+IGN1cnJlbnRfbWFwX3NlLmxhdCgpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIShnb29nbGVMb2MubG5nKCkgPCBjdXJyZW50X21hcF9zZS5sbmcoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEoZ29vZ2xlTG9jLmxuZygpID4gY3VycmVudF9tYXBfbncubG5nKCkpIClcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7IC8vIHNraXAgdGhpcyBwb3N0IC0gbm8gbmVlZCB0byBkcmF3XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIG1hcmtlciBvcHRpb24gc2V0dGluZ1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBnb29nbGVMb2MsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXA6IG1hcCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIkJ1YmJsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VQb3N0XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKG1hcmtlck9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gc2V0IHVwIHNlbGYgcmVtb3ZlIGZvciBtYXJrZXIgaXRzZWxmIGFuZCBmcm9tIG1hcmtlcnMgY29sbGVjdGlvbiBhdCBmcm9udC1lbmRcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChcbiAgICAgICAgICAgICAgICAgICAgICAgIChmdW5jdGlvbihvbGRfbWFya2VyLCBvbGRfcG9zdCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZF9tYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMCwgbWFya2VyOyBtYXJrZXIgPSBtYXJrZXJzW2tdOyBrKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9sZF9wb3N0Ll9pZCA9PSBtYXJrZXIucG9zdC5faWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2Vycy5zcGxpY2UoaywgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0obWFya2VyLCBwb3N0KSksIFxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zdC5saWZlc3Bhbik7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBhZGQgbWFya2VyIHRvIGFycmF5LCB0aGlzIG1lYW5zIHRoYXQgaXQgaGFzIGJlZW4gZHJhd24gdG8gbWFwXG4gICAgICAgICAgICAgICAgICAgIG1hcmtlcnMucHVzaChcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXI6IG1hcmtlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0ICA6IHBvc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRFJBV0lORyBNRVNTQUdFIFdJTkRPVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gJzxkaXYgaWQ9XCJidWJibGVQb3N0XCI+JyArIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0LmJvZHkgKyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvZGl2PjxkaXYgaWQ9XCJidWJibGVMaWZlQmFyXCI+PC9kaXY+JztcbiAgICAgICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgICAgICAvLyDsiqTsvZTtlITsl5DshJzrtoDthLAg7IOI66Gc7Jq0IOywqOydvOuTnCDsiqTsvZTtlITrpbwg66eM65Ok7Ja0IGVhY2ggZm9yIGxvb3Dsl5DshJwg7IKs7Jqp7ZWc64ukLlxuICAgICAgICAgICAgICAgICAgICAvLyAtLT4g7ZW07JW8LCDqsIEgRE9N7J20IOqwgeqwgeydmCBzY29wZeulvCDqsIDsoLjshJwgcG9zdCBtc2fqsIAg7JWIIOqyuey5nOuLpC5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHNjb3BlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSBwYXJlbnQuJG5ldyh0cnVlKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgb3BlbkluZm9XaW5kb3cgPSAoZnVuY3Rpb24obWFya2VyLCBjaGlsZF9zY29wZSwgcG9zdCwgY291cGxpbmdfc3RhdHVzKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY3JlYXRlIG5ldyB3aW5kb3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5mb1dpbmRvd09wdGlvbnMgPSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaXhlbE9mZnNldDogbmV3IGdvb2dsZS5tYXBzLlNpemUoLTQxLjUsIDEwLjApLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmZvV2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coaW5mb1dpbmRvd09wdGlvbnMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29tcGlsZSBpdCBiZWZvcmUgbG9hZGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSAnPGRpdiBtYXAtbXNnPjwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXBpbGVkID0gJGNvbXBpbGUoY29udGVudCkoY2hpbGRfc2NvcGUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy90byBtYWtlIGRhdGEgYXZhaWxhYmxlIHRvIHRlbXBsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUubXNnID0gcG9zdC5ib2R5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3RsaWZlID0gcG9zdC5saWZlc3BhbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Z3VpZCA9IHBvc3QuZ3VpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Z3VpZHRndCA9IHBvc3QuZ3VpZHRndDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Y291cGxlc3RhdHVzID0gY291cGxpbmdfc3RhdHVzO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjb3VwbGluZ19zdGF0dXNcIiwgY2hpbGRfc2NvcGUucG9zdGNvdXBsZXN0YXR1cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZy5kaXJlY3RpdmXsl5DshJwg7ZWY64qUIOqzvOygleydhCDsl6zquLDshJzrj4Qg7ZWg7IiYIOyeiOuLpC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihpbmZvV2luZG93LCAnZG9tcmVhZHknLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJ2RpdiBkaXYgLnBvc3RsaWZlYmFyJykuY3NzKFwiYW5pbWF0aW9uLWR1cmF0aW9uXCIsIHBvc3QubGlmZXNwYW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJKcXVlcnkgY2FsbGVkIDpcIiArICBwb3N0LmxpZmVzcGFuICsgXCIgYW5kIG1zZzpcIiArIHBvc3QuYm9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnZGl2ICNidWJibGVQb3N0JykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic2VuZGluZyAkZW1pdCAtIHNldF9ndWlkdGd0XCIsIHBvc3QuZ3VpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0X2d1aWR0Z3QnLCBwb3N0Lmd1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93LnNldENvbnRlbnQoIGNvbXBpbGVkWzBdICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5vcGVuKG1hcCAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9KShtYXJrZXIsIGNoaWxkLCBwb3N0LCBjb3VwbGluZ19zdGF0dXMpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgb3BlbkluZm9XaW5kb3coKTtcbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBFTkQgb2YgRFJBV0lORyBNRVNTQUdFIFdJTkRPVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgICAgICAgICB9IC8vIGVuZCBvZiBmb3ItbG9vcFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRNb3ZlVG9DdXJyTG9jQnRuKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGN1cnJMb2NCdG4gPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1jdXJyJykpOyBcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uVE9QX1JJR0hUXS5wdXNoKGN1cnJMb2NCdG4pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0UG9zdEZvcm0oKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgcG9zdEZvcm0gPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bvc3RpbmcnKSk7IFxuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5CT1RUT01fQ0VOVEVSXS5wdXNoKHBvc3RGb3JtKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldFBvc3RCdG4oKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgcG9zdEJ0biA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuLXN1Ym1pdCcpKTtcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uQk9UVE9NX0NFTlRFUl0ucHVzaChwb3N0QnRuKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldFNlYXJjaEJveCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgc2VhcmNoIGJveCBhbmQgbGluayBpdCB0byB0aGUgVUkgZWxlbWVudC5cbiAgICAgICAgICAgIHZhciBpbnB1dCA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFjLWlucHV0JykpOyAvLyBAdHlwZSB7SFRNTElucHV0RWxlbWVudH0gIFxuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5UT1BfTEVGVF0ucHVzaChpbnB1dCk7XG5cbiAgICAgICAgICAgIHZhciBzZWFyY2hCb3ggPSBuZXcgZ29vZ2xlLm1hcHMucGxhY2VzLlNlYXJjaEJveCgoaW5wdXQpKTsgLy8gQHR5cGUge0hUTUxJbnB1dEVsZW1lbnR9IFxuXG4gICAgICAgICAgICAvLyBMaXN0ZW4gZm9yIHRoZSBldmVudCBmaXJlZCB3aGVuIHRoZSB1c2VyIHNlbGVjdHMgYW4gaXRlbSBmcm9tIHRoZVxuICAgICAgICAgICAgLy8gcGljayBsaXN0LiBSZXRyaWV2ZSB0aGUgbWF0Y2hpbmcgcGxhY2VzIGZvciB0aGF0IGl0ZW0uXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihzZWFyY2hCb3gsICdwbGFjZXNfY2hhbmdlZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBwbGFjZXMgPSBzZWFyY2hCb3guZ2V0UGxhY2VzKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAocGxhY2VzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gdGFrZSBvbmx5IDEgc3BvdFxuICAgICAgICAgICAgICAgIHZhciBwbGFjZSA9IHBsYWNlc1swXTtcblxuICAgICAgICAgICAgICAgIC8vIHdoZW4gc2VhcmNoIGhhcHBlbnMsIGxvY2F0aW9uIHdpbGwgYmUgdXBkYXRlZCBhcyB3ZWxsIGZvciBwb3N0XG4gICAgICAgICAgICAgICAgLy8gc2NvcGUuJGVtaXQoJ3BsYWNlJywgcGxhY2UuZm9ybWF0dGVkX2FkZHJlc3MpO1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbik7XG5cbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gcGxhY2UuZ2VvbWV0cnkubG9jYXRpb24ubGF0aXR1ZGU7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUgPSBwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sb25naXR1ZGU7XG5cbiAgICAgICAgICAgICAgICBtYXAucGFuVG8ocGxhY2UuZ2VvbWV0cnkubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgIG1hcC5zZXRab29tKDE2KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0Q2xpY2tNYXAoKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBjbGljayBldmVudCBvbiBtYXAgdG8gZHJhdyBtYXJrZXJcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBkcmF3QW5kU2V0UGxhY2UoZXZlbnQubGF0TG5nKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0TW92ZVRvQ3VycmVudExvY2F0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gbW92aW5nIHRvIGEgcG9zdCdzIGxvY2F0aW9uIGFuZCBkcmF3IGEgbWFya2VyIHRoZXJlXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICdoZWFkaW5nX2NoYW5nZWQnLCBmdW5jdGlvbihsb2NhdGlvbikge1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShsb2NhdGlvbik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldENlbnRlckNoYW5nZWQoKVxuICAgICAgICB7XG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICdjZW50ZXJfY2hhbmdlZCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sYXRpdHVkZSA9IG1hcC5nZXRDZW50ZXIoKS5sYXQoKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSA9IG1hcC5nZXRDZW50ZXIoKS5sbmcoKTtcblxuICAgICAgICAgICAgICAgIHVwZGF0ZUJvdW5kcygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldE1hcERyYWdFbmQoKVxuICAgICAgICB7XG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICdkcmFnZW5kJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICB1cGRhdGVNYXAoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVCb3VuZHMoKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgYm91bmRzID0gbWFwLmdldEJvdW5kcygpO1xuICAgICAgICAgICAgdmFyIG5lID0gYm91bmRzLmdldE5vcnRoRWFzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIG5vcnRoLWVhc3QgY29ybmVyXG4gICAgICAgICAgICB2YXIgc3cgPSBib3VuZHMuZ2V0U291dGhXZXN0KCk7IC8vIExhdExuZyBvZiB0aGUgc291dGgtd2VzdCBjb3JkZXJcbiAgICAgICAgICAgIC8vWW91IGdldCBub3J0aC13ZXN0IGFuZCBzb3V0aC1lYXN0IGNvcm5lcnMgZnJvbSB0aGUgdHdvIGFib3ZlOlxuXG4gICAgICAgICAgICBjdXJyZW50X21hcF9udyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobmUubGF0KCksIHN3LmxuZygpKTtcbiAgICAgICAgICAgIGN1cnJlbnRfbWFwX3NlID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhzdy5sYXQoKSwgbmUubG5nKCkpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBmdW5jdGlvbiBzZXRMb2FkUG9zdE1hcmtlcnMoKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBtYW51YWxseSByZWxvYWQgbWFya2VycyAvIFJFRlJFU0hcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ21hcHR5cGVpZF9jaGFuZ2VkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlSGVscGVyTWFya2VyKCk7XG4gICAgICAgICAgICAgICAgdXBkYXRlTWFwKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGluaXQgdGhlIG1hcFxuICAgICAgICBmdW5jdGlvbiBpbml0TWFwKCkge1xuICAgICAgICAgICAgaWYgKG1hcCA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICAgICAgbWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChlbGVtZW50WzBdLCBtYXBPcHRpb25zKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc2V0TG9hZFBvc3RNYXJrZXJzKCk7XG5cbiAgICAgICAgICAgIC8vIGJyb2FkY2FzdCB0byBzZW5kIG1hcCB0byBhcHBsaWNhdGlvbiBjdHJsXG4gICAgICAgICAgICBzY29wZS4kZW1pdCgnbWFwSW5pdCcsIG1hcCk7XG5cbiAgICAgICAgICAgIHNldENsaWNrTWFwKCk7XG5cbiAgICAgICAgICAgIHNldFNlYXJjaEJveCgpO1xuXG4gICAgICAgICAgICBzZXRNb3ZlVG9DdXJyTG9jQnRuKCk7XG5cbiAgICAgICAgICAgIHNldFBvc3RGb3JtKCk7XG5cbiAgICAgICAgICAgIHNldFBvc3RCdG4oKTtcblxuICAgICAgICAgICAgc2V0Q2VudGVyQ2hhbmdlZCgpO1xuXG4gICAgICAgICAgICBzZXRNb3ZlVG9DdXJyZW50TG9jYXRpb24oKTtcblxuICAgICAgICAgICAgc2V0TWFwRHJhZ0VuZCgpO1xuXG4gICAgICAgICAgICB1cGRhdGVNYXAoKTtcblxuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICB1cGRhdGVCb3VuZHMoKTtcbiAgICAgICAgICAgIH0sIDgwMCk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSBcblxuICAgICAgICBpbml0TWFwKCk7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgaWQ9XCJtYXAtY2FudmFzXCI+PC9kaXY+JyxcbiAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgbGluazogbGlua1xuICAgIH07XG59KTtcblxuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5kaXJlY3RpdmUoJ21hcE1zZycsIGZ1bmN0aW9uICgkdGltZW91dCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgdGVtcGxhdGVVcmw6ICcuL3RlbXBsYXRlcy93aW5kb3cuaHRtbCcsXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGF0dHJzKSB7ICAgICAgICBcbiAgICAgICAgdmFyIGR1cmF0aW9uID0gc2NvcGUucG9zdGxpZmUgKyBcIm1zXCI7XG4gICAgICAgIHZhciBwb3N0Z3VpZCA9IHNjb3BlLnBvc3RndWlkO1xuICAgICAgICB2YXIgbXNnID0gc2NvcGUubXNnO1xuXG4gICAgICAgIC8qIGNvdXBsaW5nIHN0YXR1c1xuICAgICAgICAgIDAgLSBubyBzdGF0dXNcbiAgICAgICAgICAxIC0gaSBsaWtlIHlvdVxuICAgICAgICAgIDIgLSB5b3UgbGlrZSBpXG4gICAgICAgICAgNCAtIHdlIGxpa2UgZWFjaCBvdGhlclxuICAgICAgICAqL1xuICAgICAgICBzY29wZS5nZXRfY291cGxpbmcgPSBmdW5jdGlvbihjb3VwbGluZ19zdGF0dXMpe1xuICAgICAgICAgIGlmIChjb3VwbGluZ19zdGF0dXMgPT0gNCl7XG4gICAgICAgICAgICByZXR1cm4gXCJidWJibGVQb3N0IGJ1YmJsZVBvc3RfY291cGxlXCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKGNvdXBsaW5nX3N0YXR1cyA9PSAxKXtcbiAgICAgICAgICAgIHJldHVybiBcImJ1YmJsZVBvc3QgYnViYmxlUG9zdF9pbGlrZXlvdVwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmIChjb3VwbGluZ19zdGF0dXMgPT0gMil7XG4gICAgICAgICAgICByZXR1cm4gXCJidWJibGVQb3N0IGJ1YmJsZVBvc3RfeW91bGlrZWlcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gXCJidWJibGVQb3N0IGJ1YmJsZVBvc3Rfbm9uZVwiO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBhcyB0ZW1wbGF0ZVVybCBET00gaXMgbG9hZGVkLCB0aGlzIGZ1bmN0aW9uIHdpbGwgZ2V0IGNhbGxlZC5cbiAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcbiAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgJCgnZGl2IGRpdiAucG9zdGxpZmViYXInKS5jc3MoXCJhbmltYXRpb24tZHVyYXRpb25cIiwgZHVyYXRpb24pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJKcXVlcnkgY2FsbGVkIDpcIiArICBkdXJhdGlvbiArIFwiIGFuZCBtc2c6XCIgKyBtc2cpO1xuXG4gICAgICAgICAgICAkKCdkaXYgZGl2ICNidWJibGVDbGljaycpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgIGlmIChwb3N0Z3VpZCA9PSBzY29wZS5ndWlkKXtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlwiKVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgc2NvcGUucG9zdGNvdXBsZXN0YXR1cyA9IDE7IC8vIDEtIGlsaWtleW91XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlbWl0IHNldDpndWlkdGd0JywgcG9zdGd1aWQpO1xuICAgICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0Omd1aWR0Z3QnLCBwb3N0Z3VpZCk7XG4gICAgICAgICAgICB9KTsgICAgXG4gICAgICAgICAgfSwgMik7ICAgIFxuICAgICAgICB9KTtcbiAgICB9LFxuICB9XG59KTtcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyLmNvbnRyb2xsZXIoJ1Bvc3RzQ3RybCcsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkc2NvcGUsIFBvc3RzU3ZjLCAkd2luZG93LCAkZG9jdW1lbnQpe1xyXHJcdC8qIGVtaXQgYnJvYWRjYXN0IGZvciBjdXJyZW50IHBhZ2VJZCAqL1xyXHQkc2NvcGUuJGVtaXQoJ3BhZ2VjaGFuZ2UnLCAkc2NvcGUucGFnZUlkLnBvc3QpO1xyXHJcdCRzY29wZS5wb3N0cyA9IFtdO1xyXHIvKiDqsJXslYTsp4AgR0VU65WMIO2VhOyalO2WiOyXh+ydjC5cclx0JHNjb3BlLiRvbigncmVmZXRjaCcsIGZ1bmN0aW9uKF8sIG9iail7XHJcdFx0JHNjb3BlLnJlcXVlc3RGZXRjaCgpO1xyXHR9KTtcciovXHJcdFxyXHQvKiBhcyBzZXJ2ZXIgdGVsbHMgdGhlcmUgd2FzIG5ldyBwb3N0LCBsZXRzIHJlLWxvYWQgbGlzdCBkYXRhICovXHJcdCRzY29wZS4kb24oJ3dzOm5ld19wb3N0JywgZnVuY3Rpb24oXywgcG9zdCl7XHJcdFx0JHNjb3BlLnJlcXVlc3RGZXRjaCgpO1xyXHR9KTtcclxyXHQvKiBtb3ZlIHRvIHBvc3QncyBsb2NhdGlvbiAqL1xyXHQkc2NvcGUubW92ZVRvTG9jID0gZnVuY3Rpb24oaWQpe1xyXHRcdHZhciBwb3N0ID0gKCRzY29wZS5wb3N0c1tpZF0pO1xyXHJcdFx0dmFyIGxvY2F0aW9uID0gYW5ndWxhci5mcm9tSnNvbihwb3N0LmxvY2F0aW9uKTtcclx0XHR2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsb2NhdGlvbi5sYXQsIGxvY2F0aW9uLmxvbik7XHJcclx0XHQkc2NvcGUubWFwLnBhblRvKGdvb2dsZUxvYyk7XHJcdFx0JHNjb3BlLm1hcC5zZXRab29tKDE2KTtcclxyXHRcdC8qIHVzaW5nIGFuZ3VsYXItc2Nyb2xsIHRvIG1vdmUgdG8gdGhlIHRvcCBzbW9vdGhseSAqL1xyXHRcdHZhciB0b3AgPSAwO1xyICAgIFx0dmFyIGR1cmF0aW9uID0gNDgwO1xyICAgIFx0JGRvY3VtZW50LnNjcm9sbFRvcCh0b3AsIGR1cmF0aW9uKS50aGVuKGZ1bmN0aW9uKCkge1xyICAgICBcdFx0IGNvbnNvbGUgJiYgY29uc29sZS5sb2coJ1lvdSBqdXN0IHNjcm9sbGVkIHRvIHRoZSB0b3AhJyk7XHIgICAgXHR9KTtcclxyXHR9O1xyXHJcdCRzY29wZS5hZGRQb3N0ID0gZnVuY3Rpb24oKSB7XHJcdFx0LyogZ2V0IGF1dG9jb21wbGV0ZWQgcGxhY2UgYW5kIHJlc2V0KHNldCB0byB1bmRlZmluZWQpICovXHJcdFx0dmFyIHBsYWNlID0gJHNjb3BlLnBvc3RwbGFjZTtcclx0XHR2YXIgbG9jYXRpb24gPSAkc2NvcGUucG9zdExvY2F0aW9uO1xyXHJcdFx0dmFyIGxvY2F0aW9uSlNPTiA9IEpTT04uc3RyaW5naWZ5KGxvY2F0aW9uKTtcclxyXHRcdGNvbnNvbGUubG9nKFwiUE9TVCBsb2NhdGlvbjpcIiwgbG9jYXRpb25KU09OKTtcclx0XHRjb25zb2xlLmxvZyhcIlBPU1QgcGxhY2U6XCIsIHBsYWNlKTtcclx0XHRjb25zb2xlLmxvZyhcIlBPU1QgZ3VpZDpcIiwgJHNjb3BlLmd1aWQpO1xyXHRcdGNvbnNvbGUubG9nKFwiUE9TVCBndWlkdGd0OlwiLCAkc2NvcGUuZ3VpZHRndCk7XHJcclx0XHRQb3N0c1N2Yy5jcmVhdGUoXHJcdFx0e1xyXHRcdFx0Ym9keSAgICA6ICAkc2NvcGUuY29udGVudCxcclx0XHRcdGxvY2F0aW9uOiAgbG9jYXRpb25KU09OLFxyXHRcdFx0cGxhY2UgICA6ICBwbGFjZSxcclx0XHRcdGd1aWQgICAgOiAgJHNjb3BlLmd1aWQsXHJcdFx0XHRndWlkdGd0IDogICRzY29wZS5ndWlkdGd0XHJcdFx0fSlcclx0XHQuc3VjY2VzcyhmdW5jdGlvbihwb3N0KXtcclx0XHRcdC8qIG1hbnVhbGx5IHJlbG9hZCBtYXJrZXJzIFxyXHRcdFx0dXNpbmcgbWFwdHlwZWlkIHNpbmNlIGl0cyBtb3N0IGxlYXN0IHVzZWQgZXZlbnQsIC0ga2luZCBvZiBoYWNreSB3YXkgdG8gZG8gaXRcclx0XHRcdCovXHJcdFx0XHRnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKCRzY29wZS5tYXAsICdtYXB0eXBlaWRfY2hhbmdlZCcpO1xyXHJcdFx0XHQkc2NvcGUucG9zdHMudW5zaGlmdChwb3N0KTtcclxyXHRcdFx0LyogZnJvbnQgZW5kIHNpZGUgbGlzdCBwb3N0IHJlbW92ZSAqL1xyXHRcdFx0dmFyIGZyb250RW5kUG9zdFJlbW92ZSA9IGZ1bmN0aW9uKCl7IFxyXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8ICRzY29wZS5wb3N0cy5sZW5ndGg7ICsraSl7XHJcdFx0XHRcdGlmIChwb3N0Ll9pZCA9PSAkc2NvcGUucG9zdHNbaV0uX2lkKVxyXHRcdFx0XHRcdCRzY29wZS5wb3N0cy5zcGxpY2UoaSwgMSk7XHJcdFx0XHRcdH1cclx0XHRcdH07XHJcdFx0XHRzZXRUaW1lb3V0KGZyb250RW5kUG9zdFJlbW92ZSwgcG9zdC5saWZlc3Bhbik7XHJcclx0XHRcdC8qIHJlc2V0IGlucHV0IGZvcm1zICovXHJcdFx0XHQkc2NvcGUuY29udGVudCAgPSBudWxsO1xyXHRcdH0pXHJcdFx0LmVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cyl7XHJcdFx0XHRzd2FsKFwiUG9zdCBmYWlsZWRcIiwgXCJQbGVhc2UgY29tcGxldGUgdGhlIGZyb20gY29ycmVjdGx5XCIsIFwiZXJyb3JcIik7XHJcdFx0fSk7XHJcclx0fTtcclxyXHQvKiBhcyBzZXJ2ZXIgdGVsbHMgdGhlcmUgd2FzIG5ldyBwb3N0LCBsZXRzIHJlLWxvYWQgbGlzdCBkYXRhICovXHJcdCRzY29wZS5yZXF1ZXN0RmV0Y2ggPSBmdW5jdGlvbigpIHtcclx0XHRQb3N0c1N2Yy5mZXRjaCgpXHJcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24ocG9zdHMpe1xyXHRcdFx0JHNjb3BlLnBvc3RzID0gcG9zdHM7XHJcdFx0fSk7XHJcdH07XHJcclx0JHNjb3BlLnJlcXVlc3RGZXRjaCgpO1xyfSk7XHJcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1Bvc3RzU3ZjJywgZnVuY3Rpb24oJGh0dHApe1xuXHR0aGlzLmZldGNoID0gZnVuY3Rpb24oKXtcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJyk7XG5cdH07XG5cblx0dGhpcy5jcmVhdGUgPSBmdW5jdGlvbihwb3N0KXtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHBvc3QpO1xuXHR9O1xuXG5cdHRoaXMucmVtb3ZlID0gZnVuY3Rpb24ocG9zdCl7XG5cdFx0Y29uc29sZS5sb2coXCJkZWxldGluZyBwb3N0aW5nXCIpO1xuXHRcdGNvbnNvbGUubG9nKCdwb3N0Ll9pZDonLCBwb3N0Ll9pZCk7XG5cdFx0cmV0dXJuICRodHRwLnB1dCgnL2FwaS9wb3N0cycsIHBvc3QpO1xuXHR9O1xufSk7XG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5ydW4oZnVuY3Rpb24oJHJvb3RTY29wZSwgJHRpbWVvdXQpe1xuXG5cdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0dmFyIHVybDtcblxuXHR2YXIgaG9zdG5hbWUgPSBkb2N1bWVudC5sb2NhdGlvbi5ob3N0bmFtZTtcblx0dmFyIGRldmVsb3BtZW50SVAgPSBcIjE5Mi4xNjguMC40XCI7XG5cblx0aWYgKGhvc3RuYW1lID09IFwibG9jYWxob3N0XCIpe1xuXHRcdHVybCA9IFwid3M6Ly9sb2NhbGhvc3Q6NTAwMFwiO1xuXHR9XG5cdGVsc2UgaWYgKGhvc3RuYW1lID09IGRldmVsb3BtZW50SVApIHtcblx0XHR1cmwgPSAnd3M6Ly8xOTIuMTY4LjAuNDo1MDAwJzsgLy8gZGV2ZWxvcG1ldCBvbiBzb2NrZXQgbG9jYWxseSBcblx0fVxuXHRlbHNlIHtcblx0XHR1cmwgPSAnd3NzOi8vZnJvemVuLWJhZGxhbmRzLTg2NDkuaGVyb2t1YXBwLmNvbSc7IC8vIHByb2R1Y3Rpb24gZGVwbG95IHZlcnNpb24gLSBzdGlsbCBkZWJ1ZyBtb2RlXG5cdH1cblxuXHQvKiDqsJzrsJzqs7zsoJXsnbQg64Gd64KY6rOgIOuwsO2PrOyLnOyXkOuKlCDsnITrtoDrtoTsnYQg7KeA7Jqw6rOgIOyVhOuemCDsvZTrk5zrp4wg64Ko6rKo64+EIOuQnOuLpC5cblx0dXJsID0gJ3dzczovL2Zyb3plbi1iYWRsYW5kcy04NjQ5Lmhlcm9rdWFwcC5jb20nO1xuXHQqL1xuXG5cdHZhciBjb25uZWN0ID0gZnVuY3Rpb24oKSB7XG5cdFx0Y29ubmVjdGlvbiA9IG5ldyBXZWJTb2NrZXQodXJsKTtcblxuXHRcdGNvbm5lY3Rpb24ub25vcGVuID0gZnVuY3Rpb24oKXtcblx0XHRcdGNvbnNvbGUubG9nKCdXZWJTb2NrZXQgY29ubmVjdGVkJyk7XG5cdFx0fTtcblxuXHRcdGNvbm5lY3Rpb24ub25jbG9zZSA9IGZ1bmN0aW9uKCl7XG5cdFx0XHRjb25zb2xlLmxvZygnV2ViU29ja2V0IGNsb3NlZC4gUmVjb25lY3RpbmcuLi4nKTtcblx0XHRcdCR0aW1lb3V0KGNvbm5lY3QsIDIwMDApO1xuXHRcdH07XG5cblx0XHRjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGUpe1xuXHRcdFx0Y29uc29sZS5sb2coZSk7XG5cdFx0XHR2YXIgcGF5bG9hZCA9IEpTT04ucGFyc2UoZS5kYXRhKTtcblxuXHRcdFx0Ly8g7IOI66Gc7Jq0IO2PrOyKpO2KuOqwgCDsmKzrnbzsmZTsnYTrlYwgZnJvbnQtZW5k7JeQ7IScIOunteydtCDri6Tsi5wg7JeF642w7J207Yq4IO2VtOyVvCDrkJzri6Tqs6Ag7JWM66Ck7KSA64ukIVxuXHRcdFx0Ly8g66ek7Jqw7KSR7JqUIVxuXHRcdFx0JHJvb3RTY29wZS4kYnJvYWRjYXN0KCd3czonICsgcGF5bG9hZC50eXBlLCBwYXlsb2FkLmRhdGEpO1xuXHRcdH07XG5cdH07XG5cblx0Y29ubmVjdCgpO1xufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4ucnVuKGZ1bmN0aW9uKCRyb290U2NvcGUsICR0aW1lb3V0KXtcblxuXHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdHZhciB1cmw7XG5cblx0dmFyIGhvc3RuYW1lID0gZG9jdW1lbnQubG9jYXRpb24uaG9zdG5hbWU7XG5cdHZhciBkZXZlbG9wbWVudElQID0gXCIxOTIuMTY4LjAuNFwiO1xuXG5cdGlmIChob3N0bmFtZSA9PSBcImxvY2FsaG9zdFwiKXtcblx0XHR1cmwgPSBcIndzOi8vbG9jYWxob3N0OjUwMDBcIjtcblx0fVxuXHRlbHNlIGlmIChob3N0bmFtZSA9PSBkZXZlbG9wbWVudElQKSB7XG5cdFx0dXJsID0gJ3dzOi8vMTkyLjE2OC4wLjQ6NTAwMCc7IC8vIGRldmVsb3BtZXQgb24gc29ja2V0IGxvY2FsbHkgXG5cdH1cblx0ZWxzZSB7XG5cdFx0dXJsID0gJ3dzczovL2Zyb3plbi1iYWRsYW5kcy04NjQ5Lmhlcm9rdWFwcC5jb20nOyAvLyBwcm9kdWN0aW9uIGRlcGxveSB2ZXJzaW9uIC0gc3RpbGwgZGVidWcgbW9kZVxuXHR9XG5cblx0Lyog6rCc67Cc6rO87KCV7J20IOuBneuCmOqzoCDrsLDtj6zsi5zsl5DripQg7JyE67aA67aE7J2EIOyngOyasOqzoCDslYTrnpgg7L2U65Oc66eMIOuCqOqyqOuPhCDrkJzri6QuXG5cdHVybCA9ICd3c3M6Ly9mcm96ZW4tYmFkbGFuZHMtODY0OS5oZXJva3VhcHAuY29tJztcblx0Ki9cblxuXHR2YXIgY29ubmVjdCA9IGZ1bmN0aW9uKCkge1xuXHRcdGNvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0KHVybCk7XG5cblx0XHRjb25uZWN0aW9uLm9ub3BlbiA9IGZ1bmN0aW9uKCl7XG5cdFx0XHRjb25zb2xlLmxvZygnV2ViU29ja2V0IGNvbm5lY3RlZCcpO1xuXHRcdH07XG5cblx0XHRjb25uZWN0aW9uLm9uY2xvc2UgPSBmdW5jdGlvbigpe1xuXHRcdFx0Y29uc29sZS5sb2coJ1dlYlNvY2tldCBjbG9zZWQuIFJlY29uZWN0aW5nLi4uJyk7XG5cdFx0XHQkdGltZW91dChjb25uZWN0LCAyMDAwKTtcblx0XHR9O1xuXG5cdFx0Y29ubmVjdGlvbi5vbm1lc3NhZ2UgPSBmdW5jdGlvbihlKXtcblx0XHRcdGNvbnNvbGUubG9nKGUpO1xuXHRcdFx0dmFyIHBheWxvYWQgPSBKU09OLnBhcnNlKGUuZGF0YSk7XG5cblx0XHRcdC8vIOyDiOuhnOyatCDtj6zsiqTtirjqsIAg7Jis65287JmU7J2E65WMIGZyb250LWVuZOyXkOyEnCDrp7XsnbQg64uk7IucIOyXheuNsOydtO2KuCDtlbTslbwg65Cc64uk6rOgIOyVjOugpOykgOuLpCFcblx0XHRcdC8vIOunpOyasOykkeyalCFcblx0XHRcdCRyb290U2NvcGUuJGJyb2FkY2FzdCgnd3M6JyArIHBheWxvYWQudHlwZSwgcGF5bG9hZC5kYXRhKTtcblx0XHR9O1xuXHR9O1xuXG5cdGNvbm5lY3QoKTtcbn0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==