angular.module("app",["ngRoute","ngAnimate","ui.slider","720kb.socialshare"]),angular.module("app").controller("ApplicationCtrl",["SessionSvc","UtilSvc","ConfigSvc","$rootScope","$scope","$window","$http","$timeout",function(e,t,n,o,i,a,s,l){function r(t){var n=t.coords,o=new google.maps.LatLng(n.latitude,n.longitude);i.map.drawUserLocationMarker(o),e.updateCurrentLocation(n.latitude,n.longitude,i.guid)}window.onbeforeunload=function(t){e.updateOnlinestat(!1,i.guid).success(function(e){})["catch"](function(e){})},window.onpageshow=function(t){i.initSession(),e.updateOnlinestat(!0,i.guid),i.map&&l(function(){i.map.updateAndDrawPosts()})},window.onpagehide=function(t){e.updateOnlinestat(!1,i.guid).success(function(e){})["catch"](function(e){})},document.addEventListener("visibilitychange",function(){"visible"==document.visibilityState||"mozVisible"==document.visibilityState||"msVisible"==document.visibilityState||"webkitVisible"==document.visibilityState?(e.updateOnlinestat(!0,i.guid),i.initSession(),i.map&&i.map.updateAndDrawPosts()):("hidden"==document.visibilityState||"mozHidden"==document.visibilityState||"msHidden"==document.visibilityState||"webkitHidden"==document.visibilityState)&&e.updateOnlinestat(!1,i.guid).success(function(e){})["catch"](function(e){})}),document.addEventListener("webkitvisibilitychange",function(){document.webkitVisible?(e.updateOnlinestat(!0,i.guid),i.initSession(),i.map&&i.map.updateAndDrawPosts()):document.webkitHidden&&e.updateOnlinestat(!1,i.guid).success(function(e){})["catch"](function(e){})},!1),i.setWatchLocation=function(){navigator.geolocation.watchPosition(r)},i.initSession=function(){function t(t){var n=t.coords,o=new google.maps.LatLng(n.latitude,n.longitude);i.userLocation={lat:n.latitude,lon:n.longitude};var a={lat:o.lat(),lon:o.lng()},s=JSON.stringify(a),l=i.map.getBounds(),r=l.getNorthEast(),c=l.getSouthWest(),g={lat:r.lat(),lon:c.lng()},u={lat:c.lat(),lon:r.lng()},p={lat:window.localStorage.latitude,lon:window.localStorage.longitude},m={nw_lat:g.lat,nw_lon:g.lon,se_lat:u.lat,se_lon:u.lon,center_lat:p.lat,center_lon:p.lon},d=JSON.stringify(m),f={guidtgt:i.guidtgt,guid:i.guid,location:s,watchloc:d};e.enter(f).success(function(t){e.updateOnlinestat(!0,i.guid)})["catch"](function(e){})}function n(e){swal("","Need to turn on location service for proper use.")}if("undefined"!=i.map&&"null"!=i.map&&i.map){var o={enableHighAccuracy:!1,timeout:1e4,maximumAge:3e4};navigator.geolocation.getCurrentPosition(t,n,o),swal({title:"",text:"Retreiving currnet location..",timer:1200,showConfirmButton:!1})}},"undefined"!=window.localStorage.guid&&"null"!=window.localStorage.guid&&window.localStorage.guid||(window.localStorage.guid=t.getGuid()),i.guid=window.localStorage.guid,"undefined"!=window.localStorage.guidtgt&&"null"!=window.localStorage.guidtgt&&window.localStorage.guidtgt||(window.localStorage.guidtgt="0"),i.guidtgt=window.localStorage.guidtgt,i.pageId={post:0},i.navCollapsed=!0,i.timevalue=n.maxInstantLifeSpan,i.userLocation={lat:0,lon:0},i.toggleSearchLocation=!1,i.toggleTimeSlider=!1,l(function(){document.getElementById("map-posting").onkeypress=function(e){"13"==e.which&&$("form#map-posting-form").submit()},document.getElementById("map-posting").onfocus=function(e){i.toggleTimeSlider=!0},document.getElementById("map-posting").onblur=function(e){i.toggleTimeSlider=!1},$(".nav-burger").click(function(){$(".nav-burger").toggleClass("active"),i.toggleSearchLocation=!i.toggleSearchLocation,i.$apply()})});var c,g=document.location.hostname;c=g==n.local?n.web_socket+n.local+":"+n.port:g==n.local_ip?n.web_socket+n.local_ip+":"+n.port:n.web_socket+n.deploy_dns;var u=function(){connection=new WebSocket(c),connection.onopen=function(){connection.send(i.guid)},connection.onclose=function(){l(u,2e3)},connection.onmessage=function(e){var t=JSON.parse(e.data);o.$broadcast("ws:"+t.type,t.data)}};u(),i.$on("ws:new_post",function(e,t){i.map.updateAndDrawPosts(),t.guid==i.guid&&i.map.drawResponses(t)}),i.$on("ws:new_session",function(e,t){if(t.guid!=i.guid){var n=angular.fromJson(t.location);i.map.drawCurrLocationMarker(n)}}),i.$on("ws:remove_post",function(e,t){i.map.unDrawPost(t)}),i.$on("ws:update_guidtgt",function(e,t){i.map.updateAndDrawPosts()}),i.isInstant=function(e){return e<=n.maxInstantLifeSpan?!0:!1},i.isMobile=function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?!0:!1},i.moveToCurrentLocation=function(){function e(e){if(i.currentPageId==i.pageId.post){var t=e.coords;window.localStorage.latitude=t.latitude,window.localStorage.longitude=t.longitude;var n={lat:t.latitude,lon:t.longitude};i.map.drawXMarker(n);var o=new google.maps.LatLng(n.lat,n.lon);i.map.panTo(o),i.map.updateAndDrawPosts()}}function t(e){swal("","Need to turn on location service for proper use.")}var n={enableHighAccuracy:!0,timeout:1e4,maximumAge:3e4};navigator.geolocation.getCurrentPosition(e,t,n),swal({title:"",text:"Moving to current location..",timer:1e3,showConfirmButton:!1})},i.moveToPostLocation=function(){var e=0;if(i.isMobile()){var t=i.map.getBounds(),n=t.getNorthEast(),o=t.getSouthWest();current_map_nw=new google.maps.LatLng(n.lat(),o.lng()),current_map_se=new google.maps.LatLng(o.lat(),n.lng());var a=.5*Math.abs(i.postLocation.lat-current_map_nw.lat()),s=.5*Math.abs(i.postLocation.lat-current_map_se.lat());e=a>s?s:a}var l=i.map.getCenter(),r=new google.maps.LatLng(i.postLocation.lat+e,l.lng());i.map.panTo(r),i.map.updateAndDrawPosts()},i.collapse=function(){i.navCollapsed=!0},i.$on("set:map",function(e,t){i.map=t,l(function(){i.initSession(),i.setWatchLocation()})}),i.$on("set:guidtgt",function(e,t){i.guidtgt=t,window.localStorage.guidtgt=t}),i.$on("set:pagechange",function(e,t){i.currentPageId=t}),i.$on("set:loc",function(e,t){var n=t.lat(),o=t.lng();i.postLocation={lat:n,lon:o}}),i.$on("set:place",function(e,t){i.$apply(function(){i.postplace=t})})}]),angular.module("app").constant("ConfigSvc",{web_socket:"ws://",web_socket_secure:"wss://",local:"localhost",local_ip:"192.168.0.4",deploy_dns:"talkipia.com",port:"5000",maxInstantLifeSpan:5e3}),angular.module("app").config(["$routeProvider",function(e){e.when("/",{controller:"PostsCtrl",templateUrl:"/templates/posts.html"}).otherwise({redirectTo:"/"})}]),angular.module("app").service("UtilSvc",function(){var e=this;e.deg2rad=function(e){return e*(Math.PI/180)},e.getDistanceFromLatLonInKm=function(t,n,o,i){var a=6371,s=e.deg2rad(o-t),l=e.deg2rad(i-n),r=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e.deg2rad(t))*Math.cos(e.deg2rad(o))*Math.sin(l/2)*Math.sin(l/2),c=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)),g=a*c;return g},e.mapRange=function(e,t,n,o,i){return o+(i-o)*(e-t)/(n-t)},e.getGuid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}),angular.module("app").run(["$rootScope","$timeout","SessionSvc",function(e,t,n){}]),angular.module("app").directive("appMap",["PostsSvc","UtilSvc","ConfigSvc","SessionSvc","$compile","$timeout",function(e,t,n,o,i,a){var s=function(t,n,s){function l(){window.localStorage.latitude=E.getCenter().lat(),window.localStorage.longitude=E.getCenter().lng()}function r(){var e=E.getBounds(),t=e.getNorthEast(),n=e.getSouthWest();R=new google.maps.LatLng(t.lat(),n.lng()),U=new google.maps.LatLng(n.lat(),t.lng())}function c(){var e=E.getBounds(),n=e.getNorthEast(),i=e.getSouthWest();R={lat:n.lat(),lon:i.lng()},U={lat:i.lat(),lon:n.lng()};var a;a={lat:E.getCenter().lat(),lon:E.getCenter().lng()},o.updateWatchLocation(R,U,a,t.guid)}function g(e){for(var t,n=0;t=V[n];n++)t.setMap(null);V=[];var t=new google.maps.Marker({position:e,map:E,icon:Z});V.push(t)}function u(e){function n(n){for(var o=0;o<n.length;o++){var i=n[o];if(i.guid!=t.guid){var s=angular.fromJson(i.watchloc),l=angular.fromJson(e.location);if(s.center_lat<R.lat()&&s.center_lat>U.lat()&&s.center_lon<U.lng()&&s.center_lon>R.lng()&&l.lat<s.nw_lat&&l.lat>s.se_lat&&l.lon<s.se_lon&&l.lon>s.nw_lon){var r=new google.maps.LatLng(s.center_lat,s.center_lon),c=40*Math.random()+40,g="Blink.gif",u={url:g,size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(.5*c+5,.5*c+14),scaledSize:new google.maps.Size(c,c)};!function(e){var t={position:r,map:E,title:"Receiver",icon:e,optimized:!1},n=new google.maps.Marker(t),o=1200;a(function(e){return function(){e.setMap(null),e=null}}(n),o)}(u)}}}}r(),o.fetch().success(n)["catch"](function(e){})}function p(){for(var e,t=0;e=j[t];t++){var n=new Date,o=n.getTime(),i=e.post.lifeend-o;0>=i&&f(e.post._id)}}function m(){function n(n){for(var o=0;o<n.length;o++){var a=n[o],s=angular.fromJson(a.location),l=new google.maps.LatLng(s.lat,s.lon);if(r(),l.lat()<R.lat()&&l.lat()>U.lat()&&l.lng()<U.lng()&&l.lng()>R.lng()){for(var c,g=0;c=j[g];g++){var u=a._id==c.post._id;if(u){if(F){f(a._id);break}if(c.post.guidtgt==a.guidtgt){a=null;break}f(a._id);break}}if(null!=a){var p={position:l,map:E,title:"Bubble",icon:q},c=new google.maps.Marker(p);j.push({marker:c,post:a});var m=h(a.guid,a.guidtgt),d=a.islocal,w=t,v=w.$new(!0),y=function(n,o,a,s,l){return function(){var r={pixelOffset:new google.maps.Size(-39.5,16),disableAutoPan:!0},c=new google.maps.InfoWindow(r),g=new Date,u=g.getTime(),p=a.lifeend-u>=0?a.lifeend-u:0,m=(p/a.lifespan).toFixed(2);o.msg=a.body,o.postlife=p,o.postguid=a.guid,o.postguidtgt=a.guidtgt,o.postcouplestatus=s,o.postlifepercentage=m,o.postlocalstatus=l;var d="<div map-msg></div>",f=i(d)(o);c.setContent(f[0]),google.maps.event.addListener(c,"closeclick",function(){a.guid==t.guid&&swal({title:"Are you sure?",text:"You will not be able to recover this imaginary file!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t)e.remove(a).success(function(e){})["catch"](function(e){}),swal("Deleted!","Your imaginary file has been deleted.","success");else{var i=new Date,s=i.getTime(),l=a.lifeend-s>=0?a.lifeend-s:0,r=(l/a.lifespan).toFixed(2);r>0&&(o.postlifepercentage=r,c.open(E,n))}})}),c.open(E,n)}}(c,v,a,m,d);y()}}}}p(),F=X!=t.guidtgt,X=t.guidtgt,e.fetch().success(n)["catch"](function(e){})}function d(e){var t=new google.maps.LatLng(e.lat,e.lon);if(r(),t.lat()<R.lat()&&t.lat()>U.lat()&&t.lng()<U.lng()&&t.lng()>R.lng()){var n={position:t,map:E,animation:google.maps.Animation.DROP,title:"UserPin",icon:K},o=new google.maps.Marker(n);a(function(e){return function(){e.setMap(null)}}(o),2e3)}}function f(e){for(var t,n=0;t=j[n];n++)if(e==t.post._id){t.marker.setMap(null),j.splice(n,1);break}}function w(e){var t=new google.maps.LatLng(e.lat,e.lon);v(t),y(t),c()}function v(e){for(var t,n=0;t=H[n];n++)t.setMap(null);H=[];var t=new google.maps.Marker({position:e,map:E,icon:Y});H.push(t)}function y(e){t.$emit("set:loc",e);var n=new google.maps.Geocoder;n.geocode({latLng:e},function(e,n){try{t.$emit("set:place",e[1].formatted_address)}catch(o){swal("","Location does not exists"),t.$emit("set:place","Location does not exists")}})}function h(e,n){var o=t.guidtgt==e,i=t.guid==n,a=t.guid==e,s="0"!=t.guidtgt;return a&&s?2:o&&i?4:o&&!i?1:!o&&i?2:0}function _(){var e=document.getElementById("map-search-toggle");E.controls[google.maps.ControlPosition.TOP_LEFT].push(e)}function S(){var e=document.getElementById("map-btn-curr");E.controls[google.maps.ControlPosition.TOP_RIGHT].push(e)}function b(){var e=document.getElementById("map-posting");E.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(e)}function L(){}function T(){var e=document.getElementById("map-btn-submit");E.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(e)}function k(){var e=document.getElementById("map-time-slider");E.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(e)}function P(){var e=document.getElementById("pac-input");E.controls[google.maps.ControlPosition.TOP_LEFT].push(e);var t=new google.maps.places.SearchBox(e);google.maps.event.addListener(t,"places_changed",function(){var e=t.getPlaces();if(0!=e.length){var n=e[0],o={lat:n.geometry.location.lat(),lon:n.geometry.location.lng()};w(o),window.localStorage.latitude=n.geometry.location.latitude,window.localStorage.longitude=n.geometry.location.longitude,E.panTo(n.geometry.location),E.setZoom(16)}})}function M(){google.maps.event.addListener(N,"click",function(e){var t={lat:e.latLng.lat(),lon:e.latLng.lng()};w(t)})}function C(){google.maps.event.addListener(N,"center_changed",function(){l()})}function $(){google.maps.event.addListener(N,"bounds_changed",function(){r()})}function z(){google.maps.event.addListener(N,"dragend",function(){m(),c()})}function A(){google.maps.event.addListener(N,"resize",function(){m(),c()})}function O(){google.maps.event.addListener(N,"zoom_changed",function(){m(),c()})}function x(){J=isNaN(window.localStorage.latitude)||isNaN(window.localStorage.longitude)?0!=t.userLocation.lat&&0!=t.userLocation.lon?new google.maps.LatLng(t.userLocation.lat,t.userLocation.lon):new google.maps.LatLng(34.05,-118.24):new google.maps.LatLng(window.localStorage.latitude,window.localStorage.longitude),W={center:J,zoom:15,scrollwheel:!0,streetViewControl:!1,mapTypeControl:!1,panControl:!1,zoomControl:!1,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,G]},mapTypeId:G}}function B(){function e(e){}function t(e){google.maps.event.trigger(this,"drawXMarker",e)}function o(e){google.maps.event.trigger(this,"drawUserLocationMarker",e)}function i(e){google.maps.event.trigger(this,"drawCurrLocationMarker",e)}function a(){google.maps.event.trigger(this,"updateAndDrawPosts")}function s(e){google.maps.event.trigger(this,"drawResponses",e)}function l(e){google.maps.event.trigger(this,"unDrawPost",e)}N=new google.maps.Map(n[0],W),e.prototype=N,e.prototype.drawXMarker=t,e.prototype.drawUserLocationMarker=o,e.prototype.drawCurrLocationMarker=i,e.prototype.updateAndDrawPosts=a,e.prototype.drawResponses=s,e.prototype.unDrawPost=l,E=new e,google.maps.event.addListener(E,"drawXMarker",function(e){w(e)}),google.maps.event.addListener(E,"drawUserLocationMarker",function(e){g(e)}),google.maps.event.addListener(E,"drawCurrLocationMarker",function(e){d(e)}),google.maps.event.addListener(E,"updateAndDrawPosts",function(){m()}),google.maps.event.addListener(E,"drawResponses",function(e){u(e)}),google.maps.event.addListener(E,"unDrawPost",function(e){f(e)})}function I(){{var e,t=new Date;t.getHours()}e=[{featureType:"administrative",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#439aa5"}]},{featureType:"administrative.locality",elementType:"all",stylers:[{color:"#32485c"},{visibility:"simplified"}]},{featureType:"administrative.neighborhood",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"landscape.natural",elementType:"all",stylers:[{color:"#e9dddb"}]},{featureType:"landscape.natural.terrain",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#c4e661"}]},{featureType:"poi.park",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#e9dddb"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#32485c"},{weight:"0.7"}]},{featureType:"road.arterial",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#e9dddb"}]},{featureType:"road.arterial",elementType:"geometry.stroke",stylers:[{color:"#32485c"},{weight:"0.25"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{color:"#e9dddb"}]},{featureType:"road.local",elementType:"geometry.stroke",stylers:[{color:"#ef798e"},{weight:"0.5"},{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#ef798e"}]},{featureType:"transit.line",elementType:"geometry.fill",stylers:[{weight:"2.06"}]},{featureType:"transit.line",elementType:"geometry.stroke",stylers:[{weight:"10.00"}]},{featureType:"transit.line",elementType:"labels.text.stroke",stylers:[{weight:"0.01"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{visibility:"on"},{weight:"10.00"},{color:"#439aa5"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"on"},{color:"#32485c"},{weight:"0.85"}]}];var n={name:"Custom Style"},o=new google.maps.StyledMapType(e,n);E.mapTypes.set(G,o)}function D(){void 0===E&&(x(),B(),I()),_(),P(),S(),b(),T(),k(),L(),M(),C(),z(),A(),O(),$(),t.$emit("set:map",E)}var E,N,R,U,W,J,F,G="custom_style",H=[],V=[],j=[],X="0",q={url:"Default_Marker.png",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(1,1)},Y={url:"X_Marker.png",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)},K={url:"Current_Location_Marker.png",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(20,33)},Z={url:"curr_marker.png",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(20,33)};D(),v(J),y(J)};return{restrict:"A",template:'<div id="map-canvas"></div>',replace:!0,link:s}}]),angular.module("app").directive("mapMsg",["$timeout","SessionSvc","PostsSvc",function(e,t,n){var o=function(o,i,a){function s(){var e=o.postguid,a=o.$parent.guid,s=o.$parent.guidtgt;i.children().on("click",function(){var i=e;if(e==a){if("0"==o.$parent.guidtgt)return;i="0"}e==s&&(i="0"),o.$emit("set:guidtgt",i),t.updateCoupling(a,i).then(function(e){});var l={guid:a,guidtgt:i};n.updateGuidtgt(l).then(function(e){})})}function l(){var e=o.postlife+"ms",t=i.children().children(".postlifebar");t.css("-o-animation-duration",e),t.css("-moz-animation-duration",e),t.css("-ms-animation-duration",e),t.css("-webkit-animation-duration",e),t.css("animation-duration",e),o.postlifepercentage>.95?(t.css("-o-animation-name","postlifeanim_a"),t.css("-moz-animation-name","postlifeanim_a"),t.css("-ms-animation-name","postlifeanim_a"),t.css("-webkit-animation-name","postlifeanim_a"),t.css("animation-name","postlifeanim_a")):o.postlifepercentage<=.95&&o.postlifepercentage>.9?(t.css("-o-animation-name","postlifeanim_b"),t.css("-moz-animation-name","postlifeanim_b"),t.css("-ms-animation-name","postlifeanim_b"),t.css("-webkit-animation-name","postlifeanim_b"),t.css("animation-name","postlifeanim_b")):o.postlifepercentage<=.9&&o.postlifepercentage>.85?(t.css("-o-animation-name","postlifeanim_c"),t.css("-moz-animation-name","postlifeanim_c"),t.css("-ms-animation-name","postlifeanim_c"),postlifebar_css=t.css("-webkit-animation-name","postlifeanim_c"),postlifebar_css=t.css("animation-name","postlifeanim_c")):o.postlifepercentage<=.85&&o.postlifepercentage>.75?(t.css("-o-animation-name","postlifeanim_d"),t.css("-moz-animation-name","postlifeanim_d"),t.css("-ms-animation-name","postlifeanim_d"),t.css("-webkit-animation-name","postlifeanim_d"),t.css("animation-name","postlifeanim_d")):o.postlifepercentage<=.75&&o.postlifepercentage>.6?(t.css("-o-animation-name","postlifeanim_e"),t.css("-moz-animation-name","postlifeanim_e"),t.css("-ms-animation-name","postlifeanim_e"),t.css("-webkit-animation-name","postlifeanim_e"),t.css("animation-name","postlifeanim_e")):o.postlifepercentage<=.6&&o.postlifepercentage>.5?(t.css("-o-animation-name","postlifeanim_f"),t.css("-moz-animation-name","postlifeanim_f"),t.css("-ms-animation-name","postlifeanim_f"),t.css("-webkit-animation-name","postlifeanim_f"),t.css("animation-name","postlifeanim_f")):o.postlifepercentage<=.5&&o.postlifepercentage>.3?(t.css("-o-animation-name","postlifeanim_g"),t.css("-moz-animation-name","postlifeanim_g"),t.css("-ms-animation-name","postlifeanim_g"),t.css("-webkit-animation-name","postlifeanim_g"),t.css("animation-name","postlifeanim_g")):o.postlifepercentage<=.3&&o.postlifepercentage>.2?(t.css("-o-animation-name","postlifeanim_h"),t.css("-moz-animation-name","postlifeanim_h"),t.css("-ms-animation-name","postlifeanim_h"),t.css("-webkit-animation-name","postlifeanim_h"),t.css("animation-name","postlifeanim_h")):o.postlifepercentage<=.2&&o.postlifepercentage>.1?(t.css("-o-animation-name","postlifeanim_i"),t.css("-moz-animation-name","postlifeanim_i"),t.css("-ms-animation-name","postlifeanim_i"),t.css("-webkit-animation-name","postlifeanim_i"),t.css("animation-name","postlifeanim_i")):(t.css("-o-animation-name","postlifeanim_j"),t.css("-moz-animation-name","postlifeanim_j"),t.css("-ms-animation-name","postlifeanim_j"),t.css("-webkit-animation-name","postlifeanim_j"),t.css("animation-name","postlifeanim_j"))}function r(){var e=$(".gm-style-iw"),t=e.prev();t.children(":nth-child(2)").css({display:"none"}),t.children(":nth-child(4)").css({display:"none"}),t.children(":nth-child(3)").find("div").children().css({"box-shadow":"0 1px 6px rgba(178, 178, 178, 0.6)","z-index":"1",border:"0px"})}function c(){var e=$(".gm-style-iw"),t=e.next();t.css({opacity:"0.8",right:"20px",top:"20px"})}o.get_localstatus=function(e){return e?"local-text":"non-local-text"},o.get_coupling=function(e){return 4==e?"coupling coupling-couple":1==e?"coupling coupling-ilikeyou":2==e?"coupling coupling-youlikei":"coupling coupling-none"},angular.element(document).ready(function(){e(s,100),e(l,10),e(r,10),e(c,10)})};return{restrict:"A",templateUrl:"./templates/window.html",link:o}}]),angular.module("app").controller("PostsCtrl",["$rootScope","$scope","ConfigSvc","PostsSvc","UtilSvc","$window","$document","$timeout",function(e,t,n,o,i,a,s,l){t.$emit("set:pagechange",t.pageId.post),t.posts=[],t.$on("ws:new_post",function(e,n){t.requestFetch()}),t.addPost=function(){if(t.content){var e,a=t.postplace,s=t.postLocation,l=i.getDistanceFromLatLonInKm(s.lat,s.lon,t.userLocation.lat,t.userLocation.lon);e=3>l?!0:!1;var r,c=JSON.stringify(s);if(t.timevalue<=n.maxInstantLifeSpan){var g=t.content.length;r=5>g?4e3:g*i.mapRange(g,5,20,700,400)}else r=t.timevalue;o.create({body:t.content,location:c,place:a,guid:t.guid,guidtgt:t.guidtgt,lifespan:r,islocal:e}).success(function(e){t.content=null}).error(function(e,t){swal("Post failed","Please complete the from correctly","error")})["catch"](function(e){})}},t.requestFetch=function(){o.fetch().success(function(e){t.posts=e})["catch"](function(e){})},t.updateGuidtgt=function(e,t){var n={guid:e,guidtgt:t};o.updateGuidtgt(n).success(function(e){})["catch"](function(e){})}}]),angular.module("app").service("PostsSvc",["$http",function(e){this.fetch=function(t){return e.get("/api/posts",t)},this.create=function(t){return t.devicetoken="0",e.post("/api/posts",t)},this.remove=function(t){return e.post("/api/posts/posts_delete",t)},this.updateGuidtgt=function(t){return e.post("/api/posts/update_guidtgt",t)}}]),angular.module("app").service("SessionSvc",["$http",function(e){this.fetch=function(){return e.get("/api/sessions")},this.enter=function(t){return t.devicetoken="0",e.post("/api/sessions",t)},this.remove=function(t){var n={guid:t};return e.post("/api/sessions/delete",n)},this.updateOnlinestat=function(t,n){var o={onlinestat:t,guid:n};return e.post(SERVER.url+"/api/sessions/update_onlinestat",o)},this.updateWatchLocation=function(t,n,o,i){var a={nw_lat:t.lat,nw_lon:t.lon,se_lat:n.lat,se_lon:n.lon,center_lat:o.lat,center_lon:o.lon},s=JSON.stringify(a),l={watchloc:s,guid:i};return e.post("/api/sessions/update_watch_loc",l)},this.updateCurrentLocation=function(t,n,o){var i={lat:t,lon:n},a=JSON.stringify(i),s={currloc:a,guid:o};return e.post("/api/sessions/update_curr_loc",s)},this.updateCoupling=function(t,n){var o={guid:t,guidtgt:n};return e.post("/api/sessions/update_coupling",o)}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJjb25maWcuc3ZjLmpzIiwicm91dGVzLmpzIiwidXRpbC5zdmMuanMiLCJnZW5lcmFsL21haW4uanMiLCJtYXBzL21hcC5kaXJlY3RpdmUuanMiLCJtYXBzL21zZy5kaXJlY3RpdmUuanMiLCJwb3N0cy9wb3N0cy5jdHJsLmpzIiwicG9zdHMvcG9zdHMuc3ZjLmpzIiwic2Vzc2lvbnMvc2Vzc2lvbnMuc3ZjLmpzIiwiYXBwLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb250cm9sbGVyIiwiU2Vzc2lvblN2YyIsIlV0aWxTdmMiLCJDb25maWdTdmMiLCIkcm9vdFNjb3BlIiwiJHNjb3BlIiwiJHdpbmRvdyIsIiRodHRwIiwiJHRpbWVvdXQiLCJvblN1Y2Nlc3MiLCJwb3MiLCJjcmQiLCJjb29yZHMiLCJnb29nbGVMb2MiLCJnb29nbGUiLCJtYXBzIiwiTGF0TG5nIiwibGF0aXR1ZGUiLCJsb25naXR1ZGUiLCJtYXAiLCJkcmF3VXNlckxvY2F0aW9uTWFya2VyIiwidXBkYXRlQ3VycmVudExvY2F0aW9uIiwiZ3VpZCIsIndpbmRvdyIsIm9uYmVmb3JldW5sb2FkIiwiZSIsInVwZGF0ZU9ubGluZXN0YXQiLCJzdWNjZXNzIiwicmVzIiwiZXJyIiwib25wYWdlc2hvdyIsImluaXRTZXNzaW9uIiwidXBkYXRlQW5kRHJhd1Bvc3RzIiwib25wYWdlaGlkZSIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsInZpc2liaWxpdHlTdGF0ZSIsIndlYmtpdFZpc2libGUiLCJ3ZWJraXRIaWRkZW4iLCJzZXRXYXRjaExvY2F0aW9uIiwibmF2aWdhdG9yIiwiZ2VvbG9jYXRpb24iLCJ3YXRjaFBvc2l0aW9uIiwiZ2V0Q3VyckxvY1N1Y2Nlc3MiLCJ1c2VyTG9jYXRpb24iLCJsYXQiLCJsb24iLCJsb2NhdGlvbiIsImxuZyIsImxvY2F0aW9uSlNPTiIsIkpTT04iLCJzdHJpbmdpZnkiLCJib3VuZHMiLCJnZXRCb3VuZHMiLCJuZSIsImdldE5vcnRoRWFzdCIsInN3IiwiZ2V0U291dGhXZXN0IiwiY3VycmVudF9tYXBfbnciLCJjdXJyZW50X21hcF9zZSIsImN1cnJlbnRfbWFwX2NlbnRlciIsImxvY2FsU3RvcmFnZSIsIndhdGNobG9jIiwibndfbGF0IiwibndfbG9uIiwic2VfbGF0Iiwic2VfbG9uIiwiY2VudGVyX2xhdCIsImNlbnRlcl9sb24iLCJ3YXRjaGxvY0pTT04iLCJzZXNzaW9uIiwiZ3VpZHRndCIsImVudGVyIiwiZ2V0Q3VyckxvY0Vycm9yIiwic3dhbCIsIm9wdGlvbnMiLCJlbmFibGVIaWdoQWNjdXJhY3kiLCJ0aW1lb3V0IiwibWF4aW11bUFnZSIsImdldEN1cnJlbnRQb3NpdGlvbiIsInRpdGxlIiwidGV4dCIsInRpbWVyIiwic2hvd0NvbmZpcm1CdXR0b24iLCJnZXRHdWlkIiwicGFnZUlkIiwicG9zdCIsIm5hdkNvbGxhcHNlZCIsInRpbWV2YWx1ZSIsIm1heEluc3RhbnRMaWZlU3BhbiIsInRvZ2dsZVNlYXJjaExvY2F0aW9uIiwidG9nZ2xlVGltZVNsaWRlciIsImdldEVsZW1lbnRCeUlkIiwib25rZXlwcmVzcyIsImV2ZW50Iiwid2hpY2giLCIkIiwic3VibWl0Iiwib25mb2N1cyIsIm9uYmx1ciIsImNsaWNrIiwidG9nZ2xlQ2xhc3MiLCIkYXBwbHkiLCJ1cmwiLCJob3N0bmFtZSIsImxvY2FsIiwid2ViX3NvY2tldCIsInBvcnQiLCJsb2NhbF9pcCIsImRlcGxveV9kbnMiLCJjb25uZWN0IiwiY29ubmVjdGlvbiIsIldlYlNvY2tldCIsIm9ub3BlbiIsInNlbmQiLCJvbmNsb3NlIiwib25tZXNzYWdlIiwicGF5bG9hZCIsInBhcnNlIiwiZGF0YSIsIiRicm9hZGNhc3QiLCJ0eXBlIiwiJG9uIiwiXyIsImRyYXdSZXNwb25zZXMiLCJmcm9tSnNvbiIsImRyYXdDdXJyTG9jYXRpb25NYXJrZXIiLCJwb3N0aWQiLCJ1bkRyYXdQb3N0IiwidXBkYXRlZFNlc3Npb24iLCJpc0luc3RhbnQiLCJpc01vYmlsZSIsInVzZXJBZ2VudCIsIm1hdGNoIiwibW92ZVRvQ3VycmVudExvY2F0aW9uIiwiY3VycmVudFBhZ2VJZCIsImRyYXdYTWFya2VyIiwicGFuVG8iLCJtb3ZlVG9Qb3N0TG9jYXRpb24iLCJsYXREZWx0YSIsImxhdERlbHRhX2NlbnRlcjJub3J0aCIsIk1hdGgiLCJhYnMiLCJwb3N0TG9jYXRpb24iLCJsYXREZWx0YV9jZW50ZXIyc291dGgiLCJjZW50ZXJMb2MiLCJnZXRDZW50ZXIiLCJjb2xsYXBzZSIsInBsYWNlIiwicG9zdHBsYWNlIiwiY29uc3RhbnQiLCJ3ZWJfc29ja2V0X3NlY3VyZSIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwid2hlbiIsInRlbXBsYXRlVXJsIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsInNlcnZpY2UiLCJzdmMiLCJ0aGlzIiwiZGVnMnJhZCIsImRlZyIsIlBJIiwiZ2V0RGlzdGFuY2VGcm9tTGF0TG9uSW5LbSIsImxhdDEiLCJsb24xIiwibGF0MiIsImxvbjIiLCJSIiwiZExhdCIsImRMb24iLCJhIiwic2luIiwiY29zIiwiYyIsImF0YW4yIiwic3FydCIsImQiLCJtYXBSYW5nZSIsInZhbHVlIiwibG93MSIsImhpZ2gxIiwibG93MiIsImhpZ2gyIiwiczQiLCJmbG9vciIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyaW5nIiwicnVuIiwiZGlyZWN0aXZlIiwiUG9zdHNTdmMiLCIkY29tcGlsZSIsImxpbmsiLCJzY29wZSIsImVsZW1lbnQiLCJhdHRycyIsInVwZGF0ZURlZmF1bHRMb2NhdGlvbiIsInVwZGF0ZUJvdW5kcyIsInVwZGF0ZVdhdGNoTG9jYXRpb24iLCJkcmF3VXNlck1hcmtlciIsIm1hcmtlciIsImkiLCJ1c2VyTWFya2VycyIsInNldE1hcCIsIk1hcmtlciIsInBvc2l0aW9uIiwiaWNvbiIsImltYWdlVXNlckxvY2F0aW9uIiwicHVzaCIsImRyYXdCbGlua3MiLCJzZXNzaW9ucyIsImxlbmd0aCIsIndhdGNoX2xvY2F0aW9uIiwicG9zdF9sb2NhdGlvbiIsInJhbmRvbVNpemUiLCJ1cmxOYW1lIiwiaW1hZ2VMaXN0ZW5lciIsInNpemUiLCJTaXplIiwib3JpZ2luIiwiUG9pbnQiLCJhbmNob3IiLCJzY2FsZWRTaXplIiwibWFya2VyT3B0aW9ucyIsIm9wdGltaXplZCIsInJlY2VpdmVyX21hcmtlcl9saWZlc3BhbiIsIm9sZF9tYXJrZXIiLCJmZXRjaCIsImNsZWFudXAiLCJqIiwibWFya2Vyc09uTWFwIiwiY3VycmVudERhdGUiLCJEYXRlIiwiY3VycmVudFRpbWVNaWxsaSIsImdldFRpbWUiLCJsaWZlIiwibGlmZWVuZCIsIl9pZCIsImRyYXdQb3N0cyIsInBvc3RzIiwiaXNBbHJlYWR5RHJhd24iLCJpc0d1aWR0Z3RDaGFuZ2VkIiwiaW1hZ2VQb3N0IiwiY291cGxpbmdfc3RhdHVzIiwiY2FsY3VsYXRlQ291cGxpbmciLCJsb2NhbF9zdGF0dXMiLCJpc2xvY2FsIiwicGFyZW50IiwiY2hpbGQiLCIkbmV3Iiwib3BlbkluZm9XaW5kb3ciLCJjaGlsZF9zY29wZSIsImluZm9XaW5kb3dPcHRpb25zIiwicGl4ZWxPZmZzZXQiLCJkaXNhYmxlQXV0b1BhbiIsImluZm9XaW5kb3ciLCJJbmZvV2luZG93IiwicG9zdGxpZmUiLCJsaWZlcGVyY2VudGFnZSIsImxpZmVzcGFuIiwidG9GaXhlZCIsIm1zZyIsImJvZHkiLCJwb3N0Z3VpZCIsInBvc3RndWlkdGd0IiwicG9zdGNvdXBsZXN0YXR1cyIsInBvc3RsaWZlcGVyY2VudGFnZSIsInBvc3Rsb2NhbHN0YXR1cyIsImNvbnRlbnQiLCJjb21waWxlZCIsInNldENvbnRlbnQiLCJhZGRMaXN0ZW5lciIsInNob3dDYW5jZWxCdXR0b24iLCJjb25maXJtQnV0dG9uQ29sb3IiLCJjb25maXJtQnV0dG9uVGV4dCIsImNsb3NlT25Db25maXJtIiwiaXNDb25maXJtIiwicmVtb3ZlIiwib3BlbiIsInByZXZHdWlkdGd0IiwiZHJhd0Ryb3BEb3duIiwiYW5pbWF0aW9uIiwiQW5pbWF0aW9uIiwiRFJPUCIsImltYWdlVXNlckxvZ2luIiwiayIsInNwbGljZSIsImRyYXdBbmRTZXRQbGFjZSIsImRyYXdIZWxwZXJNYXJrZXIiLCJzZXRQbGFjZSIsImhlbHBlck1hcmtlcnMiLCJpbWFnZVRhcmdldCIsIiRlbWl0IiwiZ2VvY29kZXIiLCJHZW9jb2RlciIsImdlb2NvZGUiLCJsYXRMbmciLCJyZXN1bHRzIiwic3RhdHVzIiwiZm9ybWF0dGVkX2FkZHJlc3MiLCJwb3N0X2d1aWQiLCJwb3N0X2d1aWR0Z3QiLCJpc1BvaW50aW5nWW91IiwiaXNQb2ludGluZ01lIiwiaXNNeVBvc3QiLCJpc1BvaW50aW5nU29tZW9uZSIsInNldFVJU2VhcmNoTG9jYXRpb25Ub2dnbGUiLCJtYXBTZWFyY2hUb2dnbGUiLCJjb250cm9scyIsIkNvbnRyb2xQb3NpdGlvbiIsIlRPUF9MRUZUIiwic2V0VUlNb3ZlVG9DdXJyTG9jQnRuIiwiY3VyckxvY0J0biIsIlRPUF9SSUdIVCIsInNldFVJUG9zdEZvcm0iLCJwb3N0Rm9ybSIsIkJPVFRPTV9DRU5URVIiLCJzZXRVSVBvc3RPbk1hcCIsInNldFVJUG9zdEJ0biIsInBvc3RCdG4iLCJzZXRVSVRpbWVTbGlkZXIiLCJ0aW1lU2xpZGVyIiwic2V0VUlTZWFyY2hCb3giLCJpbnB1dCIsInNlYXJjaEJveCIsInBsYWNlcyIsIlNlYXJjaEJveCIsImdldFBsYWNlcyIsImdlb21ldHJ5Iiwic2V0Wm9vbSIsInNldEV2ZW50Q2xpY2siLCJtYXBfb3JpZ2luIiwic2V0RXZlbnRDZW50ZXJDaGFuZ2VkIiwic2V0RXZlbnRCb3VuZHNDaGFuZ2VkIiwic2V0RXZlbnREcmFnRW5kIiwic2V0RXZlbnRSZXNpemUiLCJzZXRFdmVudFpvb21DaGFuZ2VkIiwiaW5pdGlhbE1hcERhdGEiLCJpbml0aWFsTWFwQ2VudGVyIiwiaXNOYU4iLCJtYXBPcHRpb25zIiwiY2VudGVyIiwiem9vbSIsInNjcm9sbHdoZWVsIiwic3RyZWV0Vmlld0NvbnRyb2wiLCJtYXBUeXBlQ29udHJvbCIsInBhbkNvbnRyb2wiLCJ6b29tQ29udHJvbCIsIm1hcFR5cGVDb250cm9sT3B0aW9ucyIsIm1hcFR5cGVJZHMiLCJNYXBUeXBlSWQiLCJST0FETUFQIiwiQ0xPVURfTUFQX0lEIiwibWFwVHlwZUlkIiwic2V0TWFudWFsRXZlbnRzIiwiQ2xvdWRNYXAiLCJoYW5kbGVEcmF3WE1hcmtlciIsInRyaWdnZXIiLCJoYW5kbGVEcmF3VXNlckxvY2F0aW9uTWFya2VyIiwiaGFuZGxlRHJhd0N1cnJMb2NhdGlvbk1hcmtlciIsImhhbmRsZVVwZGF0ZUFuZERyYXdQb3N0cyIsImhhbmRsZURyYXdSZXNwb25zZXMiLCJoYW5kbGVVbkRyYXdQb3N0IiwiTWFwIiwicHJvdG90eXBlIiwic2V0U3R5bGVGb3JNYXAiLCJmZWF0dXJlT3B0cyIsImN1cnJlbnRUaW1lIiwiZ2V0SG91cnMiLCJmZWF0dXJlVHlwZSIsImVsZW1lbnRUeXBlIiwic3R5bGVycyIsInZpc2liaWxpdHkiLCJjb2xvciIsIndlaWdodCIsInN0eWxlZE1hcE9wdGlvbnMiLCJuYW1lIiwiY3VzdG9tTWFwVHlwZSIsIlN0eWxlZE1hcFR5cGUiLCJtYXBUeXBlcyIsInNldCIsImluaXRNYXAiLCJyZXN0cmljdCIsInRlbXBsYXRlIiwicmVwbGFjZSIsInVwZGF0ZUd1aWRUYXJnZXQiLCJteWd1aWQiLCIkcGFyZW50IiwibXlndWlkdGd0IiwiY2hpbGRyZW4iLCJvbiIsInVwZGF0ZV9ndWlkdGd0IiwidXBkYXRlQ291cGxpbmciLCJ0aGVuIiwiZG9jIiwidXBkYXRlcyIsInVwZGF0ZUd1aWR0Z3QiLCJ1cGRhdGVQb3N0VGltZXIiLCJkdXJhdGlvbiIsInBvc3RiYXJsaWZlIiwiY3NzIiwicG9zdGxpZmViYXJfY3NzIiwiY3VzdG9taXplSW5mb1dpbmRvdyIsIml3T3V0ZXIiLCJpd0JhY2tncm91bmQiLCJwcmV2IiwiZGlzcGxheSIsImZpbmQiLCJib3gtc2hhZG93Iiwiei1pbmRleCIsImJvcmRlciIsImN1c3RvbWl6ZUNsb3NlQnRuIiwiaXdDbG9zZUJ0biIsIm5leHQiLCJvcGFjaXR5IiwicmlnaHQiLCJ0b3AiLCJnZXRfbG9jYWxzdGF0dXMiLCJnZXRfY291cGxpbmciLCJyZWFkeSIsIiRkb2N1bWVudCIsInJlcXVlc3RGZXRjaCIsImFkZFBvc3QiLCJwb3N0TG9jYXRpb25Gcm9tVXNlckxvY2F0aW9uIiwicmVsYXRpdmVMaWZlU3BhbiIsImNoYXJMZW4iLCJjcmVhdGUiLCJlcnJvciIsImd1aWRPYmoiLCJnZXQiLCJkZXZpY2V0b2tlbiIsIm9ubGluZXN0YXQiLCJ1cGRhdGVkc2Vzc2lvbiIsIlNFUlZFUiIsImN1cnJlbnRfbG9jX2xhdCIsImN1cnJlbnRfbG9jX2xvbiIsImN1cnJsb2MiLCJjdXJybG9jSlNPTiIsInVwZGF0ZWRndWlkdGd0Il0sIm1hcHBpbmdzIjoiQUFDQUEsUUFBQUMsT0FBQSxPQUNBLFVBQ0EsWUFDQSxZQUNBLHNCQ0pBRCxRQUFBQyxPQUFBLE9BQ0FDLFdBQUEsbUJBQUEsYUFBQSxVQUFBLFlBQUEsYUFBQSxTQUFBLFVBQUEsUUFBQSxXQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBbUdBLFFBQUFDLEdBQUFDLEdBQ0EsR0FBQUMsR0FBQUQsRUFBQUUsT0FFQUMsRUFBQSxHQUFBQyxRQUFBQyxLQUFBQyxPQUFBTCxFQUFBTSxTQUFBTixFQUFBTyxVQUVBYixHQUFBYyxJQUFBQyx1QkFBQVAsR0FFQVosRUFBQW9CLHNCQUFBVixFQUFBTSxTQUFBTixFQUFBTyxVQUFBYixFQUFBaUIsTUFwR0FDLE9BQUFDLGVBQUEsU0FBQUMsR0FDQXhCLEVBQUF5QixrQkFBQSxFQUFBckIsRUFBQWlCLE1BRUFLLFFBQUEsU0FBQUMsTUFGQTNCLFNBS0EsU0FBQTRCLE9BS0FOLE9BQUFPLFdBQUEsU0FBQUwsR0FDQXBCLEVBQUEwQixjQUVBOUIsRUFBQXlCLGtCQUFBLEVBQUFyQixFQUFBaUIsTUFFQWpCLEVBQUFjLEtBQ0FYLEVBQUEsV0FDQUgsRUFBQWMsSUFBQWEsd0JBS0FULE9B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LFlBQUEsTUFBQUMsVUFBQUMsV0FBQSxTQUFBSCxZQUFBLGlCQUFBQyxZQUFBLG1CQUFBQyxVQUFBRSxNQUFBLGNBQUFKLFlBQUEsMEJBQUFDLFlBQUEsTUFBQUMsVUFBQUUsTUFBQSxZQUFBRCxXQUFBLGlCQUFBSCxZQUFBLDhCQUFBQyxZQUFBLE1BQUFDLFVBQUFDLFdBQUEsU0FBQUgsWUFBQSxvQkFBQUMsWUFBQSxNQUFBQyxVQUFBRSxNQUFBLGNBQUFKLFlBQUEsNEJBQUFDLFlBQUEsV0FBQUMsVUFBQUMsV0FBQSxVQUFBSCxZQUFBLE1BQUFDLFlBQUEsTUFBQUMsVUFBQUMsV0FBQSxVQUFBSCxZQUFBLFdBQUFDLFlBQUEsTUFBQUMsVUFBQUMsV0FBQSxTQUFBSCxZQUFBLFdBQUFDLFlBQUEsZ0JBQUFDLFVBQUFFLE1BQUEsY0FBQUosWUFBQSxXQUFBQyxZQUFBLFNBQUFDLFVBQUFDLFdBQUEsVUFBQUgsWUFBQSxlQUFBQyxZQUFBLGdCQUFBQyxVQUFBRSxNQUFBLGNBQUFKLFlBQUEsZUFBQUMsWUFBQSxrQkFBQUMsVUFBQUUsTUFBQSxZQUFBQyxPQUFBLFVBQUFMLFlBQUEsZ0JBQUFDLFlBQUEsTUFBQUMsVUFBQUMsV0FBQSxTQUFBSCxZQUFBLGdCQUFBQyxZQUFBLGdCQUFBQyxVQUFBRSxNQUFBLGNBQUFKLFlBQUEsZ0JBQUFDLFlBQUEsa0JBQUFDLFVBQUFFLE1BQUEsWUFBQUMsT0FBQSxXQUFBTCxZQUFBLGdCQUFBQyxZQUFBLGNBQUFDLFVBQUFDLFdBQUEsVUFBQUgsWUFBQSxhQUFBQyxZQUFBLE1BQUFDLFVBQUFDLFdBQUEsVUFBQUgsWUFBQSxhQUFBQyxZQUFBLGdCQUFBQyxVQUFBRSxNQUFBLGNBQUFKLFlBQUEsYUFBQUMsWUFBQSxrQkFBQUMsVUFBQUUsTUFBQSxZQUFBQyxPQUFBLFFBQUFGLFdBQUEsVUFBQUgsWUFBQSxVQUFBQyxZQUFBLE1BQUFDLFVBQUFDLFdBQUEsU0FBQUgsWUFBQSxlQUFBQyxZQUFBLFdBQUFDLFVBQUFFLE1BQUEsY0FBQUosWUFBQSxlQUFBQyxZQUFBLGdC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QUFDLElBQUEsaUJBQUEsbUJBRUEvTSxFQUFBeUUsb0JBQUEsS0FBQXpFLEVBQUF5RSxtQkFBQSxJQUVBcUksRUFBQUMsSUFBQSxvQkFBQSxrQkFDQUQsRUFBQUMsSUFBQSxzQkFBQSxrQkFDQUQsRUFBQUMsSUFBQSxxQkFBQSxrQkFDQUQsRUFBQUMsSUFBQSx5QkFBQSxrQkFDQUQsRUFBQUMsSUFBQSxpQkFBQSxtQkFFQS9NLEVBQUF5RSxvQkFBQSxJQUFBekUsRUFBQXlFLG1CQUFBLElBRUFxSSxFQUFBQyxJQUFBLG9CQUFBLGtCQUNBRCxFQUFBQyxJQUFBLHNCQUFBLGtCQUNBRCxFQUFBQyxJQUFBLHFCQUFBLGtCQUNBRCxFQUFBQyxJQUFBLHlCQUFBLGtCQUNBRCxFQUFBQyxJQUFBLGlCQUFBLG1CQUVBL00sRUFBQXlFLG9CQUFBLElBQUF6RSxFQUFBeUUsbUJBQUEsSUFFQXFJLEVBQUFDLElBQUEsb0JBQUEsa0JBQ0FELEVBQUFDLElBQUEsc0JBQUEsa0JBQ0FELEVBQUFDLElBQUEscUJBQUEsa0JBQ0FELEVBQUFDLElBQUEseUJBQUEsa0JBQ0FELEVBQUFDLElBQUEsaUJBQUEsbUJBRUEvTSxFQUFBeUUsb0JBQUEsSUFBQXpFLEVBQUF5RSxtQkFBQSxJQUVBcUksRUFBQUMsSUFBQSxvQkFBQSxrQkFDQUQsRUFBQUMsSUFBQSxzQkFBQSxrQkFDQUQsRUFBQUMsSUFBQSxxQkFBQSxrQkFDQUQsRUFBQUMsSUFBQSx5QkFBQSxrQkFDQUQsRUFBQUMsSUFBQSxpQkFBQSxtQkFFQS9NLEVBQUF5RSxvQkFBQSxJQUFBekUsRUFBQXlFLG1CQUFBLElBRUFxSSxFQUFBQyxJQUFBLG9CQUFBLGtCQUNBRCxFQUFBQyxJQUFBLHNCQUFBLGtCQUNBRCxFQUFBQyxJQUFBLHFCQUFBLGtCQUNBRCxFQUFBQyxJQUFBLHlCQUFBLGtCQUNBRCxFQUFBQyxJQUFBLGlCQUFBLG9CQUlBRCxFQUFBQyxJQUFBLG9CQUFBLGtCQUNBRCxFQUFBQyxJQUFBLHNCQUFBLGtCQUNBRCxFQUFBQyxJQUFBLHFCQUFBLGtCQUNBRCxF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bFIsS0FBSzNJLHNCQUF3QixTQUFTK1osRUFBaUJDLEVBQWlCL1osR0FDdkUsR0FBSWdhLElBQ0h6WSxJQUFNdVksRUFDTnRZLElBQU11WSxHQUdIRSxFQUFjclksS0FBS0MsVUFBVW1ZLEdBRTdCSixHQUNISSxRQUFTQyxFQUNUamEsS0FBU0EsRUFHVixPQUFPZixHQUFNK0UsS0FBSyxnQ0FBaUM0VixJQUdwRGxSLEtBQUswTyxlQUFpQixTQUFTcFgsRUFBTWlELEdBRXBDLEdBQUlpWCxJQUNIbGEsS0FBU0EsRUFDVGlELFFBQVNBLEVBTVYsT0FBT2hFLEdBQU0rRSxLQUFLLGdDQUFpQ2tXIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcblx0J25nUm91dGUnLFxuXHQnbmdBbmltYXRlJyxcblx0J3VpLnNsaWRlcicsXG5cdCc3MjBrYi5zb2NpYWxzaGFyZScsXG5dKTtcbiIsIlxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignQXBwbGljYXRpb25DdHJsJywgZnVuY3Rpb24oU2Vzc2lvblN2YywgVXRpbFN2YywgQ29uZmlnU3ZjLCAkcm9vdFNjb3BlLCAkc2NvcGUsICR3aW5kb3csICRodHRwLCAkdGltZW91dCl7XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIElOSVRJQUxcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgd2luZG93Lm9uYmVmb3JldW5sb2FkID0gZnVuY3Rpb24oZSkge1xuICAgIFx0U2Vzc2lvblN2Yy51cGRhdGVPbmxpbmVzdGF0KGZhbHNlLCAkc2NvcGUuZ3VpZClcbiAgICBcdC8vU2Vzc2lvblN2Yy5yZW1vdmUoJHNjb3BlLmd1aWQpXG4gICAgXHQuc3VjY2VzcyhmdW5jdGlvbihyZXMpe1xuICAgIFx0XHQvLyBoYW5kbGUgc3VjY2Vzc1xuICAgIFx0fSlcbiAgICBcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgIFx0XHQvLyBoYW5kbGUgZXJyb3JcbiAgICBcdH0pO1xuXHR9O1xuXG5cdHdpbmRvdy5vbnBhZ2VzaG93ID0gZnVuY3Rpb24oZSkge1xuXHRcdCRzY29wZS5pbml0U2Vzc2lvbigpO1xuXG5cdFx0U2Vzc2lvblN2Yy51cGRhdGVPbmxpbmVzdGF0KHRydWUsICRzY29wZS5ndWlkKTtcblxuXHRcdGlmICgkc2NvcGUubWFwKSB7XG5cdFx0XHQkdGltZW91dChmdW5jdGlvbigpe1xuXHRcdFx0XHQkc2NvcGUubWFwLnVwZGF0ZUFuZERyYXdQb3N0cygpO1xuXHRcdFx0fSlcblx0XHR9XG5cdH07XG5cblx0d2luZG93Lm9ucGFnZWhpZGUgPSBmdW5jdGlvbihlKSB7XG5cdFx0U2Vzc2lvblN2Yy51cGRhdGVPbmxpbmVzdGF0KGZhbHNlLCAkc2NvcGUuZ3VpZClcbiAgICBcdC8vU2Vzc2lvblN2Yy5yZW1vdmUoJHNjb3BlLmd1aWQpXG4gICAgXHQuc3VjY2VzcyhmdW5jdGlvbihyZXMpe1xuICAgIFx0XHQvLyBoYW5kbGUgc3VjY2Vzc1xuICAgIFx0fSlcbiAgICBcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgIFx0XHQvLyBoYW5kbGUgZXJyb3JcbiAgICBcdH0pO1xuXHR9O1xuXG5cdC8vIHNlc3Npb24gaW4gYW5kIG91dCBldmVudHNcblx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIiwgZnVuY3Rpb24oKSB7XG5cdCAgaWYgKGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAndmlzaWJsZScgfHwgXG5cdCAgXHRkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ21velZpc2libGUnIHx8IFxuXHQgIFx0ZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09ICdtc1Zpc2libGUnIHx8XG5cdCAgXHRkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ3dlYmtpdFZpc2libGUnKVxuXHQgIHtcblx0ICBcdFNlc3Npb25TdmMudXBkYXRlT25saW5lc3RhdCh0cnVlLCAkc2NvcGUuZ3VpZCk7XG5cdCAgXHQkc2NvcGUuaW5pdFNlc3Npb24oKTtcblx0ICBcdGlmICgkc2NvcGUubWFwKVxuXHQgIFx0e1xuXHQgIFx0XHQkc2NvcGUubWFwLnVwZGF0ZUFuZERyYXdQb3N0cygpO1xuXHRcdH1cblx0ICB9IFxuXHQgIGVsc2UgaWYgKGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAnaGlkZGVuJyB8fCBcblx0ICBcdGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAnbW96SGlkZGVuJyB8fCBcblx0ICBcdGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAnbXNIaWRkZW4nIHx8XG5cdCAgXHRkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ3dlYmtpdEhpZGRlbicpXG5cdCAge1xuXHQgIFx0U2Vzc2lvblN2Yy51cGRhdGVPbmxpbmVzdGF0KGZhbHNlLCAkc2NvcGUuZ3VpZClcblx0ICBcdC8vU2Vzc2lvblN2Yy5yZW1vdmUoJHNjb3BlLmd1aWQpXG5cdCAgXHQuc3VjY2VzcyhmdW5jdGlvbihyZXMpe1xuICAgIFx0XHQvLyBoYW5kbGUgc3VjY2Vzc1xuICAgIFx0fSlcbiAgICBcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgIFx0XHQvLyBoYW5kbGUgZXJyb3JcbiAgICBcdH0pO1xuXHQgIH1cblx0fSk7XG5cblx0Ly8gd2Via2l0IHNlc3Npb24gaW4gYW5kIG91dCBldmVudHNcblx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIndlYmtpdHZpc2liaWxpdHljaGFuZ2VcIiwgZnVuY3Rpb24oKSB7XG5cdCAgaWYgKGRvY3VtZW50LndlYmtpdFZpc2libGUpXG5cdCAge1xuXHQgIFx0U2Vzc2lvblN2Yy51cGRhdGVPbmxpbmVzdGF0KHRydWUsICRzY29wZS5ndWlkKTtcblx0ICBcdCRzY29wZS5pbml0U2Vzc2lvbigpO1xuXHQgIFx0aWYgKCRzY29wZS5tYXApXG5cdCAgXHR7XG5cdCAgXHRcdCRzY29wZS5tYXAudXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cdFx0fVxuXHQgIH0gXG5cdCAgZWxzZSBpZiAoZG9jdW1lbnQud2Via2l0SGlkZGVuKVxuXHQgIHtcblx0ICBcdFNlc3Npb25TdmMudXBkYXRlT25saW5lc3RhdChmYWxzZSwgJHNjb3BlLmd1aWQpXG5cdCAgXHQvL1Nlc3Npb25TdmMucmVtb3ZlKCRzY29wZS5ndWlkKVxuXHQgIFx0LnN1Y2Nlc3MoZnVuY3Rpb24ocmVzKXtcbiAgICBcdFx0Ly8gaGFuZGxlIHN1Y2Nlc3NcbiAgICBcdH0pXG4gICAgXHQuY2F0Y2goZnVuY3Rpb24oZXJyKXtcbiAgICBcdFx0Ly8gaGFuZGxlIGVycm9yXG4gICAgXHR9KTtcblx0ICB9XG5cdH0sIGZhbHNlKTtcblxuXHQkc2NvcGUuc2V0V2F0Y2hMb2NhdGlvbiA9IGZ1bmN0aW9uKCl7XG4gICAgXHRuYXZpZ2F0b3IuZ2VvbG9jYXRpb24ud2F0Y2hQb3NpdGlvbihvblN1Y2Nlc3MpO1xuICAgIH07XG5cblx0Ly8gb25TdWNjZXNzIEdlb2xvY2F0aW9uXG5cdGZ1bmN0aW9uIG9uU3VjY2Vzcyhwb3MpIHtcbiAgICAgICAgdmFyIGNyZCA9IHBvcy5jb29yZHM7XG5cbiAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoY3JkLmxhdGl0dWRlLCBjcmQubG9uZ2l0dWRlKTtcblxuICAgICAgICAkc2NvcGUubWFwLmRyYXdVc2VyTG9jYXRpb25NYXJrZXIoZ29vZ2xlTG9jKTtcblxuICAgICAgIFx0U2Vzc2lvblN2Yy51cGRhdGVDdXJyZW50TG9jYXRpb24oY3JkLmxhdGl0dWRlLCBjcmQubG9uZ2l0dWRlLCAkc2NvcGUuZ3VpZCk7XG4gICAgfTtcblxuXHQkc2NvcGUuaW5pdFNlc3Npb24gPSBmdW5jdGlvbigpe1xuXHRcdGlmICgkc2NvcGUubWFwID09ICd1bmRlZmluZWQnIHx8ICRzY29wZS5tYXAgPT0gJ251bGwnIHx8ICEkc2NvcGUubWFwKVxuXHRcdFx0cmV0dXJuO1xuXG5cdFx0ZnVuY3Rpb24gZ2V0Q3VyckxvY1N1Y2Nlc3MocG9zKSB7XHRcblx0XHRcdC8vLy8vLy8vLy8vLy8vLy8vLyBQSFlTSUNBTCBMT0NBVElPTlxuXHRcdFx0Ly8g66eo7LKY7J2M7JeQ64qUIOycoOyggOydmCDsi6TsoJwg7JyE7LmYKOyVseyXkCDsnoXsnqXtlojsnYTrlYzsnZgg7JyE7LmYKeyZgCDshLzthLAg7Y+s7KeA7IWY7J2EIOqwmeydtCDrs7TrgrTqs6AsXG5cdFx0XHQvLyDshLzthLAg7Y+s7KeA7IWY7J2AIOqzhOyGjSDsl4XrjbDsnbTtirgg65CY7Ja07JW8IO2VnOuLpC5cblx0ICAgICAgICB2YXIgY3JkID0gcG9zLmNvb3JkcztcblxuXHQgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGNyZC5sYXRpdHVkZSwgY3JkLmxvbmdpdHVkZSk7XG5cblx0ICAgICAgICAvLyBzYXZlIHRoZSB1c2VyIGxvY2F0aW9uIGludG8gYXBwbGljYXRpb24gc2NvcGUgdmFyaWFibGVcblx0ICAgICAgICAkc2NvcGUudXNlckxvY2F0aW9uID0ge1xuXHQgICAgICAgIFx0bGF0OiBjcmQubGF0aXR1ZGUsXG5cdCAgICAgICAgXHRsb246IGNyZC5sb25naXR1ZGVcblx0ICAgICAgICB9O1xuXG5cdCAgICAgICAgdmFyIGxvY2F0aW9uID0ge1xuXHQgICAgXHRcdGxhdDpnb29nbGVMb2MubGF0KCksXG5cdCAgICBcdFx0bG9uOmdvb2dsZUxvYy5sbmcoKVxuXHQgICAgXHR9O1xuXHQgICAgXHR2YXIgbG9jYXRpb25KU09OID0gSlNPTi5zdHJpbmdpZnkobG9jYXRpb24pO1xuXHQgICAgXHQvL2NvbnNvbGUubG9nKFwic2V0dGluZyBsb2NhdGlvblwiLCBsb2NhdGlvbkpTT04pO1xuXG5cdCAgICBcdC8vLy8vLy8vLy8vLy8vLy8vLyBXQVRDSCBMT0NBVElPTlxuXHQgICAgXHR2YXIgYm91bmRzID0gJHNjb3BlLm1hcC5nZXRCb3VuZHMoKTtcblx0ICAgICAgICB2YXIgbmUgPSBib3VuZHMuZ2V0Tm9ydGhFYXN0KCk7IC8vIExhdExuZyBvZiB0aGUgbm9ydGgtZWFzdCBjb3JuZXJcblx0ICAgICAgICB2YXIgc3cgPSBib3VuZHMuZ2V0U291dGhXZXN0KCk7IC8vIExhdExuZyBvZiB0aGUgc291dGgtd2VzdCBjb3JkZXJcblx0ICAgICAgICAvL1lvdSBnZXQgbm9ydGgtd2VzdCBhbmQgc291dGgtZWFzdCBjb3JuZXJzIGZyb20gdGhlIHR3byBhYm92ZTpcblxuXHQgICAgICAgIHZhciBjdXJyZW50X21hcF9udyA9IHsgXG5cdCAgICAgICAgICAgIGxhdDogbmUubGF0KCksIFxuXHQgICAgICAgICAgICBsb246IHN3LmxuZygpXG5cdCAgICAgICAgfTtcblx0ICAgICAgICB2YXIgY3VycmVudF9tYXBfc2UgPSB7XG5cdCAgICAgICAgICAgIGxhdDogc3cubGF0KCksIFxuXHQgICAgICAgICAgICBsb246IG5lLmxuZygpXG5cdCAgICAgICAgfTtcblxuXHQgICAgICAgIHZhciBjdXJyZW50X21hcF9jZW50ZXIgPSB7XG5cdCAgICAgICAgXHRsYXQ6d2luZG93LmxvY2FsU3RvcmFnZS5sYXRpdHVkZSxcblx0ICAgICAgICBcdGxvbjp3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZVxuXHQgICAgXHR9O1xuXG5cdCAgICAgICAgdmFyIHdhdGNobG9jID0ge1xuXHQgICAgICAgICAgICBud19sYXQgICAgOiBjdXJyZW50X21hcF9udy5sYXQsXG5cdCAgICAgICAgICAgIG53X2xvbiAgICA6IGN1cnJlbnRfbWFwX253Lmxvbixcblx0ICAgICAgICAgICAgc2VfbGF0ICAgIDogY3VycmVudF9tYXBfc2UubGF0LFxuXHQgICAgICAgICAgICBzZV9sb25cdCAgOiBjdXJyZW50X21hcF9zZS5sb24sXG5cdCAgICAgICAgICAgIGNlbnRlcl9sYXQ6IGN1cnJlbnRfbWFwX2NlbnRlci5sYXQsXG5cdCAgICAgICAgICAgIGNlbnRlcl9sb246IGN1cnJlbnRfbWFwX2NlbnRlci5sb25cblx0ICAgICAgICB9XG5cbiAgICAgICAgXHR2YXIgd2F0Y2hsb2NKU09OID0gSlNPTi5zdHJpbmdpZnkod2F0Y2hsb2MpO1xuICAgICAgICBcdC8vY29uc29sZS5sb2coXCJzZXR0aW5nIHdhdGNobG9jXCIsIHdhdGNobG9jSlNPTik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLyBMT0NBVElPTiBVUERBVEUgV0lUSCBTRVNTSU9OIEVOVEVSXG4gICAgICAgICAgICAvL+yXrOq4sOyEnCDruYTrj5nquLDsoIHsnLzroZwg7Jyg7KCA7J2YIOuhnOy8gOydtOyFmOydhCDslrvqs6Ag7IS47IWY7J2EIOuztOuCvOyImCDsnojri6QuXG5cdFx0XHR2YXIgc2Vzc2lvbiA9IHtcblx0XHRcdFx0Z3VpZHRndCA6ICRzY29wZS5ndWlkdGd0LFxuXHRcdFx0XHRndWlkICAgIDogJHNjb3BlLmd1aWQsXG5cdFx0XHRcdGxvY2F0aW9uOiBsb2NhdGlvbkpTT04sXG5cdFx0XHRcdHdhdGNobG9jOiB3YXRjaGxvY0pTT05cblx0XHRcdH07XG5cdFx0XHRTZXNzaW9uU3ZjLmVudGVyKHNlc3Npb24pXG5cdFx0XHQuc3VjY2VzcyhmdW5jdGlvbihyZXMpe1xuICAgIFx0XHQvLyBoYW5kbGUgc3VjY2Vzc1xuICAgIFx0XHRcdFNlc3Npb25TdmMudXBkYXRlT25saW5lc3RhdCh0cnVlLCAkc2NvcGUuZ3VpZCk7XG5cdCAgICBcdH0pXG5cdCAgICBcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xuXHQgICAgXHRcdC8vIGhhbmRsZSBlcnJvclxuXHQgICAgXHR9KTsgLy8g7ISc67KE7JeQ7IScIOycoOyggOqwgCDrk6TslrTsmLTsnYQg7JWM66aw64ukLlxuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiBnZXRDdXJyTG9jRXJyb3IoZXJyKSB7XG4gICAgICAgIFx0c3dhbChcIlwiLCBcIk5lZWQgdG8gdHVybiBvbiBsb2NhdGlvbiBzZXJ2aWNlIGZvciBwcm9wZXIgdXNlLlwiKTtcbiAgICAgICAgICAgIC8vY29uc29sZS53YXJuKCdFUlJPUignICsgZXJyLmNvZGUgKyAnKTogJyArIGVyci5tZXNzYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGluaXQgbWFwIGFuZCBwbGFjZSBzb21lIG1hcmtlcnMsIHNvIGV2ZXJ5dGhpbmcgc3RhcnQgd2l0aCB0aGlzIGZ1bmN0aW9uLlxuICAgICAgICB2YXIgb3B0aW9ucyA9IHtcblx0XHQgIGVuYWJsZUhpZ2hBY2N1cmFjeTogZmFsc2UsXG5cdFx0ICB0aW1lb3V0OiAxMDAwMCxcblx0XHQgIG1heGltdW1BZ2U6IDMwMDAwLFxuXHRcdH07XG5cdCAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGdldEN1cnJMb2NTdWNjZXNzLCBnZXRDdXJyTG9jRXJyb3IsIG9wdGlvbnMpO1xuXHRcdHN3YWwoeyAgIHRpdGxlOiBcIlwiLCAgIHRleHQ6IFwiUmV0cmVpdmluZyBjdXJybmV0IGxvY2F0aW9uLi5cIiwgICB0aW1lcjogMTIwMCwgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UgfSk7XG5cdH07XG5cbiAgICAvLyBsb2FkIGFuZCBzZXQgbGF0ZXN0IGd1aWRcblx0aWYgKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZCA9PSAndW5kZWZpbmVkJyB8fCBcblx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWQgPT0gJ251bGwnIHx8XG5cdFx0IXdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZClcblx0e1xuXHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZCA9IFV0aWxTdmMuZ2V0R3VpZCgpO1xuXHR9XG5cdCRzY29wZS5ndWlkID0gd2luZG93LmxvY2FsU3RvcmFnZS5ndWlkO1xuXG5cdC8vIGxvYWQgYW5kIHNldCBsYXRlc3QgZ3VpZHRndFxuXHRpZiAod2luZG93LmxvY2FsU3RvcmFnZS5ndWlkdGd0ID09ICd1bmRlZmluZWQnIHx8IFxuXHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZHRndCA9PSAnbnVsbCcgfHxcblx0XHQhd2luZG93LmxvY2FsU3RvcmFnZS5ndWlkdGd0KVxuXHR7XG5cdFx0d2luZG93LmxvY2FsU3RvcmFnZS5ndWlkdGd0ID0gXCIwXCI7XG5cdH1cblx0JHNjb3BlLmd1aWR0Z3QgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWR0Z3Q7IC8vIGludGVyZXN0ZWQgb3Bwb25lbnQgZ3VpZCBudW1iZXJcblxuXHQkc2NvcGUucGFnZUlkID0geyBcblx0XHRwb3N0IDogMCxcblx0fTtcblxuXHQkc2NvcGUubmF2Q29sbGFwc2VkID0gdHJ1ZTtcblxuXHQvLyB2YWx1ZSBmcm9tIHRpbWUgc2xpZGVyIGluIFVJXG5cdC8vIGRlZmF1bHQgaXMgbWF4IGluc3RhbnQgbGlmZSBzcGFuXG4gICAgJHNjb3BlLnRpbWV2YWx1ZSA9IENvbmZpZ1N2Yy5tYXhJbnN0YW50TGlmZVNwYW47XG5cblx0Ly8gdXNlcidzIGN1cnJlbnQgbG9jYXRpb24gc3RvcmFnZVxuXHQkc2NvcGUudXNlckxvY2F0aW9uID0ge1xuXHRcdGxhdDogMC4wLFxuXHRcdGxvbjogMC4wXG5cdH07XG5cblx0JHNjb3BlLnRvZ2dsZVNlYXJjaExvY2F0aW9uID0gZmFsc2U7XG5cdCRzY29wZS50b2dnbGVUaW1lU2xpZGVyID0gZmFsc2U7XG5cblx0Ly8gZXZlbnQgaGFuZGVyIGZvciBtYXAgVUlzXG5cdCR0aW1lb3V0KGZ1bmN0aW9uKCl7XG5cdFx0Ly8gZW5hYmxlcyBlbnRlciBrZXkgdG8gc3VibWl0IHBvc3QgZm9ybVxuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtcG9zdGluZycpLm9ua2V5cHJlc3MgPSBmdW5jdGlvbihldmVudCl7XG5cdFx0XHQvL2NvbnNvbGUubG9nKFwiSW5zaWRlIGtleXByZXNzXCIsZXZlbnQud2hpY2gpO1xuXHRcdFx0aWYgKGV2ZW50LndoaWNoID09ICcxMycpe1xuXHRcdFx0XHQvL2NvbnNvbGUubG9nKFwiZW50ZXIgcHJlc3NlZFwiKTtcblx0XHRcdFx0JCgnZm9ybSNtYXAtcG9zdGluZy1mb3JtJykuc3VibWl0KCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1wb3N0aW5nJykub25mb2N1cyA9IGZ1bmN0aW9uKGV2ZW50KXtcblx0XHRcdC8vY29uc29sZS5sb2coXCJvbiBmb2N1c1wiKTtcblx0XHRcdCRzY29wZS50b2dnbGVUaW1lU2xpZGVyID0gdHJ1ZTtcblx0XHR9XG5cblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLXBvc3RpbmcnKS5vbmJsdXIgPSBmdW5jdGlvbihldmVudCl7XG5cdFx0XHQvL2NvbnNvbGUubG9nKFwib24gYmx1clwiKTtcblx0XHRcdCRzY29wZS50b2dnbGVUaW1lU2xpZGVyID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0JCgnLm5hdi1idXJnZXInKS5jbGljayhmdW5jdGlvbigpIHtcblx0XHQgICQoJy5uYXYtYnVyZ2VyJykudG9nZ2xlQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdCAgLy8kKCcuY29udHJvbHMnKS50b2dnbGVDbGFzcygnYWN0aXZlJyk7XG5cdFx0ICAkc2NvcGUudG9nZ2xlU2VhcmNoTG9jYXRpb24gPSAhJHNjb3BlLnRvZ2dsZVNlYXJjaExvY2F0aW9uO1xuXHRcdCAgJHNjb3BlLiRhcHBseSgpO1xuXHRcdH0pO1xuXG5cdH0pO1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBTT0NLRVRcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHR2YXIgdXJsO1xuXHR2YXIgaG9zdG5hbWUgPSBkb2N1bWVudC5sb2NhdGlvbi5ob3N0bmFtZTtcblxuXHRpZiAoaG9zdG5hbWUgPT0gQ29uZmlnU3ZjLmxvY2FsKXtcblx0XHR1cmwgPSBDb25maWdTdmMud2ViX3NvY2tldCArIENvbmZpZ1N2Yy5sb2NhbCArICc6JyArIENvbmZpZ1N2Yy5wb3J0O1xuXHR9XG5cdGVsc2UgaWYgKGhvc3RuYW1lID09IENvbmZpZ1N2Yy5sb2NhbF9pcCkge1xuXHRcdHVybCA9IENvbmZpZ1N2Yy53ZWJfc29ja2V0ICsgQ29uZmlnU3ZjLmxvY2FsX2lwICsgJzonICsgQ29uZmlnU3ZjLnBvcnQ7IC8vIGRldmVsb3BtZXQgb24gc29ja2V0IGxvY2FsbHkgXG5cdH1cblx0ZWxzZSB7XG5cdFx0dXJsID0gQ29uZmlnU3ZjLndlYl9zb2NrZXQgKyBDb25maWdTdmMuZGVwbG95X2RuczsgLy8gcHJvZHVjdGlvbiBkZXBsb3kgdmVyc2lvbiAtIHN0aWxsIGRlYnVnIG1vZGVcblx0XHQvL3VybCA9IENvbmZpZ1N2Yy53ZWJfc29ja2V0X3NlY3VyZSArIENvbmZpZ1N2Yy5kZXBsb3lfZG5zOyAvLyBwcm9kdWN0aW9uIGRlcGxveSB2ZXJzaW9uIC0gc3RpbGwgZGVidWcgbW9kZVxuXHR9XG5cblx0Lyog6rCc67Cc6rO87KCV7J20IOuBneuCmOqzoCDrsLDtj6zsi5zsl5DripQg7JyE67aA67aE7J2EIOyngOyasOqzoCDslYTrnpgg7L2U65Oc66eMIOuCqOqyqOuPhCDrkJzri6QuXG5cdHVybCA9ICd3c3M6Ly9mcm96ZW4tYmFkbGFuZHMtODY0OS5oZXJva3VhcHAuY29tJztcblx0Ki9cblx0dmFyIGNvbm5lY3QgPSBmdW5jdGlvbigpIHtcblx0XHRjb25uZWN0aW9uID0gbmV3IFdlYlNvY2tldCh1cmwpO1xuXG5cdFx0Y29ubmVjdGlvbi5vbm9wZW4gPSBmdW5jdGlvbigpe1xuXG5cdFx0XHQvLyBzZW5kIGd1aWQgdG8gc2VydmVyIGZvciB3cyBpZGVudGlmaWNhdGlvblxuXHRcdFx0Y29ubmVjdGlvbi5zZW5kKCRzY29wZS5ndWlkKTtcblx0XHRcdC8vY29uc29sZS5sb2coJ1dlYlNvY2tldCBjb25uZWN0ZWQnKTtcblx0XHR9O1xuXG5cdFx0Y29ubmVjdGlvbi5vbmNsb3NlID0gZnVuY3Rpb24oKXtcblxuXHRcdFx0Ly9jb25zb2xlLmxvZygnV2ViU29ja2V0IGNsb3NlZC4gUmVjb25lY3RpbmcuLi4nKTtcblx0XHRcdCR0aW1lb3V0KGNvbm5lY3QsIDIwMDApO1xuXHRcdH07XG5cblx0XHRjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGUpe1xuXHRcdFx0Ly9jb25zb2xlLmxvZygnYnJvYWRjYXN0IG1zZyBmcm9tIHNlcnZlcjonLCBlKTtcblx0XHRcdHZhciBwYXlsb2FkID0gSlNPTi5wYXJzZShlLmRhdGEpO1xuXG5cdFx0XHQvKlxuXHRcdFx0XHR3czpuZXdfcG9zdCAgICAtIOyDiOuhnOyatCDtj6zsiqTtirjqsIAg7Jis65287JmU7J2E65WMIGZyb250LWVuZOyXkOyEnCDrp7XsnbQg64uk7IucIOyXheuNsOydtO2KuCDtlbTslbwg65Cc64uk6rOgIOyVjOugpOykgOuLpCFcblx0XHRcdFx0d3M6bmV3X3Nlc3Npb24gLSBzZXNzaW9u7J20IOyDiOuhnCDrk6TslrTsmKTrqbQg65Cc64uk6rOgIOyVjOugpOykgOuLpCFcblx0XHRcdFx0d3M6cmVtb3ZlX3Bvc3QgLSDtj6zsiqTtirjqsIAg7Iuc6rCE7J20IOuLpCDrkJjslrTshJwg7IKs65287KeI65WMIVxuXHRcdFx0XHTrp6TsmrDspJHsmpQhIFxuXHRcdFx0Ki9cblx0XHRcdCRyb290U2NvcGUuJGJyb2FkY2FzdCgnd3M6JyArIHBheWxvYWQudHlwZSwgcGF5bG9hZC5kYXRhKTtcblx0XHR9O1xuXHR9O1xuXHRjb25uZWN0KCk7XG5cblx0Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBTT0NLRVQgQlJPQURDQVNUIFJFQ0VJVkVSXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0Ly8gYXMgc2VydmVyIHNvY2tldCBzZW5kICd3czpuZXdfcG9zdCcgLCB3ZSBjYW4gdXBkYXRlIHRoZSBtYXAhXG5cdCRzY29wZS4kb24oJ3dzOm5ld19wb3N0JywgZnVuY3Rpb24oXywgcG9zdCl7XG5cdFx0Ly8gdXBkYXRlIHBvc3RzIG9uIG1hcFxuXHRcdCRzY29wZS5tYXAudXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cblx0XHQvLyBzaG93IHJlc3BvbnNpdmUgdXNlcnMgb25seSB0byB0aGUgdXNlciB3aG8gd3JvdGUgdGhpcyBwb3N0XG5cdFx0aWYgKHBvc3QuZ3VpZCA9PSAkc2NvcGUuZ3VpZClcblx0XHR7XG5cdFx0XHQkc2NvcGUubWFwLmRyYXdSZXNwb25zZXMocG9zdCk7XG5cdFx0fVxuXHR9KTtcblxuXHQvLyBhcyBzZXJ2ZXIgc29ja2V0IHNlbmQgJ3dzOm5ld19wb3N0JyAsIHdlIGNhbiB1cGRhdGUgdGhlIG1hcCFcblx0JHNjb3BlLiRvbignd3M6bmV3X3Nlc3Npb24nLCBmdW5jdGlvbihfLCBzZXNzaW9uKXtcblx0XHRpZiAoc2Vzc2lvbi5ndWlkICE9ICRzY29wZS5ndWlkKSB7XG5cdFx0XHR2YXIgbG9jYXRpb24gPSBhbmd1bGFyLmZyb21Kc29uKHNlc3Npb24ubG9jYXRpb24pO1xuXHRcdFx0JHNjb3BlLm1hcC5kcmF3Q3VyckxvY2F0aW9uTWFya2VyKGxvY2F0aW9uKTtcblx0XHR9XG5cdH0pO1xuXG5cdC8vIHdoZW4gc2VydmVyIHJlbW92ZSB0aGUgcG9zdCBhZnRlciB0aW1lIGZvciBsb25nZXIgb25lcywgXG5cdC8vIHVwZGF0ZSBtYXAgd2l0aCBjb3Jlc3BvbmRpbmcgaW5mb1xuXHQkc2NvcGUuJG9uKCd3czpyZW1vdmVfcG9zdCcsIGZ1bmN0aW9uKF8sIHBvc3RpZCl7XG5cdFx0JHNjb3BlLm1hcC51bkRyYXdQb3N0KHBvc3RpZCk7XG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ3dzOnVwZGF0ZV9ndWlkdGd0JywgZnVuY3Rpb24oXywgdXBkYXRlZFNlc3Npb24pe1xuXHRcdC8vIHVwZGF0ZSBwb3N0cyBvbiBtYXBcblx0XHQkc2NvcGUubWFwLnVwZGF0ZUFuZERyYXdQb3N0cygpO1xuXHR9KTtcblxuXHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEFQUExJQ0FUSU9OIExFVkVMIEZVTkNUSU9OU1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gc2VlIGlmIGl0cyBpbnN0YW50XG4gICAgJHNjb3BlLmlzSW5zdGFudCA9IGZ1bmN0aW9uKHRpbWV2YWx1ZSl7XG4gICAgXHRpZiAodGltZXZhbHVlIDw9IENvbmZpZ1N2Yy5tYXhJbnN0YW50TGlmZVNwYW4pXG4gICAgXHRcdHJldHVybiB0cnVlO1xuICAgIFx0cmV0dXJuIGZhbHNlO1xuICAgIH07XG5cblx0Ly8gc2VlIGlmIGl0cyBtb2JpbGUgcGhvbmVcblx0JHNjb3BlLmlzTW9iaWxlID0gZnVuY3Rpb24oKXtcblx0XHRpZiggbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvQW5kcm9pZC9pKVxuXHRcdCB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC93ZWJPUy9pKVxuXHRcdCB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUGhvbmUvaSlcblx0XHQgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBhZC9pKVxuXHRcdCB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUG9kL2kpXG5cdFx0IHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0JsYWNrQmVycnkvaSlcblx0XHQgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvV2luZG93cyBQaG9uZS9pKVxuXHRcdCApe1xuXHRcdCAgICByZXR1cm4gdHJ1ZTtcblx0XHQgIH1cblx0XHQgZWxzZSB7XG5cdFx0ICAgIHJldHVybiBmYWxzZTtcblx0XHQgIH1cblx0fTtcblxuXHQvKiBtb3ZlIHRvIGN1cnJlbnQgbG9jYXRpb24gKi9cblx0JHNjb3BlLm1vdmVUb0N1cnJlbnRMb2NhdGlvbiA9IGZ1bmN0aW9uKCl7XG5cdFx0ZnVuY3Rpb24gZ2V0Q3VyckxvY1N1Y2Nlc3MocG9zKSB7XG4gICAgICAgICAgICAvKiBtYWtlIHN1cmUgdG8gY2hlY2sgd2UgYXJlIG9uIHBvc3QgcGFnZSB3aXRoIG1hcCBmaXJzdCAqL1xuICAgICAgICAgICAgaWYgKCRzY29wZS5jdXJyZW50UGFnZUlkICE9ICRzY29wZS5wYWdlSWQucG9zdClcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIHZhciBjcmQgPSBwb3MuY29vcmRzO1xuXG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gY3JkLmxhdGl0dWRlO1xuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUgPSBjcmQubG9uZ2l0dWRlO1xuXG4gICAgICAgICAgICB2YXIgbG9jYXRpb24gPSB7XG4gICAgICAgICAgICBcdGxhdDogY3JkLmxhdGl0dWRlLCBcbiAgICAgICAgICAgIFx0bG9uOiBjcmQubG9uZ2l0dWRlXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgIFx0Ly8gZHJhdyB4IG1hcmtlclxuXHQgICAgICAgICRzY29wZS5tYXAuZHJhd1hNYXJrZXIobG9jYXRpb24pO1xuXG5cdCAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobG9jYXRpb24ubGF0LCBsb2NhdGlvbi5sb24pO1xuXG5cdCAgICAgICAgLy8gbW92ZSB0byB0aGUgbG9jYXRpb24gYW5kIHpvb20gaW50byByaWdodCBhbW91bnRcbiAgICAgICAgICAgICRzY29wZS5tYXAucGFuVG8oZ29vZ2xlTG9jKTtcbiAgICAgICAgICAgICRzY29wZS5tYXAudXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRDdXJyTG9jRXJyb3IoZXJyKSB7XG4gICAgICAgIFx0c3dhbChcIlwiLCBcIk5lZWQgdG8gdHVybiBvbiBsb2NhdGlvbiBzZXJ2aWNlIGZvciBwcm9wZXIgdXNlLlwiKTtcbiAgICAgICAgICAgIC8vY29uc29sZS53YXJuKCdFUlJPUignICsgZXJyLmNvZGUgKyAnKTogJyArIGVyci5tZXNzYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGluaXQgbWFwIGFuZCBwbGFjZSBzb21lIG1hcmtlcnMsIHNvIGV2ZXJ5dGhpbmcgc3RhcnQgd2l0aCB0aGlzIGZ1bmN0aW9uLlxuICAgICAgICB2YXIgb3B0aW9ucyA9IHtcblx0XHQgIGVuYWJsZUhpZ2hBY2N1cmFjeTogdHJ1ZSxcblx0XHQgIHRpbWVvdXQ6IDEwMDAwLFxuXHRcdCAgbWF4aW11bUFnZTogMzAwMDAsXG5cdFx0fTtcbiAgICAgICAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihnZXRDdXJyTG9jU3VjY2VzcywgZ2V0Q3VyckxvY0Vycm9yLCBvcHRpb25zKTtcblxuICAgICAgICBzd2FsKHsgICB0aXRsZTogXCJcIiwgICB0ZXh0OiBcIk1vdmluZyB0byBjdXJyZW50IGxvY2F0aW9uLi5cIiwgICB0aW1lcjogMTAwMCwgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UgfSk7XG5cdH07XG5cblx0JHNjb3BlLm1vdmVUb1Bvc3RMb2NhdGlvbiA9IGZ1bmN0aW9uKCl7XG5cdFx0dmFyIGxhdERlbHRhID0gMC4wO1xuXG5cdFx0aWYgKCRzY29wZS5pc01vYmlsZSgpKXtcblx0XHRcdHZhciBib3VuZHMgPSAkc2NvcGUubWFwLmdldEJvdW5kcygpO1xuXHQgICAgICAgIHZhciBuZSA9IGJvdW5kcy5nZXROb3J0aEVhc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBub3J0aC1lYXN0IGNvcm5lclxuXHQgICAgICAgIHZhciBzdyA9IGJvdW5kcy5nZXRTb3V0aFdlc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBzb3V0aC13ZXN0IGNvcmRlclxuXHQgICAgICAgIGN1cnJlbnRfbWFwX253ID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhuZS5sYXQoKSwgc3cubG5nKCkpO1xuXHQgICAgICAgIGN1cnJlbnRfbWFwX3NlID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhzdy5sYXQoKSwgbmUubG5nKCkpO1xuXG5cdCAgICAgICAgdmFyIGxhdERlbHRhX2NlbnRlcjJub3J0aCA9IDAuNSAqIE1hdGguYWJzKCRzY29wZS5wb3N0TG9jYXRpb24ubGF0IC0gY3VycmVudF9tYXBfbncubGF0KCkpO1xuXHQgICAgICAgIHZhciBsYXREZWx0YV9jZW50ZXIyc291dGggPSAwLjUgKiBNYXRoLmFicygkc2NvcGUucG9zdExvY2F0aW9uLmxhdCAtIGN1cnJlbnRfbWFwX3NlLmxhdCgpKTtcblxuXHQgICAgICAgIGlmIChsYXREZWx0YV9jZW50ZXIybm9ydGggPiBsYXREZWx0YV9jZW50ZXIyc291dGgpe1xuXHQgICAgICAgIFx0bGF0RGVsdGEgPSBsYXREZWx0YV9jZW50ZXIyc291dGg7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgIFx0bGF0RGVsdGEgPSBsYXREZWx0YV9jZW50ZXIybm9ydGg7XG5cdCAgICAgICAgfVxuXHRcdH1cblxuXHRcdHZhciBjZW50ZXJMb2MgPSAkc2NvcGUubWFwLmdldENlbnRlcigpO1xuXG5cdFx0dmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoJHNjb3BlLnBvc3RMb2NhdGlvbi5sYXQgKyBsYXREZWx0YSwgY2VudGVyTG9jLmxuZygpKTtcblx0XHQkc2NvcGUubWFwLnBhblRvKGdvb2dsZUxvYyk7XG5cdFx0JHNjb3BlLm1hcC51cGRhdGVBbmREcmF3UG9zdHMoKTtcblx0fTtcblxuXHQkc2NvcGUuY29sbGFwc2UgPSBmdW5jdGlvbigpe1xuXHRcdCRzY29wZS5uYXZDb2xsYXBzZWQgPSB0cnVlO1xuXHR9O1xuXG5cdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gR0VORVJBTCBCUk9BRENBU1QgUkVDRUlWRVJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICRzY29wZS4kb24oJ3NldDptYXAnLCBmdW5jdGlvbihfLCBtYXApe1xuXHRcdCRzY29wZS5tYXAgPSBtYXA7XG5cdFx0JHRpbWVvdXQoZnVuY3Rpb24oKXtcblx0XHRcdCRzY29wZS5pbml0U2Vzc2lvbigpO1xuXHRcdFx0JHNjb3BlLnNldFdhdGNoTG9jYXRpb24oKTtcblx0XHR9KTtcblx0fSk7XG5cbiAgICAkc2NvcGUuJG9uKCdzZXQ6Z3VpZHRndCcsIGZ1bmN0aW9uKF8sIGd1aWR0Z3Qpe1xuXHRcdCRzY29wZS5ndWlkdGd0ID0gZ3VpZHRndDtcblxuXHRcdC8vIGl0cyB2ZXJ5IGltcG9yYW50IHRvIHNldCBsb2NhbCBzdG9yYWdlIGd1aWR0Z3Rcblx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWR0Z3QgPSBndWlkdGd0O1xuXHR9KTtcblxuXHQkc2NvcGUuJG9uKCdzZXQ6cGFnZWNoYW5nZScsIGZ1bmN0aW9uKF8sIHBhZ2VJZCl7XG5cdFx0JHNjb3BlLmN1cnJlbnRQYWdlSWQgPSBwYWdlSWQ7XG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ3NldDpsb2MnLCBmdW5jdGlvbihfLCBsb2NhdGlvbil7XG5cdFx0dmFyIGxhdCA9IGxvY2F0aW9uLmxhdCgpO1xuXHRcdHZhciBsb24gPSBsb2NhdGlvbi5sbmcoKTtcblx0XHQkc2NvcGUucG9zdExvY2F0aW9uID0ge1xuXHRcdFx0bGF0OiBsYXQsXG5cdFx0XHRsb246IGxvblxuXHRcdH07XG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ3NldDpwbGFjZScsIGZ1bmN0aW9uKF8sIHBsYWNlKXtcblx0XHQvLyBGb3JjaW5nIHRoZSB1cGRhdGUgd2l0aCAkYXBwbHkoKSBtZXRob2Qgb24gJHNjb3BlXG5cdFx0Ly8gcHJvYmxlbSByZWxhdGVkIG5vdGU6IGh0dHA6Ly93d3cuamVmZnJ5aG91c2VyLmNvbS9pbmRleC5jZm0vMjAxNC82LzIvSG93LWRvLUktcnVuLWNvZGUtd2hlbi1hLXZhcmlhYmxlLWNoYW5nZXMtd2l0aC1Bbmd1bGFySlNcblx0XHQkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XG5cdFx0XHRcdCRzY29wZS5wb3N0cGxhY2UgPSBwbGFjZTtcblx0XHRcdH1cblx0XHQpO1xuXHR9KTtcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnN0YW50KCdDb25maWdTdmMnLCB7XG5cdFwid2ViX3NvY2tldFwiXHRcdDogXCJ3czovL1wiLFxuXHRcIndlYl9zb2NrZXRfc2VjdXJlXCIgOiBcIndzczovL1wiLFxuXHRcImxvY2FsXCJcdFx0XHRcdDogXCJsb2NhbGhvc3RcIixcblx0XCJsb2NhbF9pcFwiXHRcdFx0OiBcIjE5Mi4xNjguMC40XCIsXG5cdC8vXCJkZXBsb3lfZG5zXCJcdFx0OiBcImNsb3VkdGFsay5oZXJva3VhcHAuY29tXCIsXG5cdFwiZGVwbG95X2Ruc1wiXHRcdDogXCJ0YWxraXBpYS5jb21cIixcblx0XCJwb3J0XCJcdFx0XHRcdDogXCI1MDAwXCIsXG5cdFwibWF4SW5zdGFudExpZmVTcGFuXCI6IDUwMDAsXG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbmZpZyhmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIpe1xuXHQkcm91dGVQcm92aWRlclxuXHQud2hlbignLycsIFxuXHRcdHtcblx0XHRcdGNvbnRyb2xsZXI6ICdQb3N0c0N0cmwnLCBcblx0XHRcdHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9wb3N0cy5odG1sJ1xuXHRcdH0pXG5cdC8vIFJlZGlyZWN0IHRvIHRoZSByb290IHBhZ2UuXG5cdC5vdGhlcndpc2UoXG5cdFx0e1xuICAgXHRcdFx0cmVkaXJlY3RUbzogJy8nXG5cdFx0fSk7XG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1V0aWxTdmMnLCBmdW5jdGlvbigpe1xuXHR2YXIgc3ZjID0gdGhpcztcblxuXHRzdmMuZGVnMnJhZCA9IGZ1bmN0aW9uKGRlZykge1xuXHQgIHJldHVybiBkZWcgKiAoTWF0aC5QSS8xODApO1xuXHR9O1xuXG5cdHN2Yy5nZXREaXN0YW5jZUZyb21MYXRMb25JbkttID0gZnVuY3Rpb24gKGxhdDEsbG9uMSxsYXQyLGxvbjIpIHtcblx0ICB2YXIgUiA9IDYzNzE7XG5cdCAgdmFyIGRMYXQgPSBzdmMuZGVnMnJhZChsYXQyLWxhdDEpO1xuXHQgIHZhciBkTG9uID0gc3ZjLmRlZzJyYWQobG9uMi1sb24xKTsgXG5cdCAgdmFyIGEgPSBcblx0ICAgIE1hdGguc2luKGRMYXQvMikgKiBNYXRoLnNpbihkTGF0LzIpICtcblx0ICAgIE1hdGguY29zKHN2Yy5kZWcycmFkKGxhdDEpKSAqIE1hdGguY29zKHN2Yy5kZWcycmFkKGxhdDIpKSAqIFxuXHQgICAgTWF0aC5zaW4oZExvbi8yKSAqIE1hdGguc2luKGRMb24vMilcblx0ICAgIDsgXG5cdCAgdmFyIGMgPSAyICogTWF0aC5hdGFuMihNYXRoLnNxcnQoYSksIE1hdGguc3FydCgxLWEpKTsgXG5cdCAgdmFyIGQgPSBSICogYztcblx0ICByZXR1cm4gZDtcblx0fTtcblxuXHRzdmMubWFwUmFuZ2UgPSBmdW5jdGlvbiAodmFsdWUsIGxvdzEsIGhpZ2gxLCBsb3cyLCBoaWdoMikge1xuXHQgICAgcmV0dXJuIGxvdzIgKyAoaGlnaDIgLSBsb3cyKSAqICh2YWx1ZSAtIGxvdzEpIC8gKGhpZ2gxIC0gbG93MSk7XG5cdH07XG5cblx0c3ZjLmdldEd1aWQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0ZnVuY3Rpb24gczQoKSB7XG5cdFx0ICAgIHJldHVybiBNYXRoLmZsb29yKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKVxuXHRcdCAgICAgIC50b1N0cmluZygxNilcblx0XHQgICAgICAuc3Vic3RyaW5nKDEpO1xuXHRcdH1cblx0ICBcdHJldHVybiBzNCgpICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyBzNCgpICsgczQoKTtcblx0fTtcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnJ1bihmdW5jdGlvbigkcm9vdFNjb3BlLCAkdGltZW91dCwgU2Vzc2lvblN2Yyl7XG5cblxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uZGlyZWN0aXZlKCdhcHBNYXAnLCBmdW5jdGlvbihQb3N0c1N2YywgVXRpbFN2YywgQ29uZmlnU3ZjLCBTZXNzaW9uU3ZjLCAkY29tcGlsZSwgJHRpbWVvdXQpIHtcbiAgICAvLyBkaXJlY3RpdmUgbGluayBmdW5jdGlvblxuICAgIHZhciBsaW5rID0gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gR0xPQkFMIFZBUklBQkxFUyBJTiBMSU5LIEZVTkNUSU9OXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIHZhciBtYXA7IC8vIGV4cGFuZCBmcm9tIGdvb2dsZSBtYXAgZm9yIG1hbnVhbGx5IGNyZWF0ZWQgZXZlbnRzXG4gICAgICAgIHZhciBtYXBfb3JpZ2luOyAvLyBmb3Igb3JpZ2luYWwgZ29vZ2xlIG1hcCBldmVudCBmdW5jdGlvbiBsaW5rc1xuICAgICAgICB2YXIgY3VycmVudF9tYXBfbnc7XG4gICAgICAgIHZhciBjdXJyZW50X21hcF9zZTtcbiAgICAgICAgdmFyIG1hcE9wdGlvbnM7XG4gICAgICAgIHZhciBpbml0aWFsTWFwQ2VudGVyO1xuICAgICAgICB2YXIgQ0xPVURfTUFQX0lEID0gJ2N1c3RvbV9zdHlsZSc7IC8vIG1hcCBzdHlsZVxuICAgICAgICB2YXIgaGVscGVyTWFya2VycyA9IFtdO1xuICAgICAgICB2YXIgdXNlck1hcmtlcnMgPSBbXTtcbiAgICAgICAgdmFyIG1hcmtlcnNPbk1hcCA9IFtdO1xuXG4gICAgICAgIHZhciBwcmV2R3VpZHRndCA9ICcwJztcbiAgICAgICAgdmFyIGlzR3VpZHRndENoYW5nZWQ7XG5cbiAgICAgICAgdmFyIGltYWdlUG9zdCA9IHtcbiAgICAgICAgICAgIC8vdXJsOiAnaHR0cHM6Ly9jYXRjaG1lLmlmeW91Y2FuLmNvbS9pbWFnZXMvcGljdHVyZXMvSVlDX0ljb25zL0lZQ19Mb2NhdGlvbl9JY29uX1NtYWxsLnBuZycsXG4gICAgICAgICAgICB1cmw6ICdEZWZhdWx0X01hcmtlci5wbmcnLFxuICAgICAgICAgICAgc2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMTAwLCAxMDApLFxuICAgICAgICAgICAgb3JpZ2luOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMCwgMCksXG4gICAgICAgICAgICBhbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludCgxNywgMzQpLFxuICAgICAgICAgICAgc2NhbGVkU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMSwgMSlcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGltYWdlVGFyZ2V0ID0ge1xuICAgICAgICAgICAgLy91cmw6ICdodHRwOi8vd3d3LmNsa2VyLmNvbS9jbGlwYXJ0cy9VL1Avai9NL0kvaS94LW1hcmsteWVsbG93LW1kLnBuZycsXG4gICAgICAgICAgICB1cmw6ICdYX01hcmtlci5wbmcnLFxuICAgICAgICAgICAgc2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMTAwLCAxMDApLFxuICAgICAgICAgICAgb3JpZ2luOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMCwgMCksXG4gICAgICAgICAgICBhbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludCgxNywgMzQpLFxuICAgICAgICAgICAgc2NhbGVkU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMjUsIDI1KVxuICAgICAgICB9O1xuICAgICAgICB2YXIgaW1hZ2VVc2VyTG9naW4gPSB7XG4gICAgICAgICAgICAvL3VybDogJ2h0dHA6Ly93d3cuY2xrZXIuY29tL2NsaXBhcnRzL3Evby8yL0svZy9WL2xvY2F0aW9uLXN5bWJvbC1tYXAtbWQucG5nJyxcbiAgICAgICAgICAgIHVybDogJ0N1cnJlbnRfTG9jYXRpb25fTWFya2VyLnBuZycsXG4gICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICBvcmlnaW46IG5ldyBnb29nbGUubWFwcy5Qb2ludCgwLCAwKSxcbiAgICAgICAgICAgIGFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDE3LCAzNCksXG4gICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgyMCwgMzMpXG4gICAgICAgIH07XG4gICAgICAgICB2YXIgaW1hZ2VVc2VyTG9jYXRpb24gPSB7XG4gICAgICAgICAgICAgdXJsOiAnY3Vycl9tYXJrZXIucG5nJyxcbiAgICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICAgb3JpZ2luOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMCwgMCksXG4gICAgICAgICAgICAgYW5jaG9yOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMTcsIDM0KSxcbiAgICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgyMCwgMzMpXG4gICAgICAgICB9O1xuXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIEVWRU5UIEhBTkRMRVJTIC0gVVBEQVRFXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZURlZmF1bHRMb2NhdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUgPSBtYXAuZ2V0Q2VudGVyKCkubGF0KCk7XG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSA9IG1hcC5nZXRDZW50ZXIoKS5sbmcoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUJvdW5kcygpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBib3VuZHMgPSBtYXAuZ2V0Qm91bmRzKCk7XG4gICAgICAgICAgICB2YXIgbmUgPSBib3VuZHMuZ2V0Tm9ydGhFYXN0KCk7IC8vIExhdExuZyBvZiB0aGUgbm9ydGgtZWFzdCBjb3JuZXJcbiAgICAgICAgICAgIHZhciBzdyA9IGJvdW5kcy5nZXRTb3V0aFdlc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBzb3V0aC13ZXN0IGNvcmRlclxuICAgICAgICAgICAgLy9Zb3UgZ2V0IG5vcnRoLXdlc3QgYW5kIHNvdXRoLWVhc3QgY29ybmVycyBmcm9tIHRoZSB0d28gYWJvdmU6XG5cbiAgICAgICAgICAgIGN1cnJlbnRfbWFwX253ID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhuZS5sYXQoKSwgc3cubG5nKCkpO1xuICAgICAgICAgICAgY3VycmVudF9tYXBfc2UgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHN3LmxhdCgpLCBuZS5sbmcoKSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVXYXRjaExvY2F0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGJvdW5kcyA9IG1hcC5nZXRCb3VuZHMoKTtcbiAgICAgICAgICAgIHZhciBuZSA9IGJvdW5kcy5nZXROb3J0aEVhc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBub3J0aC1lYXN0IGNvcm5lclxuICAgICAgICAgICAgdmFyIHN3ID0gYm91bmRzLmdldFNvdXRoV2VzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIHNvdXRoLXdlc3QgY29yZGVyXG4gICAgICAgICAgICAvL1lvdSBnZXQgbm9ydGgtd2VzdCBhbmQgc291dGgtZWFzdCBjb3JuZXJzIGZyb20gdGhlIHR3byBhYm92ZTpcblxuICAgICAgICAgICAgY3VycmVudF9tYXBfbncgPSB7IFxuICAgICAgICAgICAgICAgIGxhdDogbmUubGF0KCksIFxuICAgICAgICAgICAgICAgIGxvbjogc3cubG5nKClcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjdXJyZW50X21hcF9zZSA9IHtcbiAgICAgICAgICAgICAgICBsYXQ6IHN3LmxhdCgpLCBcbiAgICAgICAgICAgICAgICBsb246IG5lLmxuZygpXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgY3VycmVudF9tYXBfY2VudGVyIDtcblxuICAgICAgICAgICAgY3VycmVudF9tYXBfY2VudGVyID0ge1xuICAgICAgICAgICAgICAgICAgICBsYXQ6IG1hcC5nZXRDZW50ZXIoKS5sYXQoKSxcbiAgICAgICAgICAgICAgICAgICAgbG9uOiBtYXAuZ2V0Q2VudGVyKCkubG5nKClcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgLy8gc2VlIGlmIHRoZSBsYXRlc3QgeCBtYXJrZXIgb3IgcG9zdCBsb2NhdGlvbiBpcyB3aXRoaW4gdXNlcidzIHZpZXdcbiAgICAgICAgICAgIGlmICghKHNjb3BlLnBvc3RMb2NhdGlvbi5sYXQgPCBjdXJyZW50X21hcF9udy5sYXQpIHx8XG4gICAgICAgICAgICAgICAgIShzY29wZS5wb3N0TG9jYXRpb24ubGF0ID4gY3VycmVudF9tYXBfc2UubGF0KSB8fFxuICAgICAgICAgICAgICAgICEoc2NvcGUucG9zdExvY2F0aW9uLmxvbiA8IGN1cnJlbnRfbWFwX3NlLmxvbikgfHxcbiAgICAgICAgICAgICAgICAhKHNjb3BlLnBvc3RMb2NhdGlvbi5sb24gPiBjdXJyZW50X21hcF9udy5sb24pIClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBpZiBpdCBpcyBub3Qgd2l0aGluIHVzZXIncyB2aWV3LCB0aGVuIGp1c3QgdXNlIG1hcCBjZW50ZXJcbiAgICAgICAgICAgICAgICBjdXJyZW50X21hcF9jZW50ZXIgPSB7XG4gICAgICAgICAgICAgICAgICAgIGxhdDogbWFwLmdldENlbnRlcigpLmxhdCgpLFxuICAgICAgICAgICAgICAgICAgICBsb246IG1hcC5nZXRDZW50ZXIoKS5sbmcoKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gaWYgaXQgaXMgd2l0aGluIHVzZXIncyB2aWV3LCB1c2UgeCBtYXJrZXIgbG9jYXRpb24gYS5rLmEgcG9zdCBsb2NhdGlvblxuICAgICAgICAgICAgICAgIGN1cnJlbnRfbWFwX2NlbnRlciA9IHtcbiAgICAgICAgICAgICAgICAgICAgbGF0OiBzY29wZS5wb3N0TG9jYXRpb24ubGF0LFxuICAgICAgICAgICAgICAgICAgICBsb246IHNjb3BlLnBvc3RMb2NhdGlvbi5sb25cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgU2Vzc2lvblN2Yy51cGRhdGVXYXRjaExvY2F0aW9uKGN1cnJlbnRfbWFwX253LCBjdXJyZW50X21hcF9zZSwgY3VycmVudF9tYXBfY2VudGVyLCBzY29wZS5ndWlkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGRyYXcgbWFwIHdpdGggaGVscGVyIG1hcmtlcnNcbiAgICAgICAgZnVuY3Rpb24gZHJhd1VzZXJNYXJrZXIobG9jYXRpb24pe1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG1hcmtlcjsgbWFya2VyID0gdXNlck1hcmtlcnNbaV07IGkrKykge1xuICAgICAgICAgICAgICAgIG1hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB1c2VyTWFya2VycyA9IFtdO1xuICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBsb2NhdGlvbiwgXG4gICAgICAgICAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VVc2VyTG9jYXRpb25cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdXNlck1hcmtlcnMucHVzaChtYXJrZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gRVZFTlQgSEFORExFUlMgLSBEUkFXXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgICAgICAvLyB1cGRhdGUgcmVzcG9uc2VzIHN1Y2ggYXMgdmlzdWFsaXphdGlvbiBvZiBsaXN0ZW5lcnNcbiAgICAgICAgZnVuY3Rpb24gZHJhd1Jlc3BvbnNlcyhwb3N0KXtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ3JlZmVyZW5jZSBwb3N0OicsIHBvc3QpO1xuXG4gICAgICAgICAgICB1cGRhdGVCb3VuZHMoKTtcbiAgICAgICAgICAgIGZ1bmN0aW9uIGRyYXdCbGlua3Moc2Vzc2lvbnMpe1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZXNzaW9ucy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZXNzaW9uID0gc2Vzc2lvbnNbaV07XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gc2tpcCBteSBzZXNzaW9uIC0gbm8gbmVlZCB0byBkcmF3IOuCtCDsnpDsi6DsnZgg7IS47IWY7J2AIOq3uOumtO2VhOyalOqwgCDsl4bri6QuXG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXNzaW9uLmd1aWQgPT0gc2NvcGUuZ3VpZClcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAvLyBzZXNzaW9uJ3Mgd2F0Y2ggbG9jYXRpb24gd2lsbCBiZSBib3VuY2VkIVxuICAgICAgICAgICAgICAgICAgICB2YXIgd2F0Y2hfbG9jYXRpb24gPSBhbmd1bGFyLmZyb21Kc29uKHNlc3Npb24ud2F0Y2hsb2MpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcG9zdF9sb2NhdGlvbiAgPSBhbmd1bGFyLmZyb21Kc29uKHBvc3QubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8g7Jyg7KCA6rCAIOuztOqzoCDsnojripQg67CU7Jq0642U66asIOyViOyXkCDqt7ggc2Vzc2lvbijri6TrpbjsnKDsoIApIOyytO2CgVxuXG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coY3VycmVudF9tYXBfc2UsIGN1cnJlbnRfbWFwX253KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEod2F0Y2hfbG9jYXRpb24uY2VudGVyX2xhdCA8IGN1cnJlbnRfbWFwX253LmxhdCgpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgISh3YXRjaF9sb2NhdGlvbi5jZW50ZXJfbGF0ID4gY3VycmVudF9tYXBfc2UubGF0KCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKHdhdGNoX2xvY2F0aW9uLmNlbnRlcl9sb24gPCBjdXJyZW50X21hcF9zZS5sbmcoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEod2F0Y2hfbG9jYXRpb24uY2VudGVyX2xvbiA+IGN1cnJlbnRfbWFwX253LmxuZygpKSApXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gc2Vzc2lvbijri6TrpbjsnKDsoIAp65Ok7J20IOq3uCDtj6zsiqTtirjrpbwg67O06rOgIOyeiOyngCDslYrsnLzrqbQg7Iqk7YK1LlxuICAgICAgICAgICAgICAgICAgICBpZiAoIShwb3N0X2xvY2F0aW9uLmxhdCA8IHdhdGNoX2xvY2F0aW9uLm53X2xhdCkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEocG9zdF9sb2NhdGlvbi5sYXQgPiB3YXRjaF9sb2NhdGlvbi5zZV9sYXQpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKHBvc3RfbG9jYXRpb24ubG9uIDwgd2F0Y2hfbG9jYXRpb24uc2VfbG9uKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIShwb3N0X2xvY2F0aW9uLmxvbiA+IHdhdGNoX2xvY2F0aW9uLm53X2xvbikgKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyh3YXRjaF9sb2NhdGlvbi5jZW50ZXJfbGF0LCB3YXRjaF9sb2NhdGlvbi5jZW50ZXJfbG9uKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciByYW5kb21TaXplID0gTWF0aC5yYW5kb20oKSAqIDQwICsgNDA7IFxuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsTmFtZSAgICA9ICdCbGluay5naWYnO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbWFnZUxpc3RlbmVyID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMTAwLCAxMDApLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMCwgMCksXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludChyYW5kb21TaXplICogMC41ICsgNSwgcmFuZG9tU2l6ZSAqIDAuNSArIDE0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlZFNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKHJhbmRvbVNpemUsIHJhbmRvbVNpemUpXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uKGltYWdlTGlzdGVuZXIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlck9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGdvb2dsZUxvYyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXA6IG1hcCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJSZWNlaXZlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb246IGltYWdlTGlzdGVuZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW1pemVkOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIobWFya2VyT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVjZWl2ZXJfbWFya2VyX2xpZmVzcGFuID0gMTIwMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uKG9sZF9tYXJrZXIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZF9tYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xkX21hcmtlciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfShtYXJrZXIpKSwgXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXZlcl9tYXJrZXJfbGlmZXNwYW4pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0oaW1hZ2VMaXN0ZW5lcikpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFNlc3Npb25TdmMuZmV0Y2goKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZHJhd0JsaW5rcylcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgICAgIC8vaGFuZGxlIGVycm9yc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjaGVjayBpZiB0aGUgcG9zdCBpcyBjb21wbGV0bHkgZGVhZCBhbmQgcmVtb3ZlIHRoYXQgcG9zdFxuICAgICAgICBmdW5jdGlvbiBjbGVhbnVwKCkge1xuICAgICAgICAgICAgIGZvciAodmFyIGogPSAwLCBtYXJrZXI7IG1hcmtlciA9IG1hcmtlcnNPbk1hcFtqXTsgaisrKXtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudERhdGUgICAgICA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lTWlsbGkgPSBjdXJyZW50RGF0ZS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgdmFyIGxpZmUgPSBtYXJrZXIucG9zdC5saWZlZW5kIC0gY3VycmVudFRpbWVNaWxsaTtcblxuICAgICAgICAgICAgICAgIGlmIChsaWZlIDw9IDApe1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdjbGVhbmluZyB1cC4uJywgbWFya2VyLnBvc3QuX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgdW5EcmF3UG9zdChtYXJrZXIucG9zdC5faWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUFuZERyYXdQb3N0cygpe1xuICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBmb3IgY2hlY2tpbmcgbG9jYWwgcG9zdHMgLSBpc1BvaW50aW5nWW91XG4gICAgICAgICAgICBpc0d1aWR0Z3RDaGFuZ2VkID0gcHJldkd1aWR0Z3QgIT0gc2NvcGUuZ3VpZHRndDsgLy8gc2VlIGlmIG15IGd1aWR0Z3QgaGFzIGNoYW5nZWQ7XG4gICAgICAgICAgICBwcmV2R3VpZHRndCA9IHNjb3BlLmd1aWR0Z3Q7IC8vIHVwZGF0ZSBwcmV2aW91cyBndWlkdGd0XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGRyYXdQb3N0cyhwb3N0cyl7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBvc3RzLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvc3QgPSBwb3N0c1tpXTtcblxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNUQVJUIC0gQ0hFQ0sgSUYgSVRTIFdJVEhJTiBWSUVXIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2F0aW9uID0gYW5ndWxhci5mcm9tSnNvbihwb3N0LmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobG9jYXRpb24ubGF0LCBsb2NhdGlvbi5sb24pO1xuXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUJvdW5kcygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIShnb29nbGVMb2MubGF0KCkgPCBjdXJyZW50X21hcF9udy5sYXQoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEoZ29vZ2xlTG9jLmxhdCgpID4gY3VycmVudF9tYXBfc2UubGF0KCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKGdvb2dsZUxvYy5sbmcoKSA8IGN1cnJlbnRfbWFwX3NlLmxuZygpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIShnb29nbGVMb2MubG5nKCkgPiBjdXJyZW50X21hcF9udy5sbmcoKSkgKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsgLy8gc2tpcCB0aGlzIHBvc3QgLSBubyBuZWVkIHRvIGRyYXdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEVORCAtIENIRUNLIElGIElUUyBXSVRISU4gVklFVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNUQVJUIC0gQ0hFQ0sgV0UgSEFWRSBUTyBSRURSQVcgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgbWFya2VycyBwb3N0IGlzIGV4aXNpdGluZyBvbmUsIHdlIGRvbid0IHdhbnQgdG8gZHJhdyBpdCBhZ2Fpbi5cbiAgICAgICAgICAgICAgICAgICAgLy8gb25seSBkcmF3IG5ldyBvbmVzIVxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgbWFya2VyOyBtYXJrZXIgPSBtYXJrZXJzT25NYXBbal07IGorKyl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8v7J2067aA67aEIOuhnOyngeydhCDri6Tsi5wg7Kec7JW87ZWoXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNBbHJlYWR5RHJhd24gPSBwb3N0Ll9pZCA9PSBtYXJrZXIucG9zdC5faWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBbHJlYWR5RHJhd24pIC8vIOydtOuvuCDqt7jroKTsoYzripTsp4Ag7YWM7Iqk7Yq4XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzR3VpZHRndENoYW5nZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bkRyYXdQb3N0KHBvc3QuX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtYXJrZXIucG9zdC5ndWlkdGd0ID09IHBvc3QuZ3VpZHRndCl7ICAvLyDsnbTrr7gg6re466Ck7KeE6rKD7KSRLCBndWlkdGd07J20IOuwlOuAjOyXiOuKlOqwgFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0ID0gbnVsbDsgLy8g7J2066+4IOq3uOugpOynhCDtj6zsiqTtirjrnbzrqbQsIG51bGzroZwuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOyAvLyDsnbQgbG9vcOydgCBwb3N0Ll9pZOunjCDqsoDsgqzsmqnsnoTsnLzroZwsIOunjOyVvSDqsrnsuZjrqbQg67CU66GcIGxvb3DsnYQg66mI7Law64+EIOq0nOywruuLpC59XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5EcmF3UG9zdChwb3N0Ll9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChwb3N0ID09IG51bGwpe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7IC8vIHNraXAgdGhpcyBwb3N0IC0gbm8gbmVlZCB0byBkcmF3XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBFTkQgLSBDSEVDSyBXRSBIQVZFIFRPIFJFRFJBVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNUQVJUIC0gRFJBV0lORyBQT1NUIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgICAgICAgICAgICAgLy8gbWFya2VyIG9wdGlvbiBzZXR0aW5nXG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXJrZXJPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGdvb2dsZUxvYyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcDogbWFwLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwiQnViYmxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uOiBpbWFnZVBvc3RcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIobWFya2VyT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFkZCBtYXJrZXIgdG8gYXJyYXksIHRoaXMgbWVhbnMgdGhhdCBpdCBoYXMgYmVlbiBkcmF3biB0byBtYXBcbiAgICAgICAgICAgICAgICAgICAgbWFya2Vyc09uTWFwLnB1c2goXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyOiBtYXJrZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdCAgOiBwb3N0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNUQVJUIC0gRFJBV0lORyBNRVNTQUdFIFdJTkRPVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb3VwbGluZ19zdGF0dXMgPSBjYWxjdWxhdGVDb3VwbGluZyhwb3N0Lmd1aWQsIHBvc3QuZ3VpZHRndCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcInBvc3QuaXNMb2NhbFwiLCBwb3N0LmlzbG9jYWwpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYWxfc3RhdHVzID0gcG9zdC5pc2xvY2FsO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIOyKpOy9lO2UhOyXkOyEnOu2gO2EsCDsg4jroZzsmrQg7LCo7J2865OcIOyKpOy9lO2UhOulvCDrp4zrk6TslrQgZWFjaCBmb3IgbG9vcOyXkOyEnCDsgqzsmqntlZzri6QuXG4gICAgICAgICAgICAgICAgICAgIC8vIC0tPiDtlbTslbwsIOqwgSBET03snbQg6rCB6rCB7J2YIHNjb3Bl66W8IOqwgOyguOyEnCBwb3N0IG1zZ+qwgCDslYgg6rK57Lmc64ukLlxuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gc2NvcGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9IHBhcmVudC4kbmV3KHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBvcGVuSW5mb1dpbmRvdyA9IChmdW5jdGlvbihtYXJrZXIsIGNoaWxkX3Njb3BlLCBwb3N0LCBjb3VwbGluZ19zdGF0dXMsIGxvY2FsX3N0YXR1cyl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBuZXcgd2luZG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZm9XaW5kb3dPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaXhlbE9mZnNldDogbmV3IGdvb2dsZS5tYXBzLlNpemUoLTM5LjUsIDE2LjApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlQXV0b1BhbjogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZm9XaW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyhpbmZvV2luZG93T3B0aW9ucyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgY3VycmVudCB0aW1lIGFuZCBzdWJ0cmFjdCBpdCBmcm9tIHBvc3QncyBlbmQgdGltZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGF0IHdpbGwgYmUgYWNjdXJhdGUgcG9zdCB0aW1lIGZvciBpbnN0YW50IHBvc3RzIGFuZCBsb25nIHBvc3RzLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50RGF0ZSAgICAgID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudFRpbWVNaWxsaSA9IGN1cnJlbnREYXRlLmdldFRpbWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zdGxpZmUgICAgICAgICA9ICgocG9zdC5saWZlZW5kIC0gY3VycmVudFRpbWVNaWxsaSkgPj0gMCkgPyAocG9zdC5saWZlZW5kIC0gY3VycmVudFRpbWVNaWxsaSkgOiAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxpZmVwZXJjZW50YWdlID0gKHBvc3RsaWZlIC8gcG9zdC5saWZlc3BhbikudG9GaXhlZCgyKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy90byBtYWtlIGRhdGEgYXZhaWxhYmxlIHRvIHRlbXBsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUubXNnICAgICAgICAgICAgICAgID0gcG9zdC5ib2R5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3RsaWZlICAgICAgICAgICA9IHBvc3RsaWZlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3RndWlkICAgICAgICAgICA9IHBvc3QuZ3VpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Z3VpZHRndCAgICAgICAgPSBwb3N0Lmd1aWR0Z3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUucG9zdGNvdXBsZXN0YXR1cyAgID0gY291cGxpbmdfc3RhdHVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA9IGxpZmVwZXJjZW50YWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3Rsb2NhbHN0YXR1cyAgICA9IGxvY2FsX3N0YXR1cztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBlbmFibGVzIGNoYW5naW5nIGNvdXBsaW5nIHZhbHVlIGluc3RhbnRseS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS4kb24oJ3NldDpjb3VwbGluZycsIGZ1bmN0aW9uKF8sIGNvdXBsaW5nX3VwZGF0ZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3Rjb3VwbGVzdGF0dXMgPSBjb3VwbGluZ191cGRhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbXBpbGUgaXQgYmVmb3JlIGxvYWRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50ICA9ICc8ZGl2IG1hcC1tc2c+PC9kaXY+JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29tcGlsZWQgPSAkY29tcGlsZShjb250ZW50KShjaGlsZF9zY29wZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93LnNldENvbnRlbnQoIGNvbXBpbGVkWzBdICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihpbmZvV2luZG93LCdjbG9zZWNsaWNrJyxmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9zdC5ndWlkID09IHNjb3BlLmd1aWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2FsKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIkFyZSB5b3Ugc3VyZT9cIiwgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIllvdSB3aWxsIG5vdCBiZSBhYmxlIHRvIHJlY292ZXIgdGhpcyBpbWFnaW5hcnkgZmlsZSFcIiwgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIndhcm5pbmdcIiwgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLCAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogXCIjREQ2QjU1XCIsICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6IFwiWWVzLCBkZWxldGUgaXQhXCIsICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VPbkNvbmZpcm06IGZhbHNlIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihpc0NvbmZpcm0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NvbmZpcm0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQb3N0c1N2Yy5yZW1vdmUocG9zdClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBzdWNjZXNzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaGFuZGxlIGVycm9yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3YWwoXCJEZWxldGVkIVwiLCBcIllvdXIgaW1hZ2luYXJ5IGZpbGUgaGFzIGJlZW4gZGVsZXRlZC5cIiwgXCJzdWNjZXNzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50RGF0ZSAgICAgID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lTWlsbGkgPSBjdXJyZW50RGF0ZS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3N0bGlmZSAgICAgICAgID0gKChwb3N0LmxpZmVlbmQgLSBjdXJyZW50VGltZU1pbGxpKSA+PSAwKSA/IChwb3N0LmxpZmVlbmQgLSBjdXJyZW50VGltZU1pbGxpKSA6IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsaWZlcGVyY2VudGFnZSA9IChwb3N0bGlmZSAvIHBvc3QubGlmZXNwYW4pLnRvRml4ZWQoMilcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGlmZXBlcmNlbnRhZ2UgPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA9IGxpZmVwZXJjZW50YWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5vcGVuKG1hcCAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93Lm9wZW4obWFwICwgbWFya2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0pKG1hcmtlciwgY2hpbGQsIHBvc3QsIGNvdXBsaW5nX3N0YXR1cywgbG9jYWxfc3RhdHVzKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIG9wZW5JbmZvV2luZG93KCk7XG4gICAgICAgICAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRU5EIC0gRFJBV0lORyBNRVNTQUdFIFdJTkRPVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBFTkQgLSBEUkFXSU5HIFBPU1QgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgICAgICAgICAgfSAvLyBlbmQgb2YgZm9yLWxvb3BcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgUG9zdHNTdmMuZmV0Y2goKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZHJhd1Bvc3RzKSBcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBlcnJvclxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIGVuZCBvZiBwb3N0IGZldGNoIHN1Y2Nlc3NcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGRyYXdEcm9wRG93bihsb2NhdGlvbilcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobG9jYXRpb24ubGF0LCBsb2NhdGlvbi5sb24pO1xuXG4gICAgICAgICAgICB1cGRhdGVCb3VuZHMoKTtcbiAgICAgICAgICAgIC8vIOuwlOyatOuNlOumrCDslYjsl5Ag7J6I64qU7KeA67aA7YSwIOyytO2BrOulvCDtlZjsnqVcbiAgICAgICAgICAgIGlmICghKGdvb2dsZUxvYy5sYXQoKSA8IGN1cnJlbnRfbWFwX253LmxhdCgpKSB8fFxuICAgICAgICAgICAgICAgICEoZ29vZ2xlTG9jLmxhdCgpID4gY3VycmVudF9tYXBfc2UubGF0KCkpIHx8XG4gICAgICAgICAgICAgICAgIShnb29nbGVMb2MubG5nKCkgPCBjdXJyZW50X21hcF9zZS5sbmcoKSkgfHxcbiAgICAgICAgICAgICAgICAhKGdvb2dsZUxvYy5sbmcoKSA+IGN1cnJlbnRfbWFwX253LmxuZygpKSApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBza2lwIHRoaXMgcG9zdCAtIG5vIG5lZWQgdG8gZHJhd1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBtYXJrZXIgb3B0aW9uIHNldHRpbmdcbiAgICAgICAgICAgIHZhciBtYXJrZXJPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBnb29nbGVMb2MsXG4gICAgICAgICAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUCxcbiAgICAgICAgICAgICAgICB0aXRsZTogXCJVc2VyUGluXCIsXG4gICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VVc2VyTG9naW5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKG1hcmtlck9wdGlvbnMpO1xuXG4gICAgICAgICAgICAkdGltZW91dChcbiAgICAgICAgICAgICAgICAoZnVuY3Rpb24ob2xkX21hcmtlcil7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgb2xkX21hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfShtYXJrZXIpKSwgXG4gICAgICAgICAgICAyMDAwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVuRHJhd1Bvc3QocG9zdGlkKVxuICAgICAgICB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwic3RhcnRpbmcgcmVtb3ZlIHBvc3RcIik7XG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMCwgbWFya2VyOyBtYXJrZXIgPSBtYXJrZXJzT25NYXBba107IGsrKykge1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocG9zdGlkKTtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKG1hcmtlci5wb3N0Ll9pZCk7XG4gICAgICAgICAgICAgICAgaWYgKHBvc3RpZCA9PSBtYXJrZXIucG9zdC5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyLm1hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlcnNPbk1hcC5zcGxpY2UoaywgMSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGRyYXdBbmRTZXRQbGFjZShsb2NhdGlvbilcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobG9jYXRpb24ubGF0LCBsb2NhdGlvbi5sb24pO1xuICAgICAgICAgICAgZHJhd0hlbHBlck1hcmtlcihnb29nbGVMb2MpO1xuICAgICAgICAgICAgc2V0UGxhY2UoZ29vZ2xlTG9jKTtcblxuICAgICAgICAgICAgLy8gbWFrZSBzdXJlIHNlcnZlciBnZXRzIHVwZGF0ZWQgd2hlbmV2ZXIgc2V0dGluZyBuZXcgcGxhY2Ugd2l0aCBtYXJrZXJcbiAgICAgICAgICAgIHVwZGF0ZVdhdGNoTG9jYXRpb24oKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGRyYXcgbWFwIHdpdGggaGVscGVyIG1hcmtlcnNcbiAgICAgICAgZnVuY3Rpb24gZHJhd0hlbHBlck1hcmtlcihsb2NhdGlvbil7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbWFya2VyOyBtYXJrZXIgPSBoZWxwZXJNYXJrZXJzW2ldOyBpKyspIHtcbiAgICAgICAgICAgICAgICBtYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGVscGVyTWFya2VycyA9IFtdO1xuICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBsb2NhdGlvbiwgXG4gICAgICAgICAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VUYXJnZXRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaGVscGVyTWFya2Vycy5wdXNoKG1hcmtlcik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1bkRyYXdIZWxwZXJNYXJrZXIoKXtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBtYXJrZXI7IG1hcmtlciA9IGhlbHBlck1hcmtlcnNbaV07IGkrKykge1xuICAgICAgICAgICAgICAgIG1hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBoZWxwZXJNYXJrZXJzID0gW107XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIFVUSUxcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgZnVuY3Rpb24gc2V0UGxhY2UobG9jYXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGJyb2FkY2FzdCBsb2NhdGlvbiBpbmZvcihsb24sbGF0KVxuICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldDpsb2MnLCBsb2NhdGlvbik7XG5cbiAgICAgICAgICAgIHZhciBnZW9jb2RlciA9IG5ldyBnb29nbGUubWFwcy5HZW9jb2RlcigpO1xuXG4gICAgICAgICAgICAvLyBicm9hZGNhc3QgcGxhY2UgZm9ybWF0dGVkX2FkZHJlc3MgYW5kIGRyYXcgaWNvblxuICAgICAgICAgICAgZ2VvY29kZXIuZ2VvY29kZSggeyAnbGF0TG5nJzogbG9jYXRpb24gfSwgZnVuY3Rpb24ocmVzdWx0cywgc3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgLy8gYXMgdXNlciBjbGlja3Mgb24gdGhlIG1hcCxcbiAgICAgICAgICAgICAgICAvLyB3ZSBoYXZlIHRvIHNhdmUgdGhlIGZvcm1hdHRlZCBhZGRyZXNzIGluICRzY29wZSBhbmRcbiAgICAgICAgICAgICAgICAvLyBpdCB3aWxsIGJlIHVzZWQgdGhyb3VnaCBwb3N0cy5jdHJsXG4gICAgICAgICAgICAgICAgLy8gZW1pdCBicm9hZGNhc2UgJ3BsYWNlJyBhbmQgc2VuZCB0aGlzIHRvIGFwcGxpY2F0aW9uLmN0cmxcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyBicm9hZGNhc3QgZm9ybWF0dGVkX2FkZHJlc3NcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldDpwbGFjZScsIHJlc3VsdHNbMV0uZm9ybWF0dGVkX2FkZHJlc3MpOyBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2goZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgc3dhbChcIlwiLFwiTG9jYXRpb24gZG9lcyBub3QgZXhpc3RzXCIpO1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0OnBsYWNlJywgXCJMb2NhdGlvbiBkb2VzIG5vdCBleGlzdHNcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjYWxjdWxhdGVDb3VwbGluZyhwb3N0X2d1aWQsIHBvc3RfZ3VpZHRndClcbiAgICAgICAge1xuICAgICAgICAgICAgLyogY291cGxpbmcgc3RhdHVzXG4gICAgICAgICAgICAgICAgMCAtIG5vIHN0YXR1c1xuICAgICAgICAgICAgICAgIDEgLSBpIGxpa2UgeW91XG4gICAgICAgICAgICAgICAgMiAtIHlvdSBsaWtlIGlcbiAgICAgICAgICAgICAgICA0IC0gd2UgbGlrZSBlYWNoIG90aGVyIC8vIGRpc2FibGVkLlxuICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgdmFyIGlzUG9pbnRpbmdZb3UgICAgID0gc2NvcGUuZ3VpZHRndCA9PSBwb3N0X2d1aWQ7XG4gICAgICAgICAgICB2YXIgaXNQb2ludGluZ01lICAgICAgPSBzY29wZS5ndWlkICAgID09IHBvc3RfZ3VpZHRndDtcbiAgICAgICAgICAgIHZhciBpc015UG9zdCAgICAgICAgICA9IHNjb3BlLmd1aWQgICAgPT0gcG9zdF9ndWlkO1xuICAgICAgICAgICAgdmFyIGlzUG9pbnRpbmdTb21lb25lID0gc2NvcGUuZ3VpZHRndCAhPSAnMCc7XG5cbiAgICAgICAgICAgIGlmIChpc015UG9zdCAmJiBpc1BvaW50aW5nU29tZW9uZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMjsgLy8gZm9yIG15IHZpZXcncyBteSBwb3N0IHRvIGJlIFwiSSBsaWtlIHNvbWVvbmVcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaXNQb2ludGluZ1lvdSAmJiBpc1BvaW50aW5nTWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpc1BvaW50aW5nWW91ICYmICFpc1BvaW50aW5nTWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICghaXNQb2ludGluZ1lvdSAmJiBpc1BvaW50aW5nTWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBVSVxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICBmdW5jdGlvbiBzZXRVSVNlYXJjaExvY2F0aW9uVG9nZ2xlKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIG1hcFNlYXJjaFRvZ2dsZSA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLXNlYXJjaC10b2dnbGUnKSk7XG4gICAgICAgICAgICBtYXAuY29udHJvbHNbZ29vZ2xlLm1hcHMuQ29udHJvbFBvc2l0aW9uLlRPUF9MRUZUXS5wdXNoKG1hcFNlYXJjaFRvZ2dsZSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRVSU1vdmVUb0N1cnJMb2NCdG4oKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgY3VyckxvY0J0biA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLWJ0bi1jdXJyJykpOyBcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uVE9QX1JJR0hUXS5wdXNoKGN1cnJMb2NCdG4pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0VUlQb3N0Rm9ybSgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBwb3N0Rm9ybSA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLXBvc3RpbmcnKSk7IFxuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5CT1RUT01fQ0VOVEVSXS5wdXNoKHBvc3RGb3JtKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldFVJUG9zdE9uTWFwKClcbiAgICAgICAge1xuICAgICAgICAgICAgLy92YXIgcG9zdE9uTWFwID0gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtcG9zdC1jZW50ZXInKSk7XG4gICAgICAgICAgICAvL21hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uVE9QX0NFTlRFUl0ucHVzaChwb3N0T25NYXApO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0VUlQb3N0QnRuKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIHBvc3RCdG4gPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1idG4tc3VibWl0JykpO1xuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5CT1RUT01fQ0VOVEVSXS5wdXNoKHBvc3RCdG4pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0VUlUaW1lU2xpZGVyKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIHRpbWVTbGlkZXIgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC10aW1lLXNsaWRlcicpKTtcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uQk9UVE9NX0NFTlRFUl0ucHVzaCh0aW1lU2xpZGVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldFVJU2VhcmNoQm94KClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSBzZWFyY2ggYm94IGFuZCBsaW5rIGl0IHRvIHRoZSBVSSBlbGVtZW50LlxuICAgICAgICAgICAgdmFyIGlucHV0ID0gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYWMtaW5wdXQnKSk7IC8vIEB0eXBlIHtIVE1MSW5wdXRFbGVtZW50fSAgXG4gICAgICAgICAgICBtYXAuY29udHJvbHNbZ29vZ2xlLm1hcHMuQ29udHJvbFBvc2l0aW9uLlRPUF9MRUZUXS5wdXNoKGlucHV0KTtcblxuICAgICAgICAgICAgdmFyIHNlYXJjaEJveCA9IG5ldyBnb29nbGUubWFwcy5wbGFjZXMuU2VhcmNoQm94KChpbnB1dCkpOyAvLyBAdHlwZSB7SFRNTElucHV0RWxlbWVudH0gXG5cbiAgICAgICAgICAgIC8vIExpc3RlbiBmb3IgdGhlIGV2ZW50IGZpcmVkIHdoZW4gdGhlIHVzZXIgc2VsZWN0cyBhbiBpdGVtIGZyb20gdGhlXG4gICAgICAgICAgICAvLyBwaWNrIGxpc3QuIFJldHJpZXZlIHRoZSBtYXRjaGluZyBwbGFjZXMgZm9yIHRoYXQgaXRlbS5cbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKHNlYXJjaEJveCwgJ3BsYWNlc19jaGFuZ2VkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBsYWNlcyA9IHNlYXJjaEJveC5nZXRQbGFjZXMoKTtcblxuICAgICAgICAgICAgICAgIGlmIChwbGFjZXMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyB0YWtlIG9ubHkgMSBzcG90XG4gICAgICAgICAgICAgICAgdmFyIHBsYWNlID0gcGxhY2VzWzBdO1xuXG4gICAgICAgICAgICAgICAgLy8gd2hlbiBzZWFyY2ggaGFwcGVucywgbG9jYXRpb24gd2lsbCBiZSB1cGRhdGVkIGFzIHdlbGwgZm9yIHBvc3RcbiAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIGxhdDogcGxhY2UuZ2VvbWV0cnkubG9jYXRpb24ubGF0KCksXG4gICAgICAgICAgICAgICAgICAgIGxvbjogcGxhY2UuZ2VvbWV0cnkubG9jYXRpb24ubG5nKClcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShsb2NhdGlvbik7XG5cbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gcGxhY2UuZ2VvbWV0cnkubG9jYXRpb24ubGF0aXR1ZGU7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUgPSBwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sb25naXR1ZGU7XG5cbiAgICAgICAgICAgICAgICBtYXAucGFuVG8ocGxhY2UuZ2VvbWV0cnkubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgIG1hcC5zZXRab29tKDE2KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gRVZFTlRcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgZnVuY3Rpb24gc2V0RXZlbnRDbGljaygpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGNsaWNrIGV2ZW50IG9uIG1hcCB0byBkcmF3IFggbWFya2VyIGFuZCBzZXQgUG9zdCBsb2NhdGlvblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwX29yaWdpbiwgJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIGxhdDogZXZlbnQubGF0TG5nLmxhdCgpLFxuICAgICAgICAgICAgICAgICAgICBsb246IGV2ZW50LmxhdExuZy5sbmcoKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZHJhd0FuZFNldFBsYWNlKGxvY2F0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0RXZlbnRDZW50ZXJDaGFuZ2VkKClcbiAgICAgICAge1xuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwX29yaWdpbiwgJ2NlbnRlcl9jaGFuZ2VkJywgZnVuY3Rpb24oKXsgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gd2hlbiBtYXAgY2VudGVyIGNoYW5nZSwgdXBkYXRlIGxhc3QgbG9jYXRpb24gaW4gbWVtb3J5LFxuICAgICAgICAgICAgICAgIC8vIHNvIGJyb3dzZXIgd2lsbCByZW1lbWJlciBpdCBuZXh0IHRpbWUgeW91IGNvbWUhXG4gICAgICAgICAgICAgICAgdXBkYXRlRGVmYXVsdExvY2F0aW9uKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldEV2ZW50Qm91bmRzQ2hhbmdlZCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcF9vcmlnaW4sICdib3VuZHNfY2hhbmdlZCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgLy8gd2hlbiBtYXAgY2VudGVyIGNoYW5nZSwgdXBkYXRlIGJvdW5kcyBpbmZvIGZvciBtYXBcbiAgICAgICAgICAgICAgICB1cGRhdGVCb3VuZHMoKTsgIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRFdmVudERyYWdFbmQoKVxuICAgICAgICB7XG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXBfb3JpZ2luLCAnZHJhZ2VuZCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIG1hcCBhcyBkcmFnIGVuZFxuICAgICAgICAgICAgICAgIHVwZGF0ZUFuZERyYXdQb3N0cygpO1xuXG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIHdhdGNobG9jIHdoZW4gY2VudGVyIGNoYW5nZWQuXG4gICAgICAgICAgICAgICAgdXBkYXRlV2F0Y2hMb2NhdGlvbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRFdmVudFJlc2l6ZSgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcF9vcmlnaW4sICdyZXNpemUnLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBtYXAgYXMgZHJhZyBlbmRcbiAgICAgICAgICAgICAgICB1cGRhdGVBbmREcmF3UG9zdHMoKTtcblxuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSB3YXRjaGxvYyB3aGVuIGNlbnRlciBjaGFuZ2VkLlxuICAgICAgICAgICAgICAgIHVwZGF0ZVdhdGNoTG9jYXRpb24oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0RXZlbnRab29tQ2hhbmdlZCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcF9vcmlnaW4sICd6b29tX2NoYW5nZWQnLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBtYXAgYXMgZHJhZyBlbmRcbiAgICAgICAgICAgICAgICB1cGRhdGVBbmREcmF3UG9zdHMoKTtcblxuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSB3YXRjaGxvYyB3aGVuIGNlbnRlciBjaGFuZ2VkLlxuICAgICAgICAgICAgICAgIHVwZGF0ZVdhdGNoTG9jYXRpb24oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gU0VUVVAgRk9SIE1BUFxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBtYXAgaW5pdGlhbCBjb25maWdzXG4gICAgICAgIGZ1bmN0aW9uIGluaXRpYWxNYXBEYXRhKCl7XG4gICAgICAgICAgICAvLyBpZiBsb2NhbFN0b3JhZ2UgcmVtZW1iZXJzIGxhdGVzdCBtYXAgbG9jYXRpb24sIHVzZSBpdCxcbiAgICAgICAgICAgIGlmICghaXNOYU4od2luZG93LmxvY2FsU3RvcmFnZS5sYXRpdHVkZSkgJiYgIWlzTmFOKHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlKSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpbml0aWFsTWFwQ2VudGVyID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyh3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlLCB3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBpZiB0aGVyZSBpcyBubyBsYXRlc3QgbWFwIGxvY2F0aW9uLCBnZXQgY3VycmVudCBsb2NhdGlvblxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUudXNlckxvY2F0aW9uLmxhdCAhPSAwLjAgJiYgc2NvcGUudXNlckxvY2F0aW9uLmxvbiAhPSAwLjApIFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vIHRoaXMgbWF5IG5vdCB3b3JrIGZvciBub3cgc2luY2UgbG9jYXRpb24gZ2V0cyBzZXQgYWZ0ZXIgbWFwIGlzIGRlZmluZWQuLiAoVE9ETzogcmVmYWN0b3IgdGhlIG9yZGVyKVxuICAgICAgICAgICAgICAgIGluaXRpYWxNYXBDZW50ZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHNjb3BlLnVzZXJMb2NhdGlvbi5sYXQsIHNjb3BlLnVzZXJMb2NhdGlvbi5sb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gaWYgbm9uZSBvZiBhYm92ZSB3b3JrcywgdHJ5IHRvIHNldCBpdCB0byBMQSAoPyEpXG4gICAgICAgICAgICBlbHNlIFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGluaXRpYWxNYXBDZW50ZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKDM0LjA1LCAtMTE4LjI0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbWFwT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY2VudGVyICAgICAgOiBpbml0aWFsTWFwQ2VudGVyLFxuICAgICAgICAgICAgICAgICAgICB6b29tICAgICAgICA6IDE1LFxuICAgICAgICAgICAgICAgICAgICBzY3JvbGx3aGVlbCA6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHN0cmVldFZpZXdDb250cm9sOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgbWFwVHlwZUNvbnRyb2w6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBwYW5Db250cm9sOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgem9vbUNvbnRyb2w6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBtYXBUeXBlQ29udHJvbE9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICBtYXBUeXBlSWRzOiBbZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlJPQURNQVAsIENMT1VEX01BUF9JRF1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbWFwVHlwZUlkOiBDTE9VRF9NQVBfSURcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRNYW51YWxFdmVudHMoKXtcbiAgICAgICAgICAgIGZ1bmN0aW9uIENsb3VkTWFwKG9wdGlvbnMpe1xuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiSW5pdGlhbGl6aW5nIG1hcFwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gaW5zdGFudGlhdGUgZ29vZ2xlIG1hcFxuICAgICAgICAgICAgbWFwX29yaWdpbiA9IG5ldyBnb29nbGUubWFwcy5NYXAoZWxlbWVudFswXSwgbWFwT3B0aW9ucyk7XG5cbiAgICAgICAgICAgIC8vIHNldCBwcm90b3R5cGUgb2YgY3VzdG9tIG1hcCB3aXRoIG9yaWdpbiBtYXBcbiAgICAgICAgICAgIENsb3VkTWFwLnByb3RvdHlwZSA9IG1hcF9vcmlnaW47XG5cbiAgICAgICAgICAgIC8vIGRyYXcgeCBtYXJrZXJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYXdYTWFya2VyKGxvY2F0aW9uKXtcbiAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKHRoaXMsICdkcmF3WE1hcmtlcicsIGxvY2F0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIENsb3VkTWFwLnByb3RvdHlwZS5kcmF3WE1hcmtlciA9IGhhbmRsZURyYXdYTWFya2VyO1xuXG4gICAgICAgICAgICAvLyBkcmF3IGN1cnJlbnQgdXNlciBsb2NhdGlvbiBtYXJrZXJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYXdVc2VyTG9jYXRpb25NYXJrZXIobG9jYXRpb24pe1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIodGhpcywgJ2RyYXdVc2VyTG9jYXRpb25NYXJrZXInLCBsb2NhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBDbG91ZE1hcC5wcm90b3R5cGUuZHJhd1VzZXJMb2NhdGlvbk1hcmtlciA9IGhhbmRsZURyYXdVc2VyTG9jYXRpb25NYXJrZXI7XG5cbiAgICAgICAgICAgIC8vIGRyYXcgY3VycmVudCBsb2NhdGlvbiBtYXJrZXJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYXdDdXJyTG9jYXRpb25NYXJrZXIobG9jYXRpb24pe1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIodGhpcywgJ2RyYXdDdXJyTG9jYXRpb25NYXJrZXInLCBsb2NhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBDbG91ZE1hcC5wcm90b3R5cGUuZHJhd0N1cnJMb2NhdGlvbk1hcmtlciA9IGhhbmRsZURyYXdDdXJyTG9jYXRpb25NYXJrZXI7XG5cbiAgICAgICAgICAgIC8vIGRyYXcgcG9zdHNcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZVVwZGF0ZUFuZERyYXdQb3N0cygpe1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIodGhpcywgJ3VwZGF0ZUFuZERyYXdQb3N0cycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQ2xvdWRNYXAucHJvdG90eXBlLnVwZGF0ZUFuZERyYXdQb3N0cyA9IGhhbmRsZVVwZGF0ZUFuZERyYXdQb3N0cztcblxuICAgICAgICAgICAgLy8gZHJhdyByZXNwb25zZXNcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYXdSZXNwb25zZXMocG9zdCl7XG4gICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcih0aGlzLCAnZHJhd1Jlc3BvbnNlcycsIHBvc3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQ2xvdWRNYXAucHJvdG90eXBlLmRyYXdSZXNwb25zZXMgPSBoYW5kbGVEcmF3UmVzcG9uc2VzO1xuXG4gICAgICAgICAgICAvLyB1bmRyYXcgcG9zdHNcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZVVuRHJhd1Bvc3QocG9zdGlkKXtcbiAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKHRoaXMsICd1bkRyYXdQb3N0JywgcG9zdGlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIENsb3VkTWFwLnByb3RvdHlwZS51bkRyYXdQb3N0ID0gaGFuZGxlVW5EcmF3UG9zdDtcblxuICAgICAgICAgICAgLy8gY3JlYXRlIGN1c3RvbSBtYXAgZm9yIGFwcFxuICAgICAgICAgICAgbWFwID0gbmV3IENsb3VkTWFwKCk7XG5cbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ2RyYXdYTWFya2VyJywgZnVuY3Rpb24obG9jYXRpb24pe1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShsb2NhdGlvbik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnZHJhd1VzZXJMb2NhdGlvbk1hcmtlcicsIGZ1bmN0aW9uKGxvY2F0aW9uKXtcbiAgICAgICAgICAgICAgICBkcmF3VXNlck1hcmtlcihsb2NhdGlvbik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnZHJhd0N1cnJMb2NhdGlvbk1hcmtlcicsIGZ1bmN0aW9uKGxvY2F0aW9uKXtcbiAgICAgICAgICAgICAgICBkcmF3RHJvcERvd24obG9jYXRpb24pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ3VwZGF0ZUFuZERyYXdQb3N0cycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgdXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnZHJhd1Jlc3BvbnNlcycsIGZ1bmN0aW9uKHBvc3Qpe1xuICAgICAgICAgICAgICAgIGRyYXdSZXNwb25zZXMocG9zdCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAndW5EcmF3UG9zdCcsIGZ1bmN0aW9uKHBvc3RpZCl7XG4gICAgICAgICAgICAgICAgdW5EcmF3UG9zdChwb3N0aWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRTdHlsZUZvck1hcCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBmZWF0dXJlT3B0c19kYXkgPSBbe1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzYxOTVhMFwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJhZG1pbmlzdHJhdGl2ZS5wcm92aW5jZVwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwibGFuZHNjYXBlXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wibGlnaHRuZXNzXCI6XCIwXCJ9LHtcInNhdHVyYXRpb25cIjpcIjBcIn0se1wiY29sb3JcIjpcIiNmNWY1ZjJcIn0se1wiZ2FtbWFcIjpcIjFcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwibGFuZHNjYXBlLm1hbl9tYWRlXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcImxpZ2h0bmVzc1wiOlwiLTNcIn0se1wiZ2FtbWFcIjpcIjEuMDBcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwibGFuZHNjYXBlLm5hdHVyYWwudGVycmFpblwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9mZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJwb2kucGFya1wiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LmZpbGxcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiNiYWU1Y2VcIn0se1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJzYXR1cmF0aW9uXCI6LTEwMH0se1wibGlnaHRuZXNzXCI6NDV9LHtcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnkuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2ZhYzlhOVwifSx7XCJ2aXNpYmlsaXR5XCI6XCJzaW1wbGlmaWVkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuaGlnaHdheVwiLFwiZWxlbWVudFR5cGVcIjpcImxhYmVscy50ZXh0XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNGU0ZTRlXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNzg3ODc4XCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMuaWNvblwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJzaW1wbGlmaWVkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInRyYW5zaXQuc3RhdGlvbi5haXJwb3J0XCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLmljb25cIixcInN0eWxlcnNcIjpbe1wiaHVlXCI6XCIjMGEwMGZmXCJ9LHtcInNhdHVyYXRpb25cIjpcIi03N1wifSx7XCJnYW1tYVwiOlwiMC41N1wifSx7XCJsaWdodG5lc3NcIjpcIjBcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdC5zdGF0aW9uLnJhaWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNDMzMjFlXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInRyYW5zaXQuc3RhdGlvbi5yYWlsXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLmljb25cIixcInN0eWxlcnNcIjpbe1wiaHVlXCI6XCIjZmY2YzAwXCJ9LHtcImxpZ2h0bmVzc1wiOlwiNFwifSx7XCJnYW1tYVwiOlwiMC43NVwifSx7XCJzYXR1cmF0aW9uXCI6XCItNjhcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwid2F0ZXJcIixcImVsZW1lbnRUeXBlXCI6XCJhbGxcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiNlYWY2ZjhcIn0se1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwid2F0ZXJcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjYzdlY2VkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcIndhdGVyXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJsaWdodG5lc3NcIjpcIi00OVwifSx7XCJzYXR1cmF0aW9uXCI6XCItNTNcIn0se1wiZ2FtbWFcIjpcIjAuNzlcIn1dfV07XG5cbiAgICAgICAgICAgIHZhciBmZWF0dXJlT3B0c19uaWdodCA9IFt7XCJmZWF0dXJlVHlwZVwiOlwiYWxsXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2ZmZmZmZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJhbGxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5zdHJva2VcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn0se1wiY29sb3JcIjpcIiMzZTYwNmZcIn0se1wid2VpZ2h0XCI6Mn0se1wiZ2FtbWFcIjowLjg0fV19LHtcImZlYXR1cmVUeXBlXCI6XCJhbGxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMuaWNvblwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwiYWRtaW5pc3RyYXRpdmVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJ3ZWlnaHRcIjowLjZ9LHtcImNvbG9yXCI6XCIjMTgyYTNkXCJ9LHtcInZpc2liaWxpdHlcIjpcIm9uXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcImxhbmRzY2FwZVwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjMWE1MjhiXCJ9LHtcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiM0MDZkODBcIn0se1widmlzaWJpbGl0eVwiOlwib2ZmXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInBvaS5wYXJrXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiMyYzVhNzFcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNjZhOWVlXCJ9LHtcImxpZ2h0bmVzc1wiOi0zN30se1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LmZpbGxcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHRcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib2ZmXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQubG9jYWxcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5zdHJva2VcIixcInN0eWxlcnNcIjpbe1wibGlnaHRuZXNzXCI6XCItMTFcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjZmY3ZTRlXCJ9LHtcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdC5zdGF0aW9uLmFpcnBvcnRcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwid2F0ZXJcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzE4MmEzZFwifV19XTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gc2V0IG1hcCBkZXBlbmRzIG9uIGRheXRpbWUgb3IgbmlnaHR0aW1lXG4gICAgICAgICAgICB2YXIgY3VycmVudFRpbWUgPSBuZXcgRGF0ZSgpOyAvLyBmb3Igbm93XG4gICAgICAgICAgICB2YXIgY3VycmVudEhvdXIgPSBjdXJyZW50VGltZS5nZXRIb3VycygpO1xuICAgICAgICAgICAgdmFyIGZlYXR1cmVPcHRzO1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgIGlmIChjdXJyZW50SG91ciA8IDQgfHwgY3VycmVudEhvdXIgPiAxOSl7XG4gICAgICAgICAgICAgICAgZmVhdHVyZU9wdHMgPSBmZWF0dXJlT3B0c19uaWdodDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZmVhdHVyZU9wdHMgPSBmZWF0dXJlT3B0c19kYXk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAqL1xuICAgICAgICAgICAgZmVhdHVyZU9wdHMgPSBbe1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9uXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzQzOWFhNVwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJhZG1pbmlzdHJhdGl2ZS5sb2NhbGl0eVwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzMyNDg1Y1wifSx7XCJ2aXNpYmlsaXR5XCI6XCJzaW1wbGlmaWVkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlLm5laWdoYm9yaG9vZFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvblwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJsYW5kc2NhcGUubmF0dXJhbFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2U5ZGRkYlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJsYW5kc2NhcGUubmF0dXJhbC50ZXJyYWluXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib2ZmXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInBvaVwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pLnBhcmtcIixcImVsZW1lbnRUeXBlXCI6XCJhbGxcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pLnBhcmtcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjYzRlNjYxXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInBvaS5wYXJrXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9mZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJyb2FkLmhpZ2h3YXlcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjZTlkZGRiXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuaGlnaHdheVwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzMyNDg1Y1wifSx7XCJ3ZWlnaHRcIjpcIjAuN1wifV19LHtcImZlYXR1cmVUeXBlXCI6XCJyb2FkLmFydGVyaWFsXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9uXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjZTlkZGRiXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5zdHJva2VcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiMzMjQ4NWNcIn0se1wid2VpZ2h0XCI6XCIwLjI1XCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMuaWNvblwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5sb2NhbFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5sb2NhbFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LmZpbGxcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiNlOWRkZGJcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5sb2NhbFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2VmNzk4ZVwifSx7XCJ3ZWlnaHRcIjpcIjAuNVwifSx7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvblwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LmxpbmVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2VmNzk4ZVwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LmxpbmVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcIndlaWdodFwiOlwiMi4wNlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LmxpbmVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5zdHJva2VcIixcInN0eWxlcnNcIjpbe1wid2VpZ2h0XCI6XCIxMC4wMFwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LmxpbmVcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5zdHJva2VcIixcInN0eWxlcnNcIjpbe1wid2VpZ2h0XCI6XCIwLjAxXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcIndhdGVyXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnkuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvblwifSx7XCJ3ZWlnaHRcIjpcIjEwLjAwXCJ9LHtcImNvbG9yXCI6XCIjNDM5YWE1XCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcIndhdGVyXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9uXCJ9LHtcImNvbG9yXCI6XCIjMzI0ODVjXCJ9LHtcIndlaWdodFwiOlwiMC44NVwifV19XTtcblxuICAgICAgICAgICAgdmFyIHN0eWxlZE1hcE9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ0N1c3RvbSBTdHlsZSdcbiAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGN1c3RvbU1hcFR5cGUgPSBuZXcgZ29vZ2xlLm1hcHMuU3R5bGVkTWFwVHlwZShmZWF0dXJlT3B0cywgc3R5bGVkTWFwT3B0aW9ucyk7XG4gICAgICAgICAgICBtYXAubWFwVHlwZXMuc2V0KENMT1VEX01BUF9JRCwgY3VzdG9tTWFwVHlwZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpbml0IHRoZSBtYXBcbiAgICAgICAgZnVuY3Rpb24gaW5pdE1hcCgpIHtcbiAgICAgICAgICAgIGlmIChtYXAgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIGluaXRpYWxNYXBEYXRhKCk7XG5cbiAgICAgICAgICAgICAgICBzZXRNYW51YWxFdmVudHMoKTtcblxuICAgICAgICAgICAgICAgIHNldFN0eWxlRm9yTWFwKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGFkZCBVSSBlbGVtZW50cyB0byBtYXBcbiAgICAgICAgICAgIHNldFVJU2VhcmNoTG9jYXRpb25Ub2dnbGUoKTtcbiAgICAgICAgICAgIHNldFVJU2VhcmNoQm94KCk7XG4gICAgICAgICAgICBzZXRVSU1vdmVUb0N1cnJMb2NCdG4oKTtcbiAgICAgICAgICAgIHNldFVJUG9zdEZvcm0oKTtcbiAgICAgICAgICAgIHNldFVJUG9zdEJ0bigpO1xuICAgICAgICAgICAgc2V0VUlUaW1lU2xpZGVyKCk7XG4gICAgICAgICAgICBzZXRVSVBvc3RPbk1hcCgpO1xuXG4gICAgICAgICAgICAvLyBhZGQgb3JpZ2luIG5hdGl2ZSBFdmVudCBoYW5kbGVycyB0byBtYXBcbiAgICAgICAgICAgIHNldEV2ZW50Q2xpY2soKTtcbiAgICAgICAgICAgIHNldEV2ZW50Q2VudGVyQ2hhbmdlZCgpO1xuICAgICAgICAgICAgc2V0RXZlbnREcmFnRW5kKCk7XG4gICAgICAgICAgICBzZXRFdmVudFJlc2l6ZSgpO1xuICAgICAgICAgICAgc2V0RXZlbnRab29tQ2hhbmdlZCgpO1xuICAgICAgICAgICAgc2V0RXZlbnRCb3VuZHNDaGFuZ2VkKCk7XG5cbiAgICAgICAgICAgIC8vIGJyb2FkY2FzdCB0byBzZW5kIG1hcCB0byBhcHBsaWNhdGlvbiBjdHJsXG4gICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0Om1hcCcsIG1hcCk7XG4gICAgICAgIH0gXG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gRVhFQ1VURVxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICBpbml0TWFwKCk7XG5cbiAgICAgICAgZHJhd0hlbHBlck1hcmtlcihpbml0aWFsTWFwQ2VudGVyKTtcbiAgICAgICAgc2V0UGxhY2UoaW5pdGlhbE1hcENlbnRlcik7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgaWQ9XCJtYXAtY2FudmFzXCI+PC9kaXY+JyxcbiAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgbGluazogbGlua1xuICAgIH07XG59KTtcblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uZGlyZWN0aXZlKCdtYXBNc2cnLCBmdW5jdGlvbiAoJHRpbWVvdXQsIFNlc3Npb25TdmMsIFBvc3RzU3ZjKSB7XG5cbiAgICB2YXIgbGluayA9IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykgeyAgIFxuXG4gICAgICAgIHNjb3BlLmdldF9sb2NhbHN0YXR1cyA9IGZ1bmN0aW9uKGxvY2FsX3N0YXR1cyl7XG4gICAgICAgICAgaWYgKGxvY2FsX3N0YXR1cylcbiAgICAgICAgICAgIHJldHVybiBcImxvY2FsLXRleHRcIjtcbiAgICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXR1cm4gXCJub24tbG9jYWwtdGV4dFwiO1xuICAgICAgICB9OyAgICAgXG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gQ09VUExJTkcgQ0xBU1NcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLyogY291cGxpbmcgc3RhdHVzXG4gICAgICAgICAgMCAtIG5vIHN0YXR1c1xuICAgICAgICAgIDEgLSBpIGxpa2UgeW91XG4gICAgICAgICAgMiAtIHlvdSBsaWtlIGlcbiAgICAgICAgICA0IC0gd2UgbGlrZSBlYWNoIG90aGVyXG4gICAgICAgICovXG4gICAgICAgIHNjb3BlLmdldF9jb3VwbGluZyA9IGZ1bmN0aW9uKGNvdXBsaW5nX3N0YXR1cyl7XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKGNvdXBsaW5nX3N0YXR1cyA9PSA0KXtcbiAgICAgICAgICAgIHJldHVybiBcImNvdXBsaW5nIGNvdXBsaW5nLWNvdXBsZVwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmIChjb3VwbGluZ19zdGF0dXMgPT0gMSl7XG4gICAgICAgICAgICByZXR1cm4gXCJjb3VwbGluZyBjb3VwbGluZy1pbGlrZXlvdVwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmIChjb3VwbGluZ19zdGF0dXMgPT0gMil7XG4gICAgICAgICAgICByZXR1cm4gXCJjb3VwbGluZyBjb3VwbGluZy15b3VsaWtlaVwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBcImNvdXBsaW5nIGNvdXBsaW5nLW5vbmVcIjtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gRE9DVU1FTlQgUkVBRFlcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcblxuICAgICAgICAgICR0aW1lb3V0KHVwZGF0ZUd1aWRUYXJnZXQsIDEwMCk7XG5cbiAgICAgICAgICAkdGltZW91dCh1cGRhdGVQb3N0VGltZXIsIDEwKTtcblxuICAgICAgICAgICR0aW1lb3V0KGN1c3RvbWl6ZUluZm9XaW5kb3csIDEwKTtcblxuICAgICAgICAgICR0aW1lb3V0KGN1c3RvbWl6ZUNsb3NlQnRuLCAxMCk7XG5cbiAgICAgICAgICAvL2NvbnNvbGUubG9nKFwicG9zdCBsb2NhbCBzdGF0dXM6XCIsIHNjb3BlLnBvc3Rsb2NhbHN0YXR1cyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUd1aWRUYXJnZXQoKXtcbiAgICAgICAgICAvLyB1cGRhdGUgc3RhdHVzIGZvciBndWlkIHRhcmdldFxuICAgICAgICAgIHZhciBwb3N0Z3VpZCAgPSBzY29wZS5wb3N0Z3VpZDtcbiAgICAgICAgICB2YXIgbXlndWlkICAgID0gc2NvcGUuJHBhcmVudC5ndWlkO1xuICAgICAgICAgIHZhciBteWd1aWR0Z3QgPSBzY29wZS4kcGFyZW50Lmd1aWR0Z3Q7XG5cbiAgICAgICAgICBlbGVtZW50LmNoaWxkcmVuKCkub24oJ2NsaWNrJyxmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICB2YXIgdXBkYXRlX2d1aWR0Z3QgPSBwb3N0Z3VpZDtcblxuICAgICAgICAgICAgLy8gY2xpY2tpbmcgbXkgbWVzc2FnZSB3aW5kb3dcbiAgICAgICAgICAgIC8vIGlmIGl0cyBvbiBjb3VwbGluZywgYnJlYWsgaXQhXG4gICAgICAgICAgICBpZiAocG9zdGd1aWQgPT0gbXlndWlkKXtcbiAgICAgICAgICAgICAgaWYgKHNjb3BlLiRwYXJlbnQuZ3VpZHRndCAhPSAnMCcpe1xuICAgICAgICAgICAgICAgIHVwZGF0ZV9ndWlkdGd0ID0gJzAnOyBcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gY2xpa2luZyB0aGUgb25lIHRoYXQgSSBsaWtlZFxuICAgICAgICAgICAgLy8gdG8gZGlzbGlrZSB0aGUgbWVzc2FnZSB3aW5kb3dcbiAgICAgICAgICAgIGlmIChwb3N0Z3VpZCA9PSBteWd1aWR0Z3QpIHtcbiAgICAgICAgICAgICAgdXBkYXRlX2d1aWR0Z3QgPSAnMCc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHByb3BhZ2F0ZSB0byB1cHBlciBzY29wZSBmb3IgZ3VpZHRndCB1cGRhdGVcbiAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdzZXQ6Z3VpZHRndCcsIHVwZGF0ZV9ndWlkdGd0KTsgXG5cbiAgICAgICAgICAgIC8vIHVwZGF0ZSBzZXNzaW9uIGluZm9ybWF0aW9uIG9mIG1pbmUgc28gbXkgc2Vzc2lvbiB0ZWxscyBtZSB0aGF0LFxuICAgICAgICAgICAgLy8gSSBsaWtlIHRoaXMgZ3VpZCBhdCB0aGlzIG1vbWVudCBpbiBzZXJ2ZXIgZGJcbiAgICAgICAgICAgIFNlc3Npb25TdmMudXBkYXRlQ291cGxpbmcobXlndWlkLCB1cGRhdGVfZ3VpZHRndClcbiAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oZG9jKXtcbiAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJTdWNjZXNzZnVsbHkgdWRwYXRlZCBjb3VwbGluZ1wiLCBkb2MpO1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyB1cGRhdGUgbXkgcG9zdCdzIGd1aWR0Z3QgdG8gYmUgdGhpcyBwb3N0J3MgZ3VpZCBpbiBzZXJ2ZXIgZGJcbiAgICAgICAgICAgIC8vIHRoaXMgdXBkYXRlIGlzIGZvciB0aGUgcGVvcGxlIHdobyBhcmUgbG9va2luZyBhdCBteSBwb3N0c1xuICAgICAgICAgICAgdmFyIHVwZGF0ZXMgPSB7XG4gICAgICAgICAgICAgIGd1aWQgICAgOiBteWd1aWQsXG4gICAgICAgICAgICAgIGd1aWR0Z3QgOiB1cGRhdGVfZ3VpZHRndFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFBvc3RzU3ZjLnVwZGF0ZUd1aWR0Z3QodXBkYXRlcylcbiAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oZG9jKXtcbiAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJTdWNjZXNzZnVsbHkgdWRwYXRlZCBwb3N0J3MgZ3VpZHRndFwiLCBkb2MpO1xuICAgICAgICAgICAgICAgICAgLy8gYWZ0ZXIgY291cGxpbmcgdXBkYXRlLCBtYXAgaGFzIHRvIGJlIHVwZGF0ZXMgYXMgd2VsbFxuICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgLy8gTUlHSFQgSEFWRSBUTyBDT01FIEJBQ0sgRk9SIE9QVElNSVpBVElPTlxuICAgICAgICAgICAgLy8gdGhpcyBoYXZlIHRvIGJlIHVwZGF0ZSB0byBiZSBjb21tdW5pY2F0ZWQgdGhyb3VnaCB0aGUgc2VydmVyXG4gICAgICAgICAgICBpZiAoc2NvcGUuJHBhcmVudC5ndWlkdGd0ID09IDApe1xuICAgICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0OmNvdXBsaW5nJywgMSk7IC8vIHByb3BhZ2F0ZSB0byB1cHBlciBzY29wZSBmb3IgY291cGxpbmcgdXBkYXRlXG4gICAgICAgICAgICAgIHNjb3BlLiRhcHBseSgpOyAvLyBmb3JjZSB0byB1cGRhdGUgRE9NXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0Y291cGxlc3RhdHVzID09IDEgJiYgc2NvcGUuJHBhcmVudC5ndWlkdGd0ICE9IDApe1xuICAgICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0OmNvdXBsaW5nJywgMCk7IC8vIHByb3BhZ2F0ZSB0byB1cHBlciBzY29wZSBmb3IgY291cGxpbmcgdXBkYXRlXG4gICAgICAgICAgICAgIHNjb3BlLiRhcHBseSgpOyAvLyBmb3JjZSB0byB1cGRhdGUgRE9NXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAqL1xuICAgICAgICAgICAgXG5cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVBvc3RUaW1lcigpe1xuICAgICAgICAgIC8vY29uc29sZS5sb2coXCJMaWZlICU6XCIsIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSk7XG4gICAgICAgICAgICB2YXIgZHVyYXRpb24gPSBzY29wZS5wb3N0bGlmZSArIFwibXNcIjtcblxuICAgICAgICAgICAgdmFyIHBvc3RiYXJsaWZlID0gZWxlbWVudC5jaGlsZHJlbigpLmNoaWxkcmVuKFwiLnBvc3RsaWZlYmFyXCIpO1xuXG4gICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1kdXJhdGlvbicsIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tZHVyYXRpb24nLCBkdXJhdGlvbik7XG4gICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tZHVyYXRpb24nLCBkdXJhdGlvbik7XG4gICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLWR1cmF0aW9uJywgZHVyYXRpb24pO1xuICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tZHVyYXRpb24nLCBkdXJhdGlvbik7XG5cbiAgICAgICAgICAgIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjk1KXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2EnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9hJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9hJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9hJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPD0gMC45NSAmJiBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjkpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2InKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2InKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9iJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2InKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA8PSAwLjkgJiYgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC44NSl7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9jJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYycpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYycpO1xuICAgICAgICAgICAgICBwb3N0bGlmZWJhcl9jc3MgPSBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2MnKTtcbiAgICAgICAgICAgICAgcG9zdGxpZmViYXJfY3NzID0gcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlIDw9IDAuODUgJiYgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC43NSl7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9kJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZCcpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZCcpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2QnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlIDw9IDAuNzUgJiYgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC42KXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2UnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9lJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9lJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9lJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPD0gMC42ICYmIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuNSl7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9mJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2YnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlIDw9IDAuNSAmJiBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjMpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZycpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2cnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2cnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9nJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2cnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA8PSAwLjMgJiYgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC4yKXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2gnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9oJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9oJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faCcpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9oJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPD0gMC4yICYmIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuMSl7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9pJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2knKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2onKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9qJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9qJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9qJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjdXN0b21pemVJbmZvV2luZG93KCl7XG4gICAgICAgICAgLy8gUmVmZXJlbmNlIHRvIHRoZSBESVYgdGhhdCB3cmFwcyB0aGUgYm90dG9tIG9mIGluZm93aW5kb3dcbiAgICAgICAgICB2YXIgaXdPdXRlciA9ICQoJy5nbS1zdHlsZS1pdycpO1xuICAgICAgICAgIFxuICAgICAgICAgIHZhciBpd0JhY2tncm91bmQgPSBpd091dGVyLnByZXYoKTtcblxuICAgICAgICAgIC8vIFJlbW92ZSB0aGUgYmFja2dyb3VuZCBzaGFkb3cgRElWXG4gICAgICAgICAgIGl3QmFja2dyb3VuZC5jaGlsZHJlbignOm50aC1jaGlsZCgyKScpLmNzcyh7J2Rpc3BsYXknIDogJ25vbmUnfSk7XG5cbiAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSB3aGl0ZSBiYWNrZ3JvdW5kIERJVlxuICAgICAgICAgICBpd0JhY2tncm91bmQuY2hpbGRyZW4oJzpudGgtY2hpbGQoNCknKS5jc3MoeydkaXNwbGF5JyA6ICdub25lJ30pO1xuXG4gICAgICAgICAgLy8gQ2hhbmdlcyB0aGUgZGVzaXJlZCB0YWlsIHNoYWRvdyBjb2xvci5cbiAgICAgICAgICBpd0JhY2tncm91bmQuY2hpbGRyZW4oJzpudGgtY2hpbGQoMyknKS5maW5kKCdkaXYnKS5jaGlsZHJlbigpLmNzcyh7XG4gICAgICAgICAgICAnYm94LXNoYWRvdyc6ICcwIDFweCA2cHggcmdiYSgxNzgsIDE3OCwgMTc4LCAwLjYpJywgXG4gICAgICAgICAgICAnei1pbmRleCcgOiAnMScsXG4gICAgICAgICAgICAnYm9yZGVyJzogJzBweCd9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGN1c3RvbWl6ZUNsb3NlQnRuKCl7XG4gICAgICAgICAgLy8gUmVmZXJlbmNlIHRvIHRoZSBESVYgdGhhdCB3cmFwcyB0aGUgYm90dG9tIG9mIGluZm93aW5kb3dcbiAgICAgICAgICB2YXIgaXdPdXRlciA9ICQoJy5nbS1zdHlsZS1pdycpO1xuXG4gICAgICAgICAgdmFyIGl3Q2xvc2VCdG4gPSBpd091dGVyLm5leHQoKTtcblxuICAgICAgICAgIC8qXG4gICAgICAgICAgY29uc29sZS5sb2coXCJwb3N0bG9jYWwgbGVhbnRoOlwiLCBpd091dGVyLnBhcmVudCgpLmZpbmQoJyNwb3N0bG9jYWwnKS5sZW5ndGgpO1xuICAgICAgICAgIGlmIChzY29wZS5wb3N0bG9jYWxzdGF0dXMgPT0gZmFsc2UgJiYgMCA9PSBpd091dGVyLnBhcmVudCgpLmZpbmQoJyNwb3N0bG9jYWwnKS5sZW5ndGgpe1xuICAgICAgICAgICAgaXdDbG9zZUJ0bi5hZnRlcihcIjxpbWcgaWQ9J3Bvc3Rsb2NhbCcgc3JjPSdodHRwOi8vY2RuLWltZy5lYXN5aWNvbi5uZXQvcG5nLzI0LzI0NDAucG5nJyB3aWR0aD0nMjAnLCBoZWlnaHQ9JzIwJy8+XCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAqL1xuXG4gICAgICAgICAgLy8gQXBwbHkgdGhlIGRlc2lyZWQgZWZmZWN0IHRvIHRoZSBjbG9zZSBidXR0b25cbiAgICAgICAgICBpd0Nsb3NlQnRuLmNzcyh7XG4gICAgICAgICAgICBvcGFjaXR5OiAnMC44JywgLy8gYnkgZGVmYXVsdCB0aGUgY2xvc2UgYnV0dG9uIGhhcyBhbiBvcGFjaXR5IG9mIDAuN1xuICAgICAgICAgICAgcmlnaHQ6ICcyMHB4JywgdG9wOiAnMjBweCcsIC8vIGJ1dHRvbiByZXBvc2l0aW9uaW5nXG4gICAgICAgICAgfSk7IFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcuL3RlbXBsYXRlcy93aW5kb3cuaHRtbCcsXG4gICAgICAgIGxpbms6IGxpbmtcbiAgICB9O1xufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHIuY29udHJvbGxlcignUG9zdHNDdHJsJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICRzY29wZSwgQ29uZmlnU3ZjLCBQb3N0c1N2YywgVXRpbFN2YywgJHdpbmRvdywgJGRvY3VtZW50LCAkdGltZW91dCl7XHJcclx0LyogZW1pdCBicm9hZGNhc3QgZm9yIGN1cnJlbnQgcGFnZUlkICovXHJcdCRzY29wZS4kZW1pdCgnc2V0OnBhZ2VjaGFuZ2UnLCAkc2NvcGUucGFnZUlkLnBvc3QpO1xyXHJcdCRzY29wZS5wb3N0cyA9IFtdO1xyXHJcdC8qIGFzIHNlcnZlciB0ZWxscyB0aGVyZSB3YXMgbmV3IHBvc3QsIGxldHMgcmUtbG9hZCBsaXN0IGRhdGEgKi9cclx0JHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbihfLCBwb3N0KXtcclx0XHQkc2NvcGUucmVxdWVzdEZldGNoKCk7XHJcdH0pO1xyXHJcdCRzY29wZS5hZGRQb3N0ID0gZnVuY3Rpb24oKSB7XHJcdFx0LyogY2hlY2sgaWYgdGhlIHBvc3QgY29udGVudCBpcyB0aGVyZSAtIG9ubHkgZm9yIFdFQiBmb3IgZW50ZXIgYnV0dG9uIHRvIHBvc3QgKi9cclx0XHRpZiAoISRzY29wZS5jb250ZW50KXtcclx0XHRcdC8qY29uc29sZS5sb2coXCJVc2VyIGF0dGVtcHRlZCB0byBwb3N0IHdpdGggMCB3b3Jkcy5cIikqL1xyXHRcdFx0cmV0dXJuO1xyXHRcdH1cclxyXHRcdC8qIGdldCBhdXRvY29tcGxldGVkIHBsYWNlIGFuZCByZXNldChzZXQgdG8gdW5kZWZpbmVkKSAqL1xyXHRcdHZhciBwbGFjZSAgICA9ICRzY29wZS5wb3N0cGxhY2U7XHJcdFx0dmFyIGxvY2F0aW9uID0gJHNjb3BlLnBvc3RMb2NhdGlvbjtcclxyXHRcdHZhciBsb2NhbF9zdGF0dXM7XHJcdFx0dmFyIHBvc3RMb2NhdGlvbkZyb21Vc2VyTG9jYXRpb24gPSBVdGlsU3ZjLmdldERpc3RhbmNlRnJvbUxhdExvbkluS20obG9jYXRpb24ubGF0LCBsb2NhdGlvbi5sb24sICRzY29wZS51c2VyTG9jYXRpb24ubGF0LCAkc2NvcGUudXNlckxvY2F0aW9uLmxvbik7XHJcdFx0LyogaWYgbGVzcyB0aGFuIDNrbSAqL1xyXHRcdGlmIChwb3N0TG9jYXRpb25Gcm9tVXNlckxvY2F0aW9uIDwgMyl7XHJcdFx0XHRsb2NhbF9zdGF0dXMgPSB0cnVlO1xyXHRcdH1cclx0XHRlbHNlIHtcclx0XHRcdGxvY2FsX3N0YXR1cyA9IGZhbHNlO1xyXHRcdH1cclx0XHRcclx0XHR2YXIgbG9jYXRpb25KU09OID0gSlNPTi5zdHJpbmdpZnkobG9jYXRpb24pO1xyXHJcdFx0dmFyIHJlbGF0aXZlTGlmZVNwYW47XHJcdFx0aWYgKCRzY29wZS50aW1ldmFsdWUgPD0gQ29uZmlnU3ZjLm1heEluc3RhbnRMaWZlU3Bhbil7XHJcdFx0XHR2YXIgY2hhckxlbiA9ICRzY29wZS5jb250ZW50Lmxlbmd0aDtcclx0XHRcdGlmIChjaGFyTGVuIDwgNSlcclx0XHRcdHtcclx0XHRcdFx0cmVsYXRpdmVMaWZlU3BhbiA9IDQwMDA7XHJcdFx0XHR9XHJcdFx0XHRlbHNlXHJcdFx0XHR7XHJcdFx0XHRcdHJlbGF0aXZlTGlmZVNwYW4gPSBjaGFyTGVuICogVXRpbFN2Yy5tYXBSYW5nZShjaGFyTGVuLCA1LCAyMCwgNzAwLCA0MDApO1xyXHRcdFx0fVxyXHRcdH1cclx0XHRlbHNlIHtcclx0XHRcdHJlbGF0aXZlTGlmZVNwYW4gPSAkc2NvcGUudGltZXZhbHVlO1xyXHRcdH1cclxyXHRcdFBvc3RzU3ZjLmNyZWF0ZShcclx0XHR7XHJcdFx0XHRib2R5ICAgIDogICRzY29wZS5jb250ZW50LFxyXHRcdFx0bG9jYXRpb246ICBsb2NhdGlvbkpTT04sXHJcdFx0XHRwbGFjZSAgIDogIHBsYWNlLFxyXHRcdFx0Z3VpZCAgICA6ICAkc2NvcGUuZ3VpZCxcclx0XHRcdGd1aWR0Z3QgOiAgJHNjb3BlLmd1aWR0Z3QsXHJcdFx0XHRsaWZlc3BhbjogIHJlbGF0aXZlTGlmZVNwYW4sXHJcdFx0XHRpc2xvY2FsIDogIGxvY2FsX3N0YXR1cyxcclx0XHR9KVxyXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKHBvc3Qpe1xyXHRcdFx0XHRcdFxyXHRcdFx0LyogcmVzZXQgaW5wdXQgZm9ybXMgKi9cclx0XHRcdCRzY29wZS5jb250ZW50ICA9IG51bGw7XHJcdFx0fSlcclx0XHQuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKXtcclx0XHRcdHN3YWwoXCJQb3N0IGZhaWxlZFwiLCBcIlBsZWFzZSBjb21wbGV0ZSB0aGUgZnJvbSBjb3JyZWN0bHlcIiwgXCJlcnJvclwiKTtcclx0XHR9KVxyXHRcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xyXHRcdFx0LyogaGFuZGxlIGVycm9yICovXHJcdFx0fSk7XHJcdH07XHJcclx0LyogYXMgc2VydmVyIHRlbGxzIHRoZXJlIHdhcyBuZXcgcG9zdCwgbGV0cyByZS1sb2FkIGxpc3QgZGF0YSAqL1xyXHQkc2NvcGUucmVxdWVzdEZldGNoID0gZnVuY3Rpb24oKSB7XHJcdFx0UG9zdHNTdmMuZmV0Y2goKVxyXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKHBvc3RzKXtcclx0XHRcdC8qY29uc29sZS5sb2coJ0dvdCBQb3N0czonLCBwb3N0cyk7ICovXHJcdFx0XHQkc2NvcGUucG9zdHMgPSBwb3N0cztcclx0XHR9KVxyXHRcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xyXHRcdFx0LyogZXJyb3IgaGFuZGxlICovXHJcdFx0fSk7XHJcdH07XHJcclx0LyogdXBkYXRlIGd1aWQgb2YgcG9zdCAqL1xyXHQkc2NvcGUudXBkYXRlR3VpZHRndCA9IGZ1bmN0aW9uKG15Z3VpZCwgZ3VpZHRndCkge1xyXHRcdHZhciB1cGRhdGVzID0ge1xyXHRcdFx0Z3VpZCAgICA6IG15Z3VpZCxcclx0XHRcdGd1aWR0Z3QgOiBndWlkdGd0XHJcdFx0fTtcclxyXHRcdC8qY29uc29sZS5sb2coXCJ1ZHBhdGUgdG8gcG9zdCBndWlkdGd0OlwiLCB1cGRhdGVzKSovXHJcclx0XHRQb3N0c1N2Yy51cGRhdGVHdWlkdGd0KHVwZGF0ZXMpXHJcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24odXBkYXRlcyl7XHJcdFx0XHQvKiAgZGVidWcgbXNnICAqL1xyXHRcdH0pXHJcdFx0LmNhdGNoKGZ1bmN0aW9uKGVycil7XHJcdFx0XHQvKiAgZXJyb3IgaGFuZGxpbmcgICovXHJcdFx0fSk7XHJcdH1cclxyXHQvKiRzY29wZS5yZXF1ZXN0RmV0Y2goKTsqL1xyfSk7XHIiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdQb3N0c1N2YycsIGZ1bmN0aW9uKCRodHRwKXtcblx0dGhpcy5mZXRjaCA9IGZ1bmN0aW9uKGd1aWRPYmope1xuXHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcG9zdHMnLCBndWlkT2JqKTtcblx0fTtcblxuXHR0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uKHBvc3Qpe1xuXHRcdHBvc3QuZGV2aWNldG9rZW4gPSAnMCc7IC8vIGZvciB3ZWIsIHRoZXJlIGlzIG5vIGRldmljZXRva2VuXG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcG9zdHMnLCBwb3N0KTtcblx0fTtcblxuXHR0aGlzLnJlbW92ZSA9IGZ1bmN0aW9uKHBvc3Qpe1xuXHRcdC8vY29uc29sZS5sb2coXCJkZWxldGluZyBwb3N0aW5nXCIpO1xuXHRcdC8vY29uc29sZS5sb2coJ3Bvc3QuX2lkOicsIHBvc3QuX2lkKTtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cy9wb3N0c19kZWxldGUnLCBwb3N0KTtcblx0fTtcblxuXHR0aGlzLnVwZGF0ZUd1aWR0Z3QgPSBmdW5jdGlvbih1cGRhdGVzKXtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cy91cGRhdGVfZ3VpZHRndCcsIHVwZGF0ZXMpO1xuXHR9XG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdTZXNzaW9uU3ZjJywgZnVuY3Rpb24oJGh0dHApe1xuXHR0aGlzLmZldGNoID0gZnVuY3Rpb24oKXtcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Nlc3Npb25zJyk7XG5cdH07XG5cblx0dGhpcy5lbnRlciA9IGZ1bmN0aW9uKHNlc3Npb24pe1xuXHRcdHNlc3Npb24uZGV2aWNldG9rZW4gPSAnMCc7IC8vIGZvciB3ZWIsIHRoZXJlIGlzIG5vIGRldmljZXRva2VuXG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbnMnLCBzZXNzaW9uKTtcblx0fTtcblxuXHR0aGlzLnJlbW92ZSA9IGZ1bmN0aW9uKGd1aWQpe1xuXHRcdHZhciBzZXNzaW9uID0ge2d1aWQ6IGd1aWR9O1xuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zL2RlbGV0ZScsIHNlc3Npb24pO1xuXHR9O1xuXG5cdHRoaXMudXBkYXRlT25saW5lc3RhdCA9IGZ1bmN0aW9uKG9ubGluZXN0YXQsIGd1aWQpe1xuXHRcdHZhciB1cGRhdGVkc2Vzc2lvbiA9IHtcblx0XHRcdG9ubGluZXN0YXQ6IG9ubGluZXN0YXQsXG5cdFx0XHRndWlkICAgICAgOiBndWlkXG5cdFx0fTtcblxuXHRcdHJldHVybiAkaHR0cC5wb3N0KFNFUlZFUi51cmwgKyAnL2FwaS9zZXNzaW9ucy91cGRhdGVfb25saW5lc3RhdCcsIHVwZGF0ZWRzZXNzaW9uKTtcblx0fVxuXG5cdHRoaXMudXBkYXRlV2F0Y2hMb2NhdGlvbiA9IGZ1bmN0aW9uKGN1cnJlbnRfbWFwX253LCBjdXJyZW50X21hcF9zZSwgY3VycmVudF9tYXBfY2VudGVyLCBndWlkKXtcblx0XHR2YXIgd2F0Y2hsb2MgPSB7XG4gICAgICAgICAgICBud19sYXQgICAgIDogY3VycmVudF9tYXBfbncubGF0LFxuICAgICAgICAgICAgbndfbG9uICAgICA6IGN1cnJlbnRfbWFwX253LmxvbixcbiAgICAgICAgICAgIHNlX2xhdCAgICAgOiBjdXJyZW50X21hcF9zZS5sYXQsXG4gICAgICAgICAgICBzZV9sb25cdCAgIDogY3VycmVudF9tYXBfc2UubG9uLFxuICAgICAgICAgICAgY2VudGVyX2xhdCA6IGN1cnJlbnRfbWFwX2NlbnRlci5sYXQsXG4gICAgICAgICAgICBjZW50ZXJfbG9uIDogY3VycmVudF9tYXBfY2VudGVyLmxvblxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHdhdGNobG9jSlNPTiA9IEpTT04uc3RyaW5naWZ5KHdhdGNobG9jKTtcblxuICAgICAgICB2YXIgdXBkYXRlZHNlc3Npb24gPSB7XG4gICAgICAgICAgICB3YXRjaGxvYzogd2F0Y2hsb2NKU09OLFxuICAgICAgICAgICAgZ3VpZCAgICA6IGd1aWRcbiAgICAgICAgfTtcblxuICAgICAgICAvLyB1cGRhdGUgd2F0Y2hsb2Mgd2hlbiBjZW50ZXIgY2hhbmdlZC5cbiAgICAgICAgLy9jb25zb2xlLmxvZyhcInVwZGF0aW5nIHdhdGNoIGxvY2F0aW9uXCIpO1xuXG5cdFx0Ly9jb25zb2xlLmxvZyhcInVwZGF0ZWRzZXNzaW9uOlwiLCB1cGRhdGVkc2Vzc2lvbik7XG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbnMvdXBkYXRlX3dhdGNoX2xvYycsIHVwZGF0ZWRzZXNzaW9uKTtcblx0fTtcblxuXHR0aGlzLnVwZGF0ZUN1cnJlbnRMb2NhdGlvbiA9IGZ1bmN0aW9uKGN1cnJlbnRfbG9jX2xhdCwgY3VycmVudF9sb2NfbG9uLCBndWlkKXtcblx0XHR2YXIgY3VycmxvYyA9IHtcblx0XHRcdGxhdCA6IGN1cnJlbnRfbG9jX2xhdCxcblx0XHRcdGxvbiA6IGN1cnJlbnRfbG9jX2xvblxuXHRcdH1cblxuXHRcdHZhciBjdXJybG9jSlNPTiA9IEpTT04uc3RyaW5naWZ5KGN1cnJsb2MpO1xuXG5cdFx0dmFyIHVwZGF0ZWRzZXNzaW9uID0ge1xuXHRcdFx0Y3VycmxvYzogY3VycmxvY0pTT04sXG5cdFx0XHRndWlkICAgOiBndWlkXG5cdFx0fVxuXG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbnMvdXBkYXRlX2N1cnJfbG9jJywgdXBkYXRlZHNlc3Npb24pO1xuXHR9O1xuXG5cdHRoaXMudXBkYXRlQ291cGxpbmcgPSBmdW5jdGlvbihndWlkLCBndWlkdGd0KXtcblx0XHRcblx0XHR2YXIgdXBkYXRlZGd1aWR0Z3QgPSB7XG5cdFx0XHRndWlkICAgOiBndWlkLFxuXHRcdFx0Z3VpZHRndDogZ3VpZHRndFxuXHRcdH07XG5cblx0XHQvLyB1cGRhdGUgd2F0Y2hsb2Mgd2hlbiBjZW50ZXIgY2hhbmdlZC5cbiAgICAgICAgLy9jb25zb2xlLmxvZyhcInVwZGF0aW5nIGNvdXBsaW5nXCIpO1xuXG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbnMvdXBkYXRlX2NvdXBsaW5nJywgdXBkYXRlZGd1aWR0Z3QpXG5cdH07XG59KTtcbiIsIlxuYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcblx0J25nUm91dGUnLFxuXHQnbmdBbmltYXRlJyxcblx0J3VpLnNsaWRlcicsXG5cdCc3MjBrYi5zb2NpYWxzaGFyZScsXG5dKTtcblxuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkN0cmwnLCBmdW5jdGlvbihTZXNzaW9uU3ZjLCBVdGlsU3ZjLCBDb25maWdTdmMsICRyb290U2NvcGUsICRzY29wZSwgJHdpbmRvdywgJGh0dHAsICR0aW1lb3V0KXtcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gSU5JVElBTFxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICB3aW5kb3cub25iZWZvcmV1bmxvYWQgPSBmdW5jdGlvbihlKSB7XG4gICAgXHRTZXNzaW9uU3ZjLnVwZGF0ZU9ubGluZXN0YXQoZmFsc2UsICRzY29wZS5ndWlkKVxuICAgIFx0Ly9TZXNzaW9uU3ZjLnJlbW92ZSgkc2NvcGUuZ3VpZClcbiAgICBcdC5zdWNjZXNzKGZ1bmN0aW9uKHJlcyl7XG4gICAgXHRcdC8vIGhhbmRsZSBzdWNjZXNzXG4gICAgXHR9KVxuICAgIFx0LmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgXHRcdC8vIGhhbmRsZSBlcnJvclxuICAgIFx0fSk7XG5cdH07XG5cblx0d2luZG93Lm9ucGFnZXNob3cgPSBmdW5jdGlvbihlKSB7XG5cdFx0JHNjb3BlLmluaXRTZXNzaW9uKCk7XG5cblx0XHRTZXNzaW9uU3ZjLnVwZGF0ZU9ubGluZXN0YXQodHJ1ZSwgJHNjb3BlLmd1aWQpO1xuXG5cdFx0aWYgKCRzY29wZS5tYXApIHtcblx0XHRcdCR0aW1lb3V0KGZ1bmN0aW9uKCl7XG5cdFx0XHRcdCRzY29wZS5tYXAudXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cdFx0XHR9KVxuXHRcdH1cblx0fTtcblxuXHR3aW5kb3cub25wYWdlaGlkZSA9IGZ1bmN0aW9uKGUpIHtcblx0XHRTZXNzaW9uU3ZjLnVwZGF0ZU9ubGluZXN0YXQoZmFsc2UsICRzY29wZS5ndWlkKVxuICAgIFx0Ly9TZXNzaW9uU3ZjLnJlbW92ZSgkc2NvcGUuZ3VpZClcbiAgICBcdC5zdWNjZXNzKGZ1bmN0aW9uKHJlcyl7XG4gICAgXHRcdC8vIGhhbmRsZSBzdWNjZXNzXG4gICAgXHR9KVxuICAgIFx0LmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgXHRcdC8vIGhhbmRsZSBlcnJvclxuICAgIFx0fSk7XG5cdH07XG5cblx0Ly8gc2Vzc2lvbiBpbiBhbmQgb3V0IGV2ZW50c1xuXHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwidmlzaWJpbGl0eWNoYW5nZVwiLCBmdW5jdGlvbigpIHtcblx0ICBpZiAoZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09ICd2aXNpYmxlJyB8fCBcblx0ICBcdGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAnbW96VmlzaWJsZScgfHwgXG5cdCAgXHRkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ21zVmlzaWJsZScgfHxcblx0ICBcdGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAnd2Via2l0VmlzaWJsZScpXG5cdCAge1xuXHQgIFx0U2Vzc2lvblN2Yy51cGRhdGVPbmxpbmVzdGF0KHRydWUsICRzY29wZS5ndWlkKTtcblx0ICBcdCRzY29wZS5pbml0U2Vzc2lvbigpO1xuXHQgIFx0aWYgKCRzY29wZS5tYXApXG5cdCAgXHR7XG5cdCAgXHRcdCRzY29wZS5tYXAudXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cdFx0fVxuXHQgIH0gXG5cdCAgZWxzZSBpZiAoZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09ICdoaWRkZW4nIHx8IFxuXHQgIFx0ZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09ICdtb3pIaWRkZW4nIHx8IFxuXHQgIFx0ZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09ICdtc0hpZGRlbicgfHxcblx0ICBcdGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAnd2Via2l0SGlkZGVuJylcblx0ICB7XG5cdCAgXHRTZXNzaW9uU3ZjLnVwZGF0ZU9ubGluZXN0YXQoZmFsc2UsICRzY29wZS5ndWlkKVxuXHQgIFx0Ly9TZXNzaW9uU3ZjLnJlbW92ZSgkc2NvcGUuZ3VpZClcblx0ICBcdC5zdWNjZXNzKGZ1bmN0aW9uKHJlcyl7XG4gICAgXHRcdC8vIGhhbmRsZSBzdWNjZXNzXG4gICAgXHR9KVxuICAgIFx0LmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgXHRcdC8vIGhhbmRsZSBlcnJvclxuICAgIFx0fSk7XG5cdCAgfVxuXHR9KTtcblxuXHQvLyB3ZWJraXQgc2Vzc2lvbiBpbiBhbmQgb3V0IGV2ZW50c1xuXHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwid2Via2l0dmlzaWJpbGl0eWNoYW5nZVwiLCBmdW5jdGlvbigpIHtcblx0ICBpZiAoZG9jdW1lbnQud2Via2l0VmlzaWJsZSlcblx0ICB7XG5cdCAgXHRTZXNzaW9uU3ZjLnVwZGF0ZU9ubGluZXN0YXQodHJ1ZSwgJHNjb3BlLmd1aWQpO1xuXHQgIFx0JHNjb3BlLmluaXRTZXNzaW9uKCk7XG5cdCAgXHRpZiAoJHNjb3BlLm1hcClcblx0ICBcdHtcblx0ICBcdFx0JHNjb3BlLm1hcC51cGRhdGVBbmREcmF3UG9zdHMoKTtcblx0XHR9XG5cdCAgfSBcblx0ICBlbHNlIGlmIChkb2N1bWVudC53ZWJraXRIaWRkZW4pXG5cdCAge1xuXHQgIFx0U2Vzc2lvblN2Yy51cGRhdGVPbmxpbmVzdGF0KGZhbHNlLCAkc2NvcGUuZ3VpZClcblx0ICBcdC8vU2Vzc2lvblN2Yy5yZW1vdmUoJHNjb3BlLmd1aWQpXG5cdCAgXHQuc3VjY2VzcyhmdW5jdGlvbihyZXMpe1xuICAgIFx0XHQvLyBoYW5kbGUgc3VjY2Vzc1xuICAgIFx0fSlcbiAgICBcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgIFx0XHQvLyBoYW5kbGUgZXJyb3JcbiAgICBcdH0pO1xuXHQgIH1cblx0fSwgZmFsc2UpO1xuXG5cdCRzY29wZS5zZXRXYXRjaExvY2F0aW9uID0gZnVuY3Rpb24oKXtcbiAgICBcdG5hdmlnYXRvci5nZW9sb2NhdGlvbi53YXRjaFBvc2l0aW9uKG9uU3VjY2Vzcyk7XG4gICAgfTtcblxuXHQvLyBvblN1Y2Nlc3MgR2VvbG9jYXRpb25cblx0ZnVuY3Rpb24gb25TdWNjZXNzKHBvcykge1xuICAgICAgICB2YXIgY3JkID0gcG9zLmNvb3JkcztcblxuICAgICAgICB2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhjcmQubGF0aXR1ZGUsIGNyZC5sb25naXR1ZGUpO1xuXG4gICAgICAgICRzY29wZS5tYXAuZHJhd1VzZXJMb2NhdGlvbk1hcmtlcihnb29nbGVMb2MpO1xuXG4gICAgICAgXHRTZXNzaW9uU3ZjLnVwZGF0ZUN1cnJlbnRMb2NhdGlvbihjcmQubGF0aXR1ZGUsIGNyZC5sb25naXR1ZGUsICRzY29wZS5ndWlkKTtcbiAgICB9O1xuXG5cdCRzY29wZS5pbml0U2Vzc2lvbiA9IGZ1bmN0aW9uKCl7XG5cdFx0aWYgKCRzY29wZS5tYXAgPT0gJ3VuZGVmaW5lZCcgfHwgJHNjb3BlLm1hcCA9PSAnbnVsbCcgfHwgISRzY29wZS5tYXApXG5cdFx0XHRyZXR1cm47XG5cblx0XHRmdW5jdGlvbiBnZXRDdXJyTG9jU3VjY2Vzcyhwb3MpIHtcdFxuXHRcdFx0Ly8vLy8vLy8vLy8vLy8vLy8vIFBIWVNJQ0FMIExPQ0FUSU9OXG5cdFx0XHQvLyDrp6jsspjsnYzsl5DripQg7Jyg7KCA7J2YIOyLpOygnCDsnITsuZgo7JWx7JeQIOyeheyepe2WiOydhOuVjOydmCDsnITsuZgp7JmAIOyEvO2EsCDtj6zsp4DshZjsnYQg6rCZ7J20IOuztOuCtOqzoCxcblx0XHRcdC8vIOyEvO2EsCDtj6zsp4DshZjsnYAg6rOE7IaNIOyXheuNsOydtO2KuCDrkJjslrTslbwg7ZWc64ukLlxuXHQgICAgICAgIHZhciBjcmQgPSBwb3MuY29vcmRzO1xuXG5cdCAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoY3JkLmxhdGl0dWRlLCBjcmQubG9uZ2l0dWRlKTtcblxuXHQgICAgICAgIC8vIHNhdmUgdGhlIHVzZXIgbG9jYXRpb24gaW50byBhcHBsaWNhdGlvbiBzY29wZSB2YXJpYWJsZVxuXHQgICAgICAgICRzY29wZS51c2VyTG9jYXRpb24gPSB7XG5cdCAgICAgICAgXHRsYXQ6IGNyZC5sYXRpdHVkZSxcblx0ICAgICAgICBcdGxvbjogY3JkLmxvbmdpdHVkZVxuXHQgICAgICAgIH07XG5cblx0ICAgICAgICB2YXIgbG9jYXRpb24gPSB7XG5cdCAgICBcdFx0bGF0Omdvb2dsZUxvYy5sYXQoKSxcblx0ICAgIFx0XHRsb246Z29vZ2xlTG9jLmxuZygpXG5cdCAgICBcdH07XG5cdCAgICBcdHZhciBsb2NhdGlvbkpTT04gPSBKU09OLnN0cmluZ2lmeShsb2NhdGlvbik7XG5cdCAgICBcdC8vY29uc29sZS5sb2coXCJzZXR0aW5nIGxvY2F0aW9uXCIsIGxvY2F0aW9uSlNPTik7XG5cblx0ICAgIFx0Ly8vLy8vLy8vLy8vLy8vLy8vIFdBVENIIExPQ0FUSU9OXG5cdCAgICBcdHZhciBib3VuZHMgPSAkc2NvcGUubWFwLmdldEJvdW5kcygpO1xuXHQgICAgICAgIHZhciBuZSA9IGJvdW5kcy5nZXROb3J0aEVhc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBub3J0aC1lYXN0IGNvcm5lclxuXHQgICAgICAgIHZhciBzdyA9IGJvdW5kcy5nZXRTb3V0aFdlc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBzb3V0aC13ZXN0IGNvcmRlclxuXHQgICAgICAgIC8vWW91IGdldCBub3J0aC13ZXN0IGFuZCBzb3V0aC1lYXN0IGNvcm5lcnMgZnJvbSB0aGUgdHdvIGFib3ZlOlxuXG5cdCAgICAgICAgdmFyIGN1cnJlbnRfbWFwX253ID0geyBcblx0ICAgICAgICAgICAgbGF0OiBuZS5sYXQoKSwgXG5cdCAgICAgICAgICAgIGxvbjogc3cubG5nKClcblx0ICAgICAgICB9O1xuXHQgICAgICAgIHZhciBjdXJyZW50X21hcF9zZSA9IHtcblx0ICAgICAgICAgICAgbGF0OiBzdy5sYXQoKSwgXG5cdCAgICAgICAgICAgIGxvbjogbmUubG5nKClcblx0ICAgICAgICB9O1xuXG5cdCAgICAgICAgdmFyIGN1cnJlbnRfbWFwX2NlbnRlciA9IHtcblx0ICAgICAgICBcdGxhdDp3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlLFxuXHQgICAgICAgIFx0bG9uOndpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlXG5cdCAgICBcdH07XG5cblx0ICAgICAgICB2YXIgd2F0Y2hsb2MgPSB7XG5cdCAgICAgICAgICAgIG53X2xhdCAgICA6IGN1cnJlbnRfbWFwX253LmxhdCxcblx0ICAgICAgICAgICAgbndfbG9uICAgIDogY3VycmVudF9tYXBfbncubG9uLFxuXHQgICAgICAgICAgICBzZV9sYXQgICAgOiBjdXJyZW50X21hcF9zZS5sYXQsXG5cdCAgICAgICAgICAgIHNlX2xvblx0ICA6IGN1cnJlbnRfbWFwX3NlLmxvbixcblx0ICAgICAgICAgICAgY2VudGVyX2xhdDogY3VycmVudF9tYXBfY2VudGVyLmxhdCxcblx0ICAgICAgICAgICAgY2VudGVyX2xvbjogY3VycmVudF9tYXBfY2VudGVyLmxvblxuXHQgICAgICAgIH1cblxuICAgICAgICBcdHZhciB3YXRjaGxvY0pTT04gPSBKU09OLnN0cmluZ2lmeSh3YXRjaGxvYyk7XG4gICAgICAgIFx0Ly9jb25zb2xlLmxvZyhcInNldHRpbmcgd2F0Y2hsb2NcIiwgd2F0Y2hsb2NKU09OKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vIExPQ0FUSU9OIFVQREFURSBXSVRIIFNFU1NJT04gRU5URVJcbiAgICAgICAgICAgIC8v7Jes6riw7IScIOu5hOuPmeq4sOyggeycvOuhnCDsnKDsoIDsnZgg66Gc7LyA7J207IWY7J2EIOyWu+qzoCDshLjshZjsnYQg67O064K87IiYIOyeiOuLpC5cblx0XHRcdHZhciBzZXNzaW9uID0ge1xuXHRcdFx0XHRndWlkdGd0IDogJHNjb3BlLmd1aWR0Z3QsXG5cdFx0XHRcdGd1aWQgICAgOiAkc2NvcGUuZ3VpZCxcblx0XHRcdFx0bG9jYXRpb246IGxvY2F0aW9uSlNPTixcblx0XHRcdFx0d2F0Y2hsb2M6IHdhdGNobG9jSlNPTlxuXHRcdFx0fTtcblx0XHRcdFNlc3Npb25TdmMuZW50ZXIoc2Vzc2lvbilcblx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uKHJlcyl7XG4gICAgXHRcdC8vIGhhbmRsZSBzdWNjZXNzXG4gICAgXHRcdFx0U2Vzc2lvblN2Yy51cGRhdGVPbmxpbmVzdGF0KHRydWUsICRzY29wZS5ndWlkKTtcblx0ICAgIFx0fSlcblx0ICAgIFx0LmNhdGNoKGZ1bmN0aW9uKGVycil7XG5cdCAgICBcdFx0Ly8gaGFuZGxlIGVycm9yXG5cdCAgICBcdH0pOyAvLyDshJzrsoTsl5DshJwg7Jyg7KCA6rCAIOuTpOyWtOyYtOydhCDslYzrprDri6QuXG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIGdldEN1cnJMb2NFcnJvcihlcnIpIHtcbiAgICAgICAgXHRzd2FsKFwiXCIsIFwiTmVlZCB0byB0dXJuIG9uIGxvY2F0aW9uIHNlcnZpY2UgZm9yIHByb3BlciB1c2UuXCIpO1xuICAgICAgICAgICAgLy9jb25zb2xlLndhcm4oJ0VSUk9SKCcgKyBlcnIuY29kZSArICcpOiAnICsgZXJyLm1lc3NhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaW5pdCBtYXAgYW5kIHBsYWNlIHNvbWUgbWFya2Vycywgc28gZXZlcnl0aGluZyBzdGFydCB3aXRoIHRoaXMgZnVuY3Rpb24uXG4gICAgICAgIHZhciBvcHRpb25zID0ge1xuXHRcdCAgZW5hYmxlSGlnaEFjY3VyYWN5OiBmYWxzZSxcblx0XHQgIHRpbWVvdXQ6IDEwMDAwLFxuXHRcdCAgbWF4aW11bUFnZTogMzAwMDAsXG5cdFx0fTtcblx0ICAgIG5hdmlnYXRvci5nZW9sb2NhdGlvbi5nZXRDdXJyZW50UG9zaXRpb24oZ2V0Q3VyckxvY1N1Y2Nlc3MsIGdldEN1cnJMb2NFcnJvciwgb3B0aW9ucyk7XG5cdFx0c3dhbCh7ICAgdGl0bGU6IFwiXCIsICAgdGV4dDogXCJSZXRyZWl2aW5nIGN1cnJuZXQgbG9jYXRpb24uLlwiLCAgIHRpbWVyOiAxMjAwLCAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSB9KTtcblx0fTtcblxuICAgIC8vIGxvYWQgYW5kIHNldCBsYXRlc3QgZ3VpZFxuXHRpZiAod2luZG93LmxvY2FsU3RvcmFnZS5ndWlkID09ICd1bmRlZmluZWQnIHx8IFxuXHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZCA9PSAnbnVsbCcgfHxcblx0XHQhd2luZG93LmxvY2FsU3RvcmFnZS5ndWlkKVxuXHR7XG5cdFx0d2luZG93LmxvY2FsU3RvcmFnZS5ndWlkID0gVXRpbFN2Yy5nZXRHdWlkKCk7XG5cdH1cblx0JHNjb3BlLmd1aWQgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWQ7XG5cblx0Ly8gbG9hZCBhbmQgc2V0IGxhdGVzdCBndWlkdGd0XG5cdGlmICh3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWR0Z3QgPT0gJ3VuZGVmaW5lZCcgfHwgXG5cdFx0d2luZG93LmxvY2FsU3RvcmFnZS5ndWlkdGd0ID09ICdudWxsJyB8fFxuXHRcdCF3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWR0Z3QpXG5cdHtcblx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWR0Z3QgPSBcIjBcIjtcblx0fVxuXHQkc2NvcGUuZ3VpZHRndCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZHRndDsgLy8gaW50ZXJlc3RlZCBvcHBvbmVudCBndWlkIG51bWJlclxuXG5cdCRzY29wZS5wYWdlSWQgPSB7IFxuXHRcdHBvc3QgOiAwLFxuXHR9O1xuXG5cdCRzY29wZS5uYXZDb2xsYXBzZWQgPSB0cnVlO1xuXG5cdC8vIHZhbHVlIGZyb20gdGltZSBzbGlkZXIgaW4gVUlcblx0Ly8gZGVmYXVsdCBpcyBtYXggaW5zdGFudCBsaWZlIHNwYW5cbiAgICAkc2NvcGUudGltZXZhbHVlID0gQ29uZmlnU3ZjLm1heEluc3RhbnRMaWZlU3BhbjtcblxuXHQvLyB1c2VyJ3MgY3VycmVudCBsb2NhdGlvbiBzdG9yYWdlXG5cdCRzY29wZS51c2VyTG9jYXRpb24gPSB7XG5cdFx0bGF0OiAwLjAsXG5cdFx0bG9uOiAwLjBcblx0fTtcblxuXHQkc2NvcGUudG9nZ2xlU2VhcmNoTG9jYXRpb24gPSBmYWxzZTtcblx0JHNjb3BlLnRvZ2dsZVRpbWVTbGlkZXIgPSBmYWxzZTtcblxuXHQvLyBldmVudCBoYW5kZXIgZm9yIG1hcCBVSXNcblx0JHRpbWVvdXQoZnVuY3Rpb24oKXtcblx0XHQvLyBlbmFibGVzIGVudGVyIGtleSB0byBzdWJtaXQgcG9zdCBmb3JtXG5cdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1wb3N0aW5nJykub25rZXlwcmVzcyA9IGZ1bmN0aW9uKGV2ZW50KXtcblx0XHRcdC8vY29uc29sZS5sb2coXCJJbnNpZGUga2V5cHJlc3NcIixldmVudC53aGljaCk7XG5cdFx0XHRpZiAoZXZlbnQud2hpY2ggPT0gJzEzJyl7XG5cdFx0XHRcdC8vY29uc29sZS5sb2coXCJlbnRlciBwcmVzc2VkXCIpO1xuXHRcdFx0XHQkKCdmb3JtI21hcC1wb3N0aW5nLWZvcm0nKS5zdWJtaXQoKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLXBvc3RpbmcnKS5vbmZvY3VzID0gZnVuY3Rpb24oZXZlbnQpe1xuXHRcdFx0Ly9jb25zb2xlLmxvZyhcIm9uIGZvY3VzXCIpO1xuXHRcdFx0JHNjb3BlLnRvZ2dsZVRpbWVTbGlkZXIgPSB0cnVlO1xuXHRcdH1cblxuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtcG9zdGluZycpLm9uYmx1ciA9IGZ1bmN0aW9uKGV2ZW50KXtcblx0XHRcdC8vY29uc29sZS5sb2coXCJvbiBibHVyXCIpO1xuXHRcdFx0JHNjb3BlLnRvZ2dsZVRpbWVTbGlkZXIgPSBmYWxzZTtcblx0XHR9XG5cblx0XHQkKCcubmF2LWJ1cmdlcicpLmNsaWNrKGZ1bmN0aW9uKCkge1xuXHRcdCAgJCgnLm5hdi1idXJnZXInKS50b2dnbGVDbGFzcygnYWN0aXZlJyk7XG5cdFx0ICAvLyQoJy5jb250cm9scycpLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcblx0XHQgICRzY29wZS50b2dnbGVTZWFyY2hMb2NhdGlvbiA9ICEkc2NvcGUudG9nZ2xlU2VhcmNoTG9jYXRpb247XG5cdFx0ICAkc2NvcGUuJGFwcGx5KCk7XG5cdFx0fSk7XG5cblx0fSk7XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFNPQ0tFVFxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdHZhciB1cmw7XG5cdHZhciBob3N0bmFtZSA9IGRvY3VtZW50LmxvY2F0aW9uLmhvc3RuYW1lO1xuXG5cdGlmIChob3N0bmFtZSA9PSBDb25maWdTdmMubG9jYWwpe1xuXHRcdHVybCA9IENvbmZpZ1N2Yy53ZWJfc29ja2V0ICsgQ29uZmlnU3ZjLmxvY2FsICsgJzonICsgQ29uZmlnU3ZjLnBvcnQ7XG5cdH1cblx0ZWxzZSBpZiAoaG9zdG5hbWUgPT0gQ29uZmlnU3ZjLmxvY2FsX2lwKSB7XG5cdFx0dXJsID0gQ29uZmlnU3ZjLndlYl9zb2NrZXQgKyBDb25maWdTdmMubG9jYWxfaXAgKyAnOicgKyBDb25maWdTdmMucG9ydDsgLy8gZGV2ZWxvcG1ldCBvbiBzb2NrZXQgbG9jYWxseSBcblx0fVxuXHRlbHNlIHtcblx0XHR1cmwgPSBDb25maWdTdmMud2ViX3NvY2tldCArIENvbmZpZ1N2Yy5kZXBsb3lfZG5zOyAvLyBwcm9kdWN0aW9uIGRlcGxveSB2ZXJzaW9uIC0gc3RpbGwgZGVidWcgbW9kZVxuXHRcdC8vdXJsID0gQ29uZmlnU3ZjLndlYl9zb2NrZXRfc2VjdXJlICsgQ29uZmlnU3ZjLmRlcGxveV9kbnM7IC8vIHByb2R1Y3Rpb24gZGVwbG95IHZlcnNpb24gLSBzdGlsbCBkZWJ1ZyBtb2RlXG5cdH1cblxuXHQvKiDqsJzrsJzqs7zsoJXsnbQg64Gd64KY6rOgIOuwsO2PrOyLnOyXkOuKlCDsnITrtoDrtoTsnYQg7KeA7Jqw6rOgIOyVhOuemCDsvZTrk5zrp4wg64Ko6rKo64+EIOuQnOuLpC5cblx0dXJsID0gJ3dzczovL2Zyb3plbi1iYWRsYW5kcy04NjQ5Lmhlcm9rdWFwcC5jb20nO1xuXHQqL1xuXHR2YXIgY29ubmVjdCA9IGZ1bmN0aW9uKCkge1xuXHRcdGNvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0KHVybCk7XG5cblx0XHRjb25uZWN0aW9uLm9ub3BlbiA9IGZ1bmN0aW9uKCl7XG5cblx0XHRcdC8vIHNlbmQgZ3VpZCB0byBzZXJ2ZXIgZm9yIHdzIGlkZW50aWZpY2F0aW9uXG5cdFx0XHRjb25uZWN0aW9uLnNlbmQoJHNjb3BlLmd1aWQpO1xuXHRcdFx0Ly9jb25zb2xlLmxvZygnV2ViU29ja2V0IGNvbm5lY3RlZCcpO1xuXHRcdH07XG5cblx0XHRjb25uZWN0aW9uLm9uY2xvc2UgPSBmdW5jdGlvbigpe1xuXG5cdFx0XHQvL2NvbnNvbGUubG9nKCdXZWJTb2NrZXQgY2xvc2VkLiBSZWNvbmVjdGluZy4uLicpO1xuXHRcdFx0JHRpbWVvdXQoY29ubmVjdCwgMjAwMCk7XG5cdFx0fTtcblxuXHRcdGNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24oZSl7XG5cdFx0XHQvL2NvbnNvbGUubG9nKCdicm9hZGNhc3QgbXNnIGZyb20gc2VydmVyOicsIGUpO1xuXHRcdFx0dmFyIHBheWxvYWQgPSBKU09OLnBhcnNlKGUuZGF0YSk7XG5cblx0XHRcdC8qXG5cdFx0XHRcdHdzOm5ld19wb3N0ICAgIC0g7IOI66Gc7Jq0IO2PrOyKpO2KuOqwgCDsmKzrnbzsmZTsnYTrlYwgZnJvbnQtZW5k7JeQ7IScIOunteydtCDri6Tsi5wg7JeF642w7J207Yq4IO2VtOyVvCDrkJzri6Tqs6Ag7JWM66Ck7KSA64ukIVxuXHRcdFx0XHR3czpuZXdfc2Vzc2lvbiAtIHNlc3Npb27snbQg7IOI66GcIOuTpOyWtOyYpOuptCDrkJzri6Tqs6Ag7JWM66Ck7KSA64ukIVxuXHRcdFx0XHR3czpyZW1vdmVfcG9zdCAtIO2PrOyKpO2KuOqwgCDsi5zqsITsnbQg64ukIOuQmOyWtOyEnCDsgqzrnbzsp4jrlYwhXG5cdFx0XHRcdOunpOyasOykkeyalCEgXG5cdFx0XHQqL1xuXHRcdFx0JHJvb3RTY29wZS4kYnJvYWRjYXN0KCd3czonICsgcGF5bG9hZC50eXBlLCBwYXlsb2FkLmRhdGEpO1xuXHRcdH07XG5cdH07XG5cdGNvbm5lY3QoKTtcblxuXHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFNPQ0tFVCBCUk9BRENBU1QgUkVDRUlWRVJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvLyBhcyBzZXJ2ZXIgc29ja2V0IHNlbmQgJ3dzOm5ld19wb3N0JyAsIHdlIGNhbiB1cGRhdGUgdGhlIG1hcCFcblx0JHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbihfLCBwb3N0KXtcblx0XHQvLyB1cGRhdGUgcG9zdHMgb24gbWFwXG5cdFx0JHNjb3BlLm1hcC51cGRhdGVBbmREcmF3UG9zdHMoKTtcblxuXHRcdC8vIHNob3cgcmVzcG9uc2l2ZSB1c2VycyBvbmx5IHRvIHRoZSB1c2VyIHdobyB3cm90ZSB0aGlzIHBvc3Rcblx0XHRpZiAocG9zdC5ndWlkID09ICRzY29wZS5ndWlkKVxuXHRcdHtcblx0XHRcdCRzY29wZS5tYXAuZHJhd1Jlc3BvbnNlcyhwb3N0KTtcblx0XHR9XG5cdH0pO1xuXG5cdC8vIGFzIHNlcnZlciBzb2NrZXQgc2VuZCAnd3M6bmV3X3Bvc3QnICwgd2UgY2FuIHVwZGF0ZSB0aGUgbWFwIVxuXHQkc2NvcGUuJG9uKCd3czpuZXdfc2Vzc2lvbicsIGZ1bmN0aW9uKF8sIHNlc3Npb24pe1xuXHRcdGlmIChzZXNzaW9uLmd1aWQgIT0gJHNjb3BlLmd1aWQpIHtcblx0XHRcdHZhciBsb2NhdGlvbiA9IGFuZ3VsYXIuZnJvbUpzb24oc2Vzc2lvbi5sb2NhdGlvbik7XG5cdFx0XHQkc2NvcGUubWFwLmRyYXdDdXJyTG9jYXRpb25NYXJrZXIobG9jYXRpb24pO1xuXHRcdH1cblx0fSk7XG5cblx0Ly8gd2hlbiBzZXJ2ZXIgcmVtb3ZlIHRoZSBwb3N0IGFmdGVyIHRpbWUgZm9yIGxvbmdlciBvbmVzLCBcblx0Ly8gdXBkYXRlIG1hcCB3aXRoIGNvcmVzcG9uZGluZyBpbmZvXG5cdCRzY29wZS4kb24oJ3dzOnJlbW92ZV9wb3N0JywgZnVuY3Rpb24oXywgcG9zdGlkKXtcblx0XHQkc2NvcGUubWFwLnVuRHJhd1Bvc3QocG9zdGlkKTtcblx0fSk7XG5cblx0JHNjb3BlLiRvbignd3M6dXBkYXRlX2d1aWR0Z3QnLCBmdW5jdGlvbihfLCB1cGRhdGVkU2Vzc2lvbil7XG5cdFx0Ly8gdXBkYXRlIHBvc3RzIG9uIG1hcFxuXHRcdCRzY29wZS5tYXAudXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cdH0pO1xuXG5cdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQVBQTElDQVRJT04gTEVWRUwgRlVOQ1RJT05TXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBzZWUgaWYgaXRzIGluc3RhbnRcbiAgICAkc2NvcGUuaXNJbnN0YW50ID0gZnVuY3Rpb24odGltZXZhbHVlKXtcbiAgICBcdGlmICh0aW1ldmFsdWUgPD0gQ29uZmlnU3ZjLm1heEluc3RhbnRMaWZlU3BhbilcbiAgICBcdFx0cmV0dXJuIHRydWU7XG4gICAgXHRyZXR1cm4gZmFsc2U7XG4gICAgfTtcblxuXHQvLyBzZWUgaWYgaXRzIG1vYmlsZSBwaG9uZVxuXHQkc2NvcGUuaXNNb2JpbGUgPSBmdW5jdGlvbigpe1xuXHRcdGlmKCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9BbmRyb2lkL2kpXG5cdFx0IHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL3dlYk9TL2kpXG5cdFx0IHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL2lQaG9uZS9pKVxuXHRcdCB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUGFkL2kpXG5cdFx0IHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL2lQb2QvaSlcblx0XHQgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvQmxhY2tCZXJyeS9pKVxuXHRcdCB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9XaW5kb3dzIFBob25lL2kpXG5cdFx0ICl7XG5cdFx0ICAgIHJldHVybiB0cnVlO1xuXHRcdCAgfVxuXHRcdCBlbHNlIHtcblx0XHQgICAgcmV0dXJuIGZhbHNlO1xuXHRcdCAgfVxuXHR9O1xuXG5cdC8qIG1vdmUgdG8gY3VycmVudCBsb2NhdGlvbiAqL1xuXHQkc2NvcGUubW92ZVRvQ3VycmVudExvY2F0aW9uID0gZnVuY3Rpb24oKXtcblx0XHRmdW5jdGlvbiBnZXRDdXJyTG9jU3VjY2Vzcyhwb3MpIHtcbiAgICAgICAgICAgIC8qIG1ha2Ugc3VyZSB0byBjaGVjayB3ZSBhcmUgb24gcG9zdCBwYWdlIHdpdGggbWFwIGZpcnN0ICovXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmN1cnJlbnRQYWdlSWQgIT0gJHNjb3BlLnBhZ2VJZC5wb3N0KVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgdmFyIGNyZCA9IHBvcy5jb29yZHM7XG5cbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUgPSBjcmQubGF0aXR1ZGU7XG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSA9IGNyZC5sb25naXR1ZGU7XG5cbiAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IHtcbiAgICAgICAgICAgIFx0bGF0OiBjcmQubGF0aXR1ZGUsIFxuICAgICAgICAgICAgXHRsb246IGNyZC5sb25naXR1ZGVcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgXHQvLyBkcmF3IHggbWFya2VyXG5cdCAgICAgICAgJHNjb3BlLm1hcC5kcmF3WE1hcmtlcihsb2NhdGlvbik7XG5cblx0ICAgICAgICB2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsb2NhdGlvbi5sYXQsIGxvY2F0aW9uLmxvbik7XG5cblx0ICAgICAgICAvLyBtb3ZlIHRvIHRoZSBsb2NhdGlvbiBhbmQgem9vbSBpbnRvIHJpZ2h0IGFtb3VudFxuICAgICAgICAgICAgJHNjb3BlLm1hcC5wYW5Ubyhnb29nbGVMb2MpO1xuICAgICAgICAgICAgJHNjb3BlLm1hcC51cGRhdGVBbmREcmF3UG9zdHMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEN1cnJMb2NFcnJvcihlcnIpIHtcbiAgICAgICAgXHRzd2FsKFwiXCIsIFwiTmVlZCB0byB0dXJuIG9uIGxvY2F0aW9uIHNlcnZpY2UgZm9yIHByb3BlciB1c2UuXCIpO1xuICAgICAgICAgICAgLy9jb25zb2xlLndhcm4oJ0VSUk9SKCcgKyBlcnIuY29kZSArICcpOiAnICsgZXJyLm1lc3NhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaW5pdCBtYXAgYW5kIHBsYWNlIHNvbWUgbWFya2Vycywgc28gZXZlcnl0aGluZyBzdGFydCB3aXRoIHRoaXMgZnVuY3Rpb24uXG4gICAgICAgIHZhciBvcHRpb25zID0ge1xuXHRcdCAgZW5hYmxlSGlnaEFjY3VyYWN5OiB0cnVlLFxuXHRcdCAgdGltZW91dDogMTAwMDAsXG5cdFx0ICBtYXhpbXVtQWdlOiAzMDAwMCxcblx0XHR9O1xuICAgICAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGdldEN1cnJMb2NTdWNjZXNzLCBnZXRDdXJyTG9jRXJyb3IsIG9wdGlvbnMpO1xuXG4gICAgICAgIHN3YWwoeyAgIHRpdGxlOiBcIlwiLCAgIHRleHQ6IFwiTW92aW5nIHRvIGN1cnJlbnQgbG9jYXRpb24uLlwiLCAgIHRpbWVyOiAxMDAwLCAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSB9KTtcblx0fTtcblxuXHQkc2NvcGUubW92ZVRvUG9zdExvY2F0aW9uID0gZnVuY3Rpb24oKXtcblx0XHR2YXIgbGF0RGVsdGEgPSAwLjA7XG5cblx0XHRpZiAoJHNjb3BlLmlzTW9iaWxlKCkpe1xuXHRcdFx0dmFyIGJvdW5kcyA9ICRzY29wZS5tYXAuZ2V0Qm91bmRzKCk7XG5cdCAgICAgICAgdmFyIG5lID0gYm91bmRzLmdldE5vcnRoRWFzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIG5vcnRoLWVhc3QgY29ybmVyXG5cdCAgICAgICAgdmFyIHN3ID0gYm91bmRzLmdldFNvdXRoV2VzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIHNvdXRoLXdlc3QgY29yZGVyXG5cdCAgICAgICAgY3VycmVudF9tYXBfbncgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKG5lLmxhdCgpLCBzdy5sbmcoKSk7XG5cdCAgICAgICAgY3VycmVudF9tYXBfc2UgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHN3LmxhdCgpLCBuZS5sbmcoKSk7XG5cblx0ICAgICAgICB2YXIgbGF0RGVsdGFfY2VudGVyMm5vcnRoID0gMC41ICogTWF0aC5hYnMoJHNjb3BlLnBvc3RMb2NhdGlvbi5sYXQgLSBjdXJyZW50X21hcF9udy5sYXQoKSk7XG5cdCAgICAgICAgdmFyIGxhdERlbHRhX2NlbnRlcjJzb3V0aCA9IDAuNSAqIE1hdGguYWJzKCRzY29wZS5wb3N0TG9jYXRpb24ubGF0IC0gY3VycmVudF9tYXBfc2UubGF0KCkpO1xuXG5cdCAgICAgICAgaWYgKGxhdERlbHRhX2NlbnRlcjJub3J0aCA+IGxhdERlbHRhX2NlbnRlcjJzb3V0aCl7XG5cdCAgICAgICAgXHRsYXREZWx0YSA9IGxhdERlbHRhX2NlbnRlcjJzb3V0aDtcblx0ICAgICAgICB9XG5cdCAgICAgICAgZWxzZSB7XG5cdCAgICAgICAgXHRsYXREZWx0YSA9IGxhdERlbHRhX2NlbnRlcjJub3J0aDtcblx0ICAgICAgICB9XG5cdFx0fVxuXG5cdFx0dmFyIGNlbnRlckxvYyA9ICRzY29wZS5tYXAuZ2V0Q2VudGVyKCk7XG5cblx0XHR2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZygkc2NvcGUucG9zdExvY2F0aW9uLmxhdCArIGxhdERlbHRhLCBjZW50ZXJMb2MubG5nKCkpO1xuXHRcdCRzY29wZS5tYXAucGFuVG8oZ29vZ2xlTG9jKTtcblx0XHQkc2NvcGUubWFwLnVwZGF0ZUFuZERyYXdQb3N0cygpO1xuXHR9O1xuXG5cdCRzY29wZS5jb2xsYXBzZSA9IGZ1bmN0aW9uKCl7XG5cdFx0JHNjb3BlLm5hdkNvbGxhcHNlZCA9IHRydWU7XG5cdH07XG5cblx0Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBHRU5FUkFMIEJST0FEQ0FTVCBSRUNFSVZFUlxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgJHNjb3BlLiRvbignc2V0Om1hcCcsIGZ1bmN0aW9uKF8sIG1hcCl7XG5cdFx0JHNjb3BlLm1hcCA9IG1hcDtcblx0XHQkdGltZW91dChmdW5jdGlvbigpe1xuXHRcdFx0JHNjb3BlLmluaXRTZXNzaW9uKCk7XG5cdFx0XHQkc2NvcGUuc2V0V2F0Y2hMb2NhdGlvbigpO1xuXHRcdH0pO1xuXHR9KTtcblxuICAgICRzY29wZS4kb24oJ3NldDpndWlkdGd0JywgZnVuY3Rpb24oXywgZ3VpZHRndCl7XG5cdFx0JHNjb3BlLmd1aWR0Z3QgPSBndWlkdGd0O1xuXG5cdFx0Ly8gaXRzIHZlcnkgaW1wb3JhbnQgdG8gc2V0IGxvY2FsIHN0b3JhZ2UgZ3VpZHRndFxuXHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZHRndCA9IGd1aWR0Z3Q7XG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ3NldDpwYWdlY2hhbmdlJywgZnVuY3Rpb24oXywgcGFnZUlkKXtcblx0XHQkc2NvcGUuY3VycmVudFBhZ2VJZCA9IHBhZ2VJZDtcblx0fSk7XG5cblx0JHNjb3BlLiRvbignc2V0OmxvYycsIGZ1bmN0aW9uKF8sIGxvY2F0aW9uKXtcblx0XHR2YXIgbGF0ID0gbG9jYXRpb24ubGF0KCk7XG5cdFx0dmFyIGxvbiA9IGxvY2F0aW9uLmxuZygpO1xuXHRcdCRzY29wZS5wb3N0TG9jYXRpb24gPSB7XG5cdFx0XHRsYXQ6IGxhdCxcblx0XHRcdGxvbjogbG9uXG5cdFx0fTtcblx0fSk7XG5cblx0JHNjb3BlLiRvbignc2V0OnBsYWNlJywgZnVuY3Rpb24oXywgcGxhY2Upe1xuXHRcdC8vIEZvcmNpbmcgdGhlIHVwZGF0ZSB3aXRoICRhcHBseSgpIG1ldGhvZCBvbiAkc2NvcGVcblx0XHQvLyBwcm9ibGVtIHJlbGF0ZWQgbm90ZTogaHR0cDovL3d3dy5qZWZmcnlob3VzZXIuY29tL2luZGV4LmNmbS8yMDE0LzYvMi9Ib3ctZG8tSS1ydW4tY29kZS13aGVuLWEtdmFyaWFibGUtY2hhbmdlcy13aXRoLUFuZ3VsYXJKU1xuXHRcdCRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKXtcblx0XHRcdFx0JHNjb3BlLnBvc3RwbGFjZSA9IHBsYWNlO1xuXHRcdFx0fVxuXHRcdCk7XG5cdH0pO1xufSk7XG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb25zdGFudCgnQ29uZmlnU3ZjJywge1xuXHRcIndlYl9zb2NrZXRcIlx0XHQ6IFwid3M6Ly9cIixcblx0XCJ3ZWJfc29ja2V0X3NlY3VyZVwiIDogXCJ3c3M6Ly9cIixcblx0XCJsb2NhbFwiXHRcdFx0XHQ6IFwibG9jYWxob3N0XCIsXG5cdFwibG9jYWxfaXBcIlx0XHRcdDogXCIxOTIuMTY4LjAuNFwiLFxuXHQvL1wiZGVwbG95X2Ruc1wiXHRcdDogXCJjbG91ZHRhbGsuaGVyb2t1YXBwLmNvbVwiLFxuXHRcImRlcGxveV9kbnNcIlx0XHQ6IFwidGFsa2lwaWEuY29tXCIsXG5cdFwicG9ydFwiXHRcdFx0XHQ6IFwiNTAwMFwiLFxuXHRcIm1heEluc3RhbnRMaWZlU3BhblwiOiA1MDAwLFxufSk7XG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbmZpZyhmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIpe1xuXHQkcm91dGVQcm92aWRlclxuXHQud2hlbignLycsIFxuXHRcdHtcblx0XHRcdGNvbnRyb2xsZXI6ICdQb3N0c0N0cmwnLCBcblx0XHRcdHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9wb3N0cy5odG1sJ1xuXHRcdH0pXG5cdC8vIFJlZGlyZWN0IHRvIHRoZSByb290IHBhZ2UuXG5cdC5vdGhlcndpc2UoXG5cdFx0e1xuICAgXHRcdFx0cmVkaXJlY3RUbzogJy8nXG5cdFx0fSk7XG59KTtcblxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnVXRpbFN2YycsIGZ1bmN0aW9uKCl7XG5cdHZhciBzdmMgPSB0aGlzO1xuXG5cdHN2Yy5kZWcycmFkID0gZnVuY3Rpb24oZGVnKSB7XG5cdCAgcmV0dXJuIGRlZyAqIChNYXRoLlBJLzE4MCk7XG5cdH07XG5cblx0c3ZjLmdldERpc3RhbmNlRnJvbUxhdExvbkluS20gPSBmdW5jdGlvbiAobGF0MSxsb24xLGxhdDIsbG9uMikge1xuXHQgIHZhciBSID0gNjM3MTtcblx0ICB2YXIgZExhdCA9IHN2Yy5kZWcycmFkKGxhdDItbGF0MSk7XG5cdCAgdmFyIGRMb24gPSBzdmMuZGVnMnJhZChsb24yLWxvbjEpOyBcblx0ICB2YXIgYSA9IFxuXHQgICAgTWF0aC5zaW4oZExhdC8yKSAqIE1hdGguc2luKGRMYXQvMikgK1xuXHQgICAgTWF0aC5jb3Moc3ZjLmRlZzJyYWQobGF0MSkpICogTWF0aC5jb3Moc3ZjLmRlZzJyYWQobGF0MikpICogXG5cdCAgICBNYXRoLnNpbihkTG9uLzIpICogTWF0aC5zaW4oZExvbi8yKVxuXHQgICAgOyBcblx0ICB2YXIgYyA9IDIgKiBNYXRoLmF0YW4yKE1hdGguc3FydChhKSwgTWF0aC5zcXJ0KDEtYSkpOyBcblx0ICB2YXIgZCA9IFIgKiBjO1xuXHQgIHJldHVybiBkO1xuXHR9O1xuXG5cdHN2Yy5tYXBSYW5nZSA9IGZ1bmN0aW9uICh2YWx1ZSwgbG93MSwgaGlnaDEsIGxvdzIsIGhpZ2gyKSB7XG5cdCAgICByZXR1cm4gbG93MiArIChoaWdoMiAtIGxvdzIpICogKHZhbHVlIC0gbG93MSkgLyAoaGlnaDEgLSBsb3cxKTtcblx0fTtcblxuXHRzdmMuZ2V0R3VpZCA9IGZ1bmN0aW9uICgpIHtcblx0XHRmdW5jdGlvbiBzNCgpIHtcblx0XHQgICAgcmV0dXJuIE1hdGguZmxvb3IoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApXG5cdFx0ICAgICAgLnRvU3RyaW5nKDE2KVxuXHRcdCAgICAgIC5zdWJzdHJpbmcoMSk7XG5cdFx0fVxuXHQgIFx0cmV0dXJuIHM0KCkgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArIHM0KCkgKyBzNCgpO1xuXHR9O1xufSk7XG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5ydW4oZnVuY3Rpb24oJHJvb3RTY29wZSwgJHRpbWVvdXQsIFNlc3Npb25TdmMpe1xuXG5cbn0pO1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uZGlyZWN0aXZlKCdhcHBNYXAnLCBmdW5jdGlvbihQb3N0c1N2YywgVXRpbFN2YywgQ29uZmlnU3ZjLCBTZXNzaW9uU3ZjLCAkY29tcGlsZSwgJHRpbWVvdXQpIHtcbiAgICAvLyBkaXJlY3RpdmUgbGluayBmdW5jdGlvblxuICAgIHZhciBsaW5rID0gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gR0xPQkFMIFZBUklBQkxFUyBJTiBMSU5LIEZVTkNUSU9OXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIHZhciBtYXA7IC8vIGV4cGFuZCBmcm9tIGdvb2dsZSBtYXAgZm9yIG1hbnVhbGx5IGNyZWF0ZWQgZXZlbnRzXG4gICAgICAgIHZhciBtYXBfb3JpZ2luOyAvLyBmb3Igb3JpZ2luYWwgZ29vZ2xlIG1hcCBldmVudCBmdW5jdGlvbiBsaW5rc1xuICAgICAgICB2YXIgY3VycmVudF9tYXBfbnc7XG4gICAgICAgIHZhciBjdXJyZW50X21hcF9zZTtcbiAgICAgICAgdmFyIG1hcE9wdGlvbnM7XG4gICAgICAgIHZhciBpbml0aWFsTWFwQ2VudGVyO1xuICAgICAgICB2YXIgQ0xPVURfTUFQX0lEID0gJ2N1c3RvbV9zdHlsZSc7IC8vIG1hcCBzdHlsZVxuICAgICAgICB2YXIgaGVscGVyTWFya2VycyA9IFtdO1xuICAgICAgICB2YXIgdXNlck1hcmtlcnMgPSBbXTtcbiAgICAgICAgdmFyIG1hcmtlcnNPbk1hcCA9IFtdO1xuXG4gICAgICAgIHZhciBwcmV2R3VpZHRndCA9ICcwJztcbiAgICAgICAgdmFyIGlzR3VpZHRndENoYW5nZWQ7XG5cbiAgICAgICAgdmFyIGltYWdlUG9zdCA9IHtcbiAgICAgICAgICAgIC8vdXJsOiAnaHR0cHM6Ly9jYXRjaG1lLmlmeW91Y2FuLmNvbS9pbWFnZXMvcGljdHVyZXMvSVlDX0ljb25zL0lZQ19Mb2NhdGlvbl9JY29uX1NtYWxsLnBuZycsXG4gICAgICAgICAgICB1cmw6ICdEZWZhdWx0X01hcmtlci5wbmcnLFxuICAgICAgICAgICAgc2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMTAwLCAxMDApLFxuICAgICAgICAgICAgb3JpZ2luOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMCwgMCksXG4gICAgICAgICAgICBhbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludCgxNywgMzQpLFxuICAgICAgICAgICAgc2NhbGVkU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMSwgMSlcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGltYWdlVGFyZ2V0ID0ge1xuICAgICAgICAgICAgLy91cmw6ICdodHRwOi8vd3d3LmNsa2VyLmNvbS9jbGlwYXJ0cy9VL1Avai9NL0kvaS94LW1hcmsteWVsbG93LW1kLnBuZycsXG4gICAgICAgICAgICB1cmw6ICdYX01hcmtlci5wbmcnLFxuICAgICAgICAgICAgc2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMTAwLCAxMDApLFxuICAgICAgICAgICAgb3JpZ2luOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMCwgMCksXG4gICAgICAgICAgICBhbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludCgxNywgMzQpLFxuICAgICAgICAgICAgc2NhbGVkU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMjUsIDI1KVxuICAgICAgICB9O1xuICAgICAgICB2YXIgaW1hZ2VVc2VyTG9naW4gPSB7XG4gICAgICAgICAgICAvL3VybDogJ2h0dHA6Ly93d3cuY2xrZXIuY29tL2NsaXBhcnRzL3Evby8yL0svZy9WL2xvY2F0aW9uLXN5bWJvbC1tYXAtbWQucG5nJyxcbiAgICAgICAgICAgIHVybDogJ0N1cnJlbnRfTG9jYXRpb25fTWFya2VyLnBuZycsXG4gICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICBvcmlnaW46IG5ldyBnb29nbGUubWFwcy5Qb2ludCgwLCAwKSxcbiAgICAgICAgICAgIGFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDE3LCAzNCksXG4gICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgyMCwgMzMpXG4gICAgICAgIH07XG4gICAgICAgICB2YXIgaW1hZ2VVc2VyTG9jYXRpb24gPSB7XG4gICAgICAgICAgICAgdXJsOiAnY3Vycl9tYXJrZXIucG5nJyxcbiAgICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICAgb3JpZ2luOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMCwgMCksXG4gICAgICAgICAgICAgYW5jaG9yOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMTcsIDM0KSxcbiAgICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgyMCwgMzMpXG4gICAgICAgICB9O1xuXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIEVWRU5UIEhBTkRMRVJTIC0gVVBEQVRFXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZURlZmF1bHRMb2NhdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUgPSBtYXAuZ2V0Q2VudGVyKCkubGF0KCk7XG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSA9IG1hcC5nZXRDZW50ZXIoKS5sbmcoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUJvdW5kcygpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBib3VuZHMgPSBtYXAuZ2V0Qm91bmRzKCk7XG4gICAgICAgICAgICB2YXIgbmUgPSBib3VuZHMuZ2V0Tm9ydGhFYXN0KCk7IC8vIExhdExuZyBvZiB0aGUgbm9ydGgtZWFzdCBjb3JuZXJcbiAgICAgICAgICAgIHZhciBzdyA9IGJvdW5kcy5nZXRTb3V0aFdlc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBzb3V0aC13ZXN0IGNvcmRlclxuICAgICAgICAgICAgLy9Zb3UgZ2V0IG5vcnRoLXdlc3QgYW5kIHNvdXRoLWVhc3QgY29ybmVycyBmcm9tIHRoZSB0d28gYWJvdmU6XG5cbiAgICAgICAgICAgIGN1cnJlbnRfbWFwX253ID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhuZS5sYXQoKSwgc3cubG5nKCkpO1xuICAgICAgICAgICAgY3VycmVudF9tYXBfc2UgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHN3LmxhdCgpLCBuZS5sbmcoKSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVXYXRjaExvY2F0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGJvdW5kcyA9IG1hcC5nZXRCb3VuZHMoKTtcbiAgICAgICAgICAgIHZhciBuZSA9IGJvdW5kcy5nZXROb3J0aEVhc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBub3J0aC1lYXN0IGNvcm5lclxuICAgICAgICAgICAgdmFyIHN3ID0gYm91bmRzLmdldFNvdXRoV2VzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIHNvdXRoLXdlc3QgY29yZGVyXG4gICAgICAgICAgICAvL1lvdSBnZXQgbm9ydGgtd2VzdCBhbmQgc291dGgtZWFzdCBjb3JuZXJzIGZyb20gdGhlIHR3byBhYm92ZTpcblxuICAgICAgICAgICAgY3VycmVudF9tYXBfbncgPSB7IFxuICAgICAgICAgICAgICAgIGxhdDogbmUubGF0KCksIFxuICAgICAgICAgICAgICAgIGxvbjogc3cubG5nKClcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjdXJyZW50X21hcF9zZSA9IHtcbiAgICAgICAgICAgICAgICBsYXQ6IHN3LmxhdCgpLCBcbiAgICAgICAgICAgICAgICBsb246IG5lLmxuZygpXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgY3VycmVudF9tYXBfY2VudGVyIDtcblxuICAgICAgICAgICAgY3VycmVudF9tYXBfY2VudGVyID0ge1xuICAgICAgICAgICAgICAgICAgICBsYXQ6IG1hcC5nZXRDZW50ZXIoKS5sYXQoKSxcbiAgICAgICAgICAgICAgICAgICAgbG9uOiBtYXAuZ2V0Q2VudGVyKCkubG5nKClcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgLy8gc2VlIGlmIHRoZSBsYXRlc3QgeCBtYXJrZXIgb3IgcG9zdCBsb2NhdGlvbiBpcyB3aXRoaW4gdXNlcidzIHZpZXdcbiAgICAgICAgICAgIGlmICghKHNjb3BlLnBvc3RMb2NhdGlvbi5sYXQgPCBjdXJyZW50X21hcF9udy5sYXQpIHx8XG4gICAgICAgICAgICAgICAgIShzY29wZS5wb3N0TG9jYXRpb24ubGF0ID4gY3VycmVudF9tYXBfc2UubGF0KSB8fFxuICAgICAgICAgICAgICAgICEoc2NvcGUucG9zdExvY2F0aW9uLmxvbiA8IGN1cnJlbnRfbWFwX3NlLmxvbikgfHxcbiAgICAgICAgICAgICAgICAhKHNjb3BlLnBvc3RMb2NhdGlvbi5sb24gPiBjdXJyZW50X21hcF9udy5sb24pIClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBpZiBpdCBpcyBub3Qgd2l0aGluIHVzZXIncyB2aWV3LCB0aGVuIGp1c3QgdXNlIG1hcCBjZW50ZXJcbiAgICAgICAgICAgICAgICBjdXJyZW50X21hcF9jZW50ZXIgPSB7XG4gICAgICAgICAgICAgICAgICAgIGxhdDogbWFwLmdldENlbnRlcigpLmxhdCgpLFxuICAgICAgICAgICAgICAgICAgICBsb246IG1hcC5nZXRDZW50ZXIoKS5sbmcoKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gaWYgaXQgaXMgd2l0aGluIHVzZXIncyB2aWV3LCB1c2UgeCBtYXJrZXIgbG9jYXRpb24gYS5rLmEgcG9zdCBsb2NhdGlvblxuICAgICAgICAgICAgICAgIGN1cnJlbnRfbWFwX2NlbnRlciA9IHtcbiAgICAgICAgICAgICAgICAgICAgbGF0OiBzY29wZS5wb3N0TG9jYXRpb24ubGF0LFxuICAgICAgICAgICAgICAgICAgICBsb246IHNjb3BlLnBvc3RMb2NhdGlvbi5sb25cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgU2Vzc2lvblN2Yy51cGRhdGVXYXRjaExvY2F0aW9uKGN1cnJlbnRfbWFwX253LCBjdXJyZW50X21hcF9zZSwgY3VycmVudF9tYXBfY2VudGVyLCBzY29wZS5ndWlkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGRyYXcgbWFwIHdpdGggaGVscGVyIG1hcmtlcnNcbiAgICAgICAgZnVuY3Rpb24gZHJhd1VzZXJNYXJrZXIobG9jYXRpb24pe1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG1hcmtlcjsgbWFya2VyID0gdXNlck1hcmtlcnNbaV07IGkrKykge1xuICAgICAgICAgICAgICAgIG1hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB1c2VyTWFya2VycyA9IFtdO1xuICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBsb2NhdGlvbiwgXG4gICAgICAgICAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VVc2VyTG9jYXRpb25cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdXNlck1hcmtlcnMucHVzaChtYXJrZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gRVZFTlQgSEFORExFUlMgLSBEUkFXXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgICAgICAvLyB1cGRhdGUgcmVzcG9uc2VzIHN1Y2ggYXMgdmlzdWFsaXphdGlvbiBvZiBsaXN0ZW5lcnNcbiAgICAgICAgZnVuY3Rpb24gZHJhd1Jlc3BvbnNlcyhwb3N0KXtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ3JlZmVyZW5jZSBwb3N0OicsIHBvc3QpO1xuXG4gICAgICAgICAgICB1cGRhdGVCb3VuZHMoKTtcbiAgICAgICAgICAgIGZ1bmN0aW9uIGRyYXdCbGlua3Moc2Vzc2lvbnMpe1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZXNzaW9ucy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZXNzaW9uID0gc2Vzc2lvbnNbaV07XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gc2tpcCBteSBzZXNzaW9uIC0gbm8gbmVlZCB0byBkcmF3IOuCtCDsnpDsi6DsnZgg7IS47IWY7J2AIOq3uOumtO2VhOyalOqwgCDsl4bri6QuXG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXNzaW9uLmd1aWQgPT0gc2NvcGUuZ3VpZClcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAvLyBzZXNzaW9uJ3Mgd2F0Y2ggbG9jYXRpb24gd2lsbCBiZSBib3VuY2VkIVxuICAgICAgICAgICAgICAgICAgICB2YXIgd2F0Y2hfbG9jYXRpb24gPSBhbmd1bGFyLmZyb21Kc29uKHNlc3Npb24ud2F0Y2hsb2MpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcG9zdF9sb2NhdGlvbiAgPSBhbmd1bGFyLmZyb21Kc29uKHBvc3QubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8g7Jyg7KCA6rCAIOuztOqzoCDsnojripQg67CU7Jq0642U66asIOyViOyXkCDqt7ggc2Vzc2lvbijri6TrpbjsnKDsoIApIOyytO2CgVxuXG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coY3VycmVudF9tYXBfc2UsIGN1cnJlbnRfbWFwX253KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEod2F0Y2hfbG9jYXRpb24uY2VudGVyX2xhdCA8IGN1cnJlbnRfbWFwX253LmxhdCgpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgISh3YXRjaF9sb2NhdGlvbi5jZW50ZXJfbGF0ID4gY3VycmVudF9tYXBfc2UubGF0KCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKHdhdGNoX2xvY2F0aW9uLmNlbnRlcl9sb24gPCBjdXJyZW50X21hcF9zZS5sbmcoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEod2F0Y2hfbG9jYXRpb24uY2VudGVyX2xvbiA+IGN1cnJlbnRfbWFwX253LmxuZygpKSApXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gc2Vzc2lvbijri6TrpbjsnKDsoIAp65Ok7J20IOq3uCDtj6zsiqTtirjrpbwg67O06rOgIOyeiOyngCDslYrsnLzrqbQg7Iqk7YK1LlxuICAgICAgICAgICAgICAgICAgICBpZiAoIShwb3N0X2xvY2F0aW9uLmxhdCA8IHdhdGNoX2xvY2F0aW9uLm53X2xhdCkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEocG9zdF9sb2NhdGlvbi5sYXQgPiB3YXRjaF9sb2NhdGlvbi5zZV9sYXQpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKHBvc3RfbG9jYXRpb24ubG9uIDwgd2F0Y2hfbG9jYXRpb24uc2VfbG9uKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIShwb3N0X2xvY2F0aW9uLmxvbiA+IHdhdGNoX2xvY2F0aW9uLm53X2xvbikgKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyh3YXRjaF9sb2NhdGlvbi5jZW50ZXJfbGF0LCB3YXRjaF9sb2NhdGlvbi5jZW50ZXJfbG9uKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciByYW5kb21TaXplID0gTWF0aC5yYW5kb20oKSAqIDQwICsgNDA7IFxuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsTmFtZSAgICA9ICdCbGluay5naWYnO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbWFnZUxpc3RlbmVyID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMTAwLCAxMDApLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMCwgMCksXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludChyYW5kb21TaXplICogMC41ICsgNSwgcmFuZG9tU2l6ZSAqIDAuNSArIDE0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlZFNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKHJhbmRvbVNpemUsIHJhbmRvbVNpemUpXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uKGltYWdlTGlzdGVuZXIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlck9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGdvb2dsZUxvYyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXA6IG1hcCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJSZWNlaXZlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb246IGltYWdlTGlzdGVuZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW1pemVkOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIobWFya2VyT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVjZWl2ZXJfbWFya2VyX2xpZmVzcGFuID0gMTIwMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uKG9sZF9tYXJrZXIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZF9tYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xkX21hcmtlciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfShtYXJrZXIpKSwgXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXZlcl9tYXJrZXJfbGlmZXNwYW4pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0oaW1hZ2VMaXN0ZW5lcikpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFNlc3Npb25TdmMuZmV0Y2goKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZHJhd0JsaW5rcylcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgICAgIC8vaGFuZGxlIGVycm9yc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjaGVjayBpZiB0aGUgcG9zdCBpcyBjb21wbGV0bHkgZGVhZCBhbmQgcmVtb3ZlIHRoYXQgcG9zdFxuICAgICAgICBmdW5jdGlvbiBjbGVhbnVwKCkge1xuICAgICAgICAgICAgIGZvciAodmFyIGogPSAwLCBtYXJrZXI7IG1hcmtlciA9IG1hcmtlcnNPbk1hcFtqXTsgaisrKXtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudERhdGUgICAgICA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lTWlsbGkgPSBjdXJyZW50RGF0ZS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgdmFyIGxpZmUgPSBtYXJrZXIucG9zdC5saWZlZW5kIC0gY3VycmVudFRpbWVNaWxsaTtcblxuICAgICAgICAgICAgICAgIGlmIChsaWZlIDw9IDApe1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdjbGVhbmluZyB1cC4uJywgbWFya2VyLnBvc3QuX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgdW5EcmF3UG9zdChtYXJrZXIucG9zdC5faWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUFuZERyYXdQb3N0cygpe1xuICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBmb3IgY2hlY2tpbmcgbG9jYWwgcG9zdHMgLSBpc1BvaW50aW5nWW91XG4gICAgICAgICAgICBpc0d1aWR0Z3RDaGFuZ2VkID0gcHJldkd1aWR0Z3QgIT0gc2NvcGUuZ3VpZHRndDsgLy8gc2VlIGlmIG15IGd1aWR0Z3QgaGFzIGNoYW5nZWQ7XG4gICAgICAgICAgICBwcmV2R3VpZHRndCA9IHNjb3BlLmd1aWR0Z3Q7IC8vIHVwZGF0ZSBwcmV2aW91cyBndWlkdGd0XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGRyYXdQb3N0cyhwb3N0cyl7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBvc3RzLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvc3QgPSBwb3N0c1tpXTtcblxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNUQVJUIC0gQ0hFQ0sgSUYgSVRTIFdJVEhJTiBWSUVXIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2F0aW9uID0gYW5ndWxhci5mcm9tSnNvbihwb3N0LmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobG9jYXRpb24ubGF0LCBsb2NhdGlvbi5sb24pO1xuXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUJvdW5kcygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIShnb29nbGVMb2MubGF0KCkgPCBjdXJyZW50X21hcF9udy5sYXQoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEoZ29vZ2xlTG9jLmxhdCgpID4gY3VycmVudF9tYXBfc2UubGF0KCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKGdvb2dsZUxvYy5sbmcoKSA8IGN1cnJlbnRfbWFwX3NlLmxuZygpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIShnb29nbGVMb2MubG5nKCkgPiBjdXJyZW50X21hcF9udy5sbmcoKSkgKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsgLy8gc2tpcCB0aGlzIHBvc3QgLSBubyBuZWVkIHRvIGRyYXdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEVORCAtIENIRUNLIElGIElUUyBXSVRISU4gVklFVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNUQVJUIC0gQ0hFQ0sgV0UgSEFWRSBUTyBSRURSQVcgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgbWFya2VycyBwb3N0IGlzIGV4aXNpdGluZyBvbmUsIHdlIGRvbid0IHdhbnQgdG8gZHJhdyBpdCBhZ2Fpbi5cbiAgICAgICAgICAgICAgICAgICAgLy8gb25seSBkcmF3IG5ldyBvbmVzIVxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgbWFya2VyOyBtYXJrZXIgPSBtYXJrZXJzT25NYXBbal07IGorKyl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8v7J2067aA67aEIOuhnOyngeydhCDri6Tsi5wg7Kec7JW87ZWoXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNBbHJlYWR5RHJhd24gPSBwb3N0Ll9pZCA9PSBtYXJrZXIucG9zdC5faWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBbHJlYWR5RHJhd24pIC8vIOydtOuvuCDqt7jroKTsoYzripTsp4Ag7YWM7Iqk7Yq4XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzR3VpZHRndENoYW5nZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bkRyYXdQb3N0KHBvc3QuX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtYXJrZXIucG9zdC5ndWlkdGd0ID09IHBvc3QuZ3VpZHRndCl7ICAvLyDsnbTrr7gg6re466Ck7KeE6rKD7KSRLCBndWlkdGd07J20IOuwlOuAjOyXiOuKlOqwgFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0ID0gbnVsbDsgLy8g7J2066+4IOq3uOugpOynhCDtj6zsiqTtirjrnbzrqbQsIG51bGzroZwuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOyAvLyDsnbQgbG9vcOydgCBwb3N0Ll9pZOunjCDqsoDsgqzsmqnsnoTsnLzroZwsIOunjOyVvSDqsrnsuZjrqbQg67CU66GcIGxvb3DsnYQg66mI7Law64+EIOq0nOywruuLpC59XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5EcmF3UG9zdChwb3N0Ll9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChwb3N0ID09IG51bGwpe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7IC8vIHNraXAgdGhpcyBwb3N0IC0gbm8gbmVlZCB0byBkcmF3XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBFTkQgLSBDSEVDSyBXRSBIQVZFIFRPIFJFRFJBVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNUQVJUIC0gRFJBV0lORyBQT1NUIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgICAgICAgICAgICAgLy8gbWFya2VyIG9wdGlvbiBzZXR0aW5nXG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXJrZXJPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGdvb2dsZUxvYyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcDogbWFwLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwiQnViYmxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uOiBpbWFnZVBvc3RcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIobWFya2VyT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFkZCBtYXJrZXIgdG8gYXJyYXksIHRoaXMgbWVhbnMgdGhhdCBpdCBoYXMgYmVlbiBkcmF3biB0byBtYXBcbiAgICAgICAgICAgICAgICAgICAgbWFya2Vyc09uTWFwLnB1c2goXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyOiBtYXJrZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdCAgOiBwb3N0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNUQVJUIC0gRFJBV0lORyBNRVNTQUdFIFdJTkRPVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb3VwbGluZ19zdGF0dXMgPSBjYWxjdWxhdGVDb3VwbGluZyhwb3N0Lmd1aWQsIHBvc3QuZ3VpZHRndCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcInBvc3QuaXNMb2NhbFwiLCBwb3N0LmlzbG9jYWwpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYWxfc3RhdHVzID0gcG9zdC5pc2xvY2FsO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIOyKpOy9lO2UhOyXkOyEnOu2gO2EsCDsg4jroZzsmrQg7LCo7J2865OcIOyKpOy9lO2UhOulvCDrp4zrk6TslrQgZWFjaCBmb3IgbG9vcOyXkOyEnCDsgqzsmqntlZzri6QuXG4gICAgICAgICAgICAgICAgICAgIC8vIC0tPiDtlbTslbwsIOqwgSBET03snbQg6rCB6rCB7J2YIHNjb3Bl66W8IOqwgOyguOyEnCBwb3N0IG1zZ+qwgCDslYgg6rK57Lmc64ukLlxuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gc2NvcGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9IHBhcmVudC4kbmV3KHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBvcGVuSW5mb1dpbmRvdyA9IChmdW5jdGlvbihtYXJrZXIsIGNoaWxkX3Njb3BlLCBwb3N0LCBjb3VwbGluZ19zdGF0dXMsIGxvY2FsX3N0YXR1cyl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBuZXcgd2luZG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZm9XaW5kb3dPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaXhlbE9mZnNldDogbmV3IGdvb2dsZS5tYXBzLlNpemUoLTM5LjUsIDE2LjApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlQXV0b1BhbjogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZm9XaW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyhpbmZvV2luZG93T3B0aW9ucyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgY3VycmVudCB0aW1lIGFuZCBzdWJ0cmFjdCBpdCBmcm9tIHBvc3QncyBlbmQgdGltZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGF0IHdpbGwgYmUgYWNjdXJhdGUgcG9zdCB0aW1lIGZvciBpbnN0YW50IHBvc3RzIGFuZCBsb25nIHBvc3RzLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50RGF0ZSAgICAgID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudFRpbWVNaWxsaSA9IGN1cnJlbnREYXRlLmdldFRpbWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zdGxpZmUgICAgICAgICA9ICgocG9zdC5saWZlZW5kIC0gY3VycmVudFRpbWVNaWxsaSkgPj0gMCkgPyAocG9zdC5saWZlZW5kIC0gY3VycmVudFRpbWVNaWxsaSkgOiAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxpZmVwZXJjZW50YWdlID0gKHBvc3RsaWZlIC8gcG9zdC5saWZlc3BhbikudG9GaXhlZCgyKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy90byBtYWtlIGRhdGEgYXZhaWxhYmxlIHRvIHRlbXBsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUubXNnICAgICAgICAgICAgICAgID0gcG9zdC5ib2R5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3RsaWZlICAgICAgICAgICA9IHBvc3RsaWZlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3RndWlkICAgICAgICAgICA9IHBvc3QuZ3VpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Z3VpZHRndCAgICAgICAgPSBwb3N0Lmd1aWR0Z3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUucG9zdGNvdXBsZXN0YXR1cyAgID0gY291cGxpbmdfc3RhdHVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA9IGxpZmVwZXJjZW50YWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3Rsb2NhbHN0YXR1cyAgICA9IGxvY2FsX3N0YXR1cztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBlbmFibGVzIGNoYW5naW5nIGNvdXBsaW5nIHZhbHVlIGluc3RhbnRseS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS4kb24oJ3NldDpjb3VwbGluZycsIGZ1bmN0aW9uKF8sIGNvdXBsaW5nX3VwZGF0ZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3Rjb3VwbGVzdGF0dXMgPSBjb3VwbGluZ191cGRhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbXBpbGUgaXQgYmVmb3JlIGxvYWRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50ICA9ICc8ZGl2IG1hcC1tc2c+PC9kaXY+JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29tcGlsZWQgPSAkY29tcGlsZShjb250ZW50KShjaGlsZF9zY29wZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93LnNldENvbnRlbnQoIGNvbXBpbGVkWzBdICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihpbmZvV2luZG93LCdjbG9zZWNsaWNrJyxmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9zdC5ndWlkID09IHNjb3BlLmd1aWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2FsKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIkFyZSB5b3Ugc3VyZT9cIiwgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIllvdSB3aWxsIG5vdCBiZSBhYmxlIHRvIHJlY292ZXIgdGhpcyBpbWFnaW5hcnkgZmlsZSFcIiwgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIndhcm5pbmdcIiwgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLCAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogXCIjREQ2QjU1XCIsICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6IFwiWWVzLCBkZWxldGUgaXQhXCIsICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VPbkNvbmZpcm06IGZhbHNlIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihpc0NvbmZpcm0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NvbmZpcm0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQb3N0c1N2Yy5yZW1vdmUocG9zdClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBzdWNjZXNzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaGFuZGxlIGVycm9yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3YWwoXCJEZWxldGVkIVwiLCBcIllvdXIgaW1hZ2luYXJ5IGZpbGUgaGFzIGJlZW4gZGVsZXRlZC5cIiwgXCJzdWNjZXNzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50RGF0ZSAgICAgID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lTWlsbGkgPSBjdXJyZW50RGF0ZS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3N0bGlmZSAgICAgICAgID0gKChwb3N0LmxpZmVlbmQgLSBjdXJyZW50VGltZU1pbGxpKSA+PSAwKSA/IChwb3N0LmxpZmVlbmQgLSBjdXJyZW50VGltZU1pbGxpKSA6IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsaWZlcGVyY2VudGFnZSA9IChwb3N0bGlmZSAvIHBvc3QubGlmZXNwYW4pLnRvRml4ZWQoMilcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGlmZXBlcmNlbnRhZ2UgPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA9IGxpZmVwZXJjZW50YWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5vcGVuKG1hcCAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93Lm9wZW4obWFwICwgbWFya2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0pKG1hcmtlciwgY2hpbGQsIHBvc3QsIGNvdXBsaW5nX3N0YXR1cywgbG9jYWxfc3RhdHVzKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIG9wZW5JbmZvV2luZG93KCk7XG4gICAgICAgICAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRU5EIC0gRFJBV0lORyBNRVNTQUdFIFdJTkRPVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBFTkQgLSBEUkFXSU5HIFBPU1QgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgICAgICAgICAgfSAvLyBlbmQgb2YgZm9yLWxvb3BcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgUG9zdHNTdmMuZmV0Y2goKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZHJhd1Bvc3RzKSBcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBlcnJvclxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIGVuZCBvZiBwb3N0IGZldGNoIHN1Y2Nlc3NcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGRyYXdEcm9wRG93bihsb2NhdGlvbilcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobG9jYXRpb24ubGF0LCBsb2NhdGlvbi5sb24pO1xuXG4gICAgICAgICAgICB1cGRhdGVCb3VuZHMoKTtcbiAgICAgICAgICAgIC8vIOuwlOyatOuNlOumrCDslYjsl5Ag7J6I64qU7KeA67aA7YSwIOyytO2BrOulvCDtlZjsnqVcbiAgICAgICAgICAgIGlmICghKGdvb2dsZUxvYy5sYXQoKSA8IGN1cnJlbnRfbWFwX253LmxhdCgpKSB8fFxuICAgICAgICAgICAgICAgICEoZ29vZ2xlTG9jLmxhdCgpID4gY3VycmVudF9tYXBfc2UubGF0KCkpIHx8XG4gICAgICAgICAgICAgICAgIShnb29nbGVMb2MubG5nKCkgPCBjdXJyZW50X21hcF9zZS5sbmcoKSkgfHxcbiAgICAgICAgICAgICAgICAhKGdvb2dsZUxvYy5sbmcoKSA+IGN1cnJlbnRfbWFwX253LmxuZygpKSApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBza2lwIHRoaXMgcG9zdCAtIG5vIG5lZWQgdG8gZHJhd1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBtYXJrZXIgb3B0aW9uIHNldHRpbmdcbiAgICAgICAgICAgIHZhciBtYXJrZXJPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBnb29nbGVMb2MsXG4gICAgICAgICAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUCxcbiAgICAgICAgICAgICAgICB0aXRsZTogXCJVc2VyUGluXCIsXG4gICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VVc2VyTG9naW5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKG1hcmtlck9wdGlvbnMpO1xuXG4gICAgICAgICAgICAkdGltZW91dChcbiAgICAgICAgICAgICAgICAoZnVuY3Rpb24ob2xkX21hcmtlcil7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgb2xkX21hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfShtYXJrZXIpKSwgXG4gICAgICAgICAgICAyMDAwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVuRHJhd1Bvc3QocG9zdGlkKVxuICAgICAgICB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwic3RhcnRpbmcgcmVtb3ZlIHBvc3RcIik7XG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMCwgbWFya2VyOyBtYXJrZXIgPSBtYXJrZXJzT25NYXBba107IGsrKykge1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocG9zdGlkKTtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKG1hcmtlci5wb3N0Ll9pZCk7XG4gICAgICAgICAgICAgICAgaWYgKHBvc3RpZCA9PSBtYXJrZXIucG9zdC5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyLm1hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlcnNPbk1hcC5zcGxpY2UoaywgMSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGRyYXdBbmRTZXRQbGFjZShsb2NhdGlvbilcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobG9jYXRpb24ubGF0LCBsb2NhdGlvbi5sb24pO1xuICAgICAgICAgICAgZHJhd0hlbHBlck1hcmtlcihnb29nbGVMb2MpO1xuICAgICAgICAgICAgc2V0UGxhY2UoZ29vZ2xlTG9jKTtcblxuICAgICAgICAgICAgLy8gbWFrZSBzdXJlIHNlcnZlciBnZXRzIHVwZGF0ZWQgd2hlbmV2ZXIgc2V0dGluZyBuZXcgcGxhY2Ugd2l0aCBtYXJrZXJcbiAgICAgICAgICAgIHVwZGF0ZVdhdGNoTG9jYXRpb24oKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGRyYXcgbWFwIHdpdGggaGVscGVyIG1hcmtlcnNcbiAgICAgICAgZnVuY3Rpb24gZHJhd0hlbHBlck1hcmtlcihsb2NhdGlvbil7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbWFya2VyOyBtYXJrZXIgPSBoZWxwZXJNYXJrZXJzW2ldOyBpKyspIHtcbiAgICAgICAgICAgICAgICBtYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGVscGVyTWFya2VycyA9IFtdO1xuICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBsb2NhdGlvbiwgXG4gICAgICAgICAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VUYXJnZXRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaGVscGVyTWFya2Vycy5wdXNoKG1hcmtlcik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1bkRyYXdIZWxwZXJNYXJrZXIoKXtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBtYXJrZXI7IG1hcmtlciA9IGhlbHBlck1hcmtlcnNbaV07IGkrKykge1xuICAgICAgICAgICAgICAgIG1hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBoZWxwZXJNYXJrZXJzID0gW107XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIFVUSUxcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgZnVuY3Rpb24gc2V0UGxhY2UobG9jYXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGJyb2FkY2FzdCBsb2NhdGlvbiBpbmZvcihsb24sbGF0KVxuICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldDpsb2MnLCBsb2NhdGlvbik7XG5cbiAgICAgICAgICAgIHZhciBnZW9jb2RlciA9IG5ldyBnb29nbGUubWFwcy5HZW9jb2RlcigpO1xuXG4gICAgICAgICAgICAvLyBicm9hZGNhc3QgcGxhY2UgZm9ybWF0dGVkX2FkZHJlc3MgYW5kIGRyYXcgaWNvblxuICAgICAgICAgICAgZ2VvY29kZXIuZ2VvY29kZSggeyAnbGF0TG5nJzogbG9jYXRpb24gfSwgZnVuY3Rpb24ocmVzdWx0cywgc3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgLy8gYXMgdXNlciBjbGlja3Mgb24gdGhlIG1hcCxcbiAgICAgICAgICAgICAgICAvLyB3ZSBoYXZlIHRvIHNhdmUgdGhlIGZvcm1hdHRlZCBhZGRyZXNzIGluICRzY29wZSBhbmRcbiAgICAgICAgICAgICAgICAvLyBpdCB3aWxsIGJlIHVzZWQgdGhyb3VnaCBwb3N0cy5jdHJsXG4gICAgICAgICAgICAgICAgLy8gZW1pdCBicm9hZGNhc2UgJ3BsYWNlJyBhbmQgc2VuZCB0aGlzIHRvIGFwcGxpY2F0aW9uLmN0cmxcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyBicm9hZGNhc3QgZm9ybWF0dGVkX2FkZHJlc3NcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldDpwbGFjZScsIHJlc3VsdHNbMV0uZm9ybWF0dGVkX2FkZHJlc3MpOyBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2goZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgc3dhbChcIlwiLFwiTG9jYXRpb24gZG9lcyBub3QgZXhpc3RzXCIpO1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0OnBsYWNlJywgXCJMb2NhdGlvbiBkb2VzIG5vdCBleGlzdHNcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjYWxjdWxhdGVDb3VwbGluZyhwb3N0X2d1aWQsIHBvc3RfZ3VpZHRndClcbiAgICAgICAge1xuICAgICAgICAgICAgLyogY291cGxpbmcgc3RhdHVzXG4gICAgICAgICAgICAgICAgMCAtIG5vIHN0YXR1c1xuICAgICAgICAgICAgICAgIDEgLSBpIGxpa2UgeW91XG4gICAgICAgICAgICAgICAgMiAtIHlvdSBsaWtlIGlcbiAgICAgICAgICAgICAgICA0IC0gd2UgbGlrZSBlYWNoIG90aGVyIC8vIGRpc2FibGVkLlxuICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgdmFyIGlzUG9pbnRpbmdZb3UgICAgID0gc2NvcGUuZ3VpZHRndCA9PSBwb3N0X2d1aWQ7XG4gICAgICAgICAgICB2YXIgaXNQb2ludGluZ01lICAgICAgPSBzY29wZS5ndWlkICAgID09IHBvc3RfZ3VpZHRndDtcbiAgICAgICAgICAgIHZhciBpc015UG9zdCAgICAgICAgICA9IHNjb3BlLmd1aWQgICAgPT0gcG9zdF9ndWlkO1xuICAgICAgICAgICAgdmFyIGlzUG9pbnRpbmdTb21lb25lID0gc2NvcGUuZ3VpZHRndCAhPSAnMCc7XG5cbiAgICAgICAgICAgIGlmIChpc015UG9zdCAmJiBpc1BvaW50aW5nU29tZW9uZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMjsgLy8gZm9yIG15IHZpZXcncyBteSBwb3N0IHRvIGJlIFwiSSBsaWtlIHNvbWVvbmVcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaXNQb2ludGluZ1lvdSAmJiBpc1BvaW50aW5nTWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpc1BvaW50aW5nWW91ICYmICFpc1BvaW50aW5nTWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICghaXNQb2ludGluZ1lvdSAmJiBpc1BvaW50aW5nTWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBVSVxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICBmdW5jdGlvbiBzZXRVSVNlYXJjaExvY2F0aW9uVG9nZ2xlKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIG1hcFNlYXJjaFRvZ2dsZSA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLXNlYXJjaC10b2dnbGUnKSk7XG4gICAgICAgICAgICBtYXAuY29udHJvbHNbZ29vZ2xlLm1hcHMuQ29udHJvbFBvc2l0aW9uLlRPUF9MRUZUXS5wdXNoKG1hcFNlYXJjaFRvZ2dsZSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRVSU1vdmVUb0N1cnJMb2NCdG4oKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgY3VyckxvY0J0biA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLWJ0bi1jdXJyJykpOyBcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uVE9QX1JJR0hUXS5wdXNoKGN1cnJMb2NCdG4pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0VUlQb3N0Rm9ybSgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBwb3N0Rm9ybSA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLXBvc3RpbmcnKSk7IFxuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5CT1RUT01fQ0VOVEVSXS5wdXNoKHBvc3RGb3JtKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldFVJUG9zdE9uTWFwKClcbiAgICAgICAge1xuICAgICAgICAgICAgLy92YXIgcG9zdE9uTWFwID0gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtcG9zdC1jZW50ZXInKSk7XG4gICAgICAgICAgICAvL21hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uVE9QX0NFTlRFUl0ucHVzaChwb3N0T25NYXApO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0VUlQb3N0QnRuKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIHBvc3RCdG4gPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1idG4tc3VibWl0JykpO1xuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5CT1RUT01fQ0VOVEVSXS5wdXNoKHBvc3RCdG4pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0VUlUaW1lU2xpZGVyKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIHRpbWVTbGlkZXIgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC10aW1lLXNsaWRlcicpKTtcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uQk9UVE9NX0NFTlRFUl0ucHVzaCh0aW1lU2xpZGVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldFVJU2VhcmNoQm94KClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSBzZWFyY2ggYm94IGFuZCBsaW5rIGl0IHRvIHRoZSBVSSBlbGVtZW50LlxuICAgICAgICAgICAgdmFyIGlucHV0ID0gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYWMtaW5wdXQnKSk7IC8vIEB0eXBlIHtIVE1MSW5wdXRFbGVtZW50fSAgXG4gICAgICAgICAgICBtYXAuY29udHJvbHNbZ29vZ2xlLm1hcHMuQ29udHJvbFBvc2l0aW9uLlRPUF9MRUZUXS5wdXNoKGlucHV0KTtcblxuICAgICAgICAgICAgdmFyIHNlYXJjaEJveCA9IG5ldyBnb29nbGUubWFwcy5wbGFjZXMuU2VhcmNoQm94KChpbnB1dCkpOyAvLyBAdHlwZSB7SFRNTElucHV0RWxlbWVudH0gXG5cbiAgICAgICAgICAgIC8vIExpc3RlbiBmb3IgdGhlIGV2ZW50IGZpcmVkIHdoZW4gdGhlIHVzZXIgc2VsZWN0cyBhbiBpdGVtIGZyb20gdGhlXG4gICAgICAgICAgICAvLyBwaWNrIGxpc3QuIFJldHJpZXZlIHRoZSBtYXRjaGluZyBwbGFjZXMgZm9yIHRoYXQgaXRlbS5cbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKHNlYXJjaEJveCwgJ3BsYWNlc19jaGFuZ2VkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBsYWNlcyA9IHNlYXJjaEJveC5nZXRQbGFjZXMoKTtcblxuICAgICAgICAgICAgICAgIGlmIChwbGFjZXMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyB0YWtlIG9ubHkgMSBzcG90XG4gICAgICAgICAgICAgICAgdmFyIHBsYWNlID0gcGxhY2VzWzBdO1xuXG4gICAgICAgICAgICAgICAgLy8gd2hlbiBzZWFyY2ggaGFwcGVucywgbG9jYXRpb24gd2lsbCBiZSB1cGRhdGVkIGFzIHdlbGwgZm9yIHBvc3RcbiAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIGxhdDogcGxhY2UuZ2VvbWV0cnkubG9jYXRpb24ubGF0KCksXG4gICAgICAgICAgICAgICAgICAgIGxvbjogcGxhY2UuZ2VvbWV0cnkubG9jYXRpb24ubG5nKClcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShsb2NhdGlvbik7XG5cbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gcGxhY2UuZ2VvbWV0cnkubG9jYXRpb24ubGF0aXR1ZGU7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUgPSBwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sb25naXR1ZGU7XG5cbiAgICAgICAgICAgICAgICBtYXAucGFuVG8ocGxhY2UuZ2VvbWV0cnkubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgIG1hcC5zZXRab29tKDE2KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gRVZFTlRcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgZnVuY3Rpb24gc2V0RXZlbnRDbGljaygpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGNsaWNrIGV2ZW50IG9uIG1hcCB0byBkcmF3IFggbWFya2VyIGFuZCBzZXQgUG9zdCBsb2NhdGlvblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwX29yaWdpbiwgJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIGxhdDogZXZlbnQubGF0TG5nLmxhdCgpLFxuICAgICAgICAgICAgICAgICAgICBsb246IGV2ZW50LmxhdExuZy5sbmcoKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZHJhd0FuZFNldFBsYWNlKGxvY2F0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0RXZlbnRDZW50ZXJDaGFuZ2VkKClcbiAgICAgICAge1xuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwX29yaWdpbiwgJ2NlbnRlcl9jaGFuZ2VkJywgZnVuY3Rpb24oKXsgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gd2hlbiBtYXAgY2VudGVyIGNoYW5nZSwgdXBkYXRlIGxhc3QgbG9jYXRpb24gaW4gbWVtb3J5LFxuICAgICAgICAgICAgICAgIC8vIHNvIGJyb3dzZXIgd2lsbCByZW1lbWJlciBpdCBuZXh0IHRpbWUgeW91IGNvbWUhXG4gICAgICAgICAgICAgICAgdXBkYXRlRGVmYXVsdExvY2F0aW9uKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldEV2ZW50Qm91bmRzQ2hhbmdlZCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcF9vcmlnaW4sICdib3VuZHNfY2hhbmdlZCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgLy8gd2hlbiBtYXAgY2VudGVyIGNoYW5nZSwgdXBkYXRlIGJvdW5kcyBpbmZvIGZvciBtYXBcbiAgICAgICAgICAgICAgICB1cGRhdGVCb3VuZHMoKTsgIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRFdmVudERyYWdFbmQoKVxuICAgICAgICB7XG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXBfb3JpZ2luLCAnZHJhZ2VuZCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIG1hcCBhcyBkcmFnIGVuZFxuICAgICAgICAgICAgICAgIHVwZGF0ZUFuZERyYXdQb3N0cygpO1xuXG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIHdhdGNobG9jIHdoZW4gY2VudGVyIGNoYW5nZWQuXG4gICAgICAgICAgICAgICAgdXBkYXRlV2F0Y2hMb2NhdGlvbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRFdmVudFJlc2l6ZSgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcF9vcmlnaW4sICdyZXNpemUnLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBtYXAgYXMgZHJhZyBlbmRcbiAgICAgICAgICAgICAgICB1cGRhdGVBbmREcmF3UG9zdHMoKTtcblxuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSB3YXRjaGxvYyB3aGVuIGNlbnRlciBjaGFuZ2VkLlxuICAgICAgICAgICAgICAgIHVwZGF0ZVdhdGNoTG9jYXRpb24oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0RXZlbnRab29tQ2hhbmdlZCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcF9vcmlnaW4sICd6b29tX2NoYW5nZWQnLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBtYXAgYXMgZHJhZyBlbmRcbiAgICAgICAgICAgICAgICB1cGRhdGVBbmREcmF3UG9zdHMoKTtcblxuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSB3YXRjaGxvYyB3aGVuIGNlbnRlciBjaGFuZ2VkLlxuICAgICAgICAgICAgICAgIHVwZGF0ZVdhdGNoTG9jYXRpb24oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gU0VUVVAgRk9SIE1BUFxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBtYXAgaW5pdGlhbCBjb25maWdzXG4gICAgICAgIGZ1bmN0aW9uIGluaXRpYWxNYXBEYXRhKCl7XG4gICAgICAgICAgICAvLyBpZiBsb2NhbFN0b3JhZ2UgcmVtZW1iZXJzIGxhdGVzdCBtYXAgbG9jYXRpb24sIHVzZSBpdCxcbiAgICAgICAgICAgIGlmICghaXNOYU4od2luZG93LmxvY2FsU3RvcmFnZS5sYXRpdHVkZSkgJiYgIWlzTmFOKHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlKSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpbml0aWFsTWFwQ2VudGVyID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyh3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlLCB3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBpZiB0aGVyZSBpcyBubyBsYXRlc3QgbWFwIGxvY2F0aW9uLCBnZXQgY3VycmVudCBsb2NhdGlvblxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUudXNlckxvY2F0aW9uLmxhdCAhPSAwLjAgJiYgc2NvcGUudXNlckxvY2F0aW9uLmxvbiAhPSAwLjApIFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vIHRoaXMgbWF5IG5vdCB3b3JrIGZvciBub3cgc2luY2UgbG9jYXRpb24gZ2V0cyBzZXQgYWZ0ZXIgbWFwIGlzIGRlZmluZWQuLiAoVE9ETzogcmVmYWN0b3IgdGhlIG9yZGVyKVxuICAgICAgICAgICAgICAgIGluaXRpYWxNYXBDZW50ZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHNjb3BlLnVzZXJMb2NhdGlvbi5sYXQsIHNjb3BlLnVzZXJMb2NhdGlvbi5sb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gaWYgbm9uZSBvZiBhYm92ZSB3b3JrcywgdHJ5IHRvIHNldCBpdCB0byBMQSAoPyEpXG4gICAgICAgICAgICBlbHNlIFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGluaXRpYWxNYXBDZW50ZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKDM0LjA1LCAtMTE4LjI0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbWFwT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY2VudGVyICAgICAgOiBpbml0aWFsTWFwQ2VudGVyLFxuICAgICAgICAgICAgICAgICAgICB6b29tICAgICAgICA6IDE1LFxuICAgICAgICAgICAgICAgICAgICBzY3JvbGx3aGVlbCA6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHN0cmVldFZpZXdDb250cm9sOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgbWFwVHlwZUNvbnRyb2w6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBwYW5Db250cm9sOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgem9vbUNvbnRyb2w6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBtYXBUeXBlQ29udHJvbE9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICBtYXBUeXBlSWRzOiBbZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlJPQURNQVAsIENMT1VEX01BUF9JRF1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbWFwVHlwZUlkOiBDTE9VRF9NQVBfSURcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRNYW51YWxFdmVudHMoKXtcbiAgICAgICAgICAgIGZ1bmN0aW9uIENsb3VkTWFwKG9wdGlvbnMpe1xuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiSW5pdGlhbGl6aW5nIG1hcFwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gaW5zdGFudGlhdGUgZ29vZ2xlIG1hcFxuICAgICAgICAgICAgbWFwX29yaWdpbiA9IG5ldyBnb29nbGUubWFwcy5NYXAoZWxlbWVudFswXSwgbWFwT3B0aW9ucyk7XG5cbiAgICAgICAgICAgIC8vIHNldCBwcm90b3R5cGUgb2YgY3VzdG9tIG1hcCB3aXRoIG9yaWdpbiBtYXBcbiAgICAgICAgICAgIENsb3VkTWFwLnByb3RvdHlwZSA9IG1hcF9vcmlnaW47XG5cbiAgICAgICAgICAgIC8vIGRyYXcgeCBtYXJrZXJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYXdYTWFya2VyKGxvY2F0aW9uKXtcbiAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKHRoaXMsICdkcmF3WE1hcmtlcicsIGxvY2F0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIENsb3VkTWFwLnByb3RvdHlwZS5kcmF3WE1hcmtlciA9IGhhbmRsZURyYXdYTWFya2VyO1xuXG4gICAgICAgICAgICAvLyBkcmF3IGN1cnJlbnQgdXNlciBsb2NhdGlvbiBtYXJrZXJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYXdVc2VyTG9jYXRpb25NYXJrZXIobG9jYXRpb24pe1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIodGhpcywgJ2RyYXdVc2VyTG9jYXRpb25NYXJrZXInLCBsb2NhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBDbG91ZE1hcC5wcm90b3R5cGUuZHJhd1VzZXJMb2NhdGlvbk1hcmtlciA9IGhhbmRsZURyYXdVc2VyTG9jYXRpb25NYXJrZXI7XG5cbiAgICAgICAgICAgIC8vIGRyYXcgY3VycmVudCBsb2NhdGlvbiBtYXJrZXJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYXdDdXJyTG9jYXRpb25NYXJrZXIobG9jYXRpb24pe1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIodGhpcywgJ2RyYXdDdXJyTG9jYXRpb25NYXJrZXInLCBsb2NhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBDbG91ZE1hcC5wcm90b3R5cGUuZHJhd0N1cnJMb2NhdGlvbk1hcmtlciA9IGhhbmRsZURyYXdDdXJyTG9jYXRpb25NYXJrZXI7XG5cbiAgICAgICAgICAgIC8vIGRyYXcgcG9zdHNcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZVVwZGF0ZUFuZERyYXdQb3N0cygpe1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIodGhpcywgJ3VwZGF0ZUFuZERyYXdQb3N0cycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQ2xvdWRNYXAucHJvdG90eXBlLnVwZGF0ZUFuZERyYXdQb3N0cyA9IGhhbmRsZVVwZGF0ZUFuZERyYXdQb3N0cztcblxuICAgICAgICAgICAgLy8gZHJhdyByZXNwb25zZXNcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYXdSZXNwb25zZXMocG9zdCl7XG4gICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcih0aGlzLCAnZHJhd1Jlc3BvbnNlcycsIHBvc3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQ2xvdWRNYXAucHJvdG90eXBlLmRyYXdSZXNwb25zZXMgPSBoYW5kbGVEcmF3UmVzcG9uc2VzO1xuXG4gICAgICAgICAgICAvLyB1bmRyYXcgcG9zdHNcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZVVuRHJhd1Bvc3QocG9zdGlkKXtcbiAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKHRoaXMsICd1bkRyYXdQb3N0JywgcG9zdGlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIENsb3VkTWFwLnByb3RvdHlwZS51bkRyYXdQb3N0ID0gaGFuZGxlVW5EcmF3UG9zdDtcblxuICAgICAgICAgICAgLy8gY3JlYXRlIGN1c3RvbSBtYXAgZm9yIGFwcFxuICAgICAgICAgICAgbWFwID0gbmV3IENsb3VkTWFwKCk7XG5cbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ2RyYXdYTWFya2VyJywgZnVuY3Rpb24obG9jYXRpb24pe1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShsb2NhdGlvbik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnZHJhd1VzZXJMb2NhdGlvbk1hcmtlcicsIGZ1bmN0aW9uKGxvY2F0aW9uKXtcbiAgICAgICAgICAgICAgICBkcmF3VXNlck1hcmtlcihsb2NhdGlvbik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnZHJhd0N1cnJMb2NhdGlvbk1hcmtlcicsIGZ1bmN0aW9uKGxvY2F0aW9uKXtcbiAgICAgICAgICAgICAgICBkcmF3RHJvcERvd24obG9jYXRpb24pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ3VwZGF0ZUFuZERyYXdQb3N0cycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgdXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnZHJhd1Jlc3BvbnNlcycsIGZ1bmN0aW9uKHBvc3Qpe1xuICAgICAgICAgICAgICAgIGRyYXdSZXNwb25zZXMocG9zdCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAndW5EcmF3UG9zdCcsIGZ1bmN0aW9uKHBvc3RpZCl7XG4gICAgICAgICAgICAgICAgdW5EcmF3UG9zdChwb3N0aWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRTdHlsZUZvck1hcCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBmZWF0dXJlT3B0c19kYXkgPSBbe1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzYxOTVhMFwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJhZG1pbmlzdHJhdGl2ZS5wcm92aW5jZVwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwibGFuZHNjYXBlXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wibGlnaHRuZXNzXCI6XCIwXCJ9LHtcInNhdHVyYXRpb25cIjpcIjBcIn0se1wiY29sb3JcIjpcIiNmNWY1ZjJcIn0se1wiZ2FtbWFcIjpcIjFcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwibGFuZHNjYXBlLm1hbl9tYWRlXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcImxpZ2h0bmVzc1wiOlwiLTNcIn0se1wiZ2FtbWFcIjpcIjEuMDBcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwibGFuZHNjYXBlLm5hdHVyYWwudGVycmFpblwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9mZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJwb2kucGFya1wiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LmZpbGxcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiNiYWU1Y2VcIn0se1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJzYXR1cmF0aW9uXCI6LTEwMH0se1wibGlnaHRuZXNzXCI6NDV9LHtcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnkuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2ZhYzlhOVwifSx7XCJ2aXNpYmlsaXR5XCI6XCJzaW1wbGlmaWVkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuaGlnaHdheVwiLFwiZWxlbWVudFR5cGVcIjpcImxhYmVscy50ZXh0XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNGU0ZTRlXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNzg3ODc4XCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMuaWNvblwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJzaW1wbGlmaWVkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInRyYW5zaXQuc3RhdGlvbi5haXJwb3J0XCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLmljb25cIixcInN0eWxlcnNcIjpbe1wiaHVlXCI6XCIjMGEwMGZmXCJ9LHtcInNhdHVyYXRpb25cIjpcIi03N1wifSx7XCJnYW1tYVwiOlwiMC41N1wifSx7XCJsaWdodG5lc3NcIjpcIjBcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdC5zdGF0aW9uLnJhaWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNDMzMjFlXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInRyYW5zaXQuc3RhdGlvbi5yYWlsXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLmljb25cIixcInN0eWxlcnNcIjpbe1wiaHVlXCI6XCIjZmY2YzAwXCJ9LHtcImxpZ2h0bmVzc1wiOlwiNFwifSx7XCJnYW1tYVwiOlwiMC43NVwifSx7XCJzYXR1cmF0aW9uXCI6XCItNjhcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwid2F0ZXJcIixcImVsZW1lbnRUeXBlXCI6XCJhbGxcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiNlYWY2ZjhcIn0se1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwid2F0ZXJcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjYzdlY2VkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcIndhdGVyXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJsaWdodG5lc3NcIjpcIi00OVwifSx7XCJzYXR1cmF0aW9uXCI6XCItNTNcIn0se1wiZ2FtbWFcIjpcIjAuNzlcIn1dfV07XG5cbiAgICAgICAgICAgIHZhciBmZWF0dXJlT3B0c19uaWdodCA9IFt7XCJmZWF0dXJlVHlwZVwiOlwiYWxsXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2ZmZmZmZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJhbGxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5zdHJva2VcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn0se1wiY29sb3JcIjpcIiMzZTYwNmZcIn0se1wid2VpZ2h0XCI6Mn0se1wiZ2FtbWFcIjowLjg0fV19LHtcImZlYXR1cmVUeXBlXCI6XCJhbGxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMuaWNvblwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwiYWRtaW5pc3RyYXRpdmVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJ3ZWlnaHRcIjowLjZ9LHtcImNvbG9yXCI6XCIjMTgyYTNkXCJ9LHtcInZpc2liaWxpdHlcIjpcIm9uXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcImxhbmRzY2FwZVwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjMWE1MjhiXCJ9LHtcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiM0MDZkODBcIn0se1widmlzaWJpbGl0eVwiOlwib2ZmXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInBvaS5wYXJrXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiMyYzVhNzFcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNjZhOWVlXCJ9LHtcImxpZ2h0bmVzc1wiOi0zN30se1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LmZpbGxcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHRcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib2ZmXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQubG9jYWxcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5zdHJva2VcIixcInN0eWxlcnNcIjpbe1wibGlnaHRuZXNzXCI6XCItMTFcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjZmY3ZTRlXCJ9LHtcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdC5zdGF0aW9uLmFpcnBvcnRcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwid2F0ZXJcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzE4MmEzZFwifV19XTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gc2V0IG1hcCBkZXBlbmRzIG9uIGRheXRpbWUgb3IgbmlnaHR0aW1lXG4gICAgICAgICAgICB2YXIgY3VycmVudFRpbWUgPSBuZXcgRGF0ZSgpOyAvLyBmb3Igbm93XG4gICAgICAgICAgICB2YXIgY3VycmVudEhvdXIgPSBjdXJyZW50VGltZS5nZXRIb3VycygpO1xuICAgICAgICAgICAgdmFyIGZlYXR1cmVPcHRzO1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgIGlmIChjdXJyZW50SG91ciA8IDQgfHwgY3VycmVudEhvdXIgPiAxOSl7XG4gICAgICAgICAgICAgICAgZmVhdHVyZU9wdHMgPSBmZWF0dXJlT3B0c19uaWdodDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZmVhdHVyZU9wdHMgPSBmZWF0dXJlT3B0c19kYXk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAqL1xuICAgICAgICAgICAgZmVhdHVyZU9wdHMgPSBbe1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9uXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzQzOWFhNVwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJhZG1pbmlzdHJhdGl2ZS5sb2NhbGl0eVwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzMyNDg1Y1wifSx7XCJ2aXNpYmlsaXR5XCI6XCJzaW1wbGlmaWVkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlLm5laWdoYm9yaG9vZFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvblwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJsYW5kc2NhcGUubmF0dXJhbFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2U5ZGRkYlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJsYW5kc2NhcGUubmF0dXJhbC50ZXJyYWluXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib2ZmXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInBvaVwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pLnBhcmtcIixcImVsZW1lbnRUeXBlXCI6XCJhbGxcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pLnBhcmtcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjYzRlNjYxXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInBvaS5wYXJrXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9mZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJyb2FkLmhpZ2h3YXlcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjZTlkZGRiXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuaGlnaHdheVwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzMyNDg1Y1wifSx7XCJ3ZWlnaHRcIjpcIjAuN1wifV19LHtcImZlYXR1cmVUeXBlXCI6XCJyb2FkLmFydGVyaWFsXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9uXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjZTlkZGRiXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5zdHJva2VcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiMzMjQ4NWNcIn0se1wid2VpZ2h0XCI6XCIwLjI1XCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMuaWNvblwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5sb2NhbFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5sb2NhbFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LmZpbGxcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiNlOWRkZGJcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5sb2NhbFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2VmNzk4ZVwifSx7XCJ3ZWlnaHRcIjpcIjAuNVwifSx7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvblwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LmxpbmVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2VmNzk4ZVwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LmxpbmVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcIndlaWdodFwiOlwiMi4wNlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LmxpbmVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5zdHJva2VcIixcInN0eWxlcnNcIjpbe1wid2VpZ2h0XCI6XCIxMC4wMFwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LmxpbmVcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5zdHJva2VcIixcInN0eWxlcnNcIjpbe1wid2VpZ2h0XCI6XCIwLjAxXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcIndhdGVyXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnkuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvblwifSx7XCJ3ZWlnaHRcIjpcIjEwLjAwXCJ9LHtcImNvbG9yXCI6XCIjNDM5YWE1XCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcIndhdGVyXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9uXCJ9LHtcImNvbG9yXCI6XCIjMzI0ODVjXCJ9LHtcIndlaWdodFwiOlwiMC44NVwifV19XTtcblxuICAgICAgICAgICAgdmFyIHN0eWxlZE1hcE9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ0N1c3RvbSBTdHlsZSdcbiAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGN1c3RvbU1hcFR5cGUgPSBuZXcgZ29vZ2xlLm1hcHMuU3R5bGVkTWFwVHlwZShmZWF0dXJlT3B0cywgc3R5bGVkTWFwT3B0aW9ucyk7XG4gICAgICAgICAgICBtYXAubWFwVHlwZXMuc2V0KENMT1VEX01BUF9JRCwgY3VzdG9tTWFwVHlwZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpbml0IHRoZSBtYXBcbiAgICAgICAgZnVuY3Rpb24gaW5pdE1hcCgpIHtcbiAgICAgICAgICAgIGlmIChtYXAgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIGluaXRpYWxNYXBEYXRhKCk7XG5cbiAgICAgICAgICAgICAgICBzZXRNYW51YWxFdmVudHMoKTtcblxuICAgICAgICAgICAgICAgIHNldFN0eWxlRm9yTWFwKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGFkZCBVSSBlbGVtZW50cyB0byBtYXBcbiAgICAgICAgICAgIHNldFVJU2VhcmNoTG9jYXRpb25Ub2dnbGUoKTtcbiAgICAgICAgICAgIHNldFVJU2VhcmNoQm94KCk7XG4gICAgICAgICAgICBzZXRVSU1vdmVUb0N1cnJMb2NCdG4oKTtcbiAgICAgICAgICAgIHNldFVJUG9zdEZvcm0oKTtcbiAgICAgICAgICAgIHNldFVJUG9zdEJ0bigpO1xuICAgICAgICAgICAgc2V0VUlUaW1lU2xpZGVyKCk7XG4gICAgICAgICAgICBzZXRVSVBvc3RPbk1hcCgpO1xuXG4gICAgICAgICAgICAvLyBhZGQgb3JpZ2luIG5hdGl2ZSBFdmVudCBoYW5kbGVycyB0byBtYXBcbiAgICAgICAgICAgIHNldEV2ZW50Q2xpY2soKTtcbiAgICAgICAgICAgIHNldEV2ZW50Q2VudGVyQ2hhbmdlZCgpO1xuICAgICAgICAgICAgc2V0RXZlbnREcmFnRW5kKCk7XG4gICAgICAgICAgICBzZXRFdmVudFJlc2l6ZSgpO1xuICAgICAgICAgICAgc2V0RXZlbnRab29tQ2hhbmdlZCgpO1xuICAgICAgICAgICAgc2V0RXZlbnRCb3VuZHNDaGFuZ2VkKCk7XG5cbiAgICAgICAgICAgIC8vIGJyb2FkY2FzdCB0byBzZW5kIG1hcCB0byBhcHBsaWNhdGlvbiBjdHJsXG4gICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0Om1hcCcsIG1hcCk7XG4gICAgICAgIH0gXG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gRVhFQ1VURVxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICBpbml0TWFwKCk7XG5cbiAgICAgICAgZHJhd0hlbHBlck1hcmtlcihpbml0aWFsTWFwQ2VudGVyKTtcbiAgICAgICAgc2V0UGxhY2UoaW5pdGlhbE1hcENlbnRlcik7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgaWQ9XCJtYXAtY2FudmFzXCI+PC9kaXY+JyxcbiAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgbGluazogbGlua1xuICAgIH07XG59KTtcblxuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5kaXJlY3RpdmUoJ21hcE1zZycsIGZ1bmN0aW9uICgkdGltZW91dCwgU2Vzc2lvblN2YywgUG9zdHNTdmMpIHtcblxuICAgIHZhciBsaW5rID0gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7ICAgXG5cbiAgICAgICAgc2NvcGUuZ2V0X2xvY2Fsc3RhdHVzID0gZnVuY3Rpb24obG9jYWxfc3RhdHVzKXtcbiAgICAgICAgICBpZiAobG9jYWxfc3RhdHVzKVxuICAgICAgICAgICAgcmV0dXJuIFwibG9jYWwtdGV4dFwiO1xuICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJldHVybiBcIm5vbi1sb2NhbC10ZXh0XCI7XG4gICAgICAgIH07ICAgICBcblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBDT1VQTElORyBDTEFTU1xuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvKiBjb3VwbGluZyBzdGF0dXNcbiAgICAgICAgICAwIC0gbm8gc3RhdHVzXG4gICAgICAgICAgMSAtIGkgbGlrZSB5b3VcbiAgICAgICAgICAyIC0geW91IGxpa2UgaVxuICAgICAgICAgIDQgLSB3ZSBsaWtlIGVhY2ggb3RoZXJcbiAgICAgICAgKi9cbiAgICAgICAgc2NvcGUuZ2V0X2NvdXBsaW5nID0gZnVuY3Rpb24oY291cGxpbmdfc3RhdHVzKXtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoY291cGxpbmdfc3RhdHVzID09IDQpe1xuICAgICAgICAgICAgcmV0dXJuIFwiY291cGxpbmcgY291cGxpbmctY291cGxlXCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKGNvdXBsaW5nX3N0YXR1cyA9PSAxKXtcbiAgICAgICAgICAgIHJldHVybiBcImNvdXBsaW5nIGNvdXBsaW5nLWlsaWtleW91XCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKGNvdXBsaW5nX3N0YXR1cyA9PSAyKXtcbiAgICAgICAgICAgIHJldHVybiBcImNvdXBsaW5nIGNvdXBsaW5nLXlvdWxpa2VpXCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFwiY291cGxpbmcgY291cGxpbmctbm9uZVwiO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBET0NVTUVOVCBSRUFEWVxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgJHRpbWVvdXQodXBkYXRlR3VpZFRhcmdldCwgMTAwKTtcblxuICAgICAgICAgICR0aW1lb3V0KHVwZGF0ZVBvc3RUaW1lciwgMTApO1xuXG4gICAgICAgICAgJHRpbWVvdXQoY3VzdG9taXplSW5mb1dpbmRvdywgMTApO1xuXG4gICAgICAgICAgJHRpbWVvdXQoY3VzdG9taXplQ2xvc2VCdG4sIDEwKTtcblxuICAgICAgICAgIC8vY29uc29sZS5sb2coXCJwb3N0IGxvY2FsIHN0YXR1czpcIiwgc2NvcGUucG9zdGxvY2Fsc3RhdHVzKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlR3VpZFRhcmdldCgpe1xuICAgICAgICAgIC8vIHVwZGF0ZSBzdGF0dXMgZm9yIGd1aWQgdGFyZ2V0XG4gICAgICAgICAgdmFyIHBvc3RndWlkICA9IHNjb3BlLnBvc3RndWlkO1xuICAgICAgICAgIHZhciBteWd1aWQgICAgPSBzY29wZS4kcGFyZW50Lmd1aWQ7XG4gICAgICAgICAgdmFyIG15Z3VpZHRndCA9IHNjb3BlLiRwYXJlbnQuZ3VpZHRndDtcblxuICAgICAgICAgIGVsZW1lbnQuY2hpbGRyZW4oKS5vbignY2xpY2snLGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgIHZhciB1cGRhdGVfZ3VpZHRndCA9IHBvc3RndWlkO1xuXG4gICAgICAgICAgICAvLyBjbGlja2luZyBteSBtZXNzYWdlIHdpbmRvd1xuICAgICAgICAgICAgLy8gaWYgaXRzIG9uIGNvdXBsaW5nLCBicmVhayBpdCFcbiAgICAgICAgICAgIGlmIChwb3N0Z3VpZCA9PSBteWd1aWQpe1xuICAgICAgICAgICAgICBpZiAoc2NvcGUuJHBhcmVudC5ndWlkdGd0ICE9ICcwJyl7XG4gICAgICAgICAgICAgICAgdXBkYXRlX2d1aWR0Z3QgPSAnMCc7IFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBjbGlraW5nIHRoZSBvbmUgdGhhdCBJIGxpa2VkXG4gICAgICAgICAgICAvLyB0byBkaXNsaWtlIHRoZSBtZXNzYWdlIHdpbmRvd1xuICAgICAgICAgICAgaWYgKHBvc3RndWlkID09IG15Z3VpZHRndCkge1xuICAgICAgICAgICAgICB1cGRhdGVfZ3VpZHRndCA9ICcwJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gcHJvcGFnYXRlIHRvIHVwcGVyIHNjb3BlIGZvciBndWlkdGd0IHVwZGF0ZVxuICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldDpndWlkdGd0JywgdXBkYXRlX2d1aWR0Z3QpOyBcblxuICAgICAgICAgICAgLy8gdXBkYXRlIHNlc3Npb24gaW5mb3JtYXRpb24gb2YgbWluZSBzbyBteSBzZXNzaW9uIHRlbGxzIG1lIHRoYXQsXG4gICAgICAgICAgICAvLyBJIGxpa2UgdGhpcyBndWlkIGF0IHRoaXMgbW9tZW50IGluIHNlcnZlciBkYlxuICAgICAgICAgICAgU2Vzc2lvblN2Yy51cGRhdGVDb3VwbGluZyhteWd1aWQsIHVwZGF0ZV9ndWlkdGd0KVxuICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihkb2Mpe1xuICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIlN1Y2Nlc3NmdWxseSB1ZHBhdGVkIGNvdXBsaW5nXCIsIGRvYyk7XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIHVwZGF0ZSBteSBwb3N0J3MgZ3VpZHRndCB0byBiZSB0aGlzIHBvc3QncyBndWlkIGluIHNlcnZlciBkYlxuICAgICAgICAgICAgLy8gdGhpcyB1cGRhdGUgaXMgZm9yIHRoZSBwZW9wbGUgd2hvIGFyZSBsb29raW5nIGF0IG15IHBvc3RzXG4gICAgICAgICAgICB2YXIgdXBkYXRlcyA9IHtcbiAgICAgICAgICAgICAgZ3VpZCAgICA6IG15Z3VpZCxcbiAgICAgICAgICAgICAgZ3VpZHRndCA6IHVwZGF0ZV9ndWlkdGd0XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgUG9zdHNTdmMudXBkYXRlR3VpZHRndCh1cGRhdGVzKVxuICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihkb2Mpe1xuICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIlN1Y2Nlc3NmdWxseSB1ZHBhdGVkIHBvc3QncyBndWlkdGd0XCIsIGRvYyk7XG4gICAgICAgICAgICAgICAgICAvLyBhZnRlciBjb3VwbGluZyB1cGRhdGUsIG1hcCBoYXMgdG8gYmUgdXBkYXRlcyBhcyB3ZWxsXG4gICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAvLyBNSUdIVCBIQVZFIFRPIENPTUUgQkFDSyBGT1IgT1BUSU1JWkFUSU9OXG4gICAgICAgICAgICAvLyB0aGlzIGhhdmUgdG8gYmUgdXBkYXRlIHRvIGJlIGNvbW11bmljYXRlZCB0aHJvdWdoIHRoZSBzZXJ2ZXJcbiAgICAgICAgICAgIGlmIChzY29wZS4kcGFyZW50Lmd1aWR0Z3QgPT0gMCl7XG4gICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdzZXQ6Y291cGxpbmcnLCAxKTsgLy8gcHJvcGFnYXRlIHRvIHVwcGVyIHNjb3BlIGZvciBjb3VwbGluZyB1cGRhdGVcbiAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KCk7IC8vIGZvcmNlIHRvIHVwZGF0ZSBET01cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3Rjb3VwbGVzdGF0dXMgPT0gMSAmJiBzY29wZS4kcGFyZW50Lmd1aWR0Z3QgIT0gMCl7XG4gICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdzZXQ6Y291cGxpbmcnLCAwKTsgLy8gcHJvcGFnYXRlIHRvIHVwcGVyIHNjb3BlIGZvciBjb3VwbGluZyB1cGRhdGVcbiAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KCk7IC8vIGZvcmNlIHRvIHVwZGF0ZSBET01cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICovXG4gICAgICAgICAgICBcblxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlUG9zdFRpbWVyKCl7XG4gICAgICAgICAgLy9jb25zb2xlLmxvZyhcIkxpZmUgJTpcIiwgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlKTtcbiAgICAgICAgICAgIHZhciBkdXJhdGlvbiA9IHNjb3BlLnBvc3RsaWZlICsgXCJtc1wiO1xuXG4gICAgICAgICAgICB2YXIgcG9zdGJhcmxpZmUgPSBlbGVtZW50LmNoaWxkcmVuKCkuY2hpbGRyZW4oXCIucG9zdGxpZmViYXJcIik7XG5cbiAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLWR1cmF0aW9uJywgZHVyYXRpb24pO1xuICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1kdXJhdGlvbicsIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1kdXJhdGlvbicsIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tZHVyYXRpb24nLCBkdXJhdGlvbik7XG4gICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1kdXJhdGlvbicsIGR1cmF0aW9uKTtcblxuICAgICAgICAgICAgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuOTUpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2EnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2EnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9hJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2EnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA8PSAwLjk1ICYmIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuOSl7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9iJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2InKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlIDw9IDAuOSAmJiBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjg1KXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2MnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9jJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9jJyk7XG4gICAgICAgICAgICAgIHBvc3RsaWZlYmFyX2NzcyA9IHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYycpO1xuICAgICAgICAgICAgICBwb3N0bGlmZWJhcl9jc3MgPSBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9jJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPD0gMC44NSAmJiBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjc1KXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2QnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9kJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9kJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZCcpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9kJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPD0gMC43NSAmJiBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjYpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2UnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2UnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9lJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2UnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA8PSAwLjYgJiYgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC41KXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2YnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9mJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9mJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9mJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPD0gMC41ICYmIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuMyl7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9nJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZycpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZycpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2cnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlIDw9IDAuMyAmJiBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjIpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faCcpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2gnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2gnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9oJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2gnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA8PSAwLjIgJiYgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC4xKXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2knKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9pJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9pJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9pJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2onKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2onKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9qJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2onKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGN1c3RvbWl6ZUluZm9XaW5kb3coKXtcbiAgICAgICAgICAvLyBSZWZlcmVuY2UgdG8gdGhlIERJViB0aGF0IHdyYXBzIHRoZSBib3R0b20gb2YgaW5mb3dpbmRvd1xuICAgICAgICAgIHZhciBpd091dGVyID0gJCgnLmdtLXN0eWxlLWl3Jyk7XG4gICAgICAgICAgXG4gICAgICAgICAgdmFyIGl3QmFja2dyb3VuZCA9IGl3T3V0ZXIucHJldigpO1xuXG4gICAgICAgICAgLy8gUmVtb3ZlIHRoZSBiYWNrZ3JvdW5kIHNoYWRvdyBESVZcbiAgICAgICAgICAgaXdCYWNrZ3JvdW5kLmNoaWxkcmVuKCc6bnRoLWNoaWxkKDIpJykuY3NzKHsnZGlzcGxheScgOiAnbm9uZSd9KTtcblxuICAgICAgICAgICAvLyBSZW1vdmUgdGhlIHdoaXRlIGJhY2tncm91bmQgRElWXG4gICAgICAgICAgIGl3QmFja2dyb3VuZC5jaGlsZHJlbignOm50aC1jaGlsZCg0KScpLmNzcyh7J2Rpc3BsYXknIDogJ25vbmUnfSk7XG5cbiAgICAgICAgICAvLyBDaGFuZ2VzIHRoZSBkZXNpcmVkIHRhaWwgc2hhZG93IGNvbG9yLlxuICAgICAgICAgIGl3QmFja2dyb3VuZC5jaGlsZHJlbignOm50aC1jaGlsZCgzKScpLmZpbmQoJ2RpdicpLmNoaWxkcmVuKCkuY3NzKHtcbiAgICAgICAgICAgICdib3gtc2hhZG93JzogJzAgMXB4IDZweCByZ2JhKDE3OCwgMTc4LCAxNzgsIDAuNiknLCBcbiAgICAgICAgICAgICd6LWluZGV4JyA6ICcxJyxcbiAgICAgICAgICAgICdib3JkZXInOiAnMHB4J30pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY3VzdG9taXplQ2xvc2VCdG4oKXtcbiAgICAgICAgICAvLyBSZWZlcmVuY2UgdG8gdGhlIERJViB0aGF0IHdyYXBzIHRoZSBib3R0b20gb2YgaW5mb3dpbmRvd1xuICAgICAgICAgIHZhciBpd091dGVyID0gJCgnLmdtLXN0eWxlLWl3Jyk7XG5cbiAgICAgICAgICB2YXIgaXdDbG9zZUJ0biA9IGl3T3V0ZXIubmV4dCgpO1xuXG4gICAgICAgICAgLypcbiAgICAgICAgICBjb25zb2xlLmxvZyhcInBvc3Rsb2NhbCBsZWFudGg6XCIsIGl3T3V0ZXIucGFyZW50KCkuZmluZCgnI3Bvc3Rsb2NhbCcpLmxlbmd0aCk7XG4gICAgICAgICAgaWYgKHNjb3BlLnBvc3Rsb2NhbHN0YXR1cyA9PSBmYWxzZSAmJiAwID09IGl3T3V0ZXIucGFyZW50KCkuZmluZCgnI3Bvc3Rsb2NhbCcpLmxlbmd0aCl7XG4gICAgICAgICAgICBpd0Nsb3NlQnRuLmFmdGVyKFwiPGltZyBpZD0ncG9zdGxvY2FsJyBzcmM9J2h0dHA6Ly9jZG4taW1nLmVhc3lpY29uLm5ldC9wbmcvMjQvMjQ0MC5wbmcnIHdpZHRoPScyMCcsIGhlaWdodD0nMjAnLz5cIik7XG4gICAgICAgICAgfVxuICAgICAgICAgICovXG5cbiAgICAgICAgICAvLyBBcHBseSB0aGUgZGVzaXJlZCBlZmZlY3QgdG8gdGhlIGNsb3NlIGJ1dHRvblxuICAgICAgICAgIGl3Q2xvc2VCdG4uY3NzKHtcbiAgICAgICAgICAgIG9wYWNpdHk6ICcwLjgnLCAvLyBieSBkZWZhdWx0IHRoZSBjbG9zZSBidXR0b24gaGFzIGFuIG9wYWNpdHkgb2YgMC43XG4gICAgICAgICAgICByaWdodDogJzIwcHgnLCB0b3A6ICcyMHB4JywgLy8gYnV0dG9uIHJlcG9zaXRpb25pbmdcbiAgICAgICAgICB9KTsgXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJy4vdGVtcGxhdGVzL3dpbmRvdy5odG1sJyxcbiAgICAgICAgbGluazogbGlua1xuICAgIH07XG59KTtcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyLmNvbnRyb2xsZXIoJ1Bvc3RzQ3RybCcsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkc2NvcGUsIENvbmZpZ1N2YywgUG9zdHNTdmMsIFV0aWxTdmMsICR3aW5kb3csICRkb2N1bWVudCwgJHRpbWVvdXQpe1xyXHJcdC8qIGVtaXQgYnJvYWRjYXN0IGZvciBjdXJyZW50IHBhZ2VJZCAqL1xyXHQkc2NvcGUuJGVtaXQoJ3NldDpwYWdlY2hhbmdlJywgJHNjb3BlLnBhZ2VJZC5wb3N0KTtcclxyXHQkc2NvcGUucG9zdHMgPSBbXTtcclxyXHQvKiBhcyBzZXJ2ZXIgdGVsbHMgdGhlcmUgd2FzIG5ldyBwb3N0LCBsZXRzIHJlLWxvYWQgbGlzdCBkYXRhICovXHJcdCRzY29wZS4kb24oJ3dzOm5ld19wb3N0JywgZnVuY3Rpb24oXywgcG9zdCl7XHJcdFx0JHNjb3BlLnJlcXVlc3RGZXRjaCgpO1xyXHR9KTtcclxyXHQkc2NvcGUuYWRkUG9zdCA9IGZ1bmN0aW9uKCkge1xyXHRcdC8qIGNoZWNrIGlmIHRoZSBwb3N0IGNvbnRlbnQgaXMgdGhlcmUgLSBvbmx5IGZvciBXRUIgZm9yIGVudGVyIGJ1dHRvbiB0byBwb3N0ICovXHJcdFx0aWYgKCEkc2NvcGUuY29udGVudCl7XHJcdFx0XHQvKmNvbnNvbGUubG9nKFwiVXNlciBhdHRlbXB0ZWQgdG8gcG9zdCB3aXRoIDAgd29yZHMuXCIpKi9cclx0XHRcdHJldHVybjtcclx0XHR9XHJcclx0XHQvKiBnZXQgYXV0b2NvbXBsZXRlZCBwbGFjZSBhbmQgcmVzZXQoc2V0IHRvIHVuZGVmaW5lZCkgKi9cclx0XHR2YXIgcGxhY2UgICAgPSAkc2NvcGUucG9zdHBsYWNlO1xyXHRcdHZhciBsb2NhdGlvbiA9ICRzY29wZS5wb3N0TG9jYXRpb247XHJcclx0XHR2YXIgbG9jYWxfc3RhdHVzO1xyXHRcdHZhciBwb3N0TG9jYXRpb25Gcm9tVXNlckxvY2F0aW9uID0gVXRpbFN2Yy5nZXREaXN0YW5jZUZyb21MYXRMb25JbkttKGxvY2F0aW9uLmxhdCwgbG9jYXRpb24ubG9uLCAkc2NvcGUudXNlckxvY2F0aW9uLmxhdCwgJHNjb3BlLnVzZXJMb2NhdGlvbi5sb24pO1xyXHRcdC8qIGlmIGxlc3MgdGhhbiAza20gKi9cclx0XHRpZiAocG9zdExvY2F0aW9uRnJvbVVzZXJMb2NhdGlvbiA8IDMpe1xyXHRcdFx0bG9jYWxfc3RhdHVzID0gdHJ1ZTtcclx0XHR9XHJcdFx0ZWxzZSB7XHJcdFx0XHRsb2NhbF9zdGF0dXMgPSBmYWxzZTtcclx0XHR9XHJcdFx0XHJcdFx0dmFyIGxvY2F0aW9uSlNPTiA9IEpTT04uc3RyaW5naWZ5KGxvY2F0aW9uKTtcclxyXHRcdHZhciByZWxhdGl2ZUxpZmVTcGFuO1xyXHRcdGlmICgkc2NvcGUudGltZXZhbHVlIDw9IENvbmZpZ1N2Yy5tYXhJbnN0YW50TGlmZVNwYW4pe1xyXHRcdFx0dmFyIGNoYXJMZW4gPSAkc2NvcGUuY29udGVudC5sZW5ndGg7XHJcdFx0XHRpZiAoY2hhckxlbiA8IDUpXHJcdFx0XHR7XHJcdFx0XHRcdHJlbGF0aXZlTGlmZVNwYW4gPSA0MDAwO1xyXHRcdFx0fVxyXHRcdFx0ZWxzZVxyXHRcdFx0e1xyXHRcdFx0XHRyZWxhdGl2ZUxpZmVTcGFuID0gY2hhckxlbiAqIFV0aWxTdmMubWFwUmFuZ2UoY2hhckxlbiwgNSwgMjAsIDcwMCwgNDAwKTtcclx0XHRcdH1cclx0XHR9XHJcdFx0ZWxzZSB7XHJcdFx0XHRyZWxhdGl2ZUxpZmVTcGFuID0gJHNjb3BlLnRpbWV2YWx1ZTtcclx0XHR9XHJcclx0XHRQb3N0c1N2Yy5jcmVhdGUoXHJcdFx0e1xyXHRcdFx0Ym9keSAgICA6ICAkc2NvcGUuY29udGVudCxcclx0XHRcdGxvY2F0aW9uOiAgbG9jYXRpb25KU09OLFxyXHRcdFx0cGxhY2UgICA6ICBwbGFjZSxcclx0XHRcdGd1aWQgICAgOiAgJHNjb3BlLmd1aWQsXHJcdFx0XHRndWlkdGd0IDogICRzY29wZS5ndWlkdGd0LFxyXHRcdFx0bGlmZXNwYW46ICByZWxhdGl2ZUxpZmVTcGFuLFxyXHRcdFx0aXNsb2NhbCA6ICBsb2NhbF9zdGF0dXMsXHJcdFx0fSlcclx0XHQuc3VjY2VzcyhmdW5jdGlvbihwb3N0KXtcclx0XHRcdFx0XHRcclx0XHRcdC8qIHJlc2V0IGlucHV0IGZvcm1zICovXHJcdFx0XHQkc2NvcGUuY29udGVudCAgPSBudWxsO1xyXHRcdH0pXHJcdFx0LmVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cyl7XHJcdFx0XHRzd2FsKFwiUG9zdCBmYWlsZWRcIiwgXCJQbGVhc2UgY29tcGxldGUgdGhlIGZyb20gY29ycmVjdGx5XCIsIFwiZXJyb3JcIik7XHJcdFx0fSlcclx0XHQuY2F0Y2goZnVuY3Rpb24oZXJyKXtcclx0XHRcdC8qIGhhbmRsZSBlcnJvciAqL1xyXHRcdH0pO1xyXHR9O1xyXHJcdC8qIGFzIHNlcnZlciB0ZWxscyB0aGVyZSB3YXMgbmV3IHBvc3QsIGxldHMgcmUtbG9hZCBsaXN0IGRhdGEgKi9cclx0JHNjb3BlLnJlcXVlc3RGZXRjaCA9IGZ1bmN0aW9uKCkge1xyXHRcdFBvc3RzU3ZjLmZldGNoKClcclx0XHQuc3VjY2VzcyhmdW5jdGlvbihwb3N0cyl7XHJcdFx0XHQvKmNvbnNvbGUubG9nKCdHb3QgUG9zdHM6JywgcG9zdHMpOyAqL1xyXHRcdFx0JHNjb3BlLnBvc3RzID0gcG9zdHM7XHJcdFx0fSlcclx0XHQuY2F0Y2goZnVuY3Rpb24oZXJyKXtcclx0XHRcdC8qIGVycm9yIGhhbmRsZSAqL1xyXHRcdH0pO1xyXHR9O1xyXHJcdC8qIHVwZGF0ZSBndWlkIG9mIHBvc3QgKi9cclx0JHNjb3BlLnVwZGF0ZUd1aWR0Z3QgPSBmdW5jdGlvbihteWd1aWQsIGd1aWR0Z3QpIHtcclx0XHR2YXIgdXBkYXRlcyA9IHtcclx0XHRcdGd1aWQgICAgOiBteWd1aWQsXHJcdFx0XHRndWlkdGd0IDogZ3VpZHRndFxyXHRcdH07XHJcclx0XHQvKmNvbnNvbGUubG9nKFwidWRwYXRlIHRvIHBvc3QgZ3VpZHRndDpcIiwgdXBkYXRlcykqL1xyXHJcdFx0UG9zdHNTdmMudXBkYXRlR3VpZHRndCh1cGRhdGVzKVxyXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKHVwZGF0ZXMpe1xyXHRcdFx0LyogIGRlYnVnIG1zZyAgKi9cclx0XHR9KVxyXHRcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xyXHRcdFx0LyogIGVycm9yIGhhbmRsaW5nICAqL1xyXHRcdH0pO1xyXHR9XHJcclx0Lyokc2NvcGUucmVxdWVzdEZldGNoKCk7Ki9ccn0pO1xyXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdQb3N0c1N2YycsIGZ1bmN0aW9uKCRodHRwKXtcblx0dGhpcy5mZXRjaCA9IGZ1bmN0aW9uKGd1aWRPYmope1xuXHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcG9zdHMnLCBndWlkT2JqKTtcblx0fTtcblxuXHR0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uKHBvc3Qpe1xuXHRcdHBvc3QuZGV2aWNldG9rZW4gPSAnMCc7IC8vIGZvciB3ZWIsIHRoZXJlIGlzIG5vIGRldmljZXRva2VuXG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcG9zdHMnLCBwb3N0KTtcblx0fTtcblxuXHR0aGlzLnJlbW92ZSA9IGZ1bmN0aW9uKHBvc3Qpe1xuXHRcdC8vY29uc29sZS5sb2coXCJkZWxldGluZyBwb3N0aW5nXCIpO1xuXHRcdC8vY29uc29sZS5sb2coJ3Bvc3QuX2lkOicsIHBvc3QuX2lkKTtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cy9wb3N0c19kZWxldGUnLCBwb3N0KTtcblx0fTtcblxuXHR0aGlzLnVwZGF0ZUd1aWR0Z3QgPSBmdW5jdGlvbih1cGRhdGVzKXtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cy91cGRhdGVfZ3VpZHRndCcsIHVwZGF0ZXMpO1xuXHR9XG59KTtcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1Nlc3Npb25TdmMnLCBmdW5jdGlvbigkaHR0cCl7XG5cdHRoaXMuZmV0Y2ggPSBmdW5jdGlvbigpe1xuXHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvc2Vzc2lvbnMnKTtcblx0fTtcblxuXHR0aGlzLmVudGVyID0gZnVuY3Rpb24oc2Vzc2lvbil7XG5cdFx0c2Vzc2lvbi5kZXZpY2V0b2tlbiA9ICcwJzsgLy8gZm9yIHdlYiwgdGhlcmUgaXMgbm8gZGV2aWNldG9rZW5cblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucycsIHNlc3Npb24pO1xuXHR9O1xuXG5cdHRoaXMucmVtb3ZlID0gZnVuY3Rpb24oZ3VpZCl7XG5cdFx0dmFyIHNlc3Npb24gPSB7Z3VpZDogZ3VpZH07XG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbnMvZGVsZXRlJywgc2Vzc2lvbik7XG5cdH07XG5cblx0dGhpcy51cGRhdGVPbmxpbmVzdGF0ID0gZnVuY3Rpb24ob25saW5lc3RhdCwgZ3VpZCl7XG5cdFx0dmFyIHVwZGF0ZWRzZXNzaW9uID0ge1xuXHRcdFx0b25saW5lc3RhdDogb25saW5lc3RhdCxcblx0XHRcdGd1aWQgICAgICA6IGd1aWRcblx0XHR9O1xuXG5cdFx0cmV0dXJuICRodHRwLnBvc3QoU0VSVkVSLnVybCArICcvYXBpL3Nlc3Npb25zL3VwZGF0ZV9vbmxpbmVzdGF0JywgdXBkYXRlZHNlc3Npb24pO1xuXHR9XG5cblx0dGhpcy51cGRhdGVXYXRjaExvY2F0aW9uID0gZnVuY3Rpb24oY3VycmVudF9tYXBfbncsIGN1cnJlbnRfbWFwX3NlLCBjdXJyZW50X21hcF9jZW50ZXIsIGd1aWQpe1xuXHRcdHZhciB3YXRjaGxvYyA9IHtcbiAgICAgICAgICAgIG53X2xhdCAgICAgOiBjdXJyZW50X21hcF9udy5sYXQsXG4gICAgICAgICAgICBud19sb24gICAgIDogY3VycmVudF9tYXBfbncubG9uLFxuICAgICAgICAgICAgc2VfbGF0ICAgICA6IGN1cnJlbnRfbWFwX3NlLmxhdCxcbiAgICAgICAgICAgIHNlX2xvblx0ICAgOiBjdXJyZW50X21hcF9zZS5sb24sXG4gICAgICAgICAgICBjZW50ZXJfbGF0IDogY3VycmVudF9tYXBfY2VudGVyLmxhdCxcbiAgICAgICAgICAgIGNlbnRlcl9sb24gOiBjdXJyZW50X21hcF9jZW50ZXIubG9uXG4gICAgICAgIH1cblxuICAgICAgICB2YXIgd2F0Y2hsb2NKU09OID0gSlNPTi5zdHJpbmdpZnkod2F0Y2hsb2MpO1xuXG4gICAgICAgIHZhciB1cGRhdGVkc2Vzc2lvbiA9IHtcbiAgICAgICAgICAgIHdhdGNobG9jOiB3YXRjaGxvY0pTT04sXG4gICAgICAgICAgICBndWlkICAgIDogZ3VpZFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHVwZGF0ZSB3YXRjaGxvYyB3aGVuIGNlbnRlciBjaGFuZ2VkLlxuICAgICAgICAvL2NvbnNvbGUubG9nKFwidXBkYXRpbmcgd2F0Y2ggbG9jYXRpb25cIik7XG5cblx0XHQvL2NvbnNvbGUubG9nKFwidXBkYXRlZHNlc3Npb246XCIsIHVwZGF0ZWRzZXNzaW9uKTtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucy91cGRhdGVfd2F0Y2hfbG9jJywgdXBkYXRlZHNlc3Npb24pO1xuXHR9O1xuXG5cdHRoaXMudXBkYXRlQ3VycmVudExvY2F0aW9uID0gZnVuY3Rpb24oY3VycmVudF9sb2NfbGF0LCBjdXJyZW50X2xvY19sb24sIGd1aWQpe1xuXHRcdHZhciBjdXJybG9jID0ge1xuXHRcdFx0bGF0IDogY3VycmVudF9sb2NfbGF0LFxuXHRcdFx0bG9uIDogY3VycmVudF9sb2NfbG9uXG5cdFx0fVxuXG5cdFx0dmFyIGN1cnJsb2NKU09OID0gSlNPTi5zdHJpbmdpZnkoY3VycmxvYyk7XG5cblx0XHR2YXIgdXBkYXRlZHNlc3Npb24gPSB7XG5cdFx0XHRjdXJybG9jOiBjdXJybG9jSlNPTixcblx0XHRcdGd1aWQgICA6IGd1aWRcblx0XHR9XG5cblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucy91cGRhdGVfY3Vycl9sb2MnLCB1cGRhdGVkc2Vzc2lvbik7XG5cdH07XG5cblx0dGhpcy51cGRhdGVDb3VwbGluZyA9IGZ1bmN0aW9uKGd1aWQsIGd1aWR0Z3Qpe1xuXHRcdFxuXHRcdHZhciB1cGRhdGVkZ3VpZHRndCA9IHtcblx0XHRcdGd1aWQgICA6IGd1aWQsXG5cdFx0XHRndWlkdGd0OiBndWlkdGd0XG5cdFx0fTtcblxuXHRcdC8vIHVwZGF0ZSB3YXRjaGxvYyB3aGVuIGNlbnRlciBjaGFuZ2VkLlxuICAgICAgICAvL2NvbnNvbGUubG9nKFwidXBkYXRpbmcgY291cGxpbmdcIik7XG5cblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucy91cGRhdGVfY291cGxpbmcnLCB1cGRhdGVkZ3VpZHRndClcblx0fTtcbn0pO1xuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=