angular.module("app",["ngRoute","ngAnimate","ui.slider"]),angular.module("app").controller("ApplicationCtrl",["SessionSvc","UtilSvc","ConfigSvc","$rootScope","$scope","$window","$http","$timeout",function(e,t,n,o,i,a,s,l){window.onbeforeunload=function(t){e.remove(i.guid).success(function(e){})["catch"](function(e){})},window.onpageshow=function(e){i.initSession(),i.map&&i.map.updateAndDrawPosts()},window.onpagehide=function(t){e.remove(i.guid).success(function(e){})["catch"](function(e){})},document.addEventListener("visibilitychange",function(){"visible"==document.visibilityState||"mozVisible"==document.visibilityState||"msVisible"==document.visibilityState||"webkitVisible"==document.visibilityState?(i.initSession(),i.map&&i.map.updateAndDrawPosts()):("hidden"==document.visibilityState||"mozHidden"==document.visibilityState||"msHidden"==document.visibilityState||"webkitHidden"==document.visibilityState)&&e.remove(i.guid).success(function(e){})["catch"](function(e){})}),document.addEventListener("webkitvisibilitychange",function(){document.webkitVisible?(i.initSession(),i.map&&i.map.updateAndDrawPosts()):document.webkitHidden&&e.remove(i.guid).success(function(e){})["catch"](function(e){})},!1),i.initSession=function(){function t(t){var n=t.coords,o=new google.maps.LatLng(n.latitude,n.longitude);i.userLocation={lat:n.latitude,lon:n.longitude};var a={lat:o.lat(),lon:o.lng()},s=JSON.stringify(a),l=i.map.getBounds(),r=l.getNorthEast(),c=l.getSouthWest(),g={lat:r.lat(),lon:c.lng()},p={lat:c.lat(),lon:r.lng()},u={lat:window.localStorage.latitude,lon:window.localStorage.longitude},m={nw_lat:g.lat,nw_lon:g.lon,se_lat:p.lat,se_lon:p.lon,center_lat:u.lat,center_lon:u.lon},d=JSON.stringify(m),f={guidtgt:i.guidtgt,guid:i.guid,location:s,watchloc:d};e.enter(f).success(function(e){})["catch"](function(e){})}function n(e){swal("","Need to turn on location service for proper use.")}if("undefined"!=i.map&&"null"!=i.map&&i.map){var o={enableHighAccuracy:!1,timeout:5e3,maximumAge:0};navigator.geolocation.getCurrentPosition(t,n,o),swal({title:"",text:"Retreiving currnet location..",timer:3500,showConfirmButton:!1})}},"undefined"!=window.localStorage.guid&&"null"!=window.localStorage.guid&&window.localStorage.guid||(window.localStorage.guid=t.getGuid()),i.guid=window.localStorage.guid,"undefined"!=window.localStorage.guidtgt&&"null"!=window.localStorage.guidtgt&&window.localStorage.guidtgt||(window.localStorage.guidtgt="0"),i.guidtgt=window.localStorage.guidtgt,i.pageId={post:0},i.navCollapsed=!0,i.timevalue=n.maxInstantLifeSpan,i.userLocation={lat:0,lon:0},i.toggleSearchLocation=!1,i.toggleTimeSlider=!1,l(function(){document.getElementById("map-posting").onkeypress=function(e){"13"==e.which&&$("form#map-posting-form").submit()},document.getElementById("map-posting").onfocus=function(e){i.toggleTimeSlider=!0},document.getElementById("map-posting").onblur=function(e){i.toggleTimeSlider=!1},$(".nav-burger").click(function(){$(".nav-burger").toggleClass("active"),i.toggleSearchLocation=!i.toggleSearchLocation,i.$apply()})});var r,c=document.location.hostname;r=c==n.local?n.web_socket+n.local+":"+n.port:c==n.local_ip?n.web_socket+n.local_ip+":"+n.port:n.web_socket+n.deploy_dns;var g=function(){connection=new WebSocket(r),connection.onopen=function(){connection.send(i.guid)},connection.onclose=function(){l(g,2e3)},connection.onmessage=function(e){var t=JSON.parse(e.data);o.$broadcast("ws:"+t.type,t.data)}};g(),i.$on("ws:new_post",function(e,t){i.map.updateAndDrawPosts(),t.guid==i.guid&&i.map.drawResponses(t)}),i.$on("ws:new_session",function(e,t){var n=angular.fromJson(t.location);i.map.drawCurrLocationMarker(n)}),i.$on("ws:remove_post",function(e,t){i.map.unDrawPost(t)}),i.$on("ws:update_guidtgt",function(e,t){i.map.updateAndDrawPosts()}),i.isMobile=function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?!0:!1},i.moveToCurrentLocation=function(){function e(e){if(i.currentPageId==i.pageId.post){var t=e.coords;window.localStorage.latitude=t.latitude,window.localStorage.longitude=t.longitude;var n={lat:t.latitude,lon:t.longitude};i.map.drawCurrLocationMarker(n),i.map.drawXMarker(n);var o=new google.maps.LatLng(n.lat,n.lon);i.map.panTo(o),i.map.setZoom(15)}}function t(e){swal("","Need to turn on location service for proper use.")}var n={enableHighAccuracy:!0,timeout:8e3,maximumAge:0};navigator.geolocation.getCurrentPosition(e,t,n),swal({title:"",text:"Moving to current location..",timer:1500,showConfirmButton:!1})},i.moveToPostLocation=function(){var e=0;if(i.isMobile()){var t=i.map.getBounds(),n=t.getNorthEast(),o=t.getSouthWest();current_map_nw=new google.maps.LatLng(n.lat(),o.lng()),current_map_se=new google.maps.LatLng(o.lat(),n.lng());var a=.5*Math.abs(i.postLocation.lat-current_map_nw.lat()),s=.5*Math.abs(i.postLocation.lat-current_map_se.lat());e=a>s?s:a}var l=i.map.getCenter(),r=new google.maps.LatLng(i.postLocation.lat+e,l.lng());i.map.panTo(r)},i.collapse=function(){i.navCollapsed=!0},i.$on("set:map",function(e,t){i.map=t}),i.$on("set:guidtgt",function(e,t){i.guidtgt=t,window.localStorage.guidtgt=t}),i.$on("set:pagechange",function(e,t){i.currentPageId=t}),i.$on("set:loc",function(e,t){var n=t.lat(),o=t.lng();i.postLocation={lat:n,lon:o}}),i.$on("set:place",function(e,t){i.$apply(function(){i.postplace=t})})}]),angular.module("app").constant("ConfigSvc",{web_socket:"ws://",web_socket_secure:"wss://",local:"localhost",local_ip:"192.168.0.4",deploy_dns:"talkipia.com",port:"5000",maxInstantLifeSpan:5e3}),angular.module("app").config(["$routeProvider",function(e){e.when("/",{controller:"PostsCtrl",templateUrl:"/templates/posts.html"}).otherwise({redirectTo:"/"})}]),angular.module("app").service("UtilSvc",function(){var e=this;e.deg2rad=function(e){return e*(Math.PI/180)},e.getDistanceFromLatLonInKm=function(t,n,o,i){var a=6371,s=e.deg2rad(o-t),l=e.deg2rad(i-n),r=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e.deg2rad(t))*Math.cos(e.deg2rad(o))*Math.sin(l/2)*Math.sin(l/2),c=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)),g=a*c;return g},e.mapRange=function(e,t,n,o,i){return o+(i-o)*(e-t)/(n-t)},e.getGuid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}),angular.module("app").run(["$rootScope","$timeout","SessionSvc",function(e,t,n){}]),angular.module("app").controller("PostsCtrl",["$rootScope","$scope","ConfigSvc","PostsSvc","UtilSvc","$window","$document","$timeout",function(e,t,n,o,i,a,s,l){t.$emit("set:pagechange",t.pageId.post),t.posts=[],t.$on("ws:new_post",function(e,n){t.requestFetch()}),t.addPost=function(){if(t.content){var e,a=t.postplace,s=t.postLocation,l=i.getDistanceFromLatLonInKm(s.lat,s.lon,t.userLocation.lat,t.userLocation.lon);e=3>l?!0:!1;var r,c=JSON.stringify(s);if(t.timevalue<=n.maxInstantLifeSpan){var g=t.content.length;r=5>g?4e3:g*i.mapRange(g,5,20,700,400)}else r=t.timevalue;o.create({body:t.content,location:c,place:a,guid:t.guid,guidtgt:t.guidtgt,lifespan:r,islocal:e}).success(function(e){t.content=null}).error(function(e,t){swal("Post failed","Please complete the from correctly","error")})["catch"](function(e){})}},t.requestFetch=function(){o.fetch().success(function(e){t.posts=e})["catch"](function(e){})},t.updateGuidtgt=function(e,t){var n={guid:e,guidtgt:t};o.updateGuidtgt(n).success(function(e){})["catch"](function(e){})}}]),angular.module("app").service("PostsSvc",["$http",function(e){this.fetch=function(t){return e.get("/api/posts",t)},this.create=function(t){return t.devicetoken="0",e.post("/api/posts",t)},this.remove=function(t){return e.post("/api/posts/posts_delete",t)},this.updateGuidtgt=function(t){return e.post("/api/posts/update_guidtgt",t)}}]),angular.module("app").service("SessionSvc",["$http",function(e){this.fetch=function(){return e.get("/api/sessions")},this.enter=function(t){return t.devicetoken="0",e.post("/api/sessions",t)},this.remove=function(t){var n={guid:t};return e.post("/api/sessions/delete",n)},this.updateWatchLocation=function(t,n,o,i){var a={nw_lat:t.lat,nw_lon:t.lon,se_lat:n.lat,se_lon:n.lon,center_lat:o.lat,center_lon:o.lon},s=JSON.stringify(a),l={watchloc:s,guid:i};return e.post("/api/sessions/update_session",l)},this.updateCoupling=function(t,n){var o={guid:t,guidtgt:n};return e.post("/api/sessions/update_coupling",o)}}]),angular.module("app").directive("appMap",["PostsSvc","UtilSvc","ConfigSvc","SessionSvc","$compile","$timeout",function(e,t,n,o,i,a){var s=function(t,n,s){function l(){window.localStorage.latitude=D.getCenter().lat(),window.localStorage.longitude=D.getCenter().lng()}function r(){var e=D.getBounds(),t=e.getNorthEast(),n=e.getSouthWest();O=new google.maps.LatLng(t.lat(),n.lng()),N=new google.maps.LatLng(n.lat(),t.lng())}function c(){var e=D.getBounds(),n=e.getNorthEast(),i=e.getSouthWest();O={lat:n.lat(),lon:i.lng()},N={lat:i.lat(),lon:n.lng()};var a;a=t.postLocation.lat<O.lat&&t.postLocation.lat>N.lat&&t.postLocation.lon<N.lon&&t.postLocation.lon>O.lon?{lat:t.postLocation.lat,lon:t.postLocation.lon}:{lat:D.getCenter().lat(),lon:D.getCenter().lng()},o.updateWatchLocation(O,N,a,t.guid)}function g(e){o.fetch().success(function(n){for(var o=0;o<n.length;o++){var i=n[o];if(i.guid!=t.guid){var s=angular.fromJson(i.watchloc),l=angular.fromJson(e.location);if(r(),s.center_lat<O.lat()&&s.center_lat>N.lat()&&s.center_lon<N.lng()&&s.center_lon>O.lng()&&l.lat<s.nw_lat&&l.lat>s.se_lat&&l.lon<s.se_lon&&l.lon>s.nw_lon){var c=new google.maps.LatLng(s.center_lat,s.center_lon),g=40*Math.random()+40,p="Blink.gif",u={url:p,size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(.5*g+5,.5*g+14),scaledSize:new google.maps.Size(g,g)};!function(e){var t={position:c,map:D,title:"Receiver",icon:e,optimized:!1},n=new google.maps.Marker(t),o=1200;a(function(e){return function(){e.setMap(null),e=null}}(n),o)}(u)}}}})}function p(){for(var e,t=0;e=H[t];t++){var n=new Date,o=n.getTime(),i=e.post.lifeend-o;0>=i&&d(e.post._id)}}function u(){function n(n){for(var o=0;o<n.length;o++){var a=n[o],s=angular.fromJson(a.location),l=new google.maps.LatLng(s.lat,s.lon);if(r(),l.lat()<O.lat()&&l.lat()>N.lat()&&l.lng()<N.lng()&&l.lng()>O.lng()){for(var c,g=0;c=H[g];g++){var p=a._id==c.post._id;if(p){if(W){d(a._id);break}if(c.post.guidtgt==a.guidtgt){a=null;break}d(a._id);break}}if(null!=a){var u={position:l,map:D,title:"Bubble",icon:j},c=new google.maps.Marker(u);H.push({marker:c,post:a});var m=v(a.guid,a.guidtgt),f=a.islocal,y=t,w=y.$new(!0),h=function(n,o,a,s,l){return function(){var r={pixelOffset:new google.maps.Size(-39.5,16),disableAutoPan:!0},c=new google.maps.InfoWindow(r),g=new Date,p=g.getTime(),u=a.lifeend-p>=0?a.lifeend-p:0,m=(u/a.lifespan).toFixed(2);o.msg=a.body,o.postlife=u,o.postguid=a.guid,o.postguidtgt=a.guidtgt,o.postcouplestatus=s,o.postlifepercentage=m,o.postlocalstatus=l;var d="<div map-msg></div>",f=i(d)(o);c.setContent(f[0]),google.maps.event.addListener(c,"closeclick",function(){a.guid==t.guid&&swal({title:"Are you sure?",text:"You will not be able to recover this imaginary file!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(t){if(t)e.remove(a),swal("Deleted!","Your imaginary file has been deleted.","success");else{var i=new Date,s=i.getTime(),l=a.lifeend-s>=0?a.lifeend-s:0,r=(l/a.lifespan).toFixed(2);r>0&&(o.postlifepercentage=r,c.open(D,n))}})}),c.open(D,n)}}(c,w,a,m,f);h()}}}}p(),W=U!=t.guidtgt,U=t.guidtgt,e.fetch().success(n)["catch"](function(e){})}function m(e){var t=new google.maps.LatLng(e.lat,e.lon);if(r(),t.lat()<O.lat()&&t.lat()>N.lat()&&t.lng()<N.lng()&&t.lng()>O.lng()){var n={position:t,map:D,animation:google.maps.Animation.DROP,title:"UserPin",icon:X},o=new google.maps.Marker(n);a(function(e){return function(){e.setMap(null)}}(o),2e3)}}function d(e){for(var t,n=0;t=H[n];n++)if(e==t.post._id){t.marker.setMap(null),H.splice(n,1);break}}function f(e){var t=new google.maps.LatLng(e.lat,e.lon);y(t),w(t),c()}function y(e){for(var t,n=0;t=G[n];n++)t.setMap(null);G=[];var t=new google.maps.Marker({position:e,map:D,icon:V});G.push(t)}function w(e){t.$emit("set:loc",e);var n=new google.maps.Geocoder;n.geocode({latLng:e},function(e,n){try{t.$emit("set:place",e[1].formatted_address)}catch(o){swal("","Location does not exists"),t.$emit("set:place","Location does not exists")}})}function v(e,n){var o=t.guidtgt==e,i=t.guid==n,a=t.guid==e,s="0"!=t.guidtgt;return a&&s?2:o&&i?4:o&&!i?1:!o&&i?2:0}function h(){var e=document.getElementById("map-search-toggle");D.controls[google.maps.ControlPosition.TOP_LEFT].push(e)}function _(){var e=document.getElementById("map-btn-curr");D.controls[google.maps.ControlPosition.TOP_RIGHT].push(e)}function b(){var e=document.getElementById("map-posting");D.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(e)}function T(){var e=document.getElementById("map-btn-submit");D.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(e)}function S(){var e=document.getElementById("map-time-slider");D.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(e)}function L(){var e=document.getElementById("pac-input");D.controls[google.maps.ControlPosition.TOP_LEFT].push(e);var t=new google.maps.places.SearchBox(e);google.maps.event.addListener(t,"places_changed",function(){var e=t.getPlaces();if(0!=e.length){var n=e[0],o={lat:n.geometry.location.lat(),lon:n.geometry.location.lng()};f(o),window.localStorage.latitude=n.geometry.location.latitude,window.localStorage.longitude=n.geometry.location.longitude,D.panTo(n.geometry.location),D.setZoom(16)}})}function k(){google.maps.event.addListener(E,"click",function(e){var t={lat:e.latLng.lat(),lon:e.latLng.lng()};f(t)})}function P(){google.maps.event.addListener(E,"center_changed",function(){l()})}function C(){google.maps.event.addListener(E,"bounds_changed",function(){r()})}function M(){google.maps.event.addListener(E,"dragend",function(){u(),c()})}function $(){google.maps.event.addListener(E,"resize",function(){u(),c()})}function z(){google.maps.event.addListener(E,"zoom_changed",function(){u(),c()})}function x(){J=isNaN(window.localStorage.latitude)||isNaN(window.localStorage.longitude)?0!=t.userLocation.lat&&0!=t.userLocation.lon?new google.maps.LatLng(t.userLocation.lat,t.userLocation.lon):new google.maps.LatLng(34.05,-118.24):new google.maps.LatLng(window.localStorage.latitude,window.localStorage.longitude),R={center:J,zoom:15,scrollwheel:!0,streetViewControl:!1,mapTypeControl:!1,panControl:!1,zoomControl:!1,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,F]},mapTypeId:F}}function A(){function e(e){}function t(e){google.maps.event.trigger(this,"drawXMarker",e)}function o(e){google.maps.event.trigger(this,"drawCurrLocationMarker",e)}function i(){google.maps.event.trigger(this,"updateAndDrawPosts")}function a(e){google.maps.event.trigger(this,"drawResponses",e)}function s(e){google.maps.event.trigger(this,"unDrawPost",e)}E=new google.maps.Map(n[0],R),e.prototype=E,e.prototype.drawXMarker=t,e.prototype.drawCurrLocationMarker=o,e.prototype.updateAndDrawPosts=i,e.prototype.drawResponses=a,e.prototype.unDrawPost=s,D=new e,google.maps.event.addListener(D,"drawXMarker",function(e){f(e)}),google.maps.event.addListener(D,"drawCurrLocationMarker",function(e){m(e)}),google.maps.event.addListener(D,"updateAndDrawPosts",function(){u()}),google.maps.event.addListener(D,"drawResponses",function(e){g(e)}),google.maps.event.addListener(D,"unDrawPost",function(e){d(e)})}function B(){var e,t=[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#6195a0"}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"geometry",stylers:[{lightness:"0"},{saturation:"0"},{color:"#f5f5f2"},{gamma:"1"}]},{featureType:"landscape.man_made",elementType:"all",stylers:[{lightness:"-3"},{gamma:"1.00"}]},{featureType:"landscape.natural.terrain",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#bae5ce"},{visibility:"on"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45},{visibility:"simplified"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#fac9a9"},{visibility:"simplified"}]},{featureType:"road.highway",elementType:"labels.text",stylers:[{color:"#4e4e4e"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#787878"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"transit.station.airport",elementType:"labels.icon",stylers:[{hue:"#0a00ff"},{saturation:"-77"},{gamma:"0.57"},{lightness:"0"}]},{featureType:"transit.station.rail",elementType:"labels.text.fill",stylers:[{color:"#43321e"}]},{featureType:"transit.station.rail",elementType:"labels.icon",stylers:[{hue:"#ff6c00"},{lightness:"4"},{gamma:"0.75"},{saturation:"-68"}]},{featureType:"water",elementType:"all",stylers:[{color:"#eaf6f8"},{visibility:"on"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#c7eced"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{lightness:"-49"},{saturation:"-53"},{gamma:"0.79"}]}],n=[{featureType:"all",elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#3e606f"},{weight:2},{gamma:.84}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry",stylers:[{weight:.6},{color:"#182a3d"},{visibility:"on"}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#1a528b"},{visibility:"simplified"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#406d80"},{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#2c5a71"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#66a9ee"},{lightness:-37},{visibility:"on"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{visibility:"on"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{visibility:"on"}]},{featureType:"road.highway",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"geometry.stroke",stylers:[{lightness:"-11"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#ff7e4e"},{visibility:"simplified"}]},{featureType:"transit.station.airport",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#182a3d"}]}],o=new Date,i=o.getHours();e=4>i||i>19?n:t;var a={name:"Custom Style"},s=new google.maps.StyledMapType(e,a);D.mapTypes.set(F,s)}function I(){void 0===D&&(x(),A(),B()),t.$emit("set:map",D),h(),L(),_(),b(),T(),S(),k(),P(),M(),$(),z(),C(),a(function(){l(),r(),c(),u()},800)}var D,E,O,N,R,J,W,F="custom_style",G=[],H=[],U="0",j={url:"Default_Marker.png",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(1,1)},V={url:"X_Marker.png",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)},X={url:"Current_Location_Marker.png",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(20,33)};I(),t.initSession(),y(J),w(J)};return{restrict:"A",template:'<div id="map-canvas"></div>',replace:!0,link:s}}]),angular.module("app").directive("mapMsg",["$timeout","SessionSvc","PostsSvc",function(e,t,n){var o=function(o,i,a){function s(){var e=o.postguid,a=o.$parent.guid,s=o.$parent.guidtgt;i.children().on("click",function(){var i=e;if(e==a){if("0"==o.$parent.guidtgt)return;i="0"}e==s&&(i="0"),o.$emit("set:guidtgt",i),t.updateCoupling(a,i).then(function(e){});var l={guid:a,guidtgt:i};n.updateGuidtgt(l).then(function(e){})})}function l(){var e=o.postlife+"ms",t=i.children().children(".postlifebar");t.css("-o-animation-duration",e),t.css("-moz-animation-duration",e),t.css("-ms-animation-duration",e),t.css("-webkit-animation-duration",e),t.css("animation-duration",e),o.postlifepercentage>.95?(t.css("-o-animation-name","postlifeanim_a"),t.css("-moz-animation-name","postlifeanim_a"),t.css("-ms-animation-name","postlifeanim_a"),t.css("-webkit-animation-name","postlifeanim_a"),t.css("animation-name","postlifeanim_a")):o.postlifepercentage<=.95&&o.postlifepercentage>.9?(t.css("-o-animation-name","postlifeanim_b"),t.css("-moz-animation-name","postlifeanim_b"),t.css("-ms-animation-name","postlifeanim_b"),t.css("-webkit-animation-name","postlifeanim_b"),t.css("animation-name","postlifeanim_b")):o.postlifepercentage<=.9&&o.postlifepercentage>.85?(t.css("-o-animation-name","postlifeanim_c"),t.css("-moz-animation-name","postlifeanim_c"),t.css("-ms-animation-name","postlifeanim_c"),postlifebar_css=t.css("-webkit-animation-name","postlifeanim_c"),postlifebar_css=t.css("animation-name","postlifeanim_c")):o.postlifepercentage<=.85&&o.postlifepercentage>.75?(t.css("-o-animation-name","postlifeanim_d"),t.css("-moz-animation-name","postlifeanim_d"),t.css("-ms-animation-name","postlifeanim_d"),t.css("-webkit-animation-name","postlifeanim_d"),t.css("animation-name","postlifeanim_d")):o.postlifepercentage<=.75&&o.postlifepercentage>.6?(t.css("-o-animation-name","postlifeanim_e"),t.css("-moz-animation-name","postlifeanim_e"),t.css("-ms-animation-name","postlifeanim_e"),t.css("-webkit-animation-name","postlifeanim_e"),t.css("animation-name","postlifeanim_e")):o.postlifepercentage<=.6&&o.postlifepercentage>.5?(t.css("-o-animation-name","postlifeanim_f"),t.css("-moz-animation-name","postlifeanim_f"),t.css("-ms-animation-name","postlifeanim_f"),t.css("-webkit-animation-name","postlifeanim_f"),t.css("animation-name","postlifeanim_f")):o.postlifepercentage<=.5&&o.postlifepercentage>.3?(t.css("-o-animation-name","postlifeanim_g"),t.css("-moz-animation-name","postlifeanim_g"),t.css("-ms-animation-name","postlifeanim_g"),t.css("-webkit-animation-name","postlifeanim_g"),t.css("animation-name","postlifeanim_g")):o.postlifepercentage<=.3&&o.postlifepercentage>.2?(t.css("-o-animation-name","postlifeanim_h"),t.css("-moz-animation-name","postlifeanim_h"),t.css("-ms-animation-name","postlifeanim_h"),t.css("-webkit-animation-name","postlifeanim_h"),t.css("animation-name","postlifeanim_h")):o.postlifepercentage<=.2&&o.postlifepercentage>.1?(t.css("-o-animation-name","postlifeanim_i"),t.css("-moz-animation-name","postlifeanim_i"),t.css("-ms-animation-name","postlifeanim_i"),t.css("-webkit-animation-name","postlifeanim_i"),t.css("animation-name","postlifeanim_i")):(t.css("-o-animation-name","postlifeanim_j"),t.css("-moz-animation-name","postlifeanim_j"),t.css("-ms-animation-name","postlifeanim_j"),t.css("-webkit-animation-name","postlifeanim_j"),t.css("animation-name","postlifeanim_j"))}function r(){var e=$(".gm-style-iw"),t=e.prev();t.children(":nth-child(2)").css({display:"none"}),t.children(":nth-child(4)").css({display:"none"}),t.children(":nth-child(3)").find("div").children().css({"box-shadow":"0 1px 6px rgba(178, 178, 178, 0.6)","z-index":"1",border:"0px"})}function c(){var e=$(".gm-style-iw"),t=e.next();t.css({opacity:"0.8",right:"20px",top:"20px"})}o.get_localstatus=function(e){return e?"local-text":"non-local-text"},o.get_coupling=function(e){return 4==e?"coupling coupling-couple":1==e?"coupling coupling-ilikeyou":2==e?"coupling coupling-youlikei":"coupling coupling-none"},angular.element(document).ready(function(){e(s,100),e(l,10),e(r,10),e(c,10)})};return{restrict:"A",templateUrl:"./templates/window.html",link:o}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJjb25maWcuc3ZjLmpzIiwicm91dGVzLmpzIiwidXRpbC5zdmMuanMiLCJnZW5lcmFsL21haW4uanMiLCJwb3N0cy9wb3N0cy5jdHJsLmpzIiwicG9zdHMvcG9zdHMuc3ZjLmpzIiwic2Vzc2lvbnMvc2Vzc2lvbnMuc3ZjLmpzIiwic29ja2V0cy93ZWJzb2NrZXRzLmpzIiwibWFwcy9tYXAuZGlyZWN0aXZlLmpzIiwibWFwcy9tc2cuZGlyZWN0aXZlLmpzIiwiYXBwLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb250cm9sbGVyIiwiU2Vzc2lvblN2YyIsIlV0aWxTdmMiLCJDb25maWdTdmMiLCIkcm9vdFNjb3BlIiwiJHNjb3BlIiwiJHdpbmRvdyIsIiRodHRwIiwiJHRpbWVvdXQiLCJ3aW5kb3ciLCJvbmJlZm9yZXVubG9hZCIsImUiLCJyZW1vdmUiLCJndWlkIiwic3VjY2VzcyIsInJlcyIsImVyciIsIm9ucGFnZXNob3ciLCJpbml0U2Vzc2lvbiIsIm1hcCIsInVwZGF0ZUFuZERyYXdQb3N0cyIsIm9ucGFnZWhpZGUiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJ2aXNpYmlsaXR5U3RhdGUiLCJ3ZWJraXRWaXNpYmxlIiwid2Via2l0SGlkZGVuIiwiZ2V0Q3VyckxvY1N1Y2Nlc3MiLCJwb3MiLCJjcmQiLCJjb29yZHMiLCJnb29nbGVMb2MiLCJnb29nbGUiLCJtYXBzIiwiTGF0TG5nIiwibGF0aXR1ZGUiLCJsb25naXR1ZGUiLCJ1c2VyTG9jYXRpb24iLCJsYXQiLCJsb24iLCJsb2NhdGlvbiIsImxuZyIsImxvY2F0aW9uSlNPTiIsIkpTT04iLCJzdHJpbmdpZnkiLCJib3VuZHMiLCJnZXRCb3VuZHMiLCJuZSIsImdldE5vcnRoRWFzdCIsInN3IiwiZ2V0U291dGhXZXN0IiwiY3VycmVudF9tYXBfbnciLCJjdXJyZW50X21hcF9zZSIsImN1cnJlbnRfbWFwX2NlbnRlciIsImxvY2FsU3RvcmFnZSIsIndhdGNobG9jIiwibndfbGF0IiwibndfbG9uIiwic2VfbGF0Iiwic2VfbG9uIiwiY2VudGVyX2xhdCIsImNlbnRlcl9sb24iLCJ3YXRjaGxvY0pTT04iLCJzZXNzaW9uIiwiZ3VpZHRndCIsImVudGVyIiwiZ2V0Q3VyckxvY0Vycm9yIiwic3dhbCIsIm9wdGlvbnMiLCJlbmFibGVIaWdoQWNjdXJhY3kiLCJ0aW1lb3V0IiwibWF4aW11bUFnZSIsIm5hdmlnYXRvciIsImdlb2xvY2F0aW9uIiwiZ2V0Q3VycmVudFBvc2l0aW9uIiwidGl0bGUiLCJ0ZXh0IiwidGltZXIiLCJzaG93Q29uZmlybUJ1dHRvbiIsImdldEd1aWQiLCJwYWdlSWQiLCJwb3N0IiwibmF2Q29sbGFwc2VkIiwidGltZXZhbHVlIiwibWF4SW5zdGFudExpZmVTcGFuIiwidG9nZ2xlU2VhcmNoTG9jYXRpb24iLCJ0b2dnbGVUaW1lU2xpZGVyIiwiZ2V0RWxlbWVudEJ5SWQiLCJvbmtleXByZXNzIiwiZXZlbnQiLCJ3aGljaCIsIiQiLCJzdWJtaXQiLCJvbmZvY3VzIiwib25ibHVyIiwiY2xpY2siLCJ0b2dnbGVDbGFzcyIsIiRhcHBseSIsInVybCIsImhvc3RuYW1lIiwibG9jYWwiLCJ3ZWJfc29ja2V0IiwicG9ydCIsImxvY2FsX2lwIiwiZGVwbG95X2RucyIsImNvbm5lY3QiLCJjb25uZWN0aW9uIiwiV2ViU29ja2V0Iiwib25vcGVuIiwic2VuZCIsIm9uY2xvc2UiLCJvbm1lc3NhZ2UiLCJwYXlsb2FkIiwicGFyc2UiLCJkYXRhIiwiJGJyb2FkY2FzdCIsInR5cGUiLCIkb24iLCJfIiwiZHJhd1Jlc3BvbnNlcyIsImZyb21Kc29uIiwiZHJhd0N1cnJMb2NhdGlvbk1hcmtlciIsInBvc3RpZCIsInVuRHJhd1Bvc3QiLCJ1cGRhdGVkU2Vzc2lvbiIsImlzTW9iaWxlIiwidXNlckFnZW50IiwibWF0Y2giLCJtb3ZlVG9DdXJyZW50TG9jYXRpb24iLCJjdXJyZW50UGFnZUlkIiwiZHJhd1hNYXJrZXIiLCJwYW5UbyIsInNldFpvb20iLCJtb3ZlVG9Qb3N0TG9jYXRpb24iLCJsYXREZWx0YSIsImxhdERlbHRhX2NlbnRlcjJub3J0aCIsIk1hdGgiLCJhYnMiLCJwb3N0TG9jYXRpb24iLCJsYXREZWx0YV9jZW50ZXIyc291dGgiLCJjZW50ZXJMb2MiLCJnZXRDZW50ZXIiLCJjb2xsYXBzZSIsInBsYWNlIiwicG9zdHBsYWNlIiwiY29uc3RhbnQiLCJ3ZWJfc29ja2V0X3NlY3VyZSIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwid2hlbiIsInRlbXBsYXRlVXJsIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsInNlcnZpY2UiLCJzdmMiLCJ0aGlzIiwiZGVnMnJhZCIsImRlZyIsIlBJIiwiZ2V0RGlzdGFuY2VGcm9tTGF0TG9uSW5LbSIsImxhdDEiLCJsb24xIiwibGF0MiIsImxvbjIiLCJSIiwiZExhdCIsImRMb24iLCJhIiwic2luIiwiY29zIiwiYyIsImF0YW4yIiwic3FydCIsImQiLCJtYXBSYW5nZSIsInZhbHVlIiwibG93MSIsImhpZ2gxIiwibG93MiIsImhpZ2gyIiwiczQiLCJmbG9vciIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyaW5nIiwicnVuIiwiUG9zdHNTdmMiLCIkZG9jdW1lbnQiLCIkZW1pdCIsInBvc3RzIiwicmVxdWVzdEZldGNoIiwiYWRkUG9zdCIsImNvbnRlbnQiLCJsb2NhbF9zdGF0dXMiLCJwb3N0TG9jYXRpb25Gcm9tVXNlckxvY2F0aW9uIiwicmVsYXRpdmVMaWZlU3BhbiIsImNoYXJMZW4iLCJsZW5ndGgiLCJjcmVhdGUiLCJib2R5IiwibGlmZXNwYW4iLCJpc2xvY2FsIiwiZXJyb3IiLCJzdGF0dXMiLCJmZXRjaCIsInVwZGF0ZUd1aWR0Z3QiLCJteWd1aWQiLCJ1cGRhdGVzIiwiZ3VpZE9iaiIsImdldCIsImRldmljZXRva2VuIiwidXBkYXRlV2F0Y2hMb2NhdGlvbiIsInVwZGF0ZWRzZXNzaW9uIiwidXBkYXRlQ291cGxpbmciLCJ1cGRhdGVkZ3VpZHRndCIsImRpcmVjdGl2ZSIsIiRjb21waWxlIiwibGluayIsInNjb3BlIiwiZWxlbWVudCIsImF0dHJzIiwidXBkYXRlRGVmYXVsdExvY2F0aW9uIiwidXBkYXRlQm91bmRzIiwic2Vzc2lvbnMiLCJpIiwid2F0Y2hfbG9jYXRpb24iLCJwb3N0X2xvY2F0aW9uIiwicmFuZG9tU2l6ZSIsInVybE5hbWUiLCJpbWFnZUxpc3RlbmVyIiwic2l6ZSIsIlNpemUiLCJvcmlnaW4iLCJQb2ludCIsImFuY2hvciIsInNjYWxlZFNpemUiLCJtYXJrZXJPcHRpb25zIiwicG9zaXRpb24iLCJpY29uIiwib3B0aW1pemVkIiwibWFya2VyIiwiTWFya2VyIiwicmVjZWl2ZXJfbWFya2VyX2xpZmVzcGFuIiwib2xkX21hcmtlciIsInNldE1hcCIsImNsZWFudXAiLCJqIiwibWFya2Vyc09uTWFwIiwiY3VycmVudERhdGUiLCJEYXRlIiwiY3VycmVudFRpbWVNaWxsaSIsImdldFRpbWUiLCJsaWZlIiwibGlmZWVuZCIsIl9pZCIsImRyYXdQb3N0cyIsImlzQWxyZWFkeURyYXduIiwiaXNHdWlkdGd0Q2hhbmdlZCIsImltYWdlUG9zdCIsInB1c2giLCJjb3VwbGluZ19zdGF0dXMiLCJjYWxjdWxhdGVDb3VwbGluZyIsInBhcmVudCIsImNoaWxkIiwiJG5ldyIsIm9wZW5JbmZvV2luZG93IiwiY2hpbGRfc2NvcGUiLCJpbmZvV2luZG93T3B0aW9ucyIsInBpeGVsT2Zmc2V0IiwiZGlzYWJsZUF1dG9QYW4iLCJpbmZvV2luZG93IiwiSW5mb1dpbmRvdyIsInBvc3RsaWZlIiwibGlmZXBlcmNlbnRhZ2UiLCJ0b0ZpeGVkIiwibXNnIiwicG9zdGd1aWQiLCJwb3N0Z3VpZHRndCIsInBvc3Rjb3VwbGVzdGF0dXMiLCJwb3N0bGlmZXBlcmNlbnRhZ2UiLCJwb3N0bG9jYWxzdGF0dXMiLCJjb21waWxlZCIsInNldENvbnRlbnQiLCJhZGRMaXN0ZW5lciIsInNob3dDYW5jZWxCdXR0b24iLCJjb25maXJtQnV0dG9uQ29sb3IiLCJjb25maXJtQnV0dG9uVGV4dCIsImNsb3NlT25Db25maXJtIiwiaXNDb25maXJtIiwib3BlbiIsInByZXZHdWlkdGd0IiwiZHJhd0Ryb3BEb3duIiwiYW5pbWF0aW9uIiwiQW5pbWF0aW9uIiwiRFJPUCIsImltYWdlVXNlckxvZ2luIiwiayIsInNwbGljZSIsImRyYXdBbmRTZXRQbGFjZSIsImRyYXdIZWxwZXJNYXJrZXIiLCJzZXRQbGFjZSIsImhlbHBlck1hcmtlcnMiLCJpbWFnZVRhcmdldCIsImdlb2NvZGVyIiwiR2VvY29kZXIiLCJnZW9jb2RlIiwibGF0TG5nIiwicmVzdWx0cyIsImZvcm1hdHRlZF9hZGRyZXNzIiwicG9zdF9ndWlkIiwicG9zdF9ndWlkdGd0IiwiaXNQb2ludGluZ1lvdSIsImlzUG9pbnRpbmdNZSIsImlzTXlQb3N0IiwiaXNQb2ludGluZ1NvbWVvbmUiLCJzZXRVSVNlYXJjaExvY2F0aW9uVG9nZ2xlIiwibWFwU2VhcmNoVG9nZ2xlIiwiY29udHJvbHMiLCJDb250cm9sUG9zaXRpb24iLCJUT1BfTEVGVCIsInNldFVJTW92ZVRvQ3VyckxvY0J0biIsImN1cnJMb2NCdG4iLCJUT1BfUklHSFQiLCJzZXRVSVBvc3RGb3JtIiwicG9zdEZvcm0iLCJCT1RUT01fQ0VOVEVSIiwic2V0VUlQb3N0QnRuIiwicG9zdEJ0biIsInNldFVJVGltZVNsaWRlciIsInRpbWVTbGlkZXIiLCJzZXRVSVNlYXJjaEJveCIsImlucHV0Iiwic2VhcmNoQm94IiwicGxhY2VzIiwiU2VhcmNoQm94IiwiZ2V0UGxhY2VzIiwiZ2VvbWV0cnkiLCJzZXRFdmVudENsaWNrIiwibWFwX29yaWdpbiIsInNldEV2ZW50Q2VudGVyQ2hhbmdlZCIsInNldEV2ZW50Qm91bmRzQ2hhbmdlZCIsInNldEV2ZW50RHJhZ0VuZCIsInNldEV2ZW50UmVzaXplIiwic2V0RXZlbnRab29tQ2hhbmdlZCIsImluaXRpYWxNYXBEYXRhIiwiaW5pdGlhbE1hcENlbnRlciIsImlzTmFOIiwibWFwT3B0aW9ucyIsImNlbnRlciIsInpvb20iLCJzY3JvbGx3aGVlbCIsInN0cmVldFZpZXdDb250cm9sIiwibWFwVHlwZUNvbnRyb2wiLCJwYW5Db250cm9sIiwiem9vbUNvbnRyb2wiLCJtYXBUeXBlQ29udHJvbE9wdGlvbnMiLCJtYXBUeXBlSWRzIiwiTWFwVHlwZUlkIiwiUk9BRE1BUCIsIkNMT1VEX01BUF9JRCIsIm1hcFR5cGVJZCIsInNldE1hbnVhbEV2ZW50cyIsIkNsb3VkTWFwIiwiaGFuZGxlRHJhd1hNYXJrZXIiLCJ0cmlnZ2VyIiwiaGFuZGxlRHJhd0N1cnJMb2NhdGlvbk1hcmtlciIsImhhbmRsZVVwZGF0ZUFuZERyYXdQb3N0cyIsImhhbmRsZURyYXdSZXNwb25zZXMiLCJoYW5kbGVVbkRyYXdQb3N0IiwiTWFwIiwicHJvdG90eXBlIiwic2V0U3R5bGVGb3JNYXAiLCJmZWF0dXJlT3B0cyIsImZlYXR1cmVPcHRzX2RheSIsImZlYXR1cmVUeXBlIiwiZWxlbWVudFR5cGUiLCJzdHlsZXJzIiwiY29sb3IiLCJ2aXNpYmlsaXR5IiwibGlnaHRuZXNzIiwic2F0dXJhdGlvbiIsImdhbW1hIiwiaHVlIiwiZmVhdHVyZU9wdHNfbmlnaHQiLCJ3ZWlnaHQiLCJjdXJyZW50VGltZSIsImN1cnJlbnRIb3VyIiwiZ2V0SG91cnMiLCJzdHlsZWRNYXBPcHRpb25zIiwibmFtZSIsImN1c3RvbU1hcFR5cGUiLCJTdHlsZWRNYXBUeXBlIiwibWFwVHlwZXMiLCJzZXQiLCJpbml0TWFwIiwicmVzdHJpY3QiLCJ0ZW1wbGF0ZSIsInJlcGxhY2UiLCJ1cGRhdGVHdWlkVGFyZ2V0IiwiJHBhcmVudCIsIm15Z3VpZHRndCIsImNoaWxkcmVuIiwib24iLCJ1cGRhdGVfZ3VpZHRndCIsInRoZW4iLCJkb2MiLCJ1cGRhdGVQb3N0VGltZXIiLCJkdXJhdGlvbiIsInBvc3RiYXJsaWZlIiwiY3NzIiwicG9zdGxpZmViYXJfY3NzIiwiY3VzdG9taXplSW5mb1dpbmRvdyIsIml3T3V0ZXIiLCJpd0JhY2tncm91bmQiLCJwcmV2IiwiZGlzcGxheSIsImZpbmQiLCJib3gtc2hhZG93Iiwiei1pbmRleCIsImJvcmRlciIsImN1c3RvbWl6ZUNsb3NlQnRuIiwiaXdDbG9zZUJ0biIsIm5leHQiLCJvcGFjaXR5IiwicmlnaHQiLCJ0b3AiLCJnZXRfbG9jYWxzdGF0dXMiLCJnZXRfY291cGxpbmciLCJyZWFkeSJdLCJtYXBwaW5ncyI6IkFBQ0FBLFFBQUFDLE9BQUEsT0FDQSxVQUNBLFlBQ0EsY0NIQUQsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLG1CQUFBLGFBQUEsVUFBQSxZQUFBLGFBQUEsU0FBQSxVQUFBLFFBQUEsV0FBQSxTQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQU1BQyxPQUFBQyxlQUFBLFNBQUFDLEdBQ0FWLEVBQUFXLE9BQUFQLEVBQUFRLE1BQ0FDLFFBQUEsU0FBQUMsTUFEQWQsU0FJQSxTQUFBZSxPQUtBUCxPQUFBUSxXQUFBLFNBQUFOLEdBQ0FOLEVBQUFhLGNBQ0FiLEVBQUFjLEtBQ0FkLEVBQUFjLElBQUFDLHNCQUdBWCxPQUFBWSxXQUFBLFNBQUFWLEdBQ0FWLEVBQUFXLE9BQUFQLEVBQUFRLE1BQ0FDLFFBQUEsU0FBQUMsTUFEQWQsU0FJQSxTQUFBZSxPQU1BTSxTQUFBQyxpQkFBQSxtQkFBQSxXQUNBLFdBQUFELFNBQUFFLGlCQUNBLGNBQUFGLFNBQUFFLGlCQUNBLGFBQUFGLFNBQUFFLGlCQUNBLGlCQUFBRixTQUFBRSxpQkFFQW5CLEVBQUFhLGNBQ0FiLEVBQUFjLEtBQ0FkLEVBQUFjLElBQUFDLHVCQUVBLFVBQUFFLFNBQUFFLGlCQUNBLGFBQUFGLFNBQUFFLGlCQUNBLFlBQUFGLFNBQUFFLGlCQUNBLGdCQUFBRixTQUFBRSxrQkFFQXZCLEVBQUFXLE9BQUFQLEVBQUFRLE1BQ0FDLFFBQUEsU0FBQUMsTUFEQWQsU0FJQSxTQUFBZSxRQU9BTSxTQUFBQyxpQkFBQSx5QkFBQSxXQUNBRCxTQUFBRyxlQUVBcEIsRUFBQWEsY0FDQWIsRUFBQWMsS0FDQWQsRUFBQWMsSUFBQUMsc0JBRUFFLFNBQUFJLGNBRUF6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UixHQUFValUsRUFBRSxnQkFFWjBVLEVBQWFULEVBQVFVLE1BVXpCRCxHQUFXWixLQUNUYyxRQUFTLE1BQ1RDLE1BQU8sT0FBUUMsSUFBSyxTRHpwRGhDL00sRUFBQWdOLGdCQUFBLFNBQUF6TyxHQUNBLE1BQUFBLEdBQ0EsYUFFQSxrQkFZQXlCLEVBQUFpTixhQUFBLFNBQUF2SyxHQUVBLE1BQUEsSUFBQUEsRUFDQSwyQkFFQSxHQUFBQSxFQUNBLDZCQUVBLEdBQUFBLEVBQ0EsNkJBR0EsMEJBT0F0USxRQUFBNk4sUUFBQXJNLFVBQUFzWixNQUFBLFdBRUFwYSxFQUFBc1ksRUFBQSxLQUVBdFksRUFBQThZLEVBQUEsSUFFQTlZLEVBQUFtWixFQUFBLElBRUFuWixFQUFBNFosRUFBQSxNQ21uREksUUFDSXpCLFNBQVUsSUFDVnJQLFlBQWEsMEJBQ2JtRSxLQUFNQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG5cdCduZ1JvdXRlJyxcblx0J25nQW5pbWF0ZScsXG5cdCd1aS5zbGlkZXInXG5dKTtcbiIsIlxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignQXBwbGljYXRpb25DdHJsJywgZnVuY3Rpb24oU2Vzc2lvblN2YywgVXRpbFN2YywgQ29uZmlnU3ZjLCAkcm9vdFNjb3BlLCAkc2NvcGUsICR3aW5kb3csICRodHRwLCAkdGltZW91dCl7XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIElOSVRJQUxcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgd2luZG93Lm9uYmVmb3JldW5sb2FkID0gZnVuY3Rpb24oZSkge1xuICAgIFx0U2Vzc2lvblN2Yy5yZW1vdmUoJHNjb3BlLmd1aWQpXG4gICAgXHQuc3VjY2VzcyhmdW5jdGlvbihyZXMpe1xuICAgIFx0XHQvLyBoYW5kbGUgc3VjY2Vzc1xuICAgIFx0fSlcbiAgICBcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgIFx0XHQvLyBoYW5kbGUgZXJyb3JcbiAgICBcdH0pO1xuXHR9O1xuXG5cdHdpbmRvdy5vbnBhZ2VzaG93ID0gZnVuY3Rpb24oZSkge1xuXHRcdCRzY29wZS5pbml0U2Vzc2lvbigpO1xuXHRcdGlmICgkc2NvcGUubWFwKVxuXHQgIFx0XHQkc2NvcGUubWFwLnVwZGF0ZUFuZERyYXdQb3N0cygpO1xuXHR9O1xuXG5cdHdpbmRvdy5vbnBhZ2VoaWRlID0gZnVuY3Rpb24oZSkge1xuICAgIFx0U2Vzc2lvblN2Yy5yZW1vdmUoJHNjb3BlLmd1aWQpXG4gICAgXHQuc3VjY2VzcyhmdW5jdGlvbihyZXMpe1xuICAgIFx0XHQvLyBoYW5kbGUgc3VjY2Vzc1xuICAgIFx0fSlcbiAgICBcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgIFx0XHQvLyBoYW5kbGUgZXJyb3JcbiAgICBcdH0pO1xuXHR9O1xuXG5cdC8vIHNlc3Npb24gaW4gYW5kIG91dCBldmVudHNcblx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIiwgZnVuY3Rpb24oKSB7XG5cdCAgaWYgKGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAndmlzaWJsZScgfHwgXG5cdCAgXHRkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ21velZpc2libGUnIHx8IFxuXHQgIFx0ZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09ICdtc1Zpc2libGUnIHx8XG5cdCAgXHRkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ3dlYmtpdFZpc2libGUnKVxuXHQgIHtcblx0ICBcdCRzY29wZS5pbml0U2Vzc2lvbigpO1xuXHQgIFx0aWYgKCRzY29wZS5tYXApXG5cdCAgXHRcdCRzY29wZS5tYXAudXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cdCAgfSBcblx0ICBlbHNlIGlmIChkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ2hpZGRlbicgfHwgXG5cdCAgXHRkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ21vekhpZGRlbicgfHwgXG5cdCAgXHRkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ21zSGlkZGVuJyB8fFxuXHQgIFx0ZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09ICd3ZWJraXRIaWRkZW4nKVxuXHQgIHtcblx0ICBcdFNlc3Npb25TdmMucmVtb3ZlKCRzY29wZS5ndWlkKVxuXHQgIFx0LnN1Y2Nlc3MoZnVuY3Rpb24ocmVzKXtcbiAgICBcdFx0Ly8gaGFuZGxlIHN1Y2Nlc3NcbiAgICBcdH0pXG4gICAgXHQuY2F0Y2goZnVuY3Rpb24oZXJyKXtcbiAgICBcdFx0Ly8gaGFuZGxlIGVycm9yXG4gICAgXHR9KTtcblx0ICB9XG5cdH0pO1xuXG5cdC8vIHdlYmtpdCBzZXNzaW9uIGluIGFuZCBvdXQgZXZlbnRzXG5cdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ3ZWJraXR2aXNpYmlsaXR5Y2hhbmdlXCIsIGZ1bmN0aW9uKCkge1xuXHQgIGlmIChkb2N1bWVudC53ZWJraXRWaXNpYmxlKVxuXHQgIHtcblx0ICBcdCRzY29wZS5pbml0U2Vzc2lvbigpO1xuXHQgIFx0aWYgKCRzY29wZS5tYXApXG5cdCAgXHRcdCRzY29wZS5tYXAudXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cdCAgfSBcblx0ICBlbHNlIGlmIChkb2N1bWVudC53ZWJraXRIaWRkZW4pXG5cdCAge1xuXHQgIFx0U2Vzc2lvblN2Yy5yZW1vdmUoJHNjb3BlLmd1aWQpXG5cdCAgXHQuc3VjY2VzcyhmdW5jdGlvbihyZXMpe1xuICAgIFx0XHQvLyBoYW5kbGUgc3VjY2Vzc1xuICAgIFx0fSlcbiAgICBcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgIFx0XHQvLyBoYW5kbGUgZXJyb3JcbiAgICBcdH0pO1xuXHQgIH1cblx0fSwgZmFsc2UpO1xuXG5cdCRzY29wZS5pbml0U2Vzc2lvbiA9IGZ1bmN0aW9uKCl7XG5cdFx0aWYgKCRzY29wZS5tYXAgPT0gJ3VuZGVmaW5lZCcgfHwgJHNjb3BlLm1hcCA9PSAnbnVsbCcgfHwgISRzY29wZS5tYXApXG5cdFx0XHRyZXR1cm47XG5cblx0XHRmdW5jdGlvbiBnZXRDdXJyTG9jU3VjY2Vzcyhwb3MpIHtcdFxuXHRcdFx0Ly8vLy8vLy8vLy8vLy8vLy8vIFBIWVNJQ0FMIExPQ0FUSU9OXG5cdFx0XHQvLyDrp6jsspjsnYzsl5DripQg7Jyg7KCA7J2YIOyLpOygnCDsnITsuZgo7JWx7JeQIOyeheyepe2WiOydhOuVjOydmCDsnITsuZgp7JmAIOyEvO2EsCDtj6zsp4DshZjsnYQg6rCZ7J20IOuztOuCtOqzoCxcblx0XHRcdC8vIOyEvO2EsCDtj6zsp4DshZjsnYAg6rOE7IaNIOyXheuNsOydtO2KuCDrkJjslrTslbwg7ZWc64ukLlxuXHQgICAgICAgIHZhciBjcmQgPSBwb3MuY29vcmRzO1xuXG5cdCAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoY3JkLmxhdGl0dWRlLCBjcmQubG9uZ2l0dWRlKTtcblxuXHQgICAgICAgIC8vIHNhdmUgdGhlIHVzZXIgbG9jYXRpb24gaW50byBhcHBsaWNhdGlvbiBzY29wZSB2YXJpYWJsZVxuXHQgICAgICAgICRzY29wZS51c2VyTG9jYXRpb24gPSB7XG5cdCAgICAgICAgXHRsYXQ6IGNyZC5sYXRpdHVkZSxcblx0ICAgICAgICBcdGxvbjogY3JkLmxvbmdpdHVkZVxuXHQgICAgICAgIH07XG5cblx0ICAgICAgICB2YXIgbG9jYXRpb24gPSB7XG5cdCAgICBcdFx0bGF0Omdvb2dsZUxvYy5sYXQoKSxcblx0ICAgIFx0XHRsb246Z29vZ2xlTG9jLmxuZygpXG5cdCAgICBcdH07XG5cdCAgICBcdHZhciBsb2NhdGlvbkpTT04gPSBKU09OLnN0cmluZ2lmeShsb2NhdGlvbik7XG5cdCAgICBcdC8vY29uc29sZS5sb2coXCJzZXR0aW5nIGxvY2F0aW9uXCIsIGxvY2F0aW9uSlNPTik7XG5cblx0ICAgIFx0Ly8vLy8vLy8vLy8vLy8vLy8vIFdBVENIIExPQ0FUSU9OXG5cdCAgICBcdHZhciBib3VuZHMgPSAkc2NvcGUubWFwLmdldEJvdW5kcygpO1xuXHQgICAgICAgIHZhciBuZSA9IGJvdW5kcy5nZXROb3J0aEVhc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBub3J0aC1lYXN0IGNvcm5lclxuXHQgICAgICAgIHZhciBzdyA9IGJvdW5kcy5nZXRTb3V0aFdlc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBzb3V0aC13ZXN0IGNvcmRlclxuXHQgICAgICAgIC8vWW91IGdldCBub3J0aC13ZXN0IGFuZCBzb3V0aC1lYXN0IGNvcm5lcnMgZnJvbSB0aGUgdHdvIGFib3ZlOlxuXG5cdCAgICAgICAgdmFyIGN1cnJlbnRfbWFwX253ID0geyBcblx0ICAgICAgICAgICAgbGF0OiBuZS5sYXQoKSwgXG5cdCAgICAgICAgICAgIGxvbjogc3cubG5nKClcblx0ICAgICAgICB9O1xuXHQgICAgICAgIHZhciBjdXJyZW50X21hcF9zZSA9IHtcblx0ICAgICAgICAgICAgbGF0OiBzdy5sYXQoKSwgXG5cdCAgICAgICAgICAgIGxvbjogbmUubG5nKClcblx0ICAgICAgICB9O1xuXG5cdCAgICAgICAgdmFyIGN1cnJlbnRfbWFwX2NlbnRlciA9IHtcblx0ICAgICAgICBcdGxhdDp3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlLFxuXHQgICAgICAgIFx0bG9uOndpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlXG5cdCAgICBcdH07XG5cblx0ICAgICAgICB2YXIgd2F0Y2hsb2MgPSB7XG5cdCAgICAgICAgICAgIG53X2xhdCAgICA6IGN1cnJlbnRfbWFwX253LmxhdCxcblx0ICAgICAgICAgICAgbndfbG9uICAgIDogY3VycmVudF9tYXBfbncubG9uLFxuXHQgICAgICAgICAgICBzZV9sYXQgICAgOiBjdXJyZW50X21hcF9zZS5sYXQsXG5cdCAgICAgICAgICAgIHNlX2xvblx0ICA6IGN1cnJlbnRfbWFwX3NlLmxvbixcblx0ICAgICAgICAgICAgY2VudGVyX2xhdDogY3VycmVudF9tYXBfY2VudGVyLmxhdCxcblx0ICAgICAgICAgICAgY2VudGVyX2xvbjogY3VycmVudF9tYXBfY2VudGVyLmxvblxuXHQgICAgICAgIH1cblxuICAgICAgICBcdHZhciB3YXRjaGxvY0pTT04gPSBKU09OLnN0cmluZ2lmeSh3YXRjaGxvYyk7XG4gICAgICAgIFx0Ly9jb25zb2xlLmxvZyhcInNldHRpbmcgd2F0Y2hsb2NcIiwgd2F0Y2hsb2NKU09OKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vIExPQ0FUSU9OIFVQREFURSBXSVRIIFNFU1NJT04gRU5URVJcbiAgICAgICAgICAgIC8v7Jes6riw7IScIOu5hOuPmeq4sOyggeycvOuhnCDsnKDsoIDsnZgg66Gc7LyA7J207IWY7J2EIOyWu+qzoCDshLjshZjsnYQg67O064K87IiYIOyeiOuLpC5cblx0XHRcdHZhciBzZXNzaW9uID0ge1xuXHRcdFx0XHRndWlkdGd0IDogJHNjb3BlLmd1aWR0Z3QsXG5cdFx0XHRcdGd1aWQgICAgOiAkc2NvcGUuZ3VpZCxcblx0XHRcdFx0bG9jYXRpb246IGxvY2F0aW9uSlNPTixcblx0XHRcdFx0d2F0Y2hsb2M6IHdhdGNobG9jSlNPTlxuXHRcdFx0fTtcblx0XHRcdFNlc3Npb25TdmMuZW50ZXIoc2Vzc2lvbilcblx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uKHJlcyl7XG4gICAgXHRcdC8vIGhhbmRsZSBzdWNjZXNzXG5cdCAgICBcdH0pXG5cdCAgICBcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xuXHQgICAgXHRcdC8vIGhhbmRsZSBlcnJvclxuXHQgICAgXHR9KTsgLy8g7ISc67KE7JeQ7IScIOycoOyggOqwgCDrk6TslrTsmLTsnYQg7JWM66aw64ukLlxuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiBnZXRDdXJyTG9jRXJyb3IoZXJyKSB7XG4gICAgICAgIFx0c3dhbChcIlwiLCBcIk5lZWQgdG8gdHVybiBvbiBsb2NhdGlvbiBzZXJ2aWNlIGZvciBwcm9wZXIgdXNlLlwiKTtcbiAgICAgICAgICAgIC8vY29uc29sZS53YXJuKCdFUlJPUignICsgZXJyLmNvZGUgKyAnKTogJyArIGVyci5tZXNzYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGluaXQgbWFwIGFuZCBwbGFjZSBzb21lIG1hcmtlcnMsIHNvIGV2ZXJ5dGhpbmcgc3RhcnQgd2l0aCB0aGlzIGZ1bmN0aW9uLlxuICAgICAgICB2YXIgb3B0aW9ucyA9IHtcblx0XHQgIGVuYWJsZUhpZ2hBY2N1cmFjeTogZmFsc2UsXG5cdFx0ICB0aW1lb3V0OiA1MDAwLFxuXHRcdCAgbWF4aW11bUFnZTogMFxuXHRcdH07XG5cdCAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGdldEN1cnJMb2NTdWNjZXNzLCBnZXRDdXJyTG9jRXJyb3IsIG9wdGlvbnMpO1xuXHRcdHN3YWwoeyAgIHRpdGxlOiBcIlwiLCAgIHRleHQ6IFwiUmV0cmVpdmluZyBjdXJybmV0IGxvY2F0aW9uLi5cIiwgICB0aW1lcjogMzUwMCwgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UgfSk7XG5cdH07XG5cbiAgICAvLyBsb2FkIGFuZCBzZXQgbGF0ZXN0IGd1aWRcblx0aWYgKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZCA9PSAndW5kZWZpbmVkJyB8fCBcblx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWQgPT0gJ251bGwnIHx8XG5cdFx0IXdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZClcblx0e1xuXHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZCA9IFV0aWxTdmMuZ2V0R3VpZCgpO1xuXHR9XG5cdCRzY29wZS5ndWlkID0gd2luZG93LmxvY2FsU3RvcmFnZS5ndWlkO1xuXG5cdC8vIGxvYWQgYW5kIHNldCBsYXRlc3QgZ3VpZHRndFxuXHRpZiAod2luZG93LmxvY2FsU3RvcmFnZS5ndWlkdGd0ID09ICd1bmRlZmluZWQnIHx8IFxuXHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZHRndCA9PSAnbnVsbCcgfHxcblx0XHQhd2luZG93LmxvY2FsU3RvcmFnZS5ndWlkdGd0KVxuXHR7XG5cdFx0d2luZG93LmxvY2FsU3RvcmFnZS5ndWlkdGd0ID0gXCIwXCI7XG5cdH1cblx0JHNjb3BlLmd1aWR0Z3QgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWR0Z3Q7IC8vIGludGVyZXN0ZWQgb3Bwb25lbnQgZ3VpZCBudW1iZXJcblxuXHQkc2NvcGUucGFnZUlkID0geyBcblx0XHRwb3N0IDogMCxcblx0fTtcblxuXHQkc2NvcGUubmF2Q29sbGFwc2VkID0gdHJ1ZTtcblxuXHQvLyB2YWx1ZSBmcm9tIHRpbWUgc2xpZGVyIGluIFVJXG5cdC8vIGRlZmF1bHQgaXMgbWF4IGluc3RhbnQgbGlmZSBzcGFuXG4gICAgJHNjb3BlLnRpbWV2YWx1ZSA9IENvbmZpZ1N2Yy5tYXhJbnN0YW50TGlmZVNwYW47XG5cblx0Ly8gdXNlcidzIGN1cnJlbnQgbG9jYXRpb24gc3RvcmFnZVxuXHQkc2NvcGUudXNlckxvY2F0aW9uID0ge1xuXHRcdGxhdDogMC4wLFxuXHRcdGxvbjogMC4wXG5cdH07XG5cblx0JHNjb3BlLnRvZ2dsZVNlYXJjaExvY2F0aW9uID0gZmFsc2U7XG5cdCRzY29wZS50b2dnbGVUaW1lU2xpZGVyID0gZmFsc2U7XG5cblx0Ly8gZXZlbnQgaGFuZGVyIGZvciBtYXAgVUlzXG5cdCR0aW1lb3V0KGZ1bmN0aW9uKCl7XG5cdFx0Ly8gZW5hYmxlcyBlbnRlciBrZXkgdG8gc3VibWl0IHBvc3QgZm9ybVxuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtcG9zdGluZycpLm9ua2V5cHJlc3MgPSBmdW5jdGlvbihldmVudCl7XG5cdFx0XHQvL2NvbnNvbGUubG9nKFwiSW5zaWRlIGtleXByZXNzXCIsZXZlbnQud2hpY2gpO1xuXHRcdFx0aWYgKGV2ZW50LndoaWNoID09ICcxMycpe1xuXHRcdFx0XHQvL2NvbnNvbGUubG9nKFwiZW50ZXIgcHJlc3NlZFwiKTtcblx0XHRcdFx0JCgnZm9ybSNtYXAtcG9zdGluZy1mb3JtJykuc3VibWl0KCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1wb3N0aW5nJykub25mb2N1cyA9IGZ1bmN0aW9uKGV2ZW50KXtcblx0XHRcdC8vY29uc29sZS5sb2coXCJvbiBmb2N1c1wiKTtcblx0XHRcdCRzY29wZS50b2dnbGVUaW1lU2xpZGVyID0gdHJ1ZTtcblx0XHR9XG5cblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLXBvc3RpbmcnKS5vbmJsdXIgPSBmdW5jdGlvbihldmVudCl7XG5cdFx0XHQvL2NvbnNvbGUubG9nKFwib24gYmx1clwiKTtcblx0XHRcdCRzY29wZS50b2dnbGVUaW1lU2xpZGVyID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0JCgnLm5hdi1idXJnZXInKS5jbGljayhmdW5jdGlvbigpIHtcblx0XHQgICQoJy5uYXYtYnVyZ2VyJykudG9nZ2xlQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdCAgLy8kKCcuY29udHJvbHMnKS50b2dnbGVDbGFzcygnYWN0aXZlJyk7XG5cdFx0ICAkc2NvcGUudG9nZ2xlU2VhcmNoTG9jYXRpb24gPSAhJHNjb3BlLnRvZ2dsZVNlYXJjaExvY2F0aW9uO1xuXHRcdCAgJHNjb3BlLiRhcHBseSgpO1xuXHRcdH0pO1xuXG5cdH0pO1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBTT0NLRVRcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHR2YXIgdXJsO1xuXHR2YXIgaG9zdG5hbWUgPSBkb2N1bWVudC5sb2NhdGlvbi5ob3N0bmFtZTtcblxuXHRpZiAoaG9zdG5hbWUgPT0gQ29uZmlnU3ZjLmxvY2FsKXtcblx0XHR1cmwgPSBDb25maWdTdmMud2ViX3NvY2tldCArIENvbmZpZ1N2Yy5sb2NhbCArICc6JyArIENvbmZpZ1N2Yy5wb3J0O1xuXHR9XG5cdGVsc2UgaWYgKGhvc3RuYW1lID09IENvbmZpZ1N2Yy5sb2NhbF9pcCkge1xuXHRcdHVybCA9IENvbmZpZ1N2Yy53ZWJfc29ja2V0ICsgQ29uZmlnU3ZjLmxvY2FsX2lwICsgJzonICsgQ29uZmlnU3ZjLnBvcnQ7IC8vIGRldmVsb3BtZXQgb24gc29ja2V0IGxvY2FsbHkgXG5cdH1cblx0ZWxzZSB7XG5cdFx0dXJsID0gQ29uZmlnU3ZjLndlYl9zb2NrZXQgKyBDb25maWdTdmMuZGVwbG95X2RuczsgLy8gcHJvZHVjdGlvbiBkZXBsb3kgdmVyc2lvbiAtIHN0aWxsIGRlYnVnIG1vZGVcblx0XHQvL3VybCA9IENvbmZpZ1N2Yy53ZWJfc29ja2V0X3NlY3VyZSArIENvbmZpZ1N2Yy5kZXBsb3lfZG5zOyAvLyBwcm9kdWN0aW9uIGRlcGxveSB2ZXJzaW9uIC0gc3RpbGwgZGVidWcgbW9kZVxuXHR9XG5cblx0Lyog6rCc67Cc6rO87KCV7J20IOuBneuCmOqzoCDrsLDtj6zsi5zsl5DripQg7JyE67aA67aE7J2EIOyngOyasOqzoCDslYTrnpgg7L2U65Oc66eMIOuCqOqyqOuPhCDrkJzri6QuXG5cdHVybCA9ICd3c3M6Ly9mcm96ZW4tYmFkbGFuZHMtODY0OS5oZXJva3VhcHAuY29tJztcblx0Ki9cblx0dmFyIGNvbm5lY3QgPSBmdW5jdGlvbigpIHtcblx0XHRjb25uZWN0aW9uID0gbmV3IFdlYlNvY2tldCh1cmwpO1xuXG5cdFx0Y29ubmVjdGlvbi5vbm9wZW4gPSBmdW5jdGlvbigpe1xuXG5cdFx0XHQvLyBzZW5kIGd1aWQgdG8gc2VydmVyIGZvciB3cyBpZGVudGlmaWNhdGlvblxuXHRcdFx0Y29ubmVjdGlvbi5zZW5kKCRzY29wZS5ndWlkKTtcblx0XHRcdC8vY29uc29sZS5sb2coJ1dlYlNvY2tldCBjb25uZWN0ZWQnKTtcblx0XHR9O1xuXG5cdFx0Y29ubmVjdGlvbi5vbmNsb3NlID0gZnVuY3Rpb24oKXtcblxuXHRcdFx0Ly9jb25zb2xlLmxvZygnV2ViU29ja2V0IGNsb3NlZC4gUmVjb25lY3RpbmcuLi4nKTtcblx0XHRcdCR0aW1lb3V0KGNvbm5lY3QsIDIwMDApO1xuXHRcdH07XG5cblx0XHRjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGUpe1xuXHRcdFx0Ly9jb25zb2xlLmxvZygnYnJvYWRjYXN0IG1zZyBmcm9tIHNlcnZlcjonLCBlKTtcblx0XHRcdHZhciBwYXlsb2FkID0gSlNPTi5wYXJzZShlLmRhdGEpO1xuXG5cdFx0XHQvKlxuXHRcdFx0XHR3czpuZXdfcG9zdCAgICAtIOyDiOuhnOyatCDtj6zsiqTtirjqsIAg7Jis65287JmU7J2E65WMIGZyb250LWVuZOyXkOyEnCDrp7XsnbQg64uk7IucIOyXheuNsOydtO2KuCDtlbTslbwg65Cc64uk6rOgIOyVjOugpOykgOuLpCFcblx0XHRcdFx0d3M6bmV3X3Nlc3Npb24gLSBzZXNzaW9u7J20IOyDiOuhnCDrk6TslrTsmKTrqbQg65Cc64uk6rOgIOyVjOugpOykgOuLpCFcblx0XHRcdFx0d3M6cmVtb3ZlX3Bvc3QgLSDtj6zsiqTtirjqsIAg7Iuc6rCE7J20IOuLpCDrkJjslrTshJwg7IKs65287KeI65WMIVxuXHRcdFx0XHTrp6TsmrDspJHsmpQhIFxuXHRcdFx0Ki9cblx0XHRcdCRyb290U2NvcGUuJGJyb2FkY2FzdCgnd3M6JyArIHBheWxvYWQudHlwZSwgcGF5bG9hZC5kYXRhKTtcblx0XHR9O1xuXHR9O1xuXHRjb25uZWN0KCk7XG5cblx0Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBTT0NLRVQgQlJPQURDQVNUIFJFQ0VJVkVSXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0Ly8gYXMgc2VydmVyIHNvY2tldCBzZW5kICd3czpuZXdfcG9zdCcgLCB3ZSBjYW4gdXBkYXRlIHRoZSBtYXAhXG5cdCRzY29wZS4kb24oJ3dzOm5ld19wb3N0JywgZnVuY3Rpb24oXywgcG9zdCl7XG5cdFx0Ly8gdXBkYXRlIHBvc3RzIG9uIG1hcFxuXHRcdCRzY29wZS5tYXAudXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cblx0XHQvLyBzaG93IHJlc3BvbnNpdmUgdXNlcnMgb25seSB0byB0aGUgdXNlciB3aG8gd3JvdGUgdGhpcyBwb3N0XG5cdFx0aWYgKHBvc3QuZ3VpZCA9PSAkc2NvcGUuZ3VpZClcblx0XHR7XG5cdFx0XHQkc2NvcGUubWFwLmRyYXdSZXNwb25zZXMocG9zdCk7XG5cdFx0fVxuXHR9KTtcblxuXHQvLyBhcyBzZXJ2ZXIgc29ja2V0IHNlbmQgJ3dzOm5ld19wb3N0JyAsIHdlIGNhbiB1cGRhdGUgdGhlIG1hcCFcblx0JHNjb3BlLiRvbignd3M6bmV3X3Nlc3Npb24nLCBmdW5jdGlvbihfLCBzZXNzaW9uKXtcblx0XHR2YXIgbG9jYXRpb24gPSBhbmd1bGFyLmZyb21Kc29uKHNlc3Npb24ubG9jYXRpb24pO1xuXHRcdCRzY29wZS5tYXAuZHJhd0N1cnJMb2NhdGlvbk1hcmtlcihsb2NhdGlvbik7XG5cblx0fSk7XG5cblx0Ly8gd2hlbiBzZXJ2ZXIgcmVtb3ZlIHRoZSBwb3N0IGFmdGVyIHRpbWUgZm9yIGxvbmdlciBvbmVzLCBcblx0Ly8gdXBkYXRlIG1hcCB3aXRoIGNvcmVzcG9uZGluZyBpbmZvXG5cdCRzY29wZS4kb24oJ3dzOnJlbW92ZV9wb3N0JywgZnVuY3Rpb24oXywgcG9zdGlkKXtcblx0XHQkc2NvcGUubWFwLnVuRHJhd1Bvc3QocG9zdGlkKTtcblx0fSk7XG5cblx0JHNjb3BlLiRvbignd3M6dXBkYXRlX2d1aWR0Z3QnLCBmdW5jdGlvbihfLCB1cGRhdGVkU2Vzc2lvbil7XG5cdFx0Ly8gdXBkYXRlIHBvc3RzIG9uIG1hcFxuXHRcdCRzY29wZS5tYXAudXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cdH0pO1xuXG5cdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQVBQTElDQVRJT04gTEVWRUwgRlVOQ1RJT05TXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0Ly8gc2VlIGlmIGl0cyBtb2JpbGUgcGhvbmVcblx0JHNjb3BlLmlzTW9iaWxlID0gZnVuY3Rpb24oKXtcblx0XHRpZiggbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvQW5kcm9pZC9pKVxuXHRcdCB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC93ZWJPUy9pKVxuXHRcdCB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUGhvbmUvaSlcblx0XHQgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBhZC9pKVxuXHRcdCB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUG9kL2kpXG5cdFx0IHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0JsYWNrQmVycnkvaSlcblx0XHQgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvV2luZG93cyBQaG9uZS9pKVxuXHRcdCApe1xuXHRcdCAgICByZXR1cm4gdHJ1ZTtcblx0XHQgIH1cblx0XHQgZWxzZSB7XG5cdFx0ICAgIHJldHVybiBmYWxzZTtcblx0XHQgIH1cblx0fTtcblxuXHQvKiBtb3ZlIHRvIGN1cnJlbnQgbG9jYXRpb24gKi9cblx0JHNjb3BlLm1vdmVUb0N1cnJlbnRMb2NhdGlvbiA9IGZ1bmN0aW9uKCl7XG5cdFx0ZnVuY3Rpb24gZ2V0Q3VyckxvY1N1Y2Nlc3MocG9zKSB7XG4gICAgICAgICAgICAvKiBtYWtlIHN1cmUgdG8gY2hlY2sgd2UgYXJlIG9uIHBvc3QgcGFnZSB3aXRoIG1hcCBmaXJzdCAqL1xuICAgICAgICAgICAgaWYgKCRzY29wZS5jdXJyZW50UGFnZUlkICE9ICRzY29wZS5wYWdlSWQucG9zdClcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIHZhciBjcmQgPSBwb3MuY29vcmRzO1xuXG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gY3JkLmxhdGl0dWRlO1xuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUgPSBjcmQubG9uZ2l0dWRlO1xuXG4gICAgICAgICAgICB2YXIgbG9jYXRpb24gPSB7XG4gICAgICAgICAgICBcdGxhdDogY3JkLmxhdGl0dWRlLCBcbiAgICAgICAgICAgIFx0bG9uOiBjcmQubG9uZ2l0dWRlXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBkcmF3IGRyb3AgZG93biB1c2VyIHBvc2l0aW9uXG4gICAgICAgICAgIFx0JHNjb3BlLm1hcC5kcmF3Q3VyckxvY2F0aW9uTWFya2VyKGxvY2F0aW9uKTtcblxuICAgICAgICAgICBcdC8vIGRyYXcgeCBtYXJrZXJcblx0ICAgICAgICAkc2NvcGUubWFwLmRyYXdYTWFya2VyKGxvY2F0aW9uKTtcblxuXHQgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxvY2F0aW9uLmxhdCwgbG9jYXRpb24ubG9uKTtcblxuXHQgICAgICAgIC8vIG1vdmUgdG8gdGhlIGxvY2F0aW9uIGFuZCB6b29tIGludG8gcmlnaHQgYW1vdW50XG4gICAgICAgICAgICAkc2NvcGUubWFwLnBhblRvKGdvb2dsZUxvYylcbiAgICAgICAgICAgICRzY29wZS5tYXAuc2V0Wm9vbSgxNSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRDdXJyTG9jRXJyb3IoZXJyKSB7XG4gICAgICAgIFx0c3dhbChcIlwiLCBcIk5lZWQgdG8gdHVybiBvbiBsb2NhdGlvbiBzZXJ2aWNlIGZvciBwcm9wZXIgdXNlLlwiKTtcbiAgICAgICAgICAgIC8vY29uc29sZS53YXJuKCdFUlJPUignICsgZXJyLmNvZGUgKyAnKTogJyArIGVyci5tZXNzYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGluaXQgbWFwIGFuZCBwbGFjZSBzb21lIG1hcmtlcnMsIHNvIGV2ZXJ5dGhpbmcgc3RhcnQgd2l0aCB0aGlzIGZ1bmN0aW9uLlxuICAgICAgICB2YXIgb3B0aW9ucyA9IHtcblx0XHQgIGVuYWJsZUhpZ2hBY2N1cmFjeTogdHJ1ZSxcblx0XHQgIHRpbWVvdXQ6IDgwMDAsXG5cdFx0ICBtYXhpbXVtQWdlOiAwXG5cdFx0fTtcbiAgICAgICAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihnZXRDdXJyTG9jU3VjY2VzcywgZ2V0Q3VyckxvY0Vycm9yLCBvcHRpb25zKTtcblxuICAgICAgICBzd2FsKHsgICB0aXRsZTogXCJcIiwgICB0ZXh0OiBcIk1vdmluZyB0byBjdXJyZW50IGxvY2F0aW9uLi5cIiwgICB0aW1lcjogMTUwMCwgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UgfSk7XG5cdH07XG5cblx0JHNjb3BlLm1vdmVUb1Bvc3RMb2NhdGlvbiA9IGZ1bmN0aW9uKCl7XG5cdFx0dmFyIGxhdERlbHRhID0gMC4wO1xuXG5cdFx0aWYgKCRzY29wZS5pc01vYmlsZSgpKXtcblx0XHRcdHZhciBib3VuZHMgPSAkc2NvcGUubWFwLmdldEJvdW5kcygpO1xuXHQgICAgICAgIHZhciBuZSA9IGJvdW5kcy5nZXROb3J0aEVhc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBub3J0aC1lYXN0IGNvcm5lclxuXHQgICAgICAgIHZhciBzdyA9IGJvdW5kcy5nZXRTb3V0aFdlc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBzb3V0aC13ZXN0IGNvcmRlclxuXHQgICAgICAgIGN1cnJlbnRfbWFwX253ID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhuZS5sYXQoKSwgc3cubG5nKCkpO1xuXHQgICAgICAgIGN1cnJlbnRfbWFwX3NlID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhzdy5sYXQoKSwgbmUubG5nKCkpO1xuXG5cdCAgICAgICAgdmFyIGxhdERlbHRhX2NlbnRlcjJub3J0aCA9IDAuNSAqIE1hdGguYWJzKCRzY29wZS5wb3N0TG9jYXRpb24ubGF0IC0gY3VycmVudF9tYXBfbncubGF0KCkpO1xuXHQgICAgICAgIHZhciBsYXREZWx0YV9jZW50ZXIyc291dGggPSAwLjUgKiBNYXRoLmFicygkc2NvcGUucG9zdExvY2F0aW9uLmxhdCAtIGN1cnJlbnRfbWFwX3NlLmxhdCgpKTtcblxuXHQgICAgICAgIGlmIChsYXREZWx0YV9jZW50ZXIybm9ydGggPiBsYXREZWx0YV9jZW50ZXIyc291dGgpe1xuXHQgICAgICAgIFx0bGF0RGVsdGEgPSBsYXREZWx0YV9jZW50ZXIyc291dGg7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgIFx0bGF0RGVsdGEgPSBsYXREZWx0YV9jZW50ZXIybm9ydGg7XG5cdCAgICAgICAgfVxuXHRcdH1cblxuXHRcdHZhciBjZW50ZXJMb2MgPSAkc2NvcGUubWFwLmdldENlbnRlcigpO1xuXG5cdFx0dmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoJHNjb3BlLnBvc3RMb2NhdGlvbi5sYXQgKyBsYXREZWx0YSwgY2VudGVyTG9jLmxuZygpKTtcblx0XHQkc2NvcGUubWFwLnBhblRvKGdvb2dsZUxvYyk7XG5cdH07XG5cblx0JHNjb3BlLmNvbGxhcHNlID0gZnVuY3Rpb24oKXtcblx0XHQkc2NvcGUubmF2Q29sbGFwc2VkID0gdHJ1ZTtcblx0fTtcblxuXHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEdFTkVSQUwgQlJPQURDQVNUIFJFQ0VJVkVSXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAkc2NvcGUuJG9uKCdzZXQ6bWFwJywgZnVuY3Rpb24oXywgbWFwKXtcblx0XHQkc2NvcGUubWFwID0gbWFwO1xuXHR9KTtcblxuICAgICRzY29wZS4kb24oJ3NldDpndWlkdGd0JywgZnVuY3Rpb24oXywgZ3VpZHRndCl7XG5cdFx0JHNjb3BlLmd1aWR0Z3QgPSBndWlkdGd0O1xuXG5cdFx0Ly8gaXRzIHZlcnkgaW1wb3JhbnQgdG8gc2V0IGxvY2FsIHN0b3JhZ2UgZ3VpZHRndFxuXHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZHRndCA9IGd1aWR0Z3Q7XG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ3NldDpwYWdlY2hhbmdlJywgZnVuY3Rpb24oXywgcGFnZUlkKXtcblx0XHQkc2NvcGUuY3VycmVudFBhZ2VJZCA9IHBhZ2VJZDtcblx0fSk7XG5cblx0JHNjb3BlLiRvbignc2V0OmxvYycsIGZ1bmN0aW9uKF8sIGxvY2F0aW9uKXtcblx0XHR2YXIgbGF0ID0gbG9jYXRpb24ubGF0KCk7XG5cdFx0dmFyIGxvbiA9IGxvY2F0aW9uLmxuZygpO1xuXHRcdCRzY29wZS5wb3N0TG9jYXRpb24gPSB7XG5cdFx0XHRsYXQ6IGxhdCxcblx0XHRcdGxvbjogbG9uXG5cdFx0fTtcblx0fSk7XG5cblx0JHNjb3BlLiRvbignc2V0OnBsYWNlJywgZnVuY3Rpb24oXywgcGxhY2Upe1xuXHRcdC8vIEZvcmNpbmcgdGhlIHVwZGF0ZSB3aXRoICRhcHBseSgpIG1ldGhvZCBvbiAkc2NvcGVcblx0XHQvLyBwcm9ibGVtIHJlbGF0ZWQgbm90ZTogaHR0cDovL3d3dy5qZWZmcnlob3VzZXIuY29tL2luZGV4LmNmbS8yMDE0LzYvMi9Ib3ctZG8tSS1ydW4tY29kZS13aGVuLWEtdmFyaWFibGUtY2hhbmdlcy13aXRoLUFuZ3VsYXJKU1xuXHRcdCRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKXtcblx0XHRcdFx0JHNjb3BlLnBvc3RwbGFjZSA9IHBsYWNlO1xuXHRcdFx0fVxuXHRcdCk7XG5cdH0pO1xufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29uc3RhbnQoJ0NvbmZpZ1N2YycsIHtcblx0XCJ3ZWJfc29ja2V0XCJcdFx0OiBcIndzOi8vXCIsXG5cdFwid2ViX3NvY2tldF9zZWN1cmVcIiA6IFwid3NzOi8vXCIsXG5cdFwibG9jYWxcIlx0XHRcdFx0OiBcImxvY2FsaG9zdFwiLFxuXHRcImxvY2FsX2lwXCJcdFx0XHQ6IFwiMTkyLjE2OC4wLjRcIixcblx0Ly9cImRlcGxveV9kbnNcIlx0XHQ6IFwiY2xvdWR0YWxrLmhlcm9rdWFwcC5jb21cIixcblx0XCJkZXBsb3lfZG5zXCJcdFx0OiBcInRhbGtpcGlhLmNvbVwiLFxuXHRcInBvcnRcIlx0XHRcdFx0OiBcIjUwMDBcIixcblx0XCJtYXhJbnN0YW50TGlmZVNwYW5cIjogNTAwMCxcbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29uZmlnKGZ1bmN0aW9uICgkcm91dGVQcm92aWRlcil7XG5cdCRyb3V0ZVByb3ZpZGVyXG5cdC53aGVuKCcvJywgXG5cdFx0e1xuXHRcdFx0Y29udHJvbGxlcjogJ1Bvc3RzQ3RybCcsIFxuXHRcdFx0dGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL3Bvc3RzLmh0bWwnXG5cdFx0fSlcblx0Ly8gUmVkaXJlY3QgdG8gdGhlIHJvb3QgcGFnZS5cblx0Lm90aGVyd2lzZShcblx0XHR7XG4gICBcdFx0XHRyZWRpcmVjdFRvOiAnLydcblx0XHR9KTtcbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnVXRpbFN2YycsIGZ1bmN0aW9uKCl7XG5cdHZhciBzdmMgPSB0aGlzO1xuXG5cdHN2Yy5kZWcycmFkID0gZnVuY3Rpb24oZGVnKSB7XG5cdCAgcmV0dXJuIGRlZyAqIChNYXRoLlBJLzE4MCk7XG5cdH07XG5cblx0c3ZjLmdldERpc3RhbmNlRnJvbUxhdExvbkluS20gPSBmdW5jdGlvbiAobGF0MSxsb24xLGxhdDIsbG9uMikge1xuXHQgIHZhciBSID0gNjM3MTtcblx0ICB2YXIgZExhdCA9IHN2Yy5kZWcycmFkKGxhdDItbGF0MSk7XG5cdCAgdmFyIGRMb24gPSBzdmMuZGVnMnJhZChsb24yLWxvbjEpOyBcblx0ICB2YXIgYSA9IFxuXHQgICAgTWF0aC5zaW4oZExhdC8yKSAqIE1hdGguc2luKGRMYXQvMikgK1xuXHQgICAgTWF0aC5jb3Moc3ZjLmRlZzJyYWQobGF0MSkpICogTWF0aC5jb3Moc3ZjLmRlZzJyYWQobGF0MikpICogXG5cdCAgICBNYXRoLnNpbihkTG9uLzIpICogTWF0aC5zaW4oZExvbi8yKVxuXHQgICAgOyBcblx0ICB2YXIgYyA9IDIgKiBNYXRoLmF0YW4yKE1hdGguc3FydChhKSwgTWF0aC5zcXJ0KDEtYSkpOyBcblx0ICB2YXIgZCA9IFIgKiBjO1xuXHQgIHJldHVybiBkO1xuXHR9O1xuXG5cdHN2Yy5tYXBSYW5nZSA9IGZ1bmN0aW9uICh2YWx1ZSwgbG93MSwgaGlnaDEsIGxvdzIsIGhpZ2gyKSB7XG5cdCAgICByZXR1cm4gbG93MiArIChoaWdoMiAtIGxvdzIpICogKHZhbHVlIC0gbG93MSkgLyAoaGlnaDEgLSBsb3cxKTtcblx0fTtcblxuXHRzdmMuZ2V0R3VpZCA9IGZ1bmN0aW9uICgpIHtcblx0XHRmdW5jdGlvbiBzNCgpIHtcblx0XHQgICAgcmV0dXJuIE1hdGguZmxvb3IoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApXG5cdFx0ICAgICAgLnRvU3RyaW5nKDE2KVxuXHRcdCAgICAgIC5zdWJzdHJpbmcoMSk7XG5cdFx0fVxuXHQgIFx0cmV0dXJuIHM0KCkgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArIHM0KCkgKyBzNCgpO1xuXHR9O1xufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4ucnVuKGZ1bmN0aW9uKCRyb290U2NvcGUsICR0aW1lb3V0LCBTZXNzaW9uU3ZjKXtcblxuXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcci5jb250cm9sbGVyKCdQb3N0c0N0cmwnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHNjb3BlLCBDb25maWdTdmMsIFBvc3RzU3ZjLCBVdGlsU3ZjLCAkd2luZG93LCAkZG9jdW1lbnQsICR0aW1lb3V0KXtcclxyXHQvKiBlbWl0IGJyb2FkY2FzdCBmb3IgY3VycmVudCBwYWdlSWQgKi9cclx0JHNjb3BlLiRlbWl0KCdzZXQ6cGFnZWNoYW5nZScsICRzY29wZS5wYWdlSWQucG9zdCk7XHJcclx0JHNjb3BlLnBvc3RzID0gW107XHJcclx0LyogYXMgc2VydmVyIHRlbGxzIHRoZXJlIHdhcyBuZXcgcG9zdCwgbGV0cyByZS1sb2FkIGxpc3QgZGF0YSAqL1xyXHQkc2NvcGUuJG9uKCd3czpuZXdfcG9zdCcsIGZ1bmN0aW9uKF8sIHBvc3Qpe1xyXHRcdCRzY29wZS5yZXF1ZXN0RmV0Y2goKTtcclx0fSk7XHJcclx0JHNjb3BlLmFkZFBvc3QgPSBmdW5jdGlvbigpIHtcclx0XHQvKiBjaGVjayBpZiB0aGUgcG9zdCBjb250ZW50IGlzIHRoZXJlIC0gb25seSBmb3IgV0VCIGZvciBlbnRlciBidXR0b24gdG8gcG9zdCAqL1xyXHRcdGlmICghJHNjb3BlLmNvbnRlbnQpe1xyXHRcdFx0Lypjb25zb2xlLmxvZyhcIlVzZXIgYXR0ZW1wdGVkIHRvIHBvc3Qgd2l0aCAwIHdvcmRzLlwiKSovXHJcdFx0XHRyZXR1cm47XHJcdFx0fVxyXHJcdFx0LyogZ2V0IGF1dG9jb21wbGV0ZWQgcGxhY2UgYW5kIHJlc2V0KHNldCB0byB1bmRlZmluZWQpICovXHJcdFx0dmFyIHBsYWNlICAgID0gJHNjb3BlLnBvc3RwbGFjZTtcclx0XHR2YXIgbG9jYXRpb24gPSAkc2NvcGUucG9zdExvY2F0aW9uO1xyXHJcdFx0dmFyIGxvY2FsX3N0YXR1cztcclx0XHR2YXIgcG9zdExvY2F0aW9uRnJvbVVzZXJMb2NhdGlvbiA9IFV0aWxTdmMuZ2V0RGlzdGFuY2VGcm9tTGF0TG9uSW5LbShsb2NhdGlvbi5sYXQsIGxvY2F0aW9uLmxvbiwgJHNjb3BlLnVzZXJMb2NhdGlvbi5sYXQsICRzY29wZS51c2VyTG9jYXRpb24ubG9uKTtcclx0XHQvKiBpZiBsZXNzIHRoYW4gM2ttICovXHJcdFx0aWYgKHBvc3RMb2NhdGlvbkZyb21Vc2VyTG9jYXRpb24gPCAzKXtcclx0XHRcdGxvY2FsX3N0YXR1cyA9IHRydWU7XHJcdFx0fVxyXHRcdGVsc2Uge1xyXHRcdFx0bG9jYWxfc3RhdHVzID0gZmFsc2U7XHJcdFx0fVxyXHRcdFxyXHRcdHZhciBsb2NhdGlvbkpTT04gPSBKU09OLnN0cmluZ2lmeShsb2NhdGlvbik7XHJcclx0XHR2YXIgcmVsYXRpdmVMaWZlU3Bhbjtcclx0XHRpZiAoJHNjb3BlLnRpbWV2YWx1ZSA8PSBDb25maWdTdmMubWF4SW5zdGFudExpZmVTcGFuKXtcclx0XHRcdHZhciBjaGFyTGVuID0gJHNjb3BlLmNvbnRlbnQubGVuZ3RoO1xyXHRcdFx0aWYgKGNoYXJMZW4gPCA1KVxyXHRcdFx0e1xyXHRcdFx0XHRyZWxhdGl2ZUxpZmVTcGFuID0gNDAwMDtcclx0XHRcdH1cclx0XHRcdGVsc2Vcclx0XHRcdHtcclx0XHRcdFx0cmVsYXRpdmVMaWZlU3BhbiA9IGNoYXJMZW4gKiBVdGlsU3ZjLm1hcFJhbmdlKGNoYXJMZW4sIDUsIDIwLCA3MDAsIDQwMCk7XHJcdFx0XHR9XHJcdFx0fVxyXHRcdGVsc2Uge1xyXHRcdFx0cmVsYXRpdmVMaWZlU3BhbiA9ICRzY29wZS50aW1ldmFsdWU7XHJcdFx0fVxyXHJcdFx0UG9zdHNTdmMuY3JlYXRlKFxyXHRcdHtcclx0XHRcdGJvZHkgICAgOiAgJHNjb3BlLmNvbnRlbnQsXHJcdFx0XHRsb2NhdGlvbjogIGxvY2F0aW9uSlNPTixcclx0XHRcdHBsYWNlICAgOiAgcGxhY2UsXHJcdFx0XHRndWlkICAgIDogICRzY29wZS5ndWlkLFxyXHRcdFx0Z3VpZHRndCA6ICAkc2NvcGUuZ3VpZHRndCxcclx0XHRcdGxpZmVzcGFuOiAgcmVsYXRpdmVMaWZlU3Bhbixcclx0XHRcdGlzbG9jYWwgOiAgbG9jYWxfc3RhdHVzLFxyXHRcdH0pXHJcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24ocG9zdCl7XHJcdFx0XHRcdFx0XHJcdFx0XHQvKiByZXNldCBpbnB1dCBmb3JtcyAqL1xyXHRcdFx0JHNjb3BlLmNvbnRlbnQgID0gbnVsbDtcclx0XHR9KVxyXHRcdC5lcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMpe1xyXHRcdFx0c3dhbChcIlBvc3QgZmFpbGVkXCIsIFwiUGxlYXNlIGNvbXBsZXRlIHRoZSBmcm9tIGNvcnJlY3RseVwiLCBcImVycm9yXCIpO1xyXHRcdH0pXHJcdFx0LmNhdGNoKGZ1bmN0aW9uKGVycil7XHJcdFx0XHQvKiBoYW5kbGUgZXJyb3IgKi9cclx0XHR9KTtcclx0fTtcclxyXHQvKiBhcyBzZXJ2ZXIgdGVsbHMgdGhlcmUgd2FzIG5ldyBwb3N0LCBsZXRzIHJlLWxvYWQgbGlzdCBkYXRhICovXHJcdCRzY29wZS5yZXF1ZXN0RmV0Y2ggPSBmdW5jdGlvbigpIHtcclx0XHRQb3N0c1N2Yy5mZXRjaCgpXHJcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24ocG9zdHMpe1xyXHRcdFx0Lypjb25zb2xlLmxvZygnR290IFBvc3RzOicsIHBvc3RzKTsgKi9cclx0XHRcdCRzY29wZS5wb3N0cyA9IHBvc3RzO1xyXHRcdH0pXHJcdFx0LmNhdGNoKGZ1bmN0aW9uKGVycil7XHJcdFx0XHQvKiBlcnJvciBoYW5kbGUgKi9cclx0XHR9KTtcclx0fTtcclxyXHQvKiB1cGRhdGUgZ3VpZCBvZiBwb3N0ICovXHJcdCRzY29wZS51cGRhdGVHdWlkdGd0ID0gZnVuY3Rpb24obXlndWlkLCBndWlkdGd0KSB7XHJcdFx0dmFyIHVwZGF0ZXMgPSB7XHJcdFx0XHRndWlkICAgIDogbXlndWlkLFxyXHRcdFx0Z3VpZHRndCA6IGd1aWR0Z3Rcclx0XHR9O1xyXHJcdFx0Lypjb25zb2xlLmxvZyhcInVkcGF0ZSB0byBwb3N0IGd1aWR0Z3Q6XCIsIHVwZGF0ZXMpKi9cclxyXHRcdFBvc3RzU3ZjLnVwZGF0ZUd1aWR0Z3QodXBkYXRlcylcclx0XHQuc3VjY2VzcyhmdW5jdGlvbih1cGRhdGVzKXtcclx0XHRcdC8qICBkZWJ1ZyBtc2cgICovXHJcdFx0fSlcclx0XHQuY2F0Y2goZnVuY3Rpb24oZXJyKXtcclx0XHRcdC8qICBlcnJvciBoYW5kbGluZyAgKi9cclx0XHR9KTtcclx0fVxyXHJcdC8qJHNjb3BlLnJlcXVlc3RGZXRjaCgpOyovXHJ9KTtcciIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1Bvc3RzU3ZjJywgZnVuY3Rpb24oJGh0dHApe1xuXHR0aGlzLmZldGNoID0gZnVuY3Rpb24oZ3VpZE9iail7XG5cdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS9wb3N0cycsIGd1aWRPYmopO1xuXHR9O1xuXG5cdHRoaXMuY3JlYXRlID0gZnVuY3Rpb24ocG9zdCl7XG5cdFx0cG9zdC5kZXZpY2V0b2tlbiA9ICcwJzsgLy8gZm9yIHdlYiwgdGhlcmUgaXMgbm8gZGV2aWNldG9rZW5cblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHBvc3QpO1xuXHR9O1xuXG5cdHRoaXMucmVtb3ZlID0gZnVuY3Rpb24ocG9zdCl7XG5cdFx0Ly9jb25zb2xlLmxvZyhcImRlbGV0aW5nIHBvc3RpbmdcIik7XG5cdFx0Ly9jb25zb2xlLmxvZygncG9zdC5faWQ6JywgcG9zdC5faWQpO1xuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Bvc3RzL3Bvc3RzX2RlbGV0ZScsIHBvc3QpO1xuXHR9O1xuXG5cdHRoaXMudXBkYXRlR3VpZHRndCA9IGZ1bmN0aW9uKHVwZGF0ZXMpe1xuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Bvc3RzL3VwZGF0ZV9ndWlkdGd0JywgdXBkYXRlcyk7XG5cdH1cbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1Nlc3Npb25TdmMnLCBmdW5jdGlvbigkaHR0cCl7XG5cdHRoaXMuZmV0Y2ggPSBmdW5jdGlvbigpe1xuXHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvc2Vzc2lvbnMnKTtcblx0fTtcblxuXHR0aGlzLmVudGVyID0gZnVuY3Rpb24oc2Vzc2lvbil7XG5cdFx0c2Vzc2lvbi5kZXZpY2V0b2tlbiA9ICcwJzsgLy8gZm9yIHdlYiwgdGhlcmUgaXMgbm8gZGV2aWNldG9rZW5cblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucycsIHNlc3Npb24pO1xuXHR9O1xuXG5cdHRoaXMucmVtb3ZlID0gZnVuY3Rpb24oZ3VpZCl7XG5cdFx0dmFyIHNlc3Npb24gPSB7Z3VpZDogZ3VpZH07XG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbnMvZGVsZXRlJywgc2Vzc2lvbik7XG5cdH07XG5cblx0dGhpcy51cGRhdGVXYXRjaExvY2F0aW9uID0gZnVuY3Rpb24oY3VycmVudF9tYXBfbncsIGN1cnJlbnRfbWFwX3NlLCBjdXJyZW50X21hcF9jZW50ZXIsIGd1aWQpe1xuXHRcdHZhciB3YXRjaGxvYyA9IHtcbiAgICAgICAgICAgIG53X2xhdCAgICAgOiBjdXJyZW50X21hcF9udy5sYXQsXG4gICAgICAgICAgICBud19sb24gICAgIDogY3VycmVudF9tYXBfbncubG9uLFxuICAgICAgICAgICAgc2VfbGF0ICAgICA6IGN1cnJlbnRfbWFwX3NlLmxhdCxcbiAgICAgICAgICAgIHNlX2xvblx0ICAgOiBjdXJyZW50X21hcF9zZS5sb24sXG4gICAgICAgICAgICBjZW50ZXJfbGF0IDogY3VycmVudF9tYXBfY2VudGVyLmxhdCxcbiAgICAgICAgICAgIGNlbnRlcl9sb24gOiBjdXJyZW50X21hcF9jZW50ZXIubG9uXG4gICAgICAgIH1cblxuICAgICAgICB2YXIgd2F0Y2hsb2NKU09OID0gSlNPTi5zdHJpbmdpZnkod2F0Y2hsb2MpO1xuXG4gICAgICAgIHZhciB1cGRhdGVkc2Vzc2lvbiA9IHtcbiAgICAgICAgICAgIHdhdGNobG9jOiB3YXRjaGxvY0pTT04sXG4gICAgICAgICAgICBndWlkICAgIDogZ3VpZFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHVwZGF0ZSB3YXRjaGxvYyB3aGVuIGNlbnRlciBjaGFuZ2VkLlxuICAgICAgICAvL2NvbnNvbGUubG9nKFwidXBkYXRpbmcgd2F0Y2ggbG9jYXRpb25cIik7XG5cblx0XHQvL2NvbnNvbGUubG9nKFwidXBkYXRlZHNlc3Npb246XCIsIHVwZGF0ZWRzZXNzaW9uKTtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucy91cGRhdGVfc2Vzc2lvbicsIHVwZGF0ZWRzZXNzaW9uKTtcblx0fTtcblxuXHR0aGlzLnVwZGF0ZUNvdXBsaW5nID0gZnVuY3Rpb24oZ3VpZCwgZ3VpZHRndCl7XG5cdFx0XG5cdFx0dmFyIHVwZGF0ZWRndWlkdGd0ID0ge1xuXHRcdFx0Z3VpZCAgIDogZ3VpZCxcblx0XHRcdGd1aWR0Z3Q6IGd1aWR0Z3Rcblx0XHR9O1xuXG5cdFx0Ly8gdXBkYXRlIHdhdGNobG9jIHdoZW4gY2VudGVyIGNoYW5nZWQuXG4gICAgICAgIC8vY29uc29sZS5sb2coXCJ1cGRhdGluZyBjb3VwbGluZ1wiKTtcblxuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zL3VwZGF0ZV9jb3VwbGluZycsIHVwZGF0ZWRndWlkdGd0KVxuXHR9O1xufSk7XG4iLCIiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5kaXJlY3RpdmUoJ2FwcE1hcCcsIGZ1bmN0aW9uKFBvc3RzU3ZjLCBVdGlsU3ZjLCBDb25maWdTdmMsIFNlc3Npb25TdmMsICRjb21waWxlLCAkdGltZW91dCkge1xuICAgIC8vIGRpcmVjdGl2ZSBsaW5rIGZ1bmN0aW9uXG4gICAgdmFyIGxpbmsgPSBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBHTE9CQUwgVkFSSUFCTEVTIElOIExJTksgRlVOQ1RJT05cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgdmFyIG1hcDsgLy8gZXhwYW5kIGZyb20gZ29vZ2xlIG1hcCBmb3IgbWFudWFsbHkgY3JlYXRlZCBldmVudHNcbiAgICAgICAgdmFyIG1hcF9vcmlnaW47IC8vIGZvciBvcmlnaW5hbCBnb29nbGUgbWFwIGV2ZW50IGZ1bmN0aW9uIGxpbmtzXG4gICAgICAgIHZhciBjdXJyZW50X21hcF9udztcbiAgICAgICAgdmFyIGN1cnJlbnRfbWFwX3NlO1xuICAgICAgICB2YXIgbWFwT3B0aW9ucztcbiAgICAgICAgdmFyIGluaXRpYWxNYXBDZW50ZXI7XG4gICAgICAgIHZhciBDTE9VRF9NQVBfSUQgPSAnY3VzdG9tX3N0eWxlJzsgLy8gbWFwIHN0eWxlXG4gICAgICAgIHZhciBoZWxwZXJNYXJrZXJzID0gW107XG4gICAgICAgIHZhciBtYXJrZXJzT25NYXAgPSBbXTtcblxuICAgICAgICB2YXIgcHJldkd1aWR0Z3QgPSAnMCc7XG4gICAgICAgIHZhciBpc0d1aWR0Z3RDaGFuZ2VkO1xuXG4gICAgICAgIHZhciBpbWFnZVBvc3QgPSB7XG4gICAgICAgICAgICAvL3VybDogJ2h0dHBzOi8vY2F0Y2htZS5pZnlvdWNhbi5jb20vaW1hZ2VzL3BpY3R1cmVzL0lZQ19JY29ucy9JWUNfTG9jYXRpb25fSWNvbl9TbWFsbC5wbmcnLFxuICAgICAgICAgICAgdXJsOiAnRGVmYXVsdF9NYXJrZXIucG5nJyxcbiAgICAgICAgICAgIHNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDEwMCwgMTAwKSxcbiAgICAgICAgICAgIG9yaWdpbjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDAsIDApLFxuICAgICAgICAgICAgYW5jaG9yOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMTcsIDM0KSxcbiAgICAgICAgICAgIHNjYWxlZFNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDEsIDEpXG4gICAgICAgIH07XG4gICAgICAgIHZhciBpbWFnZVRhcmdldCA9IHtcbiAgICAgICAgICAgIC8vdXJsOiAnaHR0cDovL3d3dy5jbGtlci5jb20vY2xpcGFydHMvVS9QL2ovTS9JL2kveC1tYXJrLXllbGxvdy1tZC5wbmcnLFxuICAgICAgICAgICAgdXJsOiAnWF9NYXJrZXIucG5nJyxcbiAgICAgICAgICAgIHNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDEwMCwgMTAwKSxcbiAgICAgICAgICAgIG9yaWdpbjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDAsIDApLFxuICAgICAgICAgICAgYW5jaG9yOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMTcsIDM0KSxcbiAgICAgICAgICAgIHNjYWxlZFNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDI1LCAyNSlcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGltYWdlVXNlckxvZ2luID0ge1xuICAgICAgICAgICAgLy91cmw6ICdodHRwOi8vd3d3LmNsa2VyLmNvbS9jbGlwYXJ0cy9xL28vMi9LL2cvVi9sb2NhdGlvbi1zeW1ib2wtbWFwLW1kLnBuZycsXG4gICAgICAgICAgICB1cmw6ICdDdXJyZW50X0xvY2F0aW9uX01hcmtlci5wbmcnLFxuICAgICAgICAgICAgc2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMTAwLCAxMDApLFxuICAgICAgICAgICAgb3JpZ2luOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMCwgMCksXG4gICAgICAgICAgICBhbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludCgxNywgMzQpLFxuICAgICAgICAgICAgc2NhbGVkU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMjAsIDMzKVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIEVWRU5UIEhBTkRMRVJTIC0gVVBEQVRFXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZURlZmF1bHRMb2NhdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUgPSBtYXAuZ2V0Q2VudGVyKCkubGF0KCk7XG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSA9IG1hcC5nZXRDZW50ZXIoKS5sbmcoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUJvdW5kcygpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBib3VuZHMgPSBtYXAuZ2V0Qm91bmRzKCk7XG4gICAgICAgICAgICB2YXIgbmUgPSBib3VuZHMuZ2V0Tm9ydGhFYXN0KCk7IC8vIExhdExuZyBvZiB0aGUgbm9ydGgtZWFzdCBjb3JuZXJcbiAgICAgICAgICAgIHZhciBzdyA9IGJvdW5kcy5nZXRTb3V0aFdlc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBzb3V0aC13ZXN0IGNvcmRlclxuICAgICAgICAgICAgLy9Zb3UgZ2V0IG5vcnRoLXdlc3QgYW5kIHNvdXRoLWVhc3QgY29ybmVycyBmcm9tIHRoZSB0d28gYWJvdmU6XG5cbiAgICAgICAgICAgIGN1cnJlbnRfbWFwX253ID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhuZS5sYXQoKSwgc3cubG5nKCkpO1xuICAgICAgICAgICAgY3VycmVudF9tYXBfc2UgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHN3LmxhdCgpLCBuZS5sbmcoKSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVXYXRjaExvY2F0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGJvdW5kcyA9IG1hcC5nZXRCb3VuZHMoKTtcbiAgICAgICAgICAgIHZhciBuZSA9IGJvdW5kcy5nZXROb3J0aEVhc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBub3J0aC1lYXN0IGNvcm5lclxuICAgICAgICAgICAgdmFyIHN3ID0gYm91bmRzLmdldFNvdXRoV2VzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIHNvdXRoLXdlc3QgY29yZGVyXG4gICAgICAgICAgICAvL1lvdSBnZXQgbm9ydGgtd2VzdCBhbmQgc291dGgtZWFzdCBjb3JuZXJzIGZyb20gdGhlIHR3byBhYm92ZTpcblxuICAgICAgICAgICAgY3VycmVudF9tYXBfbncgPSB7IFxuICAgICAgICAgICAgICAgIGxhdDogbmUubGF0KCksIFxuICAgICAgICAgICAgICAgIGxvbjogc3cubG5nKClcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjdXJyZW50X21hcF9zZSA9IHtcbiAgICAgICAgICAgICAgICBsYXQ6IHN3LmxhdCgpLCBcbiAgICAgICAgICAgICAgICBsb246IG5lLmxuZygpXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgY3VycmVudF9tYXBfY2VudGVyIDtcblxuICAgICAgICAgICAgLy8gc2VlIGlmIHRoZSBsYXRlc3QgeCBtYXJrZXIgb3IgcG9zdCBsb2NhdGlvbiBpcyB3aXRoaW4gdXNlcidzIHZpZXdcbiAgICAgICAgICAgIGlmICghKHNjb3BlLnBvc3RMb2NhdGlvbi5sYXQgPCBjdXJyZW50X21hcF9udy5sYXQpIHx8XG4gICAgICAgICAgICAgICAgIShzY29wZS5wb3N0TG9jYXRpb24ubGF0ID4gY3VycmVudF9tYXBfc2UubGF0KSB8fFxuICAgICAgICAgICAgICAgICEoc2NvcGUucG9zdExvY2F0aW9uLmxvbiA8IGN1cnJlbnRfbWFwX3NlLmxvbikgfHxcbiAgICAgICAgICAgICAgICAhKHNjb3BlLnBvc3RMb2NhdGlvbi5sb24gPiBjdXJyZW50X21hcF9udy5sb24pIClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBpZiBpdCBpcyBub3Qgd2l0aGluIHVzZXIncyB2aWV3LCB0aGVuIGp1c3QgdXNlIG1hcCBjZW50ZXJcbiAgICAgICAgICAgICAgICBjdXJyZW50X21hcF9jZW50ZXIgPSB7XG4gICAgICAgICAgICAgICAgICAgIGxhdDogbWFwLmdldENlbnRlcigpLmxhdCgpLFxuICAgICAgICAgICAgICAgICAgICBsb246IG1hcC5nZXRDZW50ZXIoKS5sbmcoKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gaWYgaXQgaXMgd2l0aGluIHVzZXIncyB2aWV3LCB1c2UgeCBtYXJrZXIgbG9jYXRpb24gYS5rLmEgcG9zdCBsb2NhdGlvblxuICAgICAgICAgICAgICAgIGN1cnJlbnRfbWFwX2NlbnRlciA9IHtcbiAgICAgICAgICAgICAgICAgICAgbGF0OiBzY29wZS5wb3N0TG9jYXRpb24ubGF0LFxuICAgICAgICAgICAgICAgICAgICBsb246IHNjb3BlLnBvc3RMb2NhdGlvbi5sb25cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgU2Vzc2lvblN2Yy51cGRhdGVXYXRjaExvY2F0aW9uKGN1cnJlbnRfbWFwX253LCBjdXJyZW50X21hcF9zZSwgY3VycmVudF9tYXBfY2VudGVyLCBzY29wZS5ndWlkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIEVWRU5UIEhBTkRMRVJTIC0gRFJBV1xuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyB1cGRhdGUgcmVzcG9uc2VzIHN1Y2ggYXMgdmlzdWFsaXphdGlvbiBvZiBsaXN0ZW5lcnNcbiAgICAgICAgZnVuY3Rpb24gZHJhd1Jlc3BvbnNlcyhwb3N0KXtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ3JlZmVyZW5jZSBwb3N0OicsIHBvc3QpO1xuXG4gICAgICAgICAgICBTZXNzaW9uU3ZjLmZldGNoKClcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKHNlc3Npb25zKXtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2Vzc2lvbnMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2Vzc2lvbiA9IHNlc3Npb25zW2ldO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIHNraXAgbXkgc2Vzc2lvbiAtIG5vIG5lZWQgdG8gZHJhdyDrgrQg7J6Q7Iug7J2YIOyEuOyFmOydgCDqt7jrprTtlYTsmpTqsIAg7JeG64ukLlxuICAgICAgICAgICAgICAgICAgICBpZiAoc2Vzc2lvbi5ndWlkID09IHNjb3BlLmd1aWQpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICAgICAgICAgICAgICAgLy8gc2Vzc2lvbidzIHdhdGNoIGxvY2F0aW9uIHdpbGwgYmUgYm91bmNlZCFcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdhdGNoX2xvY2F0aW9uID0gYW5ndWxhci5mcm9tSnNvbihzZXNzaW9uLndhdGNobG9jKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvc3RfbG9jYXRpb24gID0gYW5ndWxhci5mcm9tSnNvbihwb3N0LmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIOycoOyggOqwgCDrs7Tqs6Ag7J6I64qUIOuwlOyatOuNlOumrCDslYjsl5Ag6re4IHNlc3Npb24o64uk66W47Jyg7KCAKSDssrTtgoFcblxuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGN1cnJlbnRfbWFwX3NlLCBjdXJyZW50X21hcF9udyk7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUJvdW5kcygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoISh3YXRjaF9sb2NhdGlvbi5jZW50ZXJfbGF0IDwgY3VycmVudF9tYXBfbncubGF0KCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKHdhdGNoX2xvY2F0aW9uLmNlbnRlcl9sYXQgPiBjdXJyZW50X21hcF9zZS5sYXQoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEod2F0Y2hfbG9jYXRpb24uY2VudGVyX2xvbiA8IGN1cnJlbnRfbWFwX3NlLmxuZygpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgISh3YXRjaF9sb2NhdGlvbi5jZW50ZXJfbG9uID4gY3VycmVudF9tYXBfbncubG5nKCkpIClcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBzZXNzaW9uKOuLpOuluOycoOyggCnrk6TsnbQg6re4IO2PrOyKpO2KuOulvCDrs7Tqs6Ag7J6I7KeAIOyViuycvOuptCDsiqTtgrUuXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHBvc3RfbG9jYXRpb24ubGF0IDwgd2F0Y2hfbG9jYXRpb24ubndfbGF0KSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIShwb3N0X2xvY2F0aW9uLmxhdCA+IHdhdGNoX2xvY2F0aW9uLnNlX2xhdCkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEocG9zdF9sb2NhdGlvbi5sb24gPCB3YXRjaF9sb2NhdGlvbi5zZV9sb24pIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKHBvc3RfbG9jYXRpb24ubG9uID4gd2F0Y2hfbG9jYXRpb24ubndfbG9uKSApXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHdhdGNoX2xvY2F0aW9uLmNlbnRlcl9sYXQsIHdhdGNoX2xvY2F0aW9uLmNlbnRlcl9sb24pO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmRvbVNpemUgPSBNYXRoLnJhbmRvbSgpICogNDAgKyA0MDsgXG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmxOYW1lICAgID0gJ0JsaW5rLmdpZic7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGltYWdlTGlzdGVuZXIgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHVybE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IG5ldyBnb29nbGUubWFwcy5Qb2ludCgwLCAwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KHJhbmRvbVNpemUgKiAwLjUgKyA1LCByYW5kb21TaXplICogMC41ICsgMTQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGVkU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUocmFuZG9tU2l6ZSwgcmFuZG9tU2l6ZSlcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24oaW1hZ2VMaXN0ZW5lcil7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogZ29vZ2xlTG9jLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcDogbWFwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIlJlY2VpdmVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VMaXN0ZW5lcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpbWl6ZWQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcihtYXJrZXJPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWNlaXZlcl9tYXJrZXJfbGlmZXNwYW4gPSAxMjAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAkdGltZW91dChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24ob2xkX21hcmtlcil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xkX21hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGRfbWFya2VyID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KG1hcmtlcikpLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VpdmVyX21hcmtlcl9saWZlc3Bhbik7XG5cbiAgICAgICAgICAgICAgICAgICAgfShpbWFnZUxpc3RlbmVyKSk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHBvc3QgaXMgY29tcGxldGx5IGRlYWQgYW5kIHJlbW92ZSB0aGF0IHBvc3RcbiAgICAgICAgZnVuY3Rpb24gY2xlYW51cCgpIHtcbiAgICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgbWFya2VyOyBtYXJrZXIgPSBtYXJrZXJzT25NYXBbal07IGorKyl7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnREYXRlICAgICAgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VGltZU1pbGxpID0gY3VycmVudERhdGUuZ2V0VGltZSgpO1xuICAgICAgICAgICAgICAgIHZhciBsaWZlID0gbWFya2VyLnBvc3QubGlmZWVuZCAtIGN1cnJlbnRUaW1lTWlsbGk7XG5cbiAgICAgICAgICAgICAgICBpZiAobGlmZSA8PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnY2xlYW5pbmcgdXAuLicsIG1hcmtlci5wb3N0Ll9pZCk7XG4gICAgICAgICAgICAgICAgICAgIHVuRHJhd1Bvc3QobWFya2VyLnBvc3QuX2lkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVBbmREcmF3UG9zdHMoKXtcbiAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gZm9yIGNoZWNraW5nIGxvY2FsIHBvc3RzIC0gaXNQb2ludGluZ1lvdVxuICAgICAgICAgICAgaXNHdWlkdGd0Q2hhbmdlZCA9IHByZXZHdWlkdGd0ICE9IHNjb3BlLmd1aWR0Z3Q7IC8vIHNlZSBpZiBteSBndWlkdGd0IGhhcyBjaGFuZ2VkO1xuICAgICAgICAgICAgcHJldkd1aWR0Z3QgPSBzY29wZS5ndWlkdGd0OyAvLyB1cGRhdGUgcHJldmlvdXMgZ3VpZHRndFxuXG4gICAgICAgICAgICBmdW5jdGlvbiBkcmF3UG9zdHMocG9zdHMpe1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb3N0cy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwb3N0ID0gcG9zdHNbaV07XG5cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBTVEFSVCAtIENIRUNLIElGIElUUyBXSVRISU4gVklFVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IGFuZ3VsYXIuZnJvbUpzb24ocG9zdC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxvY2F0aW9uLmxhdCwgbG9jYXRpb24ubG9uKTtcblxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVCb3VuZHMoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoZ29vZ2xlTG9jLmxhdCgpIDwgY3VycmVudF9tYXBfbncubGF0KCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKGdvb2dsZUxvYy5sYXQoKSA+IGN1cnJlbnRfbWFwX3NlLmxhdCgpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIShnb29nbGVMb2MubG5nKCkgPCBjdXJyZW50X21hcF9zZS5sbmcoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEoZ29vZ2xlTG9jLmxuZygpID4gY3VycmVudF9tYXBfbncubG5nKCkpIClcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7IC8vIHNraXAgdGhpcyBwb3N0IC0gbm8gbmVlZCB0byBkcmF3XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBFTkQgLSBDSEVDSyBJRiBJVFMgV0lUSElOIFZJRVcgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBTVEFSVCAtIENIRUNLIFdFIEhBVkUgVE8gUkVEUkFXIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIG1hcmtlcnMgcG9zdCBpcyBleGlzaXRpbmcgb25lLCB3ZSBkb24ndCB3YW50IHRvIGRyYXcgaXQgYWdhaW4uXG4gICAgICAgICAgICAgICAgICAgIC8vIG9ubHkgZHJhdyBuZXcgb25lcyFcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIG1hcmtlcjsgbWFya2VyID0gbWFya2Vyc09uTWFwW2pdOyBqKyspe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL+ydtOu2gOu2hCDroZzsp4HsnYQg64uk7IucIOynnOyVvO2VqFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzQWxyZWFkeURyYXduID0gcG9zdC5faWQgPT0gbWFya2VyLnBvc3QuX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQWxyZWFkeURyYXduKSAvLyDsnbTrr7gg6re466Ck7KGM64qU7KeAIO2FjOyKpO2KuFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0d1aWR0Z3RDaGFuZ2VkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5EcmF3UG9zdChwb3N0Ll9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWFya2VyLnBvc3QuZ3VpZHRndCA9PSBwb3N0Lmd1aWR0Z3QpeyAgLy8g7J2066+4IOq3uOugpOynhOqyg+ykkSwgZ3VpZHRndOydtCDrsJTrgIzsl4jripTqsIBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdCA9IG51bGw7IC8vIOydtOuvuCDqt7jroKTsp4Qg7Y+s7Iqk7Yq4652866m0LCBudWxs66GcLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsgLy8g7J20IGxvb3DsnYAgcG9zdC5faWTrp4wg6rKA7IKs7Jqp7J6E7Jy866GcLCDrp4zslb0g6rK57LmY66m0IOuwlOuhnCBsb29w7J2EIOupiOy2sOuPhCDqtJzssK7ri6QufVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuRHJhd1Bvc3QocG9zdC5faWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAocG9zdCA9PSBudWxsKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOyAvLyBza2lwIHRoaXMgcG9zdCAtIG5vIG5lZWQgdG8gZHJhd1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRU5EIC0gQ0hFQ0sgV0UgSEFWRSBUTyBSRURSQVcgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBTVEFSVCAtIERSQVdJTkcgUE9TVCAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgICAgICAgICAgICAgIC8vIG1hcmtlciBvcHRpb24gc2V0dGluZ1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBnb29nbGVMb2MsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXA6IG1hcCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIkJ1YmJsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VQb3N0XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKG1hcmtlck9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAvLyBhZGQgbWFya2VyIHRvIGFycmF5LCB0aGlzIG1lYW5zIHRoYXQgaXQgaGFzIGJlZW4gZHJhd24gdG8gbWFwXG4gICAgICAgICAgICAgICAgICAgIG1hcmtlcnNPbk1hcC5wdXNoKFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlcjogbWFya2VyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc3QgIDogcG9zdFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBTVEFSVCAtIERSQVdJTkcgTUVTU0FHRSBXSU5ET1cgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgICAgICAgICAgICAgICAgICB2YXIgY291cGxpbmdfc3RhdHVzID0gY2FsY3VsYXRlQ291cGxpbmcocG9zdC5ndWlkLCBwb3N0Lmd1aWR0Z3QpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJwb3N0LmlzTG9jYWxcIiwgcG9zdC5pc2xvY2FsKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2FsX3N0YXR1cyA9IHBvc3QuaXNsb2NhbDtcblxuICAgICAgICAgICAgICAgICAgICAvLyDsiqTsvZTtlITsl5DshJzrtoDthLAg7IOI66Gc7Jq0IOywqOydvOuTnCDsiqTsvZTtlITrpbwg66eM65Ok7Ja0IGVhY2ggZm9yIGxvb3Dsl5DshJwg7IKs7Jqp7ZWc64ukLlxuICAgICAgICAgICAgICAgICAgICAvLyAtLT4g7ZW07JW8LCDqsIEgRE9N7J20IOqwgeqwgeydmCBzY29wZeulvCDqsIDsoLjshJwgcG9zdCBtc2fqsIAg7JWIIOqyuey5nOuLpC5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHNjb3BlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSBwYXJlbnQuJG5ldyh0cnVlKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgb3BlbkluZm9XaW5kb3cgPSAoZnVuY3Rpb24obWFya2VyLCBjaGlsZF9zY29wZSwgcG9zdCwgY291cGxpbmdfc3RhdHVzLCBsb2NhbF9zdGF0dXMpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjcmVhdGUgbmV3IHdpbmRvd1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmZvV2luZG93T3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGl4ZWxPZmZzZXQ6IG5ldyBnb29nbGUubWFwcy5TaXplKC0zOS41LCAxNi4wKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZUF1dG9QYW46IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmZvV2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coaW5mb1dpbmRvd09wdGlvbnMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGN1cnJlbnQgdGltZSBhbmQgc3VidHJhY3QgaXQgZnJvbSBwb3N0J3MgZW5kIHRpbWUuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhhdCB3aWxsIGJlIGFjY3VyYXRlIHBvc3QgdGltZSBmb3IgaW5zdGFudCBwb3N0cyBhbmQgbG9uZyBwb3N0cy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudERhdGUgICAgICA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lTWlsbGkgPSBjdXJyZW50RGF0ZS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvc3RsaWZlICAgICAgICAgPSAoKHBvc3QubGlmZWVuZCAtIGN1cnJlbnRUaW1lTWlsbGkpID49IDApID8gKHBvc3QubGlmZWVuZCAtIGN1cnJlbnRUaW1lTWlsbGkpIDogMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsaWZlcGVyY2VudGFnZSA9IChwb3N0bGlmZSAvIHBvc3QubGlmZXNwYW4pLnRvRml4ZWQoMilcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdG8gbWFrZSBkYXRhIGF2YWlsYWJsZSB0byB0ZW1wbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLm1zZyAgICAgICAgICAgICAgICA9IHBvc3QuYm9keTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0bGlmZSAgICAgICAgICAgPSBwb3N0bGlmZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Z3VpZCAgICAgICAgICAgPSBwb3N0Lmd1aWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUucG9zdGd1aWR0Z3QgICAgICAgID0gcG9zdC5ndWlkdGd0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3Rjb3VwbGVzdGF0dXMgICA9IGNvdXBsaW5nX3N0YXR1cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPSBsaWZlcGVyY2VudGFnZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0bG9jYWxzdGF0dXMgICAgPSBsb2NhbF9zdGF0dXM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgZW5hYmxlcyBjaGFuZ2luZyBjb3VwbGluZyB2YWx1ZSBpbnN0YW50bHkuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUuJG9uKCdzZXQ6Y291cGxpbmcnLCBmdW5jdGlvbihfLCBjb3VwbGluZ191cGRhdGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Y291cGxlc3RhdHVzID0gY291cGxpbmdfdXBkYXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb21waWxlIGl0IGJlZm9yZSBsb2FkZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udGVudCAgPSAnPGRpdiBtYXAtbXNnPjwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXBpbGVkID0gJGNvbXBpbGUoY29udGVudCkoY2hpbGRfc2NvcGUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5zZXRDb250ZW50KCBjb21waWxlZFswXSApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIoaW5mb1dpbmRvdywnY2xvc2VjbGljaycsZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvc3QuZ3VpZCA9PSBzY29wZS5ndWlkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dhbChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJBcmUgeW91IHN1cmU/XCIsICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogXCJZb3Ugd2lsbCBub3QgYmUgYWJsZSB0byByZWNvdmVyIHRoaXMgaW1hZ2luYXJ5IGZpbGUhXCIsICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJ3YXJuaW5nXCIsICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6IFwiI0RENkI1NVwiLCAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiBcIlllcywgZGVsZXRlIGl0IVwiLCAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlT25Db25maXJtOiBmYWxzZSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oaXNDb25maXJtKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDb25maXJtKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUG9zdHNTdmMucmVtb3ZlKHBvc3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2FsKFwiRGVsZXRlZCFcIiwgXCJZb3VyIGltYWdpbmFyeSBmaWxlIGhhcyBiZWVuIGRlbGV0ZWQuXCIsIFwic3VjY2Vzc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudERhdGUgICAgICA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VGltZU1pbGxpID0gY3VycmVudERhdGUuZ2V0VGltZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zdGxpZmUgICAgICAgICA9ICgocG9zdC5saWZlZW5kIC0gY3VycmVudFRpbWVNaWxsaSkgPj0gMCkgPyAocG9zdC5saWZlZW5kIC0gY3VycmVudFRpbWVNaWxsaSkgOiAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGlmZXBlcmNlbnRhZ2UgPSAocG9zdGxpZmUgLyBwb3N0LmxpZmVzcGFuKS50b0ZpeGVkKDIpXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpZmVwZXJjZW50YWdlID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPSBsaWZlcGVyY2VudGFnZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cub3BlbihtYXAgLCBtYXJrZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5vcGVuKG1hcCAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9KShtYXJrZXIsIGNoaWxkLCBwb3N0LCBjb3VwbGluZ19zdGF0dXMsIGxvY2FsX3N0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBvcGVuSW5mb1dpbmRvdygpO1xuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEVORCAtIERSQVdJTkcgTUVTU0FHRSBXSU5ET1cgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgICAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRU5EIC0gRFJBV0lORyBQT1NUIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICAgICAgICAgIH0gLy8gZW5kIG9mIGZvci1sb29wXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFBvc3RzU3ZjLmZldGNoKClcbiAgICAgICAgICAgIC5zdWNjZXNzKGRyYXdQb3N0cykgXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgZXJyb3JcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBlbmQgb2YgcG9zdCBmZXRjaCBzdWNjZXNzXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkcmF3RHJvcERvd24obG9jYXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxvY2F0aW9uLmxhdCwgbG9jYXRpb24ubG9uKTtcblxuICAgICAgICAgICAgdXBkYXRlQm91bmRzKCk7XG4gICAgICAgICAgICAvLyDrsJTsmrTrjZTrpqwg7JWI7JeQIOyeiOuKlOyngOu2gO2EsCDssrTtgazrpbwg7ZWY7J6lXG4gICAgICAgICAgICBpZiAoIShnb29nbGVMb2MubGF0KCkgPCBjdXJyZW50X21hcF9udy5sYXQoKSkgfHxcbiAgICAgICAgICAgICAgICAhKGdvb2dsZUxvYy5sYXQoKSA+IGN1cnJlbnRfbWFwX3NlLmxhdCgpKSB8fFxuICAgICAgICAgICAgICAgICEoZ29vZ2xlTG9jLmxuZygpIDwgY3VycmVudF9tYXBfc2UubG5nKCkpIHx8XG4gICAgICAgICAgICAgICAgIShnb29nbGVMb2MubG5nKCkgPiBjdXJyZW50X21hcF9udy5sbmcoKSkgKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybjsgLy8gc2tpcCB0aGlzIHBvc3QgLSBubyBuZWVkIHRvIGRyYXdcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gbWFya2VyIG9wdGlvbiBzZXR0aW5nXG4gICAgICAgICAgICB2YXIgbWFya2VyT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogZ29vZ2xlTG9jLFxuICAgICAgICAgICAgICAgIG1hcDogbWFwLFxuICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkRST1AsXG4gICAgICAgICAgICAgICAgdGl0bGU6IFwiVXNlclBpblwiLFxuICAgICAgICAgICAgICAgIGljb246IGltYWdlVXNlckxvZ2luXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcihtYXJrZXJPcHRpb25zKTtcblxuICAgICAgICAgICAgJHRpbWVvdXQoXG4gICAgICAgICAgICAgICAgKGZ1bmN0aW9uKG9sZF9tYXJrZXIpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9sZF9tYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0obWFya2VyKSksIFxuICAgICAgICAgICAgMjAwMCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1bkRyYXdQb3N0KHBvc3RpZClcbiAgICAgICAge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcInN0YXJ0aW5nIHJlbW92ZSBwb3N0XCIpO1xuICAgICAgICAgICAgZm9yICh2YXIgayA9IDAsIG1hcmtlcjsgbWFya2VyID0gbWFya2Vyc09uTWFwW2tdOyBrKyspIHtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHBvc3RpZCk7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhtYXJrZXIucG9zdC5faWQpO1xuICAgICAgICAgICAgICAgIGlmIChwb3N0aWQgPT0gbWFya2VyLnBvc3QuX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlci5tYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICBtYXJrZXJzT25NYXAuc3BsaWNlKGssIDEpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkcmF3QW5kU2V0UGxhY2UobG9jYXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxvY2F0aW9uLmxhdCwgbG9jYXRpb24ubG9uKTtcbiAgICAgICAgICAgIGRyYXdIZWxwZXJNYXJrZXIoZ29vZ2xlTG9jKTtcbiAgICAgICAgICAgIHNldFBsYWNlKGdvb2dsZUxvYyk7XG5cbiAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSBzZXJ2ZXIgZ2V0cyB1cGRhdGVkIHdoZW5ldmVyIHNldHRpbmcgbmV3IHBsYWNlIHdpdGggbWFya2VyXG4gICAgICAgICAgICB1cGRhdGVXYXRjaExvY2F0aW9uKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBkcmF3IG1hcCB3aXRoIGhlbHBlciBtYXJrZXJzXG4gICAgICAgIGZ1bmN0aW9uIGRyYXdIZWxwZXJNYXJrZXIobG9jYXRpb24pe1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG1hcmtlcjsgbWFya2VyID0gaGVscGVyTWFya2Vyc1tpXTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbWFya2VyLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGhlbHBlck1hcmtlcnMgPSBbXTtcbiAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogbG9jYXRpb24sIFxuICAgICAgICAgICAgICAgIG1hcDogbWFwLFxuICAgICAgICAgICAgICAgIGljb246IGltYWdlVGFyZ2V0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGhlbHBlck1hcmtlcnMucHVzaChtYXJrZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdW5EcmF3SGVscGVyTWFya2VyKCl7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbWFya2VyOyBtYXJrZXIgPSBoZWxwZXJNYXJrZXJzW2ldOyBpKyspIHtcbiAgICAgICAgICAgICAgICBtYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGVscGVyTWFya2VycyA9IFtdO1xuICAgICAgICB9XG5cblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBVVElMXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIGZ1bmN0aW9uIHNldFBsYWNlKGxvY2F0aW9uKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBicm9hZGNhc3QgbG9jYXRpb24gaW5mb3IobG9uLGxhdClcbiAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdzZXQ6bG9jJywgbG9jYXRpb24pO1xuXG4gICAgICAgICAgICB2YXIgZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTtcblxuICAgICAgICAgICAgLy8gYnJvYWRjYXN0IHBsYWNlIGZvcm1hdHRlZF9hZGRyZXNzIGFuZCBkcmF3IGljb25cbiAgICAgICAgICAgIGdlb2NvZGVyLmdlb2NvZGUoIHsgJ2xhdExuZyc6IGxvY2F0aW9uIH0sIGZ1bmN0aW9uKHJlc3VsdHMsIHN0YXR1cykge1xuICAgICAgICAgICAgICAgIC8vIGFzIHVzZXIgY2xpY2tzIG9uIHRoZSBtYXAsXG4gICAgICAgICAgICAgICAgLy8gd2UgaGF2ZSB0byBzYXZlIHRoZSBmb3JtYXR0ZWQgYWRkcmVzcyBpbiAkc2NvcGUgYW5kXG4gICAgICAgICAgICAgICAgLy8gaXQgd2lsbCBiZSB1c2VkIHRocm91Z2ggcG9zdHMuY3RybFxuICAgICAgICAgICAgICAgIC8vIGVtaXQgYnJvYWRjYXNlICdwbGFjZScgYW5kIHNlbmQgdGhpcyB0byBhcHBsaWNhdGlvbi5jdHJsXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYnJvYWRjYXN0IGZvcm1hdHRlZF9hZGRyZXNzXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdzZXQ6cGxhY2UnLCByZXN1bHRzWzFdLmZvcm1hdHRlZF9hZGRyZXNzKTsgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoKGVycikge1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgIHN3YWwoXCJcIixcIkxvY2F0aW9uIGRvZXMgbm90IGV4aXN0c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldDpwbGFjZScsIFwiTG9jYXRpb24gZG9lcyBub3QgZXhpc3RzXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2FsY3VsYXRlQ291cGxpbmcocG9zdF9ndWlkLCBwb3N0X2d1aWR0Z3QpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qIGNvdXBsaW5nIHN0YXR1c1xuICAgICAgICAgICAgICAgIDAgLSBubyBzdGF0dXNcbiAgICAgICAgICAgICAgICAxIC0gaSBsaWtlIHlvdVxuICAgICAgICAgICAgICAgIDIgLSB5b3UgbGlrZSBpXG4gICAgICAgICAgICAgICAgNCAtIHdlIGxpa2UgZWFjaCBvdGhlciAvLyBkaXNhYmxlZC5cbiAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIHZhciBpc1BvaW50aW5nWW91ICAgICA9IHNjb3BlLmd1aWR0Z3QgPT0gcG9zdF9ndWlkO1xuICAgICAgICAgICAgdmFyIGlzUG9pbnRpbmdNZSAgICAgID0gc2NvcGUuZ3VpZCAgICA9PSBwb3N0X2d1aWR0Z3Q7XG4gICAgICAgICAgICB2YXIgaXNNeVBvc3QgICAgICAgICAgPSBzY29wZS5ndWlkICAgID09IHBvc3RfZ3VpZDtcbiAgICAgICAgICAgIHZhciBpc1BvaW50aW5nU29tZW9uZSA9IHNjb3BlLmd1aWR0Z3QgIT0gJzAnO1xuXG4gICAgICAgICAgICBpZiAoaXNNeVBvc3QgJiYgaXNQb2ludGluZ1NvbWVvbmUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDI7IC8vIGZvciBteSB2aWV3J3MgbXkgcG9zdCB0byBiZSBcIkkgbGlrZSBzb21lb25lXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGlzUG9pbnRpbmdZb3UgJiYgaXNQb2ludGluZ01lKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiA0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaXNQb2ludGluZ1lvdSAmJiAhaXNQb2ludGluZ01lKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoIWlzUG9pbnRpbmdZb3UgJiYgaXNQb2ludGluZ01lKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gVUlcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgZnVuY3Rpb24gc2V0VUlTZWFyY2hMb2NhdGlvblRvZ2dsZSgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBtYXBTZWFyY2hUb2dnbGUgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1zZWFyY2gtdG9nZ2xlJykpO1xuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5UT1BfTEVGVF0ucHVzaChtYXBTZWFyY2hUb2dnbGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0VUlNb3ZlVG9DdXJyTG9jQnRuKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGN1cnJMb2NCdG4gPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1idG4tY3VycicpKTsgXG4gICAgICAgICAgICBtYXAuY29udHJvbHNbZ29vZ2xlLm1hcHMuQ29udHJvbFBvc2l0aW9uLlRPUF9SSUdIVF0ucHVzaChjdXJyTG9jQnRuKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldFVJUG9zdEZvcm0oKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgcG9zdEZvcm0gPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1wb3N0aW5nJykpOyBcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uQk9UVE9NX0NFTlRFUl0ucHVzaChwb3N0Rm9ybSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRVSVBvc3RCdG4oKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgcG9zdEJ0biA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLWJ0bi1zdWJtaXQnKSk7XG4gICAgICAgICAgICBtYXAuY29udHJvbHNbZ29vZ2xlLm1hcHMuQ29udHJvbFBvc2l0aW9uLkJPVFRPTV9DRU5URVJdLnB1c2gocG9zdEJ0bik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRVSVRpbWVTbGlkZXIoKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgdGltZVNsaWRlciA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLXRpbWUtc2xpZGVyJykpO1xuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5CT1RUT01fQ0VOVEVSXS5wdXNoKHRpbWVTbGlkZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0VUlTZWFyY2hCb3goKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgdGhlIHNlYXJjaCBib3ggYW5kIGxpbmsgaXQgdG8gdGhlIFVJIGVsZW1lbnQuXG4gICAgICAgICAgICB2YXIgaW5wdXQgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhYy1pbnB1dCcpKTsgLy8gQHR5cGUge0hUTUxJbnB1dEVsZW1lbnR9ICBcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uVE9QX0xFRlRdLnB1c2goaW5wdXQpO1xuXG4gICAgICAgICAgICB2YXIgc2VhcmNoQm94ID0gbmV3IGdvb2dsZS5tYXBzLnBsYWNlcy5TZWFyY2hCb3goKGlucHV0KSk7IC8vIEB0eXBlIHtIVE1MSW5wdXRFbGVtZW50fSBcblxuICAgICAgICAgICAgLy8gTGlzdGVuIGZvciB0aGUgZXZlbnQgZmlyZWQgd2hlbiB0aGUgdXNlciBzZWxlY3RzIGFuIGl0ZW0gZnJvbSB0aGVcbiAgICAgICAgICAgIC8vIHBpY2sgbGlzdC4gUmV0cmlldmUgdGhlIG1hdGNoaW5nIHBsYWNlcyBmb3IgdGhhdCBpdGVtLlxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIoc2VhcmNoQm94LCAncGxhY2VzX2NoYW5nZWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGxhY2VzID0gc2VhcmNoQm94LmdldFBsYWNlcygpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHBsYWNlcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIHRha2Ugb25seSAxIHNwb3RcbiAgICAgICAgICAgICAgICB2YXIgcGxhY2UgPSBwbGFjZXNbMF07XG5cbiAgICAgICAgICAgICAgICAvLyB3aGVuIHNlYXJjaCBoYXBwZW5zLCBsb2NhdGlvbiB3aWxsIGJlIHVwZGF0ZWQgYXMgd2VsbCBmb3IgcG9zdFxuICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgbGF0OiBwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sYXQoKSxcbiAgICAgICAgICAgICAgICAgICAgbG9uOiBwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZHJhd0FuZFNldFBsYWNlKGxvY2F0aW9uKTtcblxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUgPSBwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sYXRpdHVkZTtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSA9IHBsYWNlLmdlb21ldHJ5LmxvY2F0aW9uLmxvbmdpdHVkZTtcblxuICAgICAgICAgICAgICAgIG1hcC5wYW5UbyhwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgbWFwLnNldFpvb20oMTYpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBFVkVOVFxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICBmdW5jdGlvbiBzZXRFdmVudENsaWNrKClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gY2xpY2sgZXZlbnQgb24gbWFwIHRvIGRyYXcgWCBtYXJrZXIgYW5kIHNldCBQb3N0IGxvY2F0aW9uXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXBfb3JpZ2luLCAnY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgbGF0OiBldmVudC5sYXRMbmcubGF0KCksXG4gICAgICAgICAgICAgICAgICAgIGxvbjogZXZlbnQubGF0TG5nLmxuZygpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBkcmF3QW5kU2V0UGxhY2UobG9jYXRpb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRFdmVudENlbnRlckNoYW5nZWQoKVxuICAgICAgICB7XG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXBfb3JpZ2luLCAnY2VudGVyX2NoYW5nZWQnLCBmdW5jdGlvbigpeyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyB3aGVuIG1hcCBjZW50ZXIgY2hhbmdlLCB1cGRhdGUgbGFzdCBsb2NhdGlvbiBpbiBtZW1vcnksXG4gICAgICAgICAgICAgICAgLy8gc28gYnJvd3NlciB3aWxsIHJlbWVtYmVyIGl0IG5leHQgdGltZSB5b3UgY29tZSFcbiAgICAgICAgICAgICAgICB1cGRhdGVEZWZhdWx0TG9jYXRpb24oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0RXZlbnRCb3VuZHNDaGFuZ2VkKClcbiAgICAgICAge1xuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwX29yaWdpbiwgJ2JvdW5kc19jaGFuZ2VkJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAvLyB3aGVuIG1hcCBjZW50ZXIgY2hhbmdlLCB1cGRhdGUgYm91bmRzIGluZm8gZm9yIG1hcFxuICAgICAgICAgICAgICAgIHVwZGF0ZUJvdW5kcygpOyAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldEV2ZW50RHJhZ0VuZCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcF9vcmlnaW4sICdkcmFnZW5kJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgbWFwIGFzIGRyYWcgZW5kXG4gICAgICAgICAgICAgICAgdXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgd2F0Y2hsb2Mgd2hlbiBjZW50ZXIgY2hhbmdlZC5cbiAgICAgICAgICAgICAgICB1cGRhdGVXYXRjaExvY2F0aW9uKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldEV2ZW50UmVzaXplKClcbiAgICAgICAge1xuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwX29yaWdpbiwgJ3Jlc2l6ZScsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIG1hcCBhcyBkcmFnIGVuZFxuICAgICAgICAgICAgICAgIHVwZGF0ZUFuZERyYXdQb3N0cygpO1xuXG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIHdhdGNobG9jIHdoZW4gY2VudGVyIGNoYW5nZWQuXG4gICAgICAgICAgICAgICAgdXBkYXRlV2F0Y2hMb2NhdGlvbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRFdmVudFpvb21DaGFuZ2VkKClcbiAgICAgICAge1xuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwX29yaWdpbiwgJ3pvb21fY2hhbmdlZCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIG1hcCBhcyBkcmFnIGVuZFxuICAgICAgICAgICAgICAgIHVwZGF0ZUFuZERyYXdQb3N0cygpO1xuXG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIHdhdGNobG9jIHdoZW4gY2VudGVyIGNoYW5nZWQuXG4gICAgICAgICAgICAgICAgdXBkYXRlV2F0Y2hMb2NhdGlvbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBTRVRVUCBGT1IgTUFQXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIG1hcCBpbml0aWFsIGNvbmZpZ3NcbiAgICAgICAgZnVuY3Rpb24gaW5pdGlhbE1hcERhdGEoKXtcbiAgICAgICAgICAgIC8vIGlmIGxvY2FsU3RvcmFnZSByZW1lbWJlcnMgbGF0ZXN0IG1hcCBsb2NhdGlvbiwgdXNlIGl0LFxuICAgICAgICAgICAgaWYgKCFpc05hTih3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlKSAmJiAhaXNOYU4od2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGluaXRpYWxNYXBDZW50ZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUsIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmIHRoZXJlIGlzIG5vIGxhdGVzdCBtYXAgbG9jYXRpb24sIGdldCBjdXJyZW50IGxvY2F0aW9uXG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS51c2VyTG9jYXRpb24ubGF0ICE9IDAuMCAmJiBzY29wZS51c2VyTG9jYXRpb24ubG9uICE9IDAuMCkgXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gdGhpcyBtYXkgbm90IHdvcmsgZm9yIG5vdyBzaW5jZSBsb2NhdGlvbiBnZXRzIHNldCBhZnRlciBtYXAgaXMgZGVmaW5lZC4uIChUT0RPOiByZWZhY3RvciB0aGUgb3JkZXIpXG4gICAgICAgICAgICAgICAgaW5pdGlhbE1hcENlbnRlciA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoc2NvcGUudXNlckxvY2F0aW9uLmxhdCwgc2NvcGUudXNlckxvY2F0aW9uLmxvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBpZiBub25lIG9mIGFib3ZlIHdvcmtzLCB0cnkgdG8gc2V0IGl0IHRvIExBICg/ISlcbiAgICAgICAgICAgIGVsc2UgXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaW5pdGlhbE1hcENlbnRlciA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoMzQuMDUsIC0xMTguMjQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtYXBPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICBjZW50ZXIgICAgICA6IGluaXRpYWxNYXBDZW50ZXIsXG4gICAgICAgICAgICAgICAgICAgIHpvb20gICAgICAgIDogMTUsXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbHdoZWVsIDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgc3RyZWV0Vmlld0NvbnRyb2w6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBtYXBUeXBlQ29udHJvbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHBhbkNvbnRyb2w6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB6b29tQ29udHJvbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIG1hcFR5cGVDb250cm9sT3B0aW9uczoge1xuICAgICAgICAgICAgICAgICAgICAgIG1hcFR5cGVJZHM6IFtnb29nbGUubWFwcy5NYXBUeXBlSWQuUk9BRE1BUCwgQ0xPVURfTUFQX0lEXVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBtYXBUeXBlSWQ6IENMT1VEX01BUF9JRFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldE1hbnVhbEV2ZW50cygpe1xuICAgICAgICAgICAgZnVuY3Rpb24gQ2xvdWRNYXAob3B0aW9ucyl7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJJbml0aWFsaXppbmcgbWFwXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBpbnN0YW50aWF0ZSBnb29nbGUgbWFwXG4gICAgICAgICAgICBtYXBfb3JpZ2luID0gbmV3IGdvb2dsZS5tYXBzLk1hcChlbGVtZW50WzBdLCBtYXBPcHRpb25zKTtcblxuICAgICAgICAgICAgLy8gc2V0IHByb3RvdHlwZSBvZiBjdXN0b20gbWFwIHdpdGggb3JpZ2luIG1hcFxuICAgICAgICAgICAgQ2xvdWRNYXAucHJvdG90eXBlID0gbWFwX29yaWdpbjtcblxuICAgICAgICAgICAgLy8gZHJhdyB4IG1hcmtlclxuICAgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlRHJhd1hNYXJrZXIobG9jYXRpb24pe1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIodGhpcywgJ2RyYXdYTWFya2VyJywgbG9jYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQ2xvdWRNYXAucHJvdG90eXBlLmRyYXdYTWFya2VyID0gaGFuZGxlRHJhd1hNYXJrZXI7XG5cbiAgICAgICAgICAgIC8vIGRyYXcgY3VycmVudCBsb2NhdGlvbiBtYXJrZXJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYXdDdXJyTG9jYXRpb25NYXJrZXIobG9jYXRpb24pe1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIodGhpcywgJ2RyYXdDdXJyTG9jYXRpb25NYXJrZXInLCBsb2NhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBDbG91ZE1hcC5wcm90b3R5cGUuZHJhd0N1cnJMb2NhdGlvbk1hcmtlciA9IGhhbmRsZURyYXdDdXJyTG9jYXRpb25NYXJrZXI7XG5cbiAgICAgICAgICAgIC8vIGRyYXcgcG9zdHNcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZVVwZGF0ZUFuZERyYXdQb3N0cygpe1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIodGhpcywgJ3VwZGF0ZUFuZERyYXdQb3N0cycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQ2xvdWRNYXAucHJvdG90eXBlLnVwZGF0ZUFuZERyYXdQb3N0cyA9IGhhbmRsZVVwZGF0ZUFuZERyYXdQb3N0cztcblxuICAgICAgICAgICAgLy8gZHJhdyByZXNwb25zZXNcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYXdSZXNwb25zZXMocG9zdCl7XG4gICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcih0aGlzLCAnZHJhd1Jlc3BvbnNlcycsIHBvc3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQ2xvdWRNYXAucHJvdG90eXBlLmRyYXdSZXNwb25zZXMgPSBoYW5kbGVEcmF3UmVzcG9uc2VzO1xuXG4gICAgICAgICAgICAvLyB1bmRyYXcgcG9zdHNcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZVVuRHJhd1Bvc3QocG9zdGlkKXtcbiAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKHRoaXMsICd1bkRyYXdQb3N0JywgcG9zdGlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIENsb3VkTWFwLnByb3RvdHlwZS51bkRyYXdQb3N0ID0gaGFuZGxlVW5EcmF3UG9zdDtcblxuICAgICAgICAgICAgLy8gY3JlYXRlIGN1c3RvbSBtYXAgZm9yIGFwcFxuICAgICAgICAgICAgbWFwID0gbmV3IENsb3VkTWFwKCk7XG5cbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ2RyYXdYTWFya2VyJywgZnVuY3Rpb24obG9jYXRpb24pe1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShsb2NhdGlvbik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnZHJhd0N1cnJMb2NhdGlvbk1hcmtlcicsIGZ1bmN0aW9uKGxvY2F0aW9uKXtcbiAgICAgICAgICAgICAgICBkcmF3RHJvcERvd24obG9jYXRpb24pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ3VwZGF0ZUFuZERyYXdQb3N0cycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgdXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnZHJhd1Jlc3BvbnNlcycsIGZ1bmN0aW9uKHBvc3Qpe1xuICAgICAgICAgICAgICAgIGRyYXdSZXNwb25zZXMocG9zdCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAndW5EcmF3UG9zdCcsIGZ1bmN0aW9uKHBvc3RpZCl7XG4gICAgICAgICAgICAgICAgdW5EcmF3UG9zdChwb3N0aWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRTdHlsZUZvck1hcCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBmZWF0dXJlT3B0c19kYXkgPSBbe1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzYxOTVhMFwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJhZG1pbmlzdHJhdGl2ZS5wcm92aW5jZVwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwibGFuZHNjYXBlXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wibGlnaHRuZXNzXCI6XCIwXCJ9LHtcInNhdHVyYXRpb25cIjpcIjBcIn0se1wiY29sb3JcIjpcIiNmNWY1ZjJcIn0se1wiZ2FtbWFcIjpcIjFcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwibGFuZHNjYXBlLm1hbl9tYWRlXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcImxpZ2h0bmVzc1wiOlwiLTNcIn0se1wiZ2FtbWFcIjpcIjEuMDBcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwibGFuZHNjYXBlLm5hdHVyYWwudGVycmFpblwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9mZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJwb2kucGFya1wiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LmZpbGxcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiNiYWU1Y2VcIn0se1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJzYXR1cmF0aW9uXCI6LTEwMH0se1wibGlnaHRuZXNzXCI6NDV9LHtcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnkuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2ZhYzlhOVwifSx7XCJ2aXNpYmlsaXR5XCI6XCJzaW1wbGlmaWVkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuaGlnaHdheVwiLFwiZWxlbWVudFR5cGVcIjpcImxhYmVscy50ZXh0XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNGU0ZTRlXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNzg3ODc4XCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMuaWNvblwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJzaW1wbGlmaWVkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInRyYW5zaXQuc3RhdGlvbi5haXJwb3J0XCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLmljb25cIixcInN0eWxlcnNcIjpbe1wiaHVlXCI6XCIjMGEwMGZmXCJ9LHtcInNhdHVyYXRpb25cIjpcIi03N1wifSx7XCJnYW1tYVwiOlwiMC41N1wifSx7XCJsaWdodG5lc3NcIjpcIjBcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdC5zdGF0aW9uLnJhaWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNDMzMjFlXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInRyYW5zaXQuc3RhdGlvbi5yYWlsXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLmljb25cIixcInN0eWxlcnNcIjpbe1wiaHVlXCI6XCIjZmY2YzAwXCJ9LHtcImxpZ2h0bmVzc1wiOlwiNFwifSx7XCJnYW1tYVwiOlwiMC43NVwifSx7XCJzYXR1cmF0aW9uXCI6XCItNjhcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwid2F0ZXJcIixcImVsZW1lbnRUeXBlXCI6XCJhbGxcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiNlYWY2ZjhcIn0se1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwid2F0ZXJcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjYzdlY2VkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcIndhdGVyXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJsaWdodG5lc3NcIjpcIi00OVwifSx7XCJzYXR1cmF0aW9uXCI6XCItNTNcIn0se1wiZ2FtbWFcIjpcIjAuNzlcIn1dfV07XG5cbiAgICAgICAgICAgIHZhciBmZWF0dXJlT3B0c19uaWdodCA9IFt7XCJmZWF0dXJlVHlwZVwiOlwiYWxsXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2ZmZmZmZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJhbGxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5zdHJva2VcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn0se1wiY29sb3JcIjpcIiMzZTYwNmZcIn0se1wid2VpZ2h0XCI6Mn0se1wiZ2FtbWFcIjowLjg0fV19LHtcImZlYXR1cmVUeXBlXCI6XCJhbGxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMuaWNvblwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwiYWRtaW5pc3RyYXRpdmVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJ3ZWlnaHRcIjowLjZ9LHtcImNvbG9yXCI6XCIjMTgyYTNkXCJ9LHtcInZpc2liaWxpdHlcIjpcIm9uXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcImxhbmRzY2FwZVwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjMWE1MjhiXCJ9LHtcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiM0MDZkODBcIn0se1widmlzaWJpbGl0eVwiOlwib2ZmXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInBvaS5wYXJrXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiMyYzVhNzFcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNjZhOWVlXCJ9LHtcImxpZ2h0bmVzc1wiOi0zN30se1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LmZpbGxcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHRcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib2ZmXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQubG9jYWxcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5zdHJva2VcIixcInN0eWxlcnNcIjpbe1wibGlnaHRuZXNzXCI6XCItMTFcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjZmY3ZTRlXCJ9LHtcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdC5zdGF0aW9uLmFpcnBvcnRcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwid2F0ZXJcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzE4MmEzZFwifV19XTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gc2V0IG1hcCBkZXBlbmRzIG9uIGRheXRpbWUgb3IgbmlnaHR0aW1lXG4gICAgICAgICAgICB2YXIgY3VycmVudFRpbWUgPSBuZXcgRGF0ZSgpOyAvLyBmb3Igbm93XG4gICAgICAgICAgICB2YXIgY3VycmVudEhvdXIgPSBjdXJyZW50VGltZS5nZXRIb3VycygpO1xuICAgICAgICAgICAgdmFyIGZlYXR1cmVPcHRzO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRIb3VyIDwgNCB8fCBjdXJyZW50SG91ciA+IDE5KXtcbiAgICAgICAgICAgICAgICBmZWF0dXJlT3B0cyA9IGZlYXR1cmVPcHRzX25pZ2h0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmZWF0dXJlT3B0cyA9IGZlYXR1cmVPcHRzX2RheTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHN0eWxlZE1hcE9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ0N1c3RvbSBTdHlsZSdcbiAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGN1c3RvbU1hcFR5cGUgPSBuZXcgZ29vZ2xlLm1hcHMuU3R5bGVkTWFwVHlwZShmZWF0dXJlT3B0cywgc3R5bGVkTWFwT3B0aW9ucyk7XG4gICAgICAgICAgICBtYXAubWFwVHlwZXMuc2V0KENMT1VEX01BUF9JRCwgY3VzdG9tTWFwVHlwZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpbml0IHRoZSBtYXBcbiAgICAgICAgZnVuY3Rpb24gaW5pdE1hcCgpIHtcbiAgICAgICAgICAgIGlmIChtYXAgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIGluaXRpYWxNYXBEYXRhKCk7XG5cbiAgICAgICAgICAgICAgICBzZXRNYW51YWxFdmVudHMoKTtcblxuICAgICAgICAgICAgICAgIHNldFN0eWxlRm9yTWFwKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGJyb2FkY2FzdCB0byBzZW5kIG1hcCB0byBhcHBsaWNhdGlvbiBjdHJsXG4gICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0Om1hcCcsIG1hcCk7XG5cbiAgICAgICAgICAgIC8vIGFkZCBVSSBlbGVtZW50cyB0byBtYXBcbiAgICAgICAgICAgIHNldFVJU2VhcmNoTG9jYXRpb25Ub2dnbGUoKTtcbiAgICAgICAgICAgIHNldFVJU2VhcmNoQm94KCk7XG4gICAgICAgICAgICBzZXRVSU1vdmVUb0N1cnJMb2NCdG4oKTtcbiAgICAgICAgICAgIHNldFVJUG9zdEZvcm0oKTtcbiAgICAgICAgICAgIHNldFVJUG9zdEJ0bigpO1xuICAgICAgICAgICAgc2V0VUlUaW1lU2xpZGVyKCk7XG5cbiAgICAgICAgICAgIC8vIGFkZCBvcmlnaW4gbmF0aXZlIEV2ZW50IGhhbmRsZXJzIHRvIG1hcFxuICAgICAgICAgICAgc2V0RXZlbnRDbGljaygpO1xuICAgICAgICAgICAgc2V0RXZlbnRDZW50ZXJDaGFuZ2VkKCk7XG4gICAgICAgICAgICBzZXRFdmVudERyYWdFbmQoKTtcbiAgICAgICAgICAgIHNldEV2ZW50UmVzaXplKCk7XG4gICAgICAgICAgICBzZXRFdmVudFpvb21DaGFuZ2VkKCk7XG4gICAgICAgICAgICBzZXRFdmVudEJvdW5kc0NoYW5nZWQoKTtcblxuICAgICAgICAgICAgLy8gdXBkYXRlIHZlcnkgZmlyc3QgdGltZSBmb3IgYXBwXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHVwZGF0ZURlZmF1bHRMb2NhdGlvbigpO1xuICAgICAgICAgICAgICAgIHVwZGF0ZUJvdW5kcygpO1xuICAgICAgICAgICAgICAgIHVwZGF0ZVdhdGNoTG9jYXRpb24oKTtcbiAgICAgICAgICAgICAgICB1cGRhdGVBbmREcmF3UG9zdHMoKTtcbiAgICAgICAgICAgIH0sIDgwMCk7XG4gICAgICAgIH0gXG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gRVhFQ1VURVxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICBpbml0TWFwKCk7XG4gICAgICAgIHNjb3BlLmluaXRTZXNzaW9uKCk7IC8vIHRoaXMgaGF2ZSB0byBydW4gYWx3YXlzIGFmdGVyIHRoZSBtYXAgaXMgaW5pdGlhbGl6ZWQuXG5cbiAgICAgICAgZHJhd0hlbHBlck1hcmtlcihpbml0aWFsTWFwQ2VudGVyKTtcbiAgICAgICAgc2V0UGxhY2UoaW5pdGlhbE1hcENlbnRlcik7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgaWQ9XCJtYXAtY2FudmFzXCI+PC9kaXY+JyxcbiAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgbGluazogbGlua1xuICAgIH07XG59KTtcblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uZGlyZWN0aXZlKCdtYXBNc2cnLCBmdW5jdGlvbiAoJHRpbWVvdXQsIFNlc3Npb25TdmMsIFBvc3RzU3ZjKSB7XG5cbiAgICB2YXIgbGluayA9IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykgeyAgIFxuXG4gICAgICAgIHNjb3BlLmdldF9sb2NhbHN0YXR1cyA9IGZ1bmN0aW9uKGxvY2FsX3N0YXR1cyl7XG4gICAgICAgICAgaWYgKGxvY2FsX3N0YXR1cylcbiAgICAgICAgICAgIHJldHVybiBcImxvY2FsLXRleHRcIjtcbiAgICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXR1cm4gXCJub24tbG9jYWwtdGV4dFwiO1xuICAgICAgICB9OyAgICAgXG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gQ09VUExJTkcgQ0xBU1NcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLyogY291cGxpbmcgc3RhdHVzXG4gICAgICAgICAgMCAtIG5vIHN0YXR1c1xuICAgICAgICAgIDEgLSBpIGxpa2UgeW91XG4gICAgICAgICAgMiAtIHlvdSBsaWtlIGlcbiAgICAgICAgICA0IC0gd2UgbGlrZSBlYWNoIG90aGVyXG4gICAgICAgICovXG4gICAgICAgIHNjb3BlLmdldF9jb3VwbGluZyA9IGZ1bmN0aW9uKGNvdXBsaW5nX3N0YXR1cyl7XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKGNvdXBsaW5nX3N0YXR1cyA9PSA0KXtcbiAgICAgICAgICAgIHJldHVybiBcImNvdXBsaW5nIGNvdXBsaW5nLWNvdXBsZVwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmIChjb3VwbGluZ19zdGF0dXMgPT0gMSl7XG4gICAgICAgICAgICByZXR1cm4gXCJjb3VwbGluZyBjb3VwbGluZy1pbGlrZXlvdVwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmIChjb3VwbGluZ19zdGF0dXMgPT0gMil7XG4gICAgICAgICAgICByZXR1cm4gXCJjb3VwbGluZyBjb3VwbGluZy15b3VsaWtlaVwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBcImNvdXBsaW5nIGNvdXBsaW5nLW5vbmVcIjtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gRE9DVU1FTlQgUkVBRFlcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcblxuICAgICAgICAgICR0aW1lb3V0KHVwZGF0ZUd1aWRUYXJnZXQsIDEwMCk7XG5cbiAgICAgICAgICAkdGltZW91dCh1cGRhdGVQb3N0VGltZXIsIDEwKTtcblxuICAgICAgICAgICR0aW1lb3V0KGN1c3RvbWl6ZUluZm9XaW5kb3csIDEwKTtcblxuICAgICAgICAgICR0aW1lb3V0KGN1c3RvbWl6ZUNsb3NlQnRuLCAxMCk7XG5cbiAgICAgICAgICAvL2NvbnNvbGUubG9nKFwicG9zdCBsb2NhbCBzdGF0dXM6XCIsIHNjb3BlLnBvc3Rsb2NhbHN0YXR1cyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUd1aWRUYXJnZXQoKXtcbiAgICAgICAgICAvLyB1cGRhdGUgc3RhdHVzIGZvciBndWlkIHRhcmdldFxuICAgICAgICAgIHZhciBwb3N0Z3VpZCAgPSBzY29wZS5wb3N0Z3VpZDtcbiAgICAgICAgICB2YXIgbXlndWlkICAgID0gc2NvcGUuJHBhcmVudC5ndWlkO1xuICAgICAgICAgIHZhciBteWd1aWR0Z3QgPSBzY29wZS4kcGFyZW50Lmd1aWR0Z3Q7XG5cbiAgICAgICAgICBlbGVtZW50LmNoaWxkcmVuKCkub24oJ2NsaWNrJyxmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICB2YXIgdXBkYXRlX2d1aWR0Z3QgPSBwb3N0Z3VpZDtcblxuICAgICAgICAgICAgLy8gY2xpY2tpbmcgbXkgbWVzc2FnZSB3aW5kb3dcbiAgICAgICAgICAgIC8vIGlmIGl0cyBvbiBjb3VwbGluZywgYnJlYWsgaXQhXG4gICAgICAgICAgICBpZiAocG9zdGd1aWQgPT0gbXlndWlkKXtcbiAgICAgICAgICAgICAgaWYgKHNjb3BlLiRwYXJlbnQuZ3VpZHRndCAhPSAnMCcpe1xuICAgICAgICAgICAgICAgIHVwZGF0ZV9ndWlkdGd0ID0gJzAnOyBcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gY2xpa2luZyB0aGUgb25lIHRoYXQgSSBsaWtlZFxuICAgICAgICAgICAgLy8gdG8gZGlzbGlrZSB0aGUgbWVzc2FnZSB3aW5kb3dcbiAgICAgICAgICAgIGlmIChwb3N0Z3VpZCA9PSBteWd1aWR0Z3QpIHtcbiAgICAgICAgICAgICAgdXBkYXRlX2d1aWR0Z3QgPSAnMCc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHByb3BhZ2F0ZSB0byB1cHBlciBzY29wZSBmb3IgZ3VpZHRndCB1cGRhdGVcbiAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdzZXQ6Z3VpZHRndCcsIHVwZGF0ZV9ndWlkdGd0KTsgXG5cbiAgICAgICAgICAgIC8vIHVwZGF0ZSBzZXNzaW9uIGluZm9ybWF0aW9uIG9mIG1pbmUgc28gbXkgc2Vzc2lvbiB0ZWxscyBtZSB0aGF0LFxuICAgICAgICAgICAgLy8gSSBsaWtlIHRoaXMgZ3VpZCBhdCB0aGlzIG1vbWVudCBpbiBzZXJ2ZXIgZGJcbiAgICAgICAgICAgIFNlc3Npb25TdmMudXBkYXRlQ291cGxpbmcobXlndWlkLCB1cGRhdGVfZ3VpZHRndClcbiAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oZG9jKXtcbiAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJTdWNjZXNzZnVsbHkgdWRwYXRlZCBjb3VwbGluZ1wiLCBkb2MpO1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyB1cGRhdGUgbXkgcG9zdCdzIGd1aWR0Z3QgdG8gYmUgdGhpcyBwb3N0J3MgZ3VpZCBpbiBzZXJ2ZXIgZGJcbiAgICAgICAgICAgIC8vIHRoaXMgdXBkYXRlIGlzIGZvciB0aGUgcGVvcGxlIHdobyBhcmUgbG9va2luZyBhdCBteSBwb3N0c1xuICAgICAgICAgICAgdmFyIHVwZGF0ZXMgPSB7XG4gICAgICAgICAgICAgIGd1aWQgICAgOiBteWd1aWQsXG4gICAgICAgICAgICAgIGd1aWR0Z3QgOiB1cGRhdGVfZ3VpZHRndFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFBvc3RzU3ZjLnVwZGF0ZUd1aWR0Z3QodXBkYXRlcylcbiAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oZG9jKXtcbiAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJTdWNjZXNzZnVsbHkgdWRwYXRlZCBwb3N0J3MgZ3VpZHRndFwiLCBkb2MpO1xuICAgICAgICAgICAgICAgICAgLy8gYWZ0ZXIgY291cGxpbmcgdXBkYXRlLCBtYXAgaGFzIHRvIGJlIHVwZGF0ZXMgYXMgd2VsbFxuICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgLy8gTUlHSFQgSEFWRSBUTyBDT01FIEJBQ0sgRk9SIE9QVElNSVpBVElPTlxuICAgICAgICAgICAgLy8gdGhpcyBoYXZlIHRvIGJlIHVwZGF0ZSB0byBiZSBjb21tdW5pY2F0ZWQgdGhyb3VnaCB0aGUgc2VydmVyXG4gICAgICAgICAgICBpZiAoc2NvcGUuJHBhcmVudC5ndWlkdGd0ID09IDApe1xuICAgICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0OmNvdXBsaW5nJywgMSk7IC8vIHByb3BhZ2F0ZSB0byB1cHBlciBzY29wZSBmb3IgY291cGxpbmcgdXBkYXRlXG4gICAgICAgICAgICAgIHNjb3BlLiRhcHBseSgpOyAvLyBmb3JjZSB0byB1cGRhdGUgRE9NXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0Y291cGxlc3RhdHVzID09IDEgJiYgc2NvcGUuJHBhcmVudC5ndWlkdGd0ICE9IDApe1xuICAgICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0OmNvdXBsaW5nJywgMCk7IC8vIHByb3BhZ2F0ZSB0byB1cHBlciBzY29wZSBmb3IgY291cGxpbmcgdXBkYXRlXG4gICAgICAgICAgICAgIHNjb3BlLiRhcHBseSgpOyAvLyBmb3JjZSB0byB1cGRhdGUgRE9NXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAqL1xuICAgICAgICAgICAgXG5cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVBvc3RUaW1lcigpe1xuICAgICAgICAgIC8vY29uc29sZS5sb2coXCJMaWZlICU6XCIsIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSk7XG4gICAgICAgICAgICB2YXIgZHVyYXRpb24gPSBzY29wZS5wb3N0bGlmZSArIFwibXNcIjtcblxuICAgICAgICAgICAgdmFyIHBvc3RiYXJsaWZlID0gZWxlbWVudC5jaGlsZHJlbigpLmNoaWxkcmVuKFwiLnBvc3RsaWZlYmFyXCIpO1xuXG4gICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1kdXJhdGlvbicsIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tZHVyYXRpb24nLCBkdXJhdGlvbik7XG4gICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tZHVyYXRpb24nLCBkdXJhdGlvbik7XG4gICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLWR1cmF0aW9uJywgZHVyYXRpb24pO1xuICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tZHVyYXRpb24nLCBkdXJhdGlvbik7XG5cbiAgICAgICAgICAgIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjk1KXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2EnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9hJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9hJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9hJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPD0gMC45NSAmJiBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjkpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2InKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2InKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9iJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2InKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA8PSAwLjkgJiYgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC44NSl7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9jJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYycpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYycpO1xuICAgICAgICAgICAgICBwb3N0bGlmZWJhcl9jc3MgPSBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2MnKTtcbiAgICAgICAgICAgICAgcG9zdGxpZmViYXJfY3NzID0gcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlIDw9IDAuODUgJiYgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC43NSl7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9kJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZCcpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZCcpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2QnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlIDw9IDAuNzUgJiYgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC42KXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2UnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9lJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9lJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9lJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPD0gMC42ICYmIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuNSl7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9mJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2YnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlIDw9IDAuNSAmJiBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjMpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZycpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2cnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2cnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9nJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2cnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA8PSAwLjMgJiYgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC4yKXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2gnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9oJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9oJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faCcpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9oJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPD0gMC4yICYmIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuMSl7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9pJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2knKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2onKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9qJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9qJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9qJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjdXN0b21pemVJbmZvV2luZG93KCl7XG4gICAgICAgICAgLy8gUmVmZXJlbmNlIHRvIHRoZSBESVYgdGhhdCB3cmFwcyB0aGUgYm90dG9tIG9mIGluZm93aW5kb3dcbiAgICAgICAgICB2YXIgaXdPdXRlciA9ICQoJy5nbS1zdHlsZS1pdycpO1xuICAgICAgICAgIFxuICAgICAgICAgIHZhciBpd0JhY2tncm91bmQgPSBpd091dGVyLnByZXYoKTtcblxuICAgICAgICAgIC8vIFJlbW92ZSB0aGUgYmFja2dyb3VuZCBzaGFkb3cgRElWXG4gICAgICAgICAgIGl3QmFja2dyb3VuZC5jaGlsZHJlbignOm50aC1jaGlsZCgyKScpLmNzcyh7J2Rpc3BsYXknIDogJ25vbmUnfSk7XG5cbiAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSB3aGl0ZSBiYWNrZ3JvdW5kIERJVlxuICAgICAgICAgICBpd0JhY2tncm91bmQuY2hpbGRyZW4oJzpudGgtY2hpbGQoNCknKS5jc3MoeydkaXNwbGF5JyA6ICdub25lJ30pO1xuXG4gICAgICAgICAgLy8gQ2hhbmdlcyB0aGUgZGVzaXJlZCB0YWlsIHNoYWRvdyBjb2xvci5cbiAgICAgICAgICBpd0JhY2tncm91bmQuY2hpbGRyZW4oJzpudGgtY2hpbGQoMyknKS5maW5kKCdkaXYnKS5jaGlsZHJlbigpLmNzcyh7XG4gICAgICAgICAgICAnYm94LXNoYWRvdyc6ICcwIDFweCA2cHggcmdiYSgxNzgsIDE3OCwgMTc4LCAwLjYpJywgXG4gICAgICAgICAgICAnei1pbmRleCcgOiAnMScsXG4gICAgICAgICAgICAnYm9yZGVyJzogJzBweCd9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGN1c3RvbWl6ZUNsb3NlQnRuKCl7XG4gICAgICAgICAgLy8gUmVmZXJlbmNlIHRvIHRoZSBESVYgdGhhdCB3cmFwcyB0aGUgYm90dG9tIG9mIGluZm93aW5kb3dcbiAgICAgICAgICB2YXIgaXdPdXRlciA9ICQoJy5nbS1zdHlsZS1pdycpO1xuXG4gICAgICAgICAgdmFyIGl3Q2xvc2VCdG4gPSBpd091dGVyLm5leHQoKTtcblxuICAgICAgICAgIC8qXG4gICAgICAgICAgY29uc29sZS5sb2coXCJwb3N0bG9jYWwgbGVhbnRoOlwiLCBpd091dGVyLnBhcmVudCgpLmZpbmQoJyNwb3N0bG9jYWwnKS5sZW5ndGgpO1xuICAgICAgICAgIGlmIChzY29wZS5wb3N0bG9jYWxzdGF0dXMgPT0gZmFsc2UgJiYgMCA9PSBpd091dGVyLnBhcmVudCgpLmZpbmQoJyNwb3N0bG9jYWwnKS5sZW5ndGgpe1xuICAgICAgICAgICAgaXdDbG9zZUJ0bi5hZnRlcihcIjxpbWcgaWQ9J3Bvc3Rsb2NhbCcgc3JjPSdodHRwOi8vY2RuLWltZy5lYXN5aWNvbi5uZXQvcG5nLzI0LzI0NDAucG5nJyB3aWR0aD0nMjAnLCBoZWlnaHQ9JzIwJy8+XCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAqL1xuXG4gICAgICAgICAgLy8gQXBwbHkgdGhlIGRlc2lyZWQgZWZmZWN0IHRvIHRoZSBjbG9zZSBidXR0b25cbiAgICAgICAgICBpd0Nsb3NlQnRuLmNzcyh7XG4gICAgICAgICAgICBvcGFjaXR5OiAnMC44JywgLy8gYnkgZGVmYXVsdCB0aGUgY2xvc2UgYnV0dG9uIGhhcyBhbiBvcGFjaXR5IG9mIDAuN1xuICAgICAgICAgICAgcmlnaHQ6ICcyMHB4JywgdG9wOiAnMjBweCcsIC8vIGJ1dHRvbiByZXBvc2l0aW9uaW5nXG4gICAgICAgICAgfSk7IFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcuL3RlbXBsYXRlcy93aW5kb3cuaHRtbCcsXG4gICAgICAgIGxpbms6IGxpbmtcbiAgICB9O1xufSk7IiwiXG5hbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuXHQnbmdSb3V0ZScsXG5cdCduZ0FuaW1hdGUnLFxuXHQndWkuc2xpZGVyJ1xuXSk7XG5cblxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignQXBwbGljYXRpb25DdHJsJywgZnVuY3Rpb24oU2Vzc2lvblN2YywgVXRpbFN2YywgQ29uZmlnU3ZjLCAkcm9vdFNjb3BlLCAkc2NvcGUsICR3aW5kb3csICRodHRwLCAkdGltZW91dCl7XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIElOSVRJQUxcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgd2luZG93Lm9uYmVmb3JldW5sb2FkID0gZnVuY3Rpb24oZSkge1xuICAgIFx0U2Vzc2lvblN2Yy5yZW1vdmUoJHNjb3BlLmd1aWQpXG4gICAgXHQuc3VjY2VzcyhmdW5jdGlvbihyZXMpe1xuICAgIFx0XHQvLyBoYW5kbGUgc3VjY2Vzc1xuICAgIFx0fSlcbiAgICBcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgIFx0XHQvLyBoYW5kbGUgZXJyb3JcbiAgICBcdH0pO1xuXHR9O1xuXG5cdHdpbmRvdy5vbnBhZ2VzaG93ID0gZnVuY3Rpb24oZSkge1xuXHRcdCRzY29wZS5pbml0U2Vzc2lvbigpO1xuXHRcdGlmICgkc2NvcGUubWFwKVxuXHQgIFx0XHQkc2NvcGUubWFwLnVwZGF0ZUFuZERyYXdQb3N0cygpO1xuXHR9O1xuXG5cdHdpbmRvdy5vbnBhZ2VoaWRlID0gZnVuY3Rpb24oZSkge1xuICAgIFx0U2Vzc2lvblN2Yy5yZW1vdmUoJHNjb3BlLmd1aWQpXG4gICAgXHQuc3VjY2VzcyhmdW5jdGlvbihyZXMpe1xuICAgIFx0XHQvLyBoYW5kbGUgc3VjY2Vzc1xuICAgIFx0fSlcbiAgICBcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgIFx0XHQvLyBoYW5kbGUgZXJyb3JcbiAgICBcdH0pO1xuXHR9O1xuXG5cdC8vIHNlc3Npb24gaW4gYW5kIG91dCBldmVudHNcblx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIiwgZnVuY3Rpb24oKSB7XG5cdCAgaWYgKGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAndmlzaWJsZScgfHwgXG5cdCAgXHRkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ21velZpc2libGUnIHx8IFxuXHQgIFx0ZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09ICdtc1Zpc2libGUnIHx8XG5cdCAgXHRkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ3dlYmtpdFZpc2libGUnKVxuXHQgIHtcblx0ICBcdCRzY29wZS5pbml0U2Vzc2lvbigpO1xuXHQgIFx0aWYgKCRzY29wZS5tYXApXG5cdCAgXHRcdCRzY29wZS5tYXAudXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cdCAgfSBcblx0ICBlbHNlIGlmIChkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ2hpZGRlbicgfHwgXG5cdCAgXHRkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ21vekhpZGRlbicgfHwgXG5cdCAgXHRkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ21zSGlkZGVuJyB8fFxuXHQgIFx0ZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09ICd3ZWJraXRIaWRkZW4nKVxuXHQgIHtcblx0ICBcdFNlc3Npb25TdmMucmVtb3ZlKCRzY29wZS5ndWlkKVxuXHQgIFx0LnN1Y2Nlc3MoZnVuY3Rpb24ocmVzKXtcbiAgICBcdFx0Ly8gaGFuZGxlIHN1Y2Nlc3NcbiAgICBcdH0pXG4gICAgXHQuY2F0Y2goZnVuY3Rpb24oZXJyKXtcbiAgICBcdFx0Ly8gaGFuZGxlIGVycm9yXG4gICAgXHR9KTtcblx0ICB9XG5cdH0pO1xuXG5cdC8vIHdlYmtpdCBzZXNzaW9uIGluIGFuZCBvdXQgZXZlbnRzXG5cdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ3ZWJraXR2aXNpYmlsaXR5Y2hhbmdlXCIsIGZ1bmN0aW9uKCkge1xuXHQgIGlmIChkb2N1bWVudC53ZWJraXRWaXNpYmxlKVxuXHQgIHtcblx0ICBcdCRzY29wZS5pbml0U2Vzc2lvbigpO1xuXHQgIFx0aWYgKCRzY29wZS5tYXApXG5cdCAgXHRcdCRzY29wZS5tYXAudXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cdCAgfSBcblx0ICBlbHNlIGlmIChkb2N1bWVudC53ZWJraXRIaWRkZW4pXG5cdCAge1xuXHQgIFx0U2Vzc2lvblN2Yy5yZW1vdmUoJHNjb3BlLmd1aWQpXG5cdCAgXHQuc3VjY2VzcyhmdW5jdGlvbihyZXMpe1xuICAgIFx0XHQvLyBoYW5kbGUgc3VjY2Vzc1xuICAgIFx0fSlcbiAgICBcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgIFx0XHQvLyBoYW5kbGUgZXJyb3JcbiAgICBcdH0pO1xuXHQgIH1cblx0fSwgZmFsc2UpO1xuXG5cdCRzY29wZS5pbml0U2Vzc2lvbiA9IGZ1bmN0aW9uKCl7XG5cdFx0aWYgKCRzY29wZS5tYXAgPT0gJ3VuZGVmaW5lZCcgfHwgJHNjb3BlLm1hcCA9PSAnbnVsbCcgfHwgISRzY29wZS5tYXApXG5cdFx0XHRyZXR1cm47XG5cblx0XHRmdW5jdGlvbiBnZXRDdXJyTG9jU3VjY2Vzcyhwb3MpIHtcdFxuXHRcdFx0Ly8vLy8vLy8vLy8vLy8vLy8vIFBIWVNJQ0FMIExPQ0FUSU9OXG5cdFx0XHQvLyDrp6jsspjsnYzsl5DripQg7Jyg7KCA7J2YIOyLpOygnCDsnITsuZgo7JWx7JeQIOyeheyepe2WiOydhOuVjOydmCDsnITsuZgp7JmAIOyEvO2EsCDtj6zsp4DshZjsnYQg6rCZ7J20IOuztOuCtOqzoCxcblx0XHRcdC8vIOyEvO2EsCDtj6zsp4DshZjsnYAg6rOE7IaNIOyXheuNsOydtO2KuCDrkJjslrTslbwg7ZWc64ukLlxuXHQgICAgICAgIHZhciBjcmQgPSBwb3MuY29vcmRzO1xuXG5cdCAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoY3JkLmxhdGl0dWRlLCBjcmQubG9uZ2l0dWRlKTtcblxuXHQgICAgICAgIC8vIHNhdmUgdGhlIHVzZXIgbG9jYXRpb24gaW50byBhcHBsaWNhdGlvbiBzY29wZSB2YXJpYWJsZVxuXHQgICAgICAgICRzY29wZS51c2VyTG9jYXRpb24gPSB7XG5cdCAgICAgICAgXHRsYXQ6IGNyZC5sYXRpdHVkZSxcblx0ICAgICAgICBcdGxvbjogY3JkLmxvbmdpdHVkZVxuXHQgICAgICAgIH07XG5cblx0ICAgICAgICB2YXIgbG9jYXRpb24gPSB7XG5cdCAgICBcdFx0bGF0Omdvb2dsZUxvYy5sYXQoKSxcblx0ICAgIFx0XHRsb246Z29vZ2xlTG9jLmxuZygpXG5cdCAgICBcdH07XG5cdCAgICBcdHZhciBsb2NhdGlvbkpTT04gPSBKU09OLnN0cmluZ2lmeShsb2NhdGlvbik7XG5cdCAgICBcdC8vY29uc29sZS5sb2coXCJzZXR0aW5nIGxvY2F0aW9uXCIsIGxvY2F0aW9uSlNPTik7XG5cblx0ICAgIFx0Ly8vLy8vLy8vLy8vLy8vLy8vIFdBVENIIExPQ0FUSU9OXG5cdCAgICBcdHZhciBib3VuZHMgPSAkc2NvcGUubWFwLmdldEJvdW5kcygpO1xuXHQgICAgICAgIHZhciBuZSA9IGJvdW5kcy5nZXROb3J0aEVhc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBub3J0aC1lYXN0IGNvcm5lclxuXHQgICAgICAgIHZhciBzdyA9IGJvdW5kcy5nZXRTb3V0aFdlc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBzb3V0aC13ZXN0IGNvcmRlclxuXHQgICAgICAgIC8vWW91IGdldCBub3J0aC13ZXN0IGFuZCBzb3V0aC1lYXN0IGNvcm5lcnMgZnJvbSB0aGUgdHdvIGFib3ZlOlxuXG5cdCAgICAgICAgdmFyIGN1cnJlbnRfbWFwX253ID0geyBcblx0ICAgICAgICAgICAgbGF0OiBuZS5sYXQoKSwgXG5cdCAgICAgICAgICAgIGxvbjogc3cubG5nKClcblx0ICAgICAgICB9O1xuXHQgICAgICAgIHZhciBjdXJyZW50X21hcF9zZSA9IHtcblx0ICAgICAgICAgICAgbGF0OiBzdy5sYXQoKSwgXG5cdCAgICAgICAgICAgIGxvbjogbmUubG5nKClcblx0ICAgICAgICB9O1xuXG5cdCAgICAgICAgdmFyIGN1cnJlbnRfbWFwX2NlbnRlciA9IHtcblx0ICAgICAgICBcdGxhdDp3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlLFxuXHQgICAgICAgIFx0bG9uOndpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlXG5cdCAgICBcdH07XG5cblx0ICAgICAgICB2YXIgd2F0Y2hsb2MgPSB7XG5cdCAgICAgICAgICAgIG53X2xhdCAgICA6IGN1cnJlbnRfbWFwX253LmxhdCxcblx0ICAgICAgICAgICAgbndfbG9uICAgIDogY3VycmVudF9tYXBfbncubG9uLFxuXHQgICAgICAgICAgICBzZV9sYXQgICAgOiBjdXJyZW50X21hcF9zZS5sYXQsXG5cdCAgICAgICAgICAgIHNlX2xvblx0ICA6IGN1cnJlbnRfbWFwX3NlLmxvbixcblx0ICAgICAgICAgICAgY2VudGVyX2xhdDogY3VycmVudF9tYXBfY2VudGVyLmxhdCxcblx0ICAgICAgICAgICAgY2VudGVyX2xvbjogY3VycmVudF9tYXBfY2VudGVyLmxvblxuXHQgICAgICAgIH1cblxuICAgICAgICBcdHZhciB3YXRjaGxvY0pTT04gPSBKU09OLnN0cmluZ2lmeSh3YXRjaGxvYyk7XG4gICAgICAgIFx0Ly9jb25zb2xlLmxvZyhcInNldHRpbmcgd2F0Y2hsb2NcIiwgd2F0Y2hsb2NKU09OKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vIExPQ0FUSU9OIFVQREFURSBXSVRIIFNFU1NJT04gRU5URVJcbiAgICAgICAgICAgIC8v7Jes6riw7IScIOu5hOuPmeq4sOyggeycvOuhnCDsnKDsoIDsnZgg66Gc7LyA7J207IWY7J2EIOyWu+qzoCDshLjshZjsnYQg67O064K87IiYIOyeiOuLpC5cblx0XHRcdHZhciBzZXNzaW9uID0ge1xuXHRcdFx0XHRndWlkdGd0IDogJHNjb3BlLmd1aWR0Z3QsXG5cdFx0XHRcdGd1aWQgICAgOiAkc2NvcGUuZ3VpZCxcblx0XHRcdFx0bG9jYXRpb246IGxvY2F0aW9uSlNPTixcblx0XHRcdFx0d2F0Y2hsb2M6IHdhdGNobG9jSlNPTlxuXHRcdFx0fTtcblx0XHRcdFNlc3Npb25TdmMuZW50ZXIoc2Vzc2lvbilcblx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uKHJlcyl7XG4gICAgXHRcdC8vIGhhbmRsZSBzdWNjZXNzXG5cdCAgICBcdH0pXG5cdCAgICBcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xuXHQgICAgXHRcdC8vIGhhbmRsZSBlcnJvclxuXHQgICAgXHR9KTsgLy8g7ISc67KE7JeQ7IScIOycoOyggOqwgCDrk6TslrTsmLTsnYQg7JWM66aw64ukLlxuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiBnZXRDdXJyTG9jRXJyb3IoZXJyKSB7XG4gICAgICAgIFx0c3dhbChcIlwiLCBcIk5lZWQgdG8gdHVybiBvbiBsb2NhdGlvbiBzZXJ2aWNlIGZvciBwcm9wZXIgdXNlLlwiKTtcbiAgICAgICAgICAgIC8vY29uc29sZS53YXJuKCdFUlJPUignICsgZXJyLmNvZGUgKyAnKTogJyArIGVyci5tZXNzYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGluaXQgbWFwIGFuZCBwbGFjZSBzb21lIG1hcmtlcnMsIHNvIGV2ZXJ5dGhpbmcgc3RhcnQgd2l0aCB0aGlzIGZ1bmN0aW9uLlxuICAgICAgICB2YXIgb3B0aW9ucyA9IHtcblx0XHQgIGVuYWJsZUhpZ2hBY2N1cmFjeTogZmFsc2UsXG5cdFx0ICB0aW1lb3V0OiA1MDAwLFxuXHRcdCAgbWF4aW11bUFnZTogMFxuXHRcdH07XG5cdCAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGdldEN1cnJMb2NTdWNjZXNzLCBnZXRDdXJyTG9jRXJyb3IsIG9wdGlvbnMpO1xuXHRcdHN3YWwoeyAgIHRpdGxlOiBcIlwiLCAgIHRleHQ6IFwiUmV0cmVpdmluZyBjdXJybmV0IGxvY2F0aW9uLi5cIiwgICB0aW1lcjogMzUwMCwgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UgfSk7XG5cdH07XG5cbiAgICAvLyBsb2FkIGFuZCBzZXQgbGF0ZXN0IGd1aWRcblx0aWYgKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZCA9PSAndW5kZWZpbmVkJyB8fCBcblx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWQgPT0gJ251bGwnIHx8XG5cdFx0IXdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZClcblx0e1xuXHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZCA9IFV0aWxTdmMuZ2V0R3VpZCgpO1xuXHR9XG5cdCRzY29wZS5ndWlkID0gd2luZG93LmxvY2FsU3RvcmFnZS5ndWlkO1xuXG5cdC8vIGxvYWQgYW5kIHNldCBsYXRlc3QgZ3VpZHRndFxuXHRpZiAod2luZG93LmxvY2FsU3RvcmFnZS5ndWlkdGd0ID09ICd1bmRlZmluZWQnIHx8IFxuXHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZHRndCA9PSAnbnVsbCcgfHxcblx0XHQhd2luZG93LmxvY2FsU3RvcmFnZS5ndWlkdGd0KVxuXHR7XG5cdFx0d2luZG93LmxvY2FsU3RvcmFnZS5ndWlkdGd0ID0gXCIwXCI7XG5cdH1cblx0JHNjb3BlLmd1aWR0Z3QgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmd1aWR0Z3Q7IC8vIGludGVyZXN0ZWQgb3Bwb25lbnQgZ3VpZCBudW1iZXJcblxuXHQkc2NvcGUucGFnZUlkID0geyBcblx0XHRwb3N0IDogMCxcblx0fTtcblxuXHQkc2NvcGUubmF2Q29sbGFwc2VkID0gdHJ1ZTtcblxuXHQvLyB2YWx1ZSBmcm9tIHRpbWUgc2xpZGVyIGluIFVJXG5cdC8vIGRlZmF1bHQgaXMgbWF4IGluc3RhbnQgbGlmZSBzcGFuXG4gICAgJHNjb3BlLnRpbWV2YWx1ZSA9IENvbmZpZ1N2Yy5tYXhJbnN0YW50TGlmZVNwYW47XG5cblx0Ly8gdXNlcidzIGN1cnJlbnQgbG9jYXRpb24gc3RvcmFnZVxuXHQkc2NvcGUudXNlckxvY2F0aW9uID0ge1xuXHRcdGxhdDogMC4wLFxuXHRcdGxvbjogMC4wXG5cdH07XG5cblx0JHNjb3BlLnRvZ2dsZVNlYXJjaExvY2F0aW9uID0gZmFsc2U7XG5cdCRzY29wZS50b2dnbGVUaW1lU2xpZGVyID0gZmFsc2U7XG5cblx0Ly8gZXZlbnQgaGFuZGVyIGZvciBtYXAgVUlzXG5cdCR0aW1lb3V0KGZ1bmN0aW9uKCl7XG5cdFx0Ly8gZW5hYmxlcyBlbnRlciBrZXkgdG8gc3VibWl0IHBvc3QgZm9ybVxuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtcG9zdGluZycpLm9ua2V5cHJlc3MgPSBmdW5jdGlvbihldmVudCl7XG5cdFx0XHQvL2NvbnNvbGUubG9nKFwiSW5zaWRlIGtleXByZXNzXCIsZXZlbnQud2hpY2gpO1xuXHRcdFx0aWYgKGV2ZW50LndoaWNoID09ICcxMycpe1xuXHRcdFx0XHQvL2NvbnNvbGUubG9nKFwiZW50ZXIgcHJlc3NlZFwiKTtcblx0XHRcdFx0JCgnZm9ybSNtYXAtcG9zdGluZy1mb3JtJykuc3VibWl0KCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1wb3N0aW5nJykub25mb2N1cyA9IGZ1bmN0aW9uKGV2ZW50KXtcblx0XHRcdC8vY29uc29sZS5sb2coXCJvbiBmb2N1c1wiKTtcblx0XHRcdCRzY29wZS50b2dnbGVUaW1lU2xpZGVyID0gdHJ1ZTtcblx0XHR9XG5cblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLXBvc3RpbmcnKS5vbmJsdXIgPSBmdW5jdGlvbihldmVudCl7XG5cdFx0XHQvL2NvbnNvbGUubG9nKFwib24gYmx1clwiKTtcblx0XHRcdCRzY29wZS50b2dnbGVUaW1lU2xpZGVyID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0JCgnLm5hdi1idXJnZXInKS5jbGljayhmdW5jdGlvbigpIHtcblx0XHQgICQoJy5uYXYtYnVyZ2VyJykudG9nZ2xlQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdCAgLy8kKCcuY29udHJvbHMnKS50b2dnbGVDbGFzcygnYWN0aXZlJyk7XG5cdFx0ICAkc2NvcGUudG9nZ2xlU2VhcmNoTG9jYXRpb24gPSAhJHNjb3BlLnRvZ2dsZVNlYXJjaExvY2F0aW9uO1xuXHRcdCAgJHNjb3BlLiRhcHBseSgpO1xuXHRcdH0pO1xuXG5cdH0pO1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBTT0NLRVRcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHR2YXIgdXJsO1xuXHR2YXIgaG9zdG5hbWUgPSBkb2N1bWVudC5sb2NhdGlvbi5ob3N0bmFtZTtcblxuXHRpZiAoaG9zdG5hbWUgPT0gQ29uZmlnU3ZjLmxvY2FsKXtcblx0XHR1cmwgPSBDb25maWdTdmMud2ViX3NvY2tldCArIENvbmZpZ1N2Yy5sb2NhbCArICc6JyArIENvbmZpZ1N2Yy5wb3J0O1xuXHR9XG5cdGVsc2UgaWYgKGhvc3RuYW1lID09IENvbmZpZ1N2Yy5sb2NhbF9pcCkge1xuXHRcdHVybCA9IENvbmZpZ1N2Yy53ZWJfc29ja2V0ICsgQ29uZmlnU3ZjLmxvY2FsX2lwICsgJzonICsgQ29uZmlnU3ZjLnBvcnQ7IC8vIGRldmVsb3BtZXQgb24gc29ja2V0IGxvY2FsbHkgXG5cdH1cblx0ZWxzZSB7XG5cdFx0dXJsID0gQ29uZmlnU3ZjLndlYl9zb2NrZXQgKyBDb25maWdTdmMuZGVwbG95X2RuczsgLy8gcHJvZHVjdGlvbiBkZXBsb3kgdmVyc2lvbiAtIHN0aWxsIGRlYnVnIG1vZGVcblx0XHQvL3VybCA9IENvbmZpZ1N2Yy53ZWJfc29ja2V0X3NlY3VyZSArIENvbmZpZ1N2Yy5kZXBsb3lfZG5zOyAvLyBwcm9kdWN0aW9uIGRlcGxveSB2ZXJzaW9uIC0gc3RpbGwgZGVidWcgbW9kZVxuXHR9XG5cblx0Lyog6rCc67Cc6rO87KCV7J20IOuBneuCmOqzoCDrsLDtj6zsi5zsl5DripQg7JyE67aA67aE7J2EIOyngOyasOqzoCDslYTrnpgg7L2U65Oc66eMIOuCqOqyqOuPhCDrkJzri6QuXG5cdHVybCA9ICd3c3M6Ly9mcm96ZW4tYmFkbGFuZHMtODY0OS5oZXJva3VhcHAuY29tJztcblx0Ki9cblx0dmFyIGNvbm5lY3QgPSBmdW5jdGlvbigpIHtcblx0XHRjb25uZWN0aW9uID0gbmV3IFdlYlNvY2tldCh1cmwpO1xuXG5cdFx0Y29ubmVjdGlvbi5vbm9wZW4gPSBmdW5jdGlvbigpe1xuXG5cdFx0XHQvLyBzZW5kIGd1aWQgdG8gc2VydmVyIGZvciB3cyBpZGVudGlmaWNhdGlvblxuXHRcdFx0Y29ubmVjdGlvbi5zZW5kKCRzY29wZS5ndWlkKTtcblx0XHRcdC8vY29uc29sZS5sb2coJ1dlYlNvY2tldCBjb25uZWN0ZWQnKTtcblx0XHR9O1xuXG5cdFx0Y29ubmVjdGlvbi5vbmNsb3NlID0gZnVuY3Rpb24oKXtcblxuXHRcdFx0Ly9jb25zb2xlLmxvZygnV2ViU29ja2V0IGNsb3NlZC4gUmVjb25lY3RpbmcuLi4nKTtcblx0XHRcdCR0aW1lb3V0KGNvbm5lY3QsIDIwMDApO1xuXHRcdH07XG5cblx0XHRjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGUpe1xuXHRcdFx0Ly9jb25zb2xlLmxvZygnYnJvYWRjYXN0IG1zZyBmcm9tIHNlcnZlcjonLCBlKTtcblx0XHRcdHZhciBwYXlsb2FkID0gSlNPTi5wYXJzZShlLmRhdGEpO1xuXG5cdFx0XHQvKlxuXHRcdFx0XHR3czpuZXdfcG9zdCAgICAtIOyDiOuhnOyatCDtj6zsiqTtirjqsIAg7Jis65287JmU7J2E65WMIGZyb250LWVuZOyXkOyEnCDrp7XsnbQg64uk7IucIOyXheuNsOydtO2KuCDtlbTslbwg65Cc64uk6rOgIOyVjOugpOykgOuLpCFcblx0XHRcdFx0d3M6bmV3X3Nlc3Npb24gLSBzZXNzaW9u7J20IOyDiOuhnCDrk6TslrTsmKTrqbQg65Cc64uk6rOgIOyVjOugpOykgOuLpCFcblx0XHRcdFx0d3M6cmVtb3ZlX3Bvc3QgLSDtj6zsiqTtirjqsIAg7Iuc6rCE7J20IOuLpCDrkJjslrTshJwg7IKs65287KeI65WMIVxuXHRcdFx0XHTrp6TsmrDspJHsmpQhIFxuXHRcdFx0Ki9cblx0XHRcdCRyb290U2NvcGUuJGJyb2FkY2FzdCgnd3M6JyArIHBheWxvYWQudHlwZSwgcGF5bG9hZC5kYXRhKTtcblx0XHR9O1xuXHR9O1xuXHRjb25uZWN0KCk7XG5cblx0Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBTT0NLRVQgQlJPQURDQVNUIFJFQ0VJVkVSXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0Ly8gYXMgc2VydmVyIHNvY2tldCBzZW5kICd3czpuZXdfcG9zdCcgLCB3ZSBjYW4gdXBkYXRlIHRoZSBtYXAhXG5cdCRzY29wZS4kb24oJ3dzOm5ld19wb3N0JywgZnVuY3Rpb24oXywgcG9zdCl7XG5cdFx0Ly8gdXBkYXRlIHBvc3RzIG9uIG1hcFxuXHRcdCRzY29wZS5tYXAudXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cblx0XHQvLyBzaG93IHJlc3BvbnNpdmUgdXNlcnMgb25seSB0byB0aGUgdXNlciB3aG8gd3JvdGUgdGhpcyBwb3N0XG5cdFx0aWYgKHBvc3QuZ3VpZCA9PSAkc2NvcGUuZ3VpZClcblx0XHR7XG5cdFx0XHQkc2NvcGUubWFwLmRyYXdSZXNwb25zZXMocG9zdCk7XG5cdFx0fVxuXHR9KTtcblxuXHQvLyBhcyBzZXJ2ZXIgc29ja2V0IHNlbmQgJ3dzOm5ld19wb3N0JyAsIHdlIGNhbiB1cGRhdGUgdGhlIG1hcCFcblx0JHNjb3BlLiRvbignd3M6bmV3X3Nlc3Npb24nLCBmdW5jdGlvbihfLCBzZXNzaW9uKXtcblx0XHR2YXIgbG9jYXRpb24gPSBhbmd1bGFyLmZyb21Kc29uKHNlc3Npb24ubG9jYXRpb24pO1xuXHRcdCRzY29wZS5tYXAuZHJhd0N1cnJMb2NhdGlvbk1hcmtlcihsb2NhdGlvbik7XG5cblx0fSk7XG5cblx0Ly8gd2hlbiBzZXJ2ZXIgcmVtb3ZlIHRoZSBwb3N0IGFmdGVyIHRpbWUgZm9yIGxvbmdlciBvbmVzLCBcblx0Ly8gdXBkYXRlIG1hcCB3aXRoIGNvcmVzcG9uZGluZyBpbmZvXG5cdCRzY29wZS4kb24oJ3dzOnJlbW92ZV9wb3N0JywgZnVuY3Rpb24oXywgcG9zdGlkKXtcblx0XHQkc2NvcGUubWFwLnVuRHJhd1Bvc3QocG9zdGlkKTtcblx0fSk7XG5cblx0JHNjb3BlLiRvbignd3M6dXBkYXRlX2d1aWR0Z3QnLCBmdW5jdGlvbihfLCB1cGRhdGVkU2Vzc2lvbil7XG5cdFx0Ly8gdXBkYXRlIHBvc3RzIG9uIG1hcFxuXHRcdCRzY29wZS5tYXAudXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cdH0pO1xuXG5cdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQVBQTElDQVRJT04gTEVWRUwgRlVOQ1RJT05TXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0Ly8gc2VlIGlmIGl0cyBtb2JpbGUgcGhvbmVcblx0JHNjb3BlLmlzTW9iaWxlID0gZnVuY3Rpb24oKXtcblx0XHRpZiggbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvQW5kcm9pZC9pKVxuXHRcdCB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC93ZWJPUy9pKVxuXHRcdCB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUGhvbmUvaSlcblx0XHQgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBhZC9pKVxuXHRcdCB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUG9kL2kpXG5cdFx0IHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0JsYWNrQmVycnkvaSlcblx0XHQgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvV2luZG93cyBQaG9uZS9pKVxuXHRcdCApe1xuXHRcdCAgICByZXR1cm4gdHJ1ZTtcblx0XHQgIH1cblx0XHQgZWxzZSB7XG5cdFx0ICAgIHJldHVybiBmYWxzZTtcblx0XHQgIH1cblx0fTtcblxuXHQvKiBtb3ZlIHRvIGN1cnJlbnQgbG9jYXRpb24gKi9cblx0JHNjb3BlLm1vdmVUb0N1cnJlbnRMb2NhdGlvbiA9IGZ1bmN0aW9uKCl7XG5cdFx0ZnVuY3Rpb24gZ2V0Q3VyckxvY1N1Y2Nlc3MocG9zKSB7XG4gICAgICAgICAgICAvKiBtYWtlIHN1cmUgdG8gY2hlY2sgd2UgYXJlIG9uIHBvc3QgcGFnZSB3aXRoIG1hcCBmaXJzdCAqL1xuICAgICAgICAgICAgaWYgKCRzY29wZS5jdXJyZW50UGFnZUlkICE9ICRzY29wZS5wYWdlSWQucG9zdClcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIHZhciBjcmQgPSBwb3MuY29vcmRzO1xuXG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gY3JkLmxhdGl0dWRlO1xuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUgPSBjcmQubG9uZ2l0dWRlO1xuXG4gICAgICAgICAgICB2YXIgbG9jYXRpb24gPSB7XG4gICAgICAgICAgICBcdGxhdDogY3JkLmxhdGl0dWRlLCBcbiAgICAgICAgICAgIFx0bG9uOiBjcmQubG9uZ2l0dWRlXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBkcmF3IGRyb3AgZG93biB1c2VyIHBvc2l0aW9uXG4gICAgICAgICAgIFx0JHNjb3BlLm1hcC5kcmF3Q3VyckxvY2F0aW9uTWFya2VyKGxvY2F0aW9uKTtcblxuICAgICAgICAgICBcdC8vIGRyYXcgeCBtYXJrZXJcblx0ICAgICAgICAkc2NvcGUubWFwLmRyYXdYTWFya2VyKGxvY2F0aW9uKTtcblxuXHQgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxvY2F0aW9uLmxhdCwgbG9jYXRpb24ubG9uKTtcblxuXHQgICAgICAgIC8vIG1vdmUgdG8gdGhlIGxvY2F0aW9uIGFuZCB6b29tIGludG8gcmlnaHQgYW1vdW50XG4gICAgICAgICAgICAkc2NvcGUubWFwLnBhblRvKGdvb2dsZUxvYylcbiAgICAgICAgICAgICRzY29wZS5tYXAuc2V0Wm9vbSgxNSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRDdXJyTG9jRXJyb3IoZXJyKSB7XG4gICAgICAgIFx0c3dhbChcIlwiLCBcIk5lZWQgdG8gdHVybiBvbiBsb2NhdGlvbiBzZXJ2aWNlIGZvciBwcm9wZXIgdXNlLlwiKTtcbiAgICAgICAgICAgIC8vY29uc29sZS53YXJuKCdFUlJPUignICsgZXJyLmNvZGUgKyAnKTogJyArIGVyci5tZXNzYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGluaXQgbWFwIGFuZCBwbGFjZSBzb21lIG1hcmtlcnMsIHNvIGV2ZXJ5dGhpbmcgc3RhcnQgd2l0aCB0aGlzIGZ1bmN0aW9uLlxuICAgICAgICB2YXIgb3B0aW9ucyA9IHtcblx0XHQgIGVuYWJsZUhpZ2hBY2N1cmFjeTogdHJ1ZSxcblx0XHQgIHRpbWVvdXQ6IDgwMDAsXG5cdFx0ICBtYXhpbXVtQWdlOiAwXG5cdFx0fTtcbiAgICAgICAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihnZXRDdXJyTG9jU3VjY2VzcywgZ2V0Q3VyckxvY0Vycm9yLCBvcHRpb25zKTtcblxuICAgICAgICBzd2FsKHsgICB0aXRsZTogXCJcIiwgICB0ZXh0OiBcIk1vdmluZyB0byBjdXJyZW50IGxvY2F0aW9uLi5cIiwgICB0aW1lcjogMTUwMCwgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UgfSk7XG5cdH07XG5cblx0JHNjb3BlLm1vdmVUb1Bvc3RMb2NhdGlvbiA9IGZ1bmN0aW9uKCl7XG5cdFx0dmFyIGxhdERlbHRhID0gMC4wO1xuXG5cdFx0aWYgKCRzY29wZS5pc01vYmlsZSgpKXtcblx0XHRcdHZhciBib3VuZHMgPSAkc2NvcGUubWFwLmdldEJvdW5kcygpO1xuXHQgICAgICAgIHZhciBuZSA9IGJvdW5kcy5nZXROb3J0aEVhc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBub3J0aC1lYXN0IGNvcm5lclxuXHQgICAgICAgIHZhciBzdyA9IGJvdW5kcy5nZXRTb3V0aFdlc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBzb3V0aC13ZXN0IGNvcmRlclxuXHQgICAgICAgIGN1cnJlbnRfbWFwX253ID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhuZS5sYXQoKSwgc3cubG5nKCkpO1xuXHQgICAgICAgIGN1cnJlbnRfbWFwX3NlID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhzdy5sYXQoKSwgbmUubG5nKCkpO1xuXG5cdCAgICAgICAgdmFyIGxhdERlbHRhX2NlbnRlcjJub3J0aCA9IDAuNSAqIE1hdGguYWJzKCRzY29wZS5wb3N0TG9jYXRpb24ubGF0IC0gY3VycmVudF9tYXBfbncubGF0KCkpO1xuXHQgICAgICAgIHZhciBsYXREZWx0YV9jZW50ZXIyc291dGggPSAwLjUgKiBNYXRoLmFicygkc2NvcGUucG9zdExvY2F0aW9uLmxhdCAtIGN1cnJlbnRfbWFwX3NlLmxhdCgpKTtcblxuXHQgICAgICAgIGlmIChsYXREZWx0YV9jZW50ZXIybm9ydGggPiBsYXREZWx0YV9jZW50ZXIyc291dGgpe1xuXHQgICAgICAgIFx0bGF0RGVsdGEgPSBsYXREZWx0YV9jZW50ZXIyc291dGg7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgIFx0bGF0RGVsdGEgPSBsYXREZWx0YV9jZW50ZXIybm9ydGg7XG5cdCAgICAgICAgfVxuXHRcdH1cblxuXHRcdHZhciBjZW50ZXJMb2MgPSAkc2NvcGUubWFwLmdldENlbnRlcigpO1xuXG5cdFx0dmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoJHNjb3BlLnBvc3RMb2NhdGlvbi5sYXQgKyBsYXREZWx0YSwgY2VudGVyTG9jLmxuZygpKTtcblx0XHQkc2NvcGUubWFwLnBhblRvKGdvb2dsZUxvYyk7XG5cdH07XG5cblx0JHNjb3BlLmNvbGxhcHNlID0gZnVuY3Rpb24oKXtcblx0XHQkc2NvcGUubmF2Q29sbGFwc2VkID0gdHJ1ZTtcblx0fTtcblxuXHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEdFTkVSQUwgQlJPQURDQVNUIFJFQ0VJVkVSXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAkc2NvcGUuJG9uKCdzZXQ6bWFwJywgZnVuY3Rpb24oXywgbWFwKXtcblx0XHQkc2NvcGUubWFwID0gbWFwO1xuXHR9KTtcblxuICAgICRzY29wZS4kb24oJ3NldDpndWlkdGd0JywgZnVuY3Rpb24oXywgZ3VpZHRndCl7XG5cdFx0JHNjb3BlLmd1aWR0Z3QgPSBndWlkdGd0O1xuXG5cdFx0Ly8gaXRzIHZlcnkgaW1wb3JhbnQgdG8gc2V0IGxvY2FsIHN0b3JhZ2UgZ3VpZHRndFxuXHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ3VpZHRndCA9IGd1aWR0Z3Q7XG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ3NldDpwYWdlY2hhbmdlJywgZnVuY3Rpb24oXywgcGFnZUlkKXtcblx0XHQkc2NvcGUuY3VycmVudFBhZ2VJZCA9IHBhZ2VJZDtcblx0fSk7XG5cblx0JHNjb3BlLiRvbignc2V0OmxvYycsIGZ1bmN0aW9uKF8sIGxvY2F0aW9uKXtcblx0XHR2YXIgbGF0ID0gbG9jYXRpb24ubGF0KCk7XG5cdFx0dmFyIGxvbiA9IGxvY2F0aW9uLmxuZygpO1xuXHRcdCRzY29wZS5wb3N0TG9jYXRpb24gPSB7XG5cdFx0XHRsYXQ6IGxhdCxcblx0XHRcdGxvbjogbG9uXG5cdFx0fTtcblx0fSk7XG5cblx0JHNjb3BlLiRvbignc2V0OnBsYWNlJywgZnVuY3Rpb24oXywgcGxhY2Upe1xuXHRcdC8vIEZvcmNpbmcgdGhlIHVwZGF0ZSB3aXRoICRhcHBseSgpIG1ldGhvZCBvbiAkc2NvcGVcblx0XHQvLyBwcm9ibGVtIHJlbGF0ZWQgbm90ZTogaHR0cDovL3d3dy5qZWZmcnlob3VzZXIuY29tL2luZGV4LmNmbS8yMDE0LzYvMi9Ib3ctZG8tSS1ydW4tY29kZS13aGVuLWEtdmFyaWFibGUtY2hhbmdlcy13aXRoLUFuZ3VsYXJKU1xuXHRcdCRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKXtcblx0XHRcdFx0JHNjb3BlLnBvc3RwbGFjZSA9IHBsYWNlO1xuXHRcdFx0fVxuXHRcdCk7XG5cdH0pO1xufSk7XG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb25zdGFudCgnQ29uZmlnU3ZjJywge1xuXHRcIndlYl9zb2NrZXRcIlx0XHQ6IFwid3M6Ly9cIixcblx0XCJ3ZWJfc29ja2V0X3NlY3VyZVwiIDogXCJ3c3M6Ly9cIixcblx0XCJsb2NhbFwiXHRcdFx0XHQ6IFwibG9jYWxob3N0XCIsXG5cdFwibG9jYWxfaXBcIlx0XHRcdDogXCIxOTIuMTY4LjAuNFwiLFxuXHQvL1wiZGVwbG95X2Ruc1wiXHRcdDogXCJjbG91ZHRhbGsuaGVyb2t1YXBwLmNvbVwiLFxuXHRcImRlcGxveV9kbnNcIlx0XHQ6IFwidGFsa2lwaWEuY29tXCIsXG5cdFwicG9ydFwiXHRcdFx0XHQ6IFwiNTAwMFwiLFxuXHRcIm1heEluc3RhbnRMaWZlU3BhblwiOiA1MDAwLFxufSk7XG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbmZpZyhmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIpe1xuXHQkcm91dGVQcm92aWRlclxuXHQud2hlbignLycsIFxuXHRcdHtcblx0XHRcdGNvbnRyb2xsZXI6ICdQb3N0c0N0cmwnLCBcblx0XHRcdHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9wb3N0cy5odG1sJ1xuXHRcdH0pXG5cdC8vIFJlZGlyZWN0IHRvIHRoZSByb290IHBhZ2UuXG5cdC5vdGhlcndpc2UoXG5cdFx0e1xuICAgXHRcdFx0cmVkaXJlY3RUbzogJy8nXG5cdFx0fSk7XG59KTtcblxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnVXRpbFN2YycsIGZ1bmN0aW9uKCl7XG5cdHZhciBzdmMgPSB0aGlzO1xuXG5cdHN2Yy5kZWcycmFkID0gZnVuY3Rpb24oZGVnKSB7XG5cdCAgcmV0dXJuIGRlZyAqIChNYXRoLlBJLzE4MCk7XG5cdH07XG5cblx0c3ZjLmdldERpc3RhbmNlRnJvbUxhdExvbkluS20gPSBmdW5jdGlvbiAobGF0MSxsb24xLGxhdDIsbG9uMikge1xuXHQgIHZhciBSID0gNjM3MTtcblx0ICB2YXIgZExhdCA9IHN2Yy5kZWcycmFkKGxhdDItbGF0MSk7XG5cdCAgdmFyIGRMb24gPSBzdmMuZGVnMnJhZChsb24yLWxvbjEpOyBcblx0ICB2YXIgYSA9IFxuXHQgICAgTWF0aC5zaW4oZExhdC8yKSAqIE1hdGguc2luKGRMYXQvMikgK1xuXHQgICAgTWF0aC5jb3Moc3ZjLmRlZzJyYWQobGF0MSkpICogTWF0aC5jb3Moc3ZjLmRlZzJyYWQobGF0MikpICogXG5cdCAgICBNYXRoLnNpbihkTG9uLzIpICogTWF0aC5zaW4oZExvbi8yKVxuXHQgICAgOyBcblx0ICB2YXIgYyA9IDIgKiBNYXRoLmF0YW4yKE1hdGguc3FydChhKSwgTWF0aC5zcXJ0KDEtYSkpOyBcblx0ICB2YXIgZCA9IFIgKiBjO1xuXHQgIHJldHVybiBkO1xuXHR9O1xuXG5cdHN2Yy5tYXBSYW5nZSA9IGZ1bmN0aW9uICh2YWx1ZSwgbG93MSwgaGlnaDEsIGxvdzIsIGhpZ2gyKSB7XG5cdCAgICByZXR1cm4gbG93MiArIChoaWdoMiAtIGxvdzIpICogKHZhbHVlIC0gbG93MSkgLyAoaGlnaDEgLSBsb3cxKTtcblx0fTtcblxuXHRzdmMuZ2V0R3VpZCA9IGZ1bmN0aW9uICgpIHtcblx0XHRmdW5jdGlvbiBzNCgpIHtcblx0XHQgICAgcmV0dXJuIE1hdGguZmxvb3IoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApXG5cdFx0ICAgICAgLnRvU3RyaW5nKDE2KVxuXHRcdCAgICAgIC5zdWJzdHJpbmcoMSk7XG5cdFx0fVxuXHQgIFx0cmV0dXJuIHM0KCkgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArIHM0KCkgKyBzNCgpO1xuXHR9O1xufSk7XG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5ydW4oZnVuY3Rpb24oJHJvb3RTY29wZSwgJHRpbWVvdXQsIFNlc3Npb25TdmMpe1xuXG5cbn0pO1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHIuY29udHJvbGxlcignUG9zdHNDdHJsJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICRzY29wZSwgQ29uZmlnU3ZjLCBQb3N0c1N2YywgVXRpbFN2YywgJHdpbmRvdywgJGRvY3VtZW50LCAkdGltZW91dCl7XHJcclx0LyogZW1pdCBicm9hZGNhc3QgZm9yIGN1cnJlbnQgcGFnZUlkICovXHJcdCRzY29wZS4kZW1pdCgnc2V0OnBhZ2VjaGFuZ2UnLCAkc2NvcGUucGFnZUlkLnBvc3QpO1xyXHJcdCRzY29wZS5wb3N0cyA9IFtdO1xyXHJcdC8qIGFzIHNlcnZlciB0ZWxscyB0aGVyZSB3YXMgbmV3IHBvc3QsIGxldHMgcmUtbG9hZCBsaXN0IGRhdGEgKi9cclx0JHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbihfLCBwb3N0KXtcclx0XHQkc2NvcGUucmVxdWVzdEZldGNoKCk7XHJcdH0pO1xyXHJcdCRzY29wZS5hZGRQb3N0ID0gZnVuY3Rpb24oKSB7XHJcdFx0LyogY2hlY2sgaWYgdGhlIHBvc3QgY29udGVudCBpcyB0aGVyZSAtIG9ubHkgZm9yIFdFQiBmb3IgZW50ZXIgYnV0dG9uIHRvIHBvc3QgKi9cclx0XHRpZiAoISRzY29wZS5jb250ZW50KXtcclx0XHRcdC8qY29uc29sZS5sb2coXCJVc2VyIGF0dGVtcHRlZCB0byBwb3N0IHdpdGggMCB3b3Jkcy5cIikqL1xyXHRcdFx0cmV0dXJuO1xyXHRcdH1cclxyXHRcdC8qIGdldCBhdXRvY29tcGxldGVkIHBsYWNlIGFuZCByZXNldChzZXQgdG8gdW5kZWZpbmVkKSAqL1xyXHRcdHZhciBwbGFjZSAgICA9ICRzY29wZS5wb3N0cGxhY2U7XHJcdFx0dmFyIGxvY2F0aW9uID0gJHNjb3BlLnBvc3RMb2NhdGlvbjtcclxyXHRcdHZhciBsb2NhbF9zdGF0dXM7XHJcdFx0dmFyIHBvc3RMb2NhdGlvbkZyb21Vc2VyTG9jYXRpb24gPSBVdGlsU3ZjLmdldERpc3RhbmNlRnJvbUxhdExvbkluS20obG9jYXRpb24ubGF0LCBsb2NhdGlvbi5sb24sICRzY29wZS51c2VyTG9jYXRpb24ubGF0LCAkc2NvcGUudXNlckxvY2F0aW9uLmxvbik7XHJcdFx0LyogaWYgbGVzcyB0aGFuIDNrbSAqL1xyXHRcdGlmIChwb3N0TG9jYXRpb25Gcm9tVXNlckxvY2F0aW9uIDwgMyl7XHJcdFx0XHRsb2NhbF9zdGF0dXMgPSB0cnVlO1xyXHRcdH1cclx0XHRlbHNlIHtcclx0XHRcdGxvY2FsX3N0YXR1cyA9IGZhbHNlO1xyXHRcdH1cclx0XHRcclx0XHR2YXIgbG9jYXRpb25KU09OID0gSlNPTi5zdHJpbmdpZnkobG9jYXRpb24pO1xyXHJcdFx0dmFyIHJlbGF0aXZlTGlmZVNwYW47XHJcdFx0aWYgKCRzY29wZS50aW1ldmFsdWUgPD0gQ29uZmlnU3ZjLm1heEluc3RhbnRMaWZlU3Bhbil7XHJcdFx0XHR2YXIgY2hhckxlbiA9ICRzY29wZS5jb250ZW50Lmxlbmd0aDtcclx0XHRcdGlmIChjaGFyTGVuIDwgNSlcclx0XHRcdHtcclx0XHRcdFx0cmVsYXRpdmVMaWZlU3BhbiA9IDQwMDA7XHJcdFx0XHR9XHJcdFx0XHRlbHNlXHJcdFx0XHR7XHJcdFx0XHRcdHJlbGF0aXZlTGlmZVNwYW4gPSBjaGFyTGVuICogVXRpbFN2Yy5tYXBSYW5nZShjaGFyTGVuLCA1LCAyMCwgNzAwLCA0MDApO1xyXHRcdFx0fVxyXHRcdH1cclx0XHRlbHNlIHtcclx0XHRcdHJlbGF0aXZlTGlmZVNwYW4gPSAkc2NvcGUudGltZXZhbHVlO1xyXHRcdH1cclxyXHRcdFBvc3RzU3ZjLmNyZWF0ZShcclx0XHR7XHJcdFx0XHRib2R5ICAgIDogICRzY29wZS5jb250ZW50LFxyXHRcdFx0bG9jYXRpb246ICBsb2NhdGlvbkpTT04sXHJcdFx0XHRwbGFjZSAgIDogIHBsYWNlLFxyXHRcdFx0Z3VpZCAgICA6ICAkc2NvcGUuZ3VpZCxcclx0XHRcdGd1aWR0Z3QgOiAgJHNjb3BlLmd1aWR0Z3QsXHJcdFx0XHRsaWZlc3BhbjogIHJlbGF0aXZlTGlmZVNwYW4sXHJcdFx0XHRpc2xvY2FsIDogIGxvY2FsX3N0YXR1cyxcclx0XHR9KVxyXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKHBvc3Qpe1xyXHRcdFx0XHRcdFxyXHRcdFx0LyogcmVzZXQgaW5wdXQgZm9ybXMgKi9cclx0XHRcdCRzY29wZS5jb250ZW50ICA9IG51bGw7XHJcdFx0fSlcclx0XHQuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKXtcclx0XHRcdHN3YWwoXCJQb3N0IGZhaWxlZFwiLCBcIlBsZWFzZSBjb21wbGV0ZSB0aGUgZnJvbSBjb3JyZWN0bHlcIiwgXCJlcnJvclwiKTtcclx0XHR9KVxyXHRcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xyXHRcdFx0LyogaGFuZGxlIGVycm9yICovXHJcdFx0fSk7XHJcdH07XHJcclx0LyogYXMgc2VydmVyIHRlbGxzIHRoZXJlIHdhcyBuZXcgcG9zdCwgbGV0cyByZS1sb2FkIGxpc3QgZGF0YSAqL1xyXHQkc2NvcGUucmVxdWVzdEZldGNoID0gZnVuY3Rpb24oKSB7XHJcdFx0UG9zdHNTdmMuZmV0Y2goKVxyXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKHBvc3RzKXtcclx0XHRcdC8qY29uc29sZS5sb2coJ0dvdCBQb3N0czonLCBwb3N0cyk7ICovXHJcdFx0XHQkc2NvcGUucG9zdHMgPSBwb3N0cztcclx0XHR9KVxyXHRcdC5jYXRjaChmdW5jdGlvbihlcnIpe1xyXHRcdFx0LyogZXJyb3IgaGFuZGxlICovXHJcdFx0fSk7XHJcdH07XHJcclx0LyogdXBkYXRlIGd1aWQgb2YgcG9zdCAqL1xyXHQkc2NvcGUudXBkYXRlR3VpZHRndCA9IGZ1bmN0aW9uKG15Z3VpZCwgZ3VpZHRndCkge1xyXHRcdHZhciB1cGRhdGVzID0ge1xyXHRcdFx0Z3VpZCAgICA6IG15Z3VpZCxcclx0XHRcdGd1aWR0Z3QgOiBndWlkdGd0XHJcdFx0fTtcclxyXHRcdC8qY29uc29sZS5sb2coXCJ1ZHBhdGUgdG8gcG9zdCBndWlkdGd0OlwiLCB1cGRhdGVzKSovXHJcclx0XHRQb3N0c1N2Yy51cGRhdGVHdWlkdGd0KHVwZGF0ZXMpXHJcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24odXBkYXRlcyl7XHJcdFx0XHQvKiAgZGVidWcgbXNnICAqL1xyXHRcdH0pXHJcdFx0LmNhdGNoKGZ1bmN0aW9uKGVycil7XHJcdFx0XHQvKiAgZXJyb3IgaGFuZGxpbmcgICovXHJcdFx0fSk7XHJcdH1cclxyXHQvKiRzY29wZS5yZXF1ZXN0RmV0Y2goKTsqL1xyfSk7XHJcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1Bvc3RzU3ZjJywgZnVuY3Rpb24oJGh0dHApe1xuXHR0aGlzLmZldGNoID0gZnVuY3Rpb24oZ3VpZE9iail7XG5cdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS9wb3N0cycsIGd1aWRPYmopO1xuXHR9O1xuXG5cdHRoaXMuY3JlYXRlID0gZnVuY3Rpb24ocG9zdCl7XG5cdFx0cG9zdC5kZXZpY2V0b2tlbiA9ICcwJzsgLy8gZm9yIHdlYiwgdGhlcmUgaXMgbm8gZGV2aWNldG9rZW5cblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHBvc3QpO1xuXHR9O1xuXG5cdHRoaXMucmVtb3ZlID0gZnVuY3Rpb24ocG9zdCl7XG5cdFx0Ly9jb25zb2xlLmxvZyhcImRlbGV0aW5nIHBvc3RpbmdcIik7XG5cdFx0Ly9jb25zb2xlLmxvZygncG9zdC5faWQ6JywgcG9zdC5faWQpO1xuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Bvc3RzL3Bvc3RzX2RlbGV0ZScsIHBvc3QpO1xuXHR9O1xuXG5cdHRoaXMudXBkYXRlR3VpZHRndCA9IGZ1bmN0aW9uKHVwZGF0ZXMpe1xuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Bvc3RzL3VwZGF0ZV9ndWlkdGd0JywgdXBkYXRlcyk7XG5cdH1cbn0pO1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnU2Vzc2lvblN2YycsIGZ1bmN0aW9uKCRodHRwKXtcblx0dGhpcy5mZXRjaCA9IGZ1bmN0aW9uKCl7XG5cdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS9zZXNzaW9ucycpO1xuXHR9O1xuXG5cdHRoaXMuZW50ZXIgPSBmdW5jdGlvbihzZXNzaW9uKXtcblx0XHRzZXNzaW9uLmRldmljZXRva2VuID0gJzAnOyAvLyBmb3Igd2ViLCB0aGVyZSBpcyBubyBkZXZpY2V0b2tlblxuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zJywgc2Vzc2lvbik7XG5cdH07XG5cblx0dGhpcy5yZW1vdmUgPSBmdW5jdGlvbihndWlkKXtcblx0XHR2YXIgc2Vzc2lvbiA9IHtndWlkOiBndWlkfTtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucy9kZWxldGUnLCBzZXNzaW9uKTtcblx0fTtcblxuXHR0aGlzLnVwZGF0ZVdhdGNoTG9jYXRpb24gPSBmdW5jdGlvbihjdXJyZW50X21hcF9udywgY3VycmVudF9tYXBfc2UsIGN1cnJlbnRfbWFwX2NlbnRlciwgZ3VpZCl7XG5cdFx0dmFyIHdhdGNobG9jID0ge1xuICAgICAgICAgICAgbndfbGF0ICAgICA6IGN1cnJlbnRfbWFwX253LmxhdCxcbiAgICAgICAgICAgIG53X2xvbiAgICAgOiBjdXJyZW50X21hcF9udy5sb24sXG4gICAgICAgICAgICBzZV9sYXQgICAgIDogY3VycmVudF9tYXBfc2UubGF0LFxuICAgICAgICAgICAgc2VfbG9uXHQgICA6IGN1cnJlbnRfbWFwX3NlLmxvbixcbiAgICAgICAgICAgIGNlbnRlcl9sYXQgOiBjdXJyZW50X21hcF9jZW50ZXIubGF0LFxuICAgICAgICAgICAgY2VudGVyX2xvbiA6IGN1cnJlbnRfbWFwX2NlbnRlci5sb25cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciB3YXRjaGxvY0pTT04gPSBKU09OLnN0cmluZ2lmeSh3YXRjaGxvYyk7XG5cbiAgICAgICAgdmFyIHVwZGF0ZWRzZXNzaW9uID0ge1xuICAgICAgICAgICAgd2F0Y2hsb2M6IHdhdGNobG9jSlNPTixcbiAgICAgICAgICAgIGd1aWQgICAgOiBndWlkXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gdXBkYXRlIHdhdGNobG9jIHdoZW4gY2VudGVyIGNoYW5nZWQuXG4gICAgICAgIC8vY29uc29sZS5sb2coXCJ1cGRhdGluZyB3YXRjaCBsb2NhdGlvblwiKTtcblxuXHRcdC8vY29uc29sZS5sb2coXCJ1cGRhdGVkc2Vzc2lvbjpcIiwgdXBkYXRlZHNlc3Npb24pO1xuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zL3VwZGF0ZV9zZXNzaW9uJywgdXBkYXRlZHNlc3Npb24pO1xuXHR9O1xuXG5cdHRoaXMudXBkYXRlQ291cGxpbmcgPSBmdW5jdGlvbihndWlkLCBndWlkdGd0KXtcblx0XHRcblx0XHR2YXIgdXBkYXRlZGd1aWR0Z3QgPSB7XG5cdFx0XHRndWlkICAgOiBndWlkLFxuXHRcdFx0Z3VpZHRndDogZ3VpZHRndFxuXHRcdH07XG5cblx0XHQvLyB1cGRhdGUgd2F0Y2hsb2Mgd2hlbiBjZW50ZXIgY2hhbmdlZC5cbiAgICAgICAgLy9jb25zb2xlLmxvZyhcInVwZGF0aW5nIGNvdXBsaW5nXCIpO1xuXG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbnMvdXBkYXRlX2NvdXBsaW5nJywgdXBkYXRlZGd1aWR0Z3QpXG5cdH07XG59KTtcblxuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5kaXJlY3RpdmUoJ2FwcE1hcCcsIGZ1bmN0aW9uKFBvc3RzU3ZjLCBVdGlsU3ZjLCBDb25maWdTdmMsIFNlc3Npb25TdmMsICRjb21waWxlLCAkdGltZW91dCkge1xuICAgIC8vIGRpcmVjdGl2ZSBsaW5rIGZ1bmN0aW9uXG4gICAgdmFyIGxpbmsgPSBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBHTE9CQUwgVkFSSUFCTEVTIElOIExJTksgRlVOQ1RJT05cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgdmFyIG1hcDsgLy8gZXhwYW5kIGZyb20gZ29vZ2xlIG1hcCBmb3IgbWFudWFsbHkgY3JlYXRlZCBldmVudHNcbiAgICAgICAgdmFyIG1hcF9vcmlnaW47IC8vIGZvciBvcmlnaW5hbCBnb29nbGUgbWFwIGV2ZW50IGZ1bmN0aW9uIGxpbmtzXG4gICAgICAgIHZhciBjdXJyZW50X21hcF9udztcbiAgICAgICAgdmFyIGN1cnJlbnRfbWFwX3NlO1xuICAgICAgICB2YXIgbWFwT3B0aW9ucztcbiAgICAgICAgdmFyIGluaXRpYWxNYXBDZW50ZXI7XG4gICAgICAgIHZhciBDTE9VRF9NQVBfSUQgPSAnY3VzdG9tX3N0eWxlJzsgLy8gbWFwIHN0eWxlXG4gICAgICAgIHZhciBoZWxwZXJNYXJrZXJzID0gW107XG4gICAgICAgIHZhciBtYXJrZXJzT25NYXAgPSBbXTtcblxuICAgICAgICB2YXIgcHJldkd1aWR0Z3QgPSAnMCc7XG4gICAgICAgIHZhciBpc0d1aWR0Z3RDaGFuZ2VkO1xuXG4gICAgICAgIHZhciBpbWFnZVBvc3QgPSB7XG4gICAgICAgICAgICAvL3VybDogJ2h0dHBzOi8vY2F0Y2htZS5pZnlvdWNhbi5jb20vaW1hZ2VzL3BpY3R1cmVzL0lZQ19JY29ucy9JWUNfTG9jYXRpb25fSWNvbl9TbWFsbC5wbmcnLFxuICAgICAgICAgICAgdXJsOiAnRGVmYXVsdF9NYXJrZXIucG5nJyxcbiAgICAgICAgICAgIHNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDEwMCwgMTAwKSxcbiAgICAgICAgICAgIG9yaWdpbjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDAsIDApLFxuICAgICAgICAgICAgYW5jaG9yOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMTcsIDM0KSxcbiAgICAgICAgICAgIHNjYWxlZFNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDEsIDEpXG4gICAgICAgIH07XG4gICAgICAgIHZhciBpbWFnZVRhcmdldCA9IHtcbiAgICAgICAgICAgIC8vdXJsOiAnaHR0cDovL3d3dy5jbGtlci5jb20vY2xpcGFydHMvVS9QL2ovTS9JL2kveC1tYXJrLXllbGxvdy1tZC5wbmcnLFxuICAgICAgICAgICAgdXJsOiAnWF9NYXJrZXIucG5nJyxcbiAgICAgICAgICAgIHNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDEwMCwgMTAwKSxcbiAgICAgICAgICAgIG9yaWdpbjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDAsIDApLFxuICAgICAgICAgICAgYW5jaG9yOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMTcsIDM0KSxcbiAgICAgICAgICAgIHNjYWxlZFNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDI1LCAyNSlcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGltYWdlVXNlckxvZ2luID0ge1xuICAgICAgICAgICAgLy91cmw6ICdodHRwOi8vd3d3LmNsa2VyLmNvbS9jbGlwYXJ0cy9xL28vMi9LL2cvVi9sb2NhdGlvbi1zeW1ib2wtbWFwLW1kLnBuZycsXG4gICAgICAgICAgICB1cmw6ICdDdXJyZW50X0xvY2F0aW9uX01hcmtlci5wbmcnLFxuICAgICAgICAgICAgc2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMTAwLCAxMDApLFxuICAgICAgICAgICAgb3JpZ2luOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMCwgMCksXG4gICAgICAgICAgICBhbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludCgxNywgMzQpLFxuICAgICAgICAgICAgc2NhbGVkU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMjAsIDMzKVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIEVWRU5UIEhBTkRMRVJTIC0gVVBEQVRFXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZURlZmF1bHRMb2NhdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUgPSBtYXAuZ2V0Q2VudGVyKCkubGF0KCk7XG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSA9IG1hcC5nZXRDZW50ZXIoKS5sbmcoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUJvdW5kcygpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBib3VuZHMgPSBtYXAuZ2V0Qm91bmRzKCk7XG4gICAgICAgICAgICB2YXIgbmUgPSBib3VuZHMuZ2V0Tm9ydGhFYXN0KCk7IC8vIExhdExuZyBvZiB0aGUgbm9ydGgtZWFzdCBjb3JuZXJcbiAgICAgICAgICAgIHZhciBzdyA9IGJvdW5kcy5nZXRTb3V0aFdlc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBzb3V0aC13ZXN0IGNvcmRlclxuICAgICAgICAgICAgLy9Zb3UgZ2V0IG5vcnRoLXdlc3QgYW5kIHNvdXRoLWVhc3QgY29ybmVycyBmcm9tIHRoZSB0d28gYWJvdmU6XG5cbiAgICAgICAgICAgIGN1cnJlbnRfbWFwX253ID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhuZS5sYXQoKSwgc3cubG5nKCkpO1xuICAgICAgICAgICAgY3VycmVudF9tYXBfc2UgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHN3LmxhdCgpLCBuZS5sbmcoKSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVXYXRjaExvY2F0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGJvdW5kcyA9IG1hcC5nZXRCb3VuZHMoKTtcbiAgICAgICAgICAgIHZhciBuZSA9IGJvdW5kcy5nZXROb3J0aEVhc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBub3J0aC1lYXN0IGNvcm5lclxuICAgICAgICAgICAgdmFyIHN3ID0gYm91bmRzLmdldFNvdXRoV2VzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIHNvdXRoLXdlc3QgY29yZGVyXG4gICAgICAgICAgICAvL1lvdSBnZXQgbm9ydGgtd2VzdCBhbmQgc291dGgtZWFzdCBjb3JuZXJzIGZyb20gdGhlIHR3byBhYm92ZTpcblxuICAgICAgICAgICAgY3VycmVudF9tYXBfbncgPSB7IFxuICAgICAgICAgICAgICAgIGxhdDogbmUubGF0KCksIFxuICAgICAgICAgICAgICAgIGxvbjogc3cubG5nKClcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjdXJyZW50X21hcF9zZSA9IHtcbiAgICAgICAgICAgICAgICBsYXQ6IHN3LmxhdCgpLCBcbiAgICAgICAgICAgICAgICBsb246IG5lLmxuZygpXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgY3VycmVudF9tYXBfY2VudGVyIDtcblxuICAgICAgICAgICAgLy8gc2VlIGlmIHRoZSBsYXRlc3QgeCBtYXJrZXIgb3IgcG9zdCBsb2NhdGlvbiBpcyB3aXRoaW4gdXNlcidzIHZpZXdcbiAgICAgICAgICAgIGlmICghKHNjb3BlLnBvc3RMb2NhdGlvbi5sYXQgPCBjdXJyZW50X21hcF9udy5sYXQpIHx8XG4gICAgICAgICAgICAgICAgIShzY29wZS5wb3N0TG9jYXRpb24ubGF0ID4gY3VycmVudF9tYXBfc2UubGF0KSB8fFxuICAgICAgICAgICAgICAgICEoc2NvcGUucG9zdExvY2F0aW9uLmxvbiA8IGN1cnJlbnRfbWFwX3NlLmxvbikgfHxcbiAgICAgICAgICAgICAgICAhKHNjb3BlLnBvc3RMb2NhdGlvbi5sb24gPiBjdXJyZW50X21hcF9udy5sb24pIClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBpZiBpdCBpcyBub3Qgd2l0aGluIHVzZXIncyB2aWV3LCB0aGVuIGp1c3QgdXNlIG1hcCBjZW50ZXJcbiAgICAgICAgICAgICAgICBjdXJyZW50X21hcF9jZW50ZXIgPSB7XG4gICAgICAgICAgICAgICAgICAgIGxhdDogbWFwLmdldENlbnRlcigpLmxhdCgpLFxuICAgICAgICAgICAgICAgICAgICBsb246IG1hcC5nZXRDZW50ZXIoKS5sbmcoKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gaWYgaXQgaXMgd2l0aGluIHVzZXIncyB2aWV3LCB1c2UgeCBtYXJrZXIgbG9jYXRpb24gYS5rLmEgcG9zdCBsb2NhdGlvblxuICAgICAgICAgICAgICAgIGN1cnJlbnRfbWFwX2NlbnRlciA9IHtcbiAgICAgICAgICAgICAgICAgICAgbGF0OiBzY29wZS5wb3N0TG9jYXRpb24ubGF0LFxuICAgICAgICAgICAgICAgICAgICBsb246IHNjb3BlLnBvc3RMb2NhdGlvbi5sb25cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgU2Vzc2lvblN2Yy51cGRhdGVXYXRjaExvY2F0aW9uKGN1cnJlbnRfbWFwX253LCBjdXJyZW50X21hcF9zZSwgY3VycmVudF9tYXBfY2VudGVyLCBzY29wZS5ndWlkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIEVWRU5UIEhBTkRMRVJTIC0gRFJBV1xuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyB1cGRhdGUgcmVzcG9uc2VzIHN1Y2ggYXMgdmlzdWFsaXphdGlvbiBvZiBsaXN0ZW5lcnNcbiAgICAgICAgZnVuY3Rpb24gZHJhd1Jlc3BvbnNlcyhwb3N0KXtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ3JlZmVyZW5jZSBwb3N0OicsIHBvc3QpO1xuXG4gICAgICAgICAgICBTZXNzaW9uU3ZjLmZldGNoKClcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKHNlc3Npb25zKXtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2Vzc2lvbnMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2Vzc2lvbiA9IHNlc3Npb25zW2ldO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIHNraXAgbXkgc2Vzc2lvbiAtIG5vIG5lZWQgdG8gZHJhdyDrgrQg7J6Q7Iug7J2YIOyEuOyFmOydgCDqt7jrprTtlYTsmpTqsIAg7JeG64ukLlxuICAgICAgICAgICAgICAgICAgICBpZiAoc2Vzc2lvbi5ndWlkID09IHNjb3BlLmd1aWQpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICAgICAgICAgICAgICAgLy8gc2Vzc2lvbidzIHdhdGNoIGxvY2F0aW9uIHdpbGwgYmUgYm91bmNlZCFcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdhdGNoX2xvY2F0aW9uID0gYW5ndWxhci5mcm9tSnNvbihzZXNzaW9uLndhdGNobG9jKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvc3RfbG9jYXRpb24gID0gYW5ndWxhci5mcm9tSnNvbihwb3N0LmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIOycoOyggOqwgCDrs7Tqs6Ag7J6I64qUIOuwlOyatOuNlOumrCDslYjsl5Ag6re4IHNlc3Npb24o64uk66W47Jyg7KCAKSDssrTtgoFcblxuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGN1cnJlbnRfbWFwX3NlLCBjdXJyZW50X21hcF9udyk7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUJvdW5kcygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoISh3YXRjaF9sb2NhdGlvbi5jZW50ZXJfbGF0IDwgY3VycmVudF9tYXBfbncubGF0KCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKHdhdGNoX2xvY2F0aW9uLmNlbnRlcl9sYXQgPiBjdXJyZW50X21hcF9zZS5sYXQoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEod2F0Y2hfbG9jYXRpb24uY2VudGVyX2xvbiA8IGN1cnJlbnRfbWFwX3NlLmxuZygpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgISh3YXRjaF9sb2NhdGlvbi5jZW50ZXJfbG9uID4gY3VycmVudF9tYXBfbncubG5nKCkpIClcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBzZXNzaW9uKOuLpOuluOycoOyggCnrk6TsnbQg6re4IO2PrOyKpO2KuOulvCDrs7Tqs6Ag7J6I7KeAIOyViuycvOuptCDsiqTtgrUuXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHBvc3RfbG9jYXRpb24ubGF0IDwgd2F0Y2hfbG9jYXRpb24ubndfbGF0KSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIShwb3N0X2xvY2F0aW9uLmxhdCA+IHdhdGNoX2xvY2F0aW9uLnNlX2xhdCkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEocG9zdF9sb2NhdGlvbi5sb24gPCB3YXRjaF9sb2NhdGlvbi5zZV9sb24pIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKHBvc3RfbG9jYXRpb24ubG9uID4gd2F0Y2hfbG9jYXRpb24ubndfbG9uKSApXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHdhdGNoX2xvY2F0aW9uLmNlbnRlcl9sYXQsIHdhdGNoX2xvY2F0aW9uLmNlbnRlcl9sb24pO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmRvbVNpemUgPSBNYXRoLnJhbmRvbSgpICogNDAgKyA0MDsgXG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmxOYW1lICAgID0gJ0JsaW5rLmdpZic7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGltYWdlTGlzdGVuZXIgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHVybE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IG5ldyBnb29nbGUubWFwcy5Qb2ludCgwLCAwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KHJhbmRvbVNpemUgKiAwLjUgKyA1LCByYW5kb21TaXplICogMC41ICsgMTQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGVkU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUocmFuZG9tU2l6ZSwgcmFuZG9tU2l6ZSlcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24oaW1hZ2VMaXN0ZW5lcil7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogZ29vZ2xlTG9jLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcDogbWFwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIlJlY2VpdmVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VMaXN0ZW5lcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpbWl6ZWQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcihtYXJrZXJPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWNlaXZlcl9tYXJrZXJfbGlmZXNwYW4gPSAxMjAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAkdGltZW91dChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24ob2xkX21hcmtlcil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xkX21hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGRfbWFya2VyID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KG1hcmtlcikpLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VpdmVyX21hcmtlcl9saWZlc3Bhbik7XG5cbiAgICAgICAgICAgICAgICAgICAgfShpbWFnZUxpc3RlbmVyKSk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHBvc3QgaXMgY29tcGxldGx5IGRlYWQgYW5kIHJlbW92ZSB0aGF0IHBvc3RcbiAgICAgICAgZnVuY3Rpb24gY2xlYW51cCgpIHtcbiAgICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgbWFya2VyOyBtYXJrZXIgPSBtYXJrZXJzT25NYXBbal07IGorKyl7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnREYXRlICAgICAgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VGltZU1pbGxpID0gY3VycmVudERhdGUuZ2V0VGltZSgpO1xuICAgICAgICAgICAgICAgIHZhciBsaWZlID0gbWFya2VyLnBvc3QubGlmZWVuZCAtIGN1cnJlbnRUaW1lTWlsbGk7XG5cbiAgICAgICAgICAgICAgICBpZiAobGlmZSA8PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnY2xlYW5pbmcgdXAuLicsIG1hcmtlci5wb3N0Ll9pZCk7XG4gICAgICAgICAgICAgICAgICAgIHVuRHJhd1Bvc3QobWFya2VyLnBvc3QuX2lkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVBbmREcmF3UG9zdHMoKXtcbiAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gZm9yIGNoZWNraW5nIGxvY2FsIHBvc3RzIC0gaXNQb2ludGluZ1lvdVxuICAgICAgICAgICAgaXNHdWlkdGd0Q2hhbmdlZCA9IHByZXZHdWlkdGd0ICE9IHNjb3BlLmd1aWR0Z3Q7IC8vIHNlZSBpZiBteSBndWlkdGd0IGhhcyBjaGFuZ2VkO1xuICAgICAgICAgICAgcHJldkd1aWR0Z3QgPSBzY29wZS5ndWlkdGd0OyAvLyB1cGRhdGUgcHJldmlvdXMgZ3VpZHRndFxuXG4gICAgICAgICAgICBmdW5jdGlvbiBkcmF3UG9zdHMocG9zdHMpe1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb3N0cy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwb3N0ID0gcG9zdHNbaV07XG5cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBTVEFSVCAtIENIRUNLIElGIElUUyBXSVRISU4gVklFVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IGFuZ3VsYXIuZnJvbUpzb24ocG9zdC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxvY2F0aW9uLmxhdCwgbG9jYXRpb24ubG9uKTtcblxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVCb3VuZHMoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoZ29vZ2xlTG9jLmxhdCgpIDwgY3VycmVudF9tYXBfbncubGF0KCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKGdvb2dsZUxvYy5sYXQoKSA+IGN1cnJlbnRfbWFwX3NlLmxhdCgpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIShnb29nbGVMb2MubG5nKCkgPCBjdXJyZW50X21hcF9zZS5sbmcoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEoZ29vZ2xlTG9jLmxuZygpID4gY3VycmVudF9tYXBfbncubG5nKCkpIClcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7IC8vIHNraXAgdGhpcyBwb3N0IC0gbm8gbmVlZCB0byBkcmF3XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBFTkQgLSBDSEVDSyBJRiBJVFMgV0lUSElOIFZJRVcgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBTVEFSVCAtIENIRUNLIFdFIEhBVkUgVE8gUkVEUkFXIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIG1hcmtlcnMgcG9zdCBpcyBleGlzaXRpbmcgb25lLCB3ZSBkb24ndCB3YW50IHRvIGRyYXcgaXQgYWdhaW4uXG4gICAgICAgICAgICAgICAgICAgIC8vIG9ubHkgZHJhdyBuZXcgb25lcyFcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIG1hcmtlcjsgbWFya2VyID0gbWFya2Vyc09uTWFwW2pdOyBqKyspe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL+ydtOu2gOu2hCDroZzsp4HsnYQg64uk7IucIOynnOyVvO2VqFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzQWxyZWFkeURyYXduID0gcG9zdC5faWQgPT0gbWFya2VyLnBvc3QuX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQWxyZWFkeURyYXduKSAvLyDsnbTrr7gg6re466Ck7KGM64qU7KeAIO2FjOyKpO2KuFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0d1aWR0Z3RDaGFuZ2VkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5EcmF3UG9zdChwb3N0Ll9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWFya2VyLnBvc3QuZ3VpZHRndCA9PSBwb3N0Lmd1aWR0Z3QpeyAgLy8g7J2066+4IOq3uOugpOynhOqyg+ykkSwgZ3VpZHRndOydtCDrsJTrgIzsl4jripTqsIBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdCA9IG51bGw7IC8vIOydtOuvuCDqt7jroKTsp4Qg7Y+s7Iqk7Yq4652866m0LCBudWxs66GcLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsgLy8g7J20IGxvb3DsnYAgcG9zdC5faWTrp4wg6rKA7IKs7Jqp7J6E7Jy866GcLCDrp4zslb0g6rK57LmY66m0IOuwlOuhnCBsb29w7J2EIOupiOy2sOuPhCDqtJzssK7ri6QufVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuRHJhd1Bvc3QocG9zdC5faWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAocG9zdCA9PSBudWxsKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOyAvLyBza2lwIHRoaXMgcG9zdCAtIG5vIG5lZWQgdG8gZHJhd1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRU5EIC0gQ0hFQ0sgV0UgSEFWRSBUTyBSRURSQVcgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBTVEFSVCAtIERSQVdJTkcgUE9TVCAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgICAgICAgICAgICAgIC8vIG1hcmtlciBvcHRpb24gc2V0dGluZ1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBnb29nbGVMb2MsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXA6IG1hcCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIkJ1YmJsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VQb3N0XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKG1hcmtlck9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAvLyBhZGQgbWFya2VyIHRvIGFycmF5LCB0aGlzIG1lYW5zIHRoYXQgaXQgaGFzIGJlZW4gZHJhd24gdG8gbWFwXG4gICAgICAgICAgICAgICAgICAgIG1hcmtlcnNPbk1hcC5wdXNoKFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlcjogbWFya2VyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc3QgIDogcG9zdFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBTVEFSVCAtIERSQVdJTkcgTUVTU0FHRSBXSU5ET1cgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgICAgICAgICAgICAgICAgICB2YXIgY291cGxpbmdfc3RhdHVzID0gY2FsY3VsYXRlQ291cGxpbmcocG9zdC5ndWlkLCBwb3N0Lmd1aWR0Z3QpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJwb3N0LmlzTG9jYWxcIiwgcG9zdC5pc2xvY2FsKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2FsX3N0YXR1cyA9IHBvc3QuaXNsb2NhbDtcblxuICAgICAgICAgICAgICAgICAgICAvLyDsiqTsvZTtlITsl5DshJzrtoDthLAg7IOI66Gc7Jq0IOywqOydvOuTnCDsiqTsvZTtlITrpbwg66eM65Ok7Ja0IGVhY2ggZm9yIGxvb3Dsl5DshJwg7IKs7Jqp7ZWc64ukLlxuICAgICAgICAgICAgICAgICAgICAvLyAtLT4g7ZW07JW8LCDqsIEgRE9N7J20IOqwgeqwgeydmCBzY29wZeulvCDqsIDsoLjshJwgcG9zdCBtc2fqsIAg7JWIIOqyuey5nOuLpC5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHNjb3BlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSBwYXJlbnQuJG5ldyh0cnVlKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgb3BlbkluZm9XaW5kb3cgPSAoZnVuY3Rpb24obWFya2VyLCBjaGlsZF9zY29wZSwgcG9zdCwgY291cGxpbmdfc3RhdHVzLCBsb2NhbF9zdGF0dXMpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjcmVhdGUgbmV3IHdpbmRvd1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmZvV2luZG93T3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGl4ZWxPZmZzZXQ6IG5ldyBnb29nbGUubWFwcy5TaXplKC0zOS41LCAxNi4wKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZUF1dG9QYW46IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmZvV2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coaW5mb1dpbmRvd09wdGlvbnMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGN1cnJlbnQgdGltZSBhbmQgc3VidHJhY3QgaXQgZnJvbSBwb3N0J3MgZW5kIHRpbWUuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhhdCB3aWxsIGJlIGFjY3VyYXRlIHBvc3QgdGltZSBmb3IgaW5zdGFudCBwb3N0cyBhbmQgbG9uZyBwb3N0cy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudERhdGUgICAgICA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lTWlsbGkgPSBjdXJyZW50RGF0ZS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvc3RsaWZlICAgICAgICAgPSAoKHBvc3QubGlmZWVuZCAtIGN1cnJlbnRUaW1lTWlsbGkpID49IDApID8gKHBvc3QubGlmZWVuZCAtIGN1cnJlbnRUaW1lTWlsbGkpIDogMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsaWZlcGVyY2VudGFnZSA9IChwb3N0bGlmZSAvIHBvc3QubGlmZXNwYW4pLnRvRml4ZWQoMilcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdG8gbWFrZSBkYXRhIGF2YWlsYWJsZSB0byB0ZW1wbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLm1zZyAgICAgICAgICAgICAgICA9IHBvc3QuYm9keTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0bGlmZSAgICAgICAgICAgPSBwb3N0bGlmZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Z3VpZCAgICAgICAgICAgPSBwb3N0Lmd1aWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUucG9zdGd1aWR0Z3QgICAgICAgID0gcG9zdC5ndWlkdGd0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3Rjb3VwbGVzdGF0dXMgICA9IGNvdXBsaW5nX3N0YXR1cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPSBsaWZlcGVyY2VudGFnZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0bG9jYWxzdGF0dXMgICAgPSBsb2NhbF9zdGF0dXM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgZW5hYmxlcyBjaGFuZ2luZyBjb3VwbGluZyB2YWx1ZSBpbnN0YW50bHkuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUuJG9uKCdzZXQ6Y291cGxpbmcnLCBmdW5jdGlvbihfLCBjb3VwbGluZ191cGRhdGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Y291cGxlc3RhdHVzID0gY291cGxpbmdfdXBkYXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb21waWxlIGl0IGJlZm9yZSBsb2FkZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udGVudCAgPSAnPGRpdiBtYXAtbXNnPjwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXBpbGVkID0gJGNvbXBpbGUoY29udGVudCkoY2hpbGRfc2NvcGUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5zZXRDb250ZW50KCBjb21waWxlZFswXSApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIoaW5mb1dpbmRvdywnY2xvc2VjbGljaycsZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvc3QuZ3VpZCA9PSBzY29wZS5ndWlkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dhbChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJBcmUgeW91IHN1cmU/XCIsICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogXCJZb3Ugd2lsbCBub3QgYmUgYWJsZSB0byByZWNvdmVyIHRoaXMgaW1hZ2luYXJ5IGZpbGUhXCIsICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJ3YXJuaW5nXCIsICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6IFwiI0RENkI1NVwiLCAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiBcIlllcywgZGVsZXRlIGl0IVwiLCAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlT25Db25maXJtOiBmYWxzZSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oaXNDb25maXJtKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDb25maXJtKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUG9zdHNTdmMucmVtb3ZlKHBvc3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2FsKFwiRGVsZXRlZCFcIiwgXCJZb3VyIGltYWdpbmFyeSBmaWxlIGhhcyBiZWVuIGRlbGV0ZWQuXCIsIFwic3VjY2Vzc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudERhdGUgICAgICA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VGltZU1pbGxpID0gY3VycmVudERhdGUuZ2V0VGltZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zdGxpZmUgICAgICAgICA9ICgocG9zdC5saWZlZW5kIC0gY3VycmVudFRpbWVNaWxsaSkgPj0gMCkgPyAocG9zdC5saWZlZW5kIC0gY3VycmVudFRpbWVNaWxsaSkgOiAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGlmZXBlcmNlbnRhZ2UgPSAocG9zdGxpZmUgLyBwb3N0LmxpZmVzcGFuKS50b0ZpeGVkKDIpXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpZmVwZXJjZW50YWdlID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPSBsaWZlcGVyY2VudGFnZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cub3BlbihtYXAgLCBtYXJrZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5vcGVuKG1hcCAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9KShtYXJrZXIsIGNoaWxkLCBwb3N0LCBjb3VwbGluZ19zdGF0dXMsIGxvY2FsX3N0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBvcGVuSW5mb1dpbmRvdygpO1xuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEVORCAtIERSQVdJTkcgTUVTU0FHRSBXSU5ET1cgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgICAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRU5EIC0gRFJBV0lORyBQT1NUIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICAgICAgICAgIH0gLy8gZW5kIG9mIGZvci1sb29wXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFBvc3RzU3ZjLmZldGNoKClcbiAgICAgICAgICAgIC5zdWNjZXNzKGRyYXdQb3N0cykgXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgZXJyb3JcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBlbmQgb2YgcG9zdCBmZXRjaCBzdWNjZXNzXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkcmF3RHJvcERvd24obG9jYXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxvY2F0aW9uLmxhdCwgbG9jYXRpb24ubG9uKTtcblxuICAgICAgICAgICAgdXBkYXRlQm91bmRzKCk7XG4gICAgICAgICAgICAvLyDrsJTsmrTrjZTrpqwg7JWI7JeQIOyeiOuKlOyngOu2gO2EsCDssrTtgazrpbwg7ZWY7J6lXG4gICAgICAgICAgICBpZiAoIShnb29nbGVMb2MubGF0KCkgPCBjdXJyZW50X21hcF9udy5sYXQoKSkgfHxcbiAgICAgICAgICAgICAgICAhKGdvb2dsZUxvYy5sYXQoKSA+IGN1cnJlbnRfbWFwX3NlLmxhdCgpKSB8fFxuICAgICAgICAgICAgICAgICEoZ29vZ2xlTG9jLmxuZygpIDwgY3VycmVudF9tYXBfc2UubG5nKCkpIHx8XG4gICAgICAgICAgICAgICAgIShnb29nbGVMb2MubG5nKCkgPiBjdXJyZW50X21hcF9udy5sbmcoKSkgKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybjsgLy8gc2tpcCB0aGlzIHBvc3QgLSBubyBuZWVkIHRvIGRyYXdcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gbWFya2VyIG9wdGlvbiBzZXR0aW5nXG4gICAgICAgICAgICB2YXIgbWFya2VyT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogZ29vZ2xlTG9jLFxuICAgICAgICAgICAgICAgIG1hcDogbWFwLFxuICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkRST1AsXG4gICAgICAgICAgICAgICAgdGl0bGU6IFwiVXNlclBpblwiLFxuICAgICAgICAgICAgICAgIGljb246IGltYWdlVXNlckxvZ2luXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcihtYXJrZXJPcHRpb25zKTtcblxuICAgICAgICAgICAgJHRpbWVvdXQoXG4gICAgICAgICAgICAgICAgKGZ1bmN0aW9uKG9sZF9tYXJrZXIpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9sZF9tYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0obWFya2VyKSksIFxuICAgICAgICAgICAgMjAwMCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1bkRyYXdQb3N0KHBvc3RpZClcbiAgICAgICAge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcInN0YXJ0aW5nIHJlbW92ZSBwb3N0XCIpO1xuICAgICAgICAgICAgZm9yICh2YXIgayA9IDAsIG1hcmtlcjsgbWFya2VyID0gbWFya2Vyc09uTWFwW2tdOyBrKyspIHtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHBvc3RpZCk7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhtYXJrZXIucG9zdC5faWQpO1xuICAgICAgICAgICAgICAgIGlmIChwb3N0aWQgPT0gbWFya2VyLnBvc3QuX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlci5tYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICBtYXJrZXJzT25NYXAuc3BsaWNlKGssIDEpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkcmF3QW5kU2V0UGxhY2UobG9jYXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxvY2F0aW9uLmxhdCwgbG9jYXRpb24ubG9uKTtcbiAgICAgICAgICAgIGRyYXdIZWxwZXJNYXJrZXIoZ29vZ2xlTG9jKTtcbiAgICAgICAgICAgIHNldFBsYWNlKGdvb2dsZUxvYyk7XG5cbiAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSBzZXJ2ZXIgZ2V0cyB1cGRhdGVkIHdoZW5ldmVyIHNldHRpbmcgbmV3IHBsYWNlIHdpdGggbWFya2VyXG4gICAgICAgICAgICB1cGRhdGVXYXRjaExvY2F0aW9uKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBkcmF3IG1hcCB3aXRoIGhlbHBlciBtYXJrZXJzXG4gICAgICAgIGZ1bmN0aW9uIGRyYXdIZWxwZXJNYXJrZXIobG9jYXRpb24pe1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG1hcmtlcjsgbWFya2VyID0gaGVscGVyTWFya2Vyc1tpXTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbWFya2VyLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGhlbHBlck1hcmtlcnMgPSBbXTtcbiAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogbG9jYXRpb24sIFxuICAgICAgICAgICAgICAgIG1hcDogbWFwLFxuICAgICAgICAgICAgICAgIGljb246IGltYWdlVGFyZ2V0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGhlbHBlck1hcmtlcnMucHVzaChtYXJrZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdW5EcmF3SGVscGVyTWFya2VyKCl7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbWFya2VyOyBtYXJrZXIgPSBoZWxwZXJNYXJrZXJzW2ldOyBpKyspIHtcbiAgICAgICAgICAgICAgICBtYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGVscGVyTWFya2VycyA9IFtdO1xuICAgICAgICB9XG5cblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBVVElMXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIGZ1bmN0aW9uIHNldFBsYWNlKGxvY2F0aW9uKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBicm9hZGNhc3QgbG9jYXRpb24gaW5mb3IobG9uLGxhdClcbiAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdzZXQ6bG9jJywgbG9jYXRpb24pO1xuXG4gICAgICAgICAgICB2YXIgZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTtcblxuICAgICAgICAgICAgLy8gYnJvYWRjYXN0IHBsYWNlIGZvcm1hdHRlZF9hZGRyZXNzIGFuZCBkcmF3IGljb25cbiAgICAgICAgICAgIGdlb2NvZGVyLmdlb2NvZGUoIHsgJ2xhdExuZyc6IGxvY2F0aW9uIH0sIGZ1bmN0aW9uKHJlc3VsdHMsIHN0YXR1cykge1xuICAgICAgICAgICAgICAgIC8vIGFzIHVzZXIgY2xpY2tzIG9uIHRoZSBtYXAsXG4gICAgICAgICAgICAgICAgLy8gd2UgaGF2ZSB0byBzYXZlIHRoZSBmb3JtYXR0ZWQgYWRkcmVzcyBpbiAkc2NvcGUgYW5kXG4gICAgICAgICAgICAgICAgLy8gaXQgd2lsbCBiZSB1c2VkIHRocm91Z2ggcG9zdHMuY3RybFxuICAgICAgICAgICAgICAgIC8vIGVtaXQgYnJvYWRjYXNlICdwbGFjZScgYW5kIHNlbmQgdGhpcyB0byBhcHBsaWNhdGlvbi5jdHJsXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYnJvYWRjYXN0IGZvcm1hdHRlZF9hZGRyZXNzXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdzZXQ6cGxhY2UnLCByZXN1bHRzWzFdLmZvcm1hdHRlZF9hZGRyZXNzKTsgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoKGVycikge1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgIHN3YWwoXCJcIixcIkxvY2F0aW9uIGRvZXMgbm90IGV4aXN0c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldDpwbGFjZScsIFwiTG9jYXRpb24gZG9lcyBub3QgZXhpc3RzXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2FsY3VsYXRlQ291cGxpbmcocG9zdF9ndWlkLCBwb3N0X2d1aWR0Z3QpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qIGNvdXBsaW5nIHN0YXR1c1xuICAgICAgICAgICAgICAgIDAgLSBubyBzdGF0dXNcbiAgICAgICAgICAgICAgICAxIC0gaSBsaWtlIHlvdVxuICAgICAgICAgICAgICAgIDIgLSB5b3UgbGlrZSBpXG4gICAgICAgICAgICAgICAgNCAtIHdlIGxpa2UgZWFjaCBvdGhlciAvLyBkaXNhYmxlZC5cbiAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIHZhciBpc1BvaW50aW5nWW91ICAgICA9IHNjb3BlLmd1aWR0Z3QgPT0gcG9zdF9ndWlkO1xuICAgICAgICAgICAgdmFyIGlzUG9pbnRpbmdNZSAgICAgID0gc2NvcGUuZ3VpZCAgICA9PSBwb3N0X2d1aWR0Z3Q7XG4gICAgICAgICAgICB2YXIgaXNNeVBvc3QgICAgICAgICAgPSBzY29wZS5ndWlkICAgID09IHBvc3RfZ3VpZDtcbiAgICAgICAgICAgIHZhciBpc1BvaW50aW5nU29tZW9uZSA9IHNjb3BlLmd1aWR0Z3QgIT0gJzAnO1xuXG4gICAgICAgICAgICBpZiAoaXNNeVBvc3QgJiYgaXNQb2ludGluZ1NvbWVvbmUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDI7IC8vIGZvciBteSB2aWV3J3MgbXkgcG9zdCB0byBiZSBcIkkgbGlrZSBzb21lb25lXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGlzUG9pbnRpbmdZb3UgJiYgaXNQb2ludGluZ01lKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiA0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaXNQb2ludGluZ1lvdSAmJiAhaXNQb2ludGluZ01lKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoIWlzUG9pbnRpbmdZb3UgJiYgaXNQb2ludGluZ01lKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gVUlcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgZnVuY3Rpb24gc2V0VUlTZWFyY2hMb2NhdGlvblRvZ2dsZSgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBtYXBTZWFyY2hUb2dnbGUgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1zZWFyY2gtdG9nZ2xlJykpO1xuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5UT1BfTEVGVF0ucHVzaChtYXBTZWFyY2hUb2dnbGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0VUlNb3ZlVG9DdXJyTG9jQnRuKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGN1cnJMb2NCdG4gPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1idG4tY3VycicpKTsgXG4gICAgICAgICAgICBtYXAuY29udHJvbHNbZ29vZ2xlLm1hcHMuQ29udHJvbFBvc2l0aW9uLlRPUF9SSUdIVF0ucHVzaChjdXJyTG9jQnRuKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldFVJUG9zdEZvcm0oKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgcG9zdEZvcm0gPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1wb3N0aW5nJykpOyBcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uQk9UVE9NX0NFTlRFUl0ucHVzaChwb3N0Rm9ybSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRVSVBvc3RCdG4oKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgcG9zdEJ0biA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLWJ0bi1zdWJtaXQnKSk7XG4gICAgICAgICAgICBtYXAuY29udHJvbHNbZ29vZ2xlLm1hcHMuQ29udHJvbFBvc2l0aW9uLkJPVFRPTV9DRU5URVJdLnB1c2gocG9zdEJ0bik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRVSVRpbWVTbGlkZXIoKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgdGltZVNsaWRlciA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLXRpbWUtc2xpZGVyJykpO1xuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5CT1RUT01fQ0VOVEVSXS5wdXNoKHRpbWVTbGlkZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0VUlTZWFyY2hCb3goKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgdGhlIHNlYXJjaCBib3ggYW5kIGxpbmsgaXQgdG8gdGhlIFVJIGVsZW1lbnQuXG4gICAgICAgICAgICB2YXIgaW5wdXQgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhYy1pbnB1dCcpKTsgLy8gQHR5cGUge0hUTUxJbnB1dEVsZW1lbnR9ICBcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uVE9QX0xFRlRdLnB1c2goaW5wdXQpO1xuXG4gICAgICAgICAgICB2YXIgc2VhcmNoQm94ID0gbmV3IGdvb2dsZS5tYXBzLnBsYWNlcy5TZWFyY2hCb3goKGlucHV0KSk7IC8vIEB0eXBlIHtIVE1MSW5wdXRFbGVtZW50fSBcblxuICAgICAgICAgICAgLy8gTGlzdGVuIGZvciB0aGUgZXZlbnQgZmlyZWQgd2hlbiB0aGUgdXNlciBzZWxlY3RzIGFuIGl0ZW0gZnJvbSB0aGVcbiAgICAgICAgICAgIC8vIHBpY2sgbGlzdC4gUmV0cmlldmUgdGhlIG1hdGNoaW5nIHBsYWNlcyBmb3IgdGhhdCBpdGVtLlxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIoc2VhcmNoQm94LCAncGxhY2VzX2NoYW5nZWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGxhY2VzID0gc2VhcmNoQm94LmdldFBsYWNlcygpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHBsYWNlcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIHRha2Ugb25seSAxIHNwb3RcbiAgICAgICAgICAgICAgICB2YXIgcGxhY2UgPSBwbGFjZXNbMF07XG5cbiAgICAgICAgICAgICAgICAvLyB3aGVuIHNlYXJjaCBoYXBwZW5zLCBsb2NhdGlvbiB3aWxsIGJlIHVwZGF0ZWQgYXMgd2VsbCBmb3IgcG9zdFxuICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgbGF0OiBwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sYXQoKSxcbiAgICAgICAgICAgICAgICAgICAgbG9uOiBwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZHJhd0FuZFNldFBsYWNlKGxvY2F0aW9uKTtcblxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUgPSBwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sYXRpdHVkZTtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSA9IHBsYWNlLmdlb21ldHJ5LmxvY2F0aW9uLmxvbmdpdHVkZTtcblxuICAgICAgICAgICAgICAgIG1hcC5wYW5UbyhwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgbWFwLnNldFpvb20oMTYpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBFVkVOVFxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICBmdW5jdGlvbiBzZXRFdmVudENsaWNrKClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gY2xpY2sgZXZlbnQgb24gbWFwIHRvIGRyYXcgWCBtYXJrZXIgYW5kIHNldCBQb3N0IGxvY2F0aW9uXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXBfb3JpZ2luLCAnY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgbGF0OiBldmVudC5sYXRMbmcubGF0KCksXG4gICAgICAgICAgICAgICAgICAgIGxvbjogZXZlbnQubGF0TG5nLmxuZygpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBkcmF3QW5kU2V0UGxhY2UobG9jYXRpb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRFdmVudENlbnRlckNoYW5nZWQoKVxuICAgICAgICB7XG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXBfb3JpZ2luLCAnY2VudGVyX2NoYW5nZWQnLCBmdW5jdGlvbigpeyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyB3aGVuIG1hcCBjZW50ZXIgY2hhbmdlLCB1cGRhdGUgbGFzdCBsb2NhdGlvbiBpbiBtZW1vcnksXG4gICAgICAgICAgICAgICAgLy8gc28gYnJvd3NlciB3aWxsIHJlbWVtYmVyIGl0IG5leHQgdGltZSB5b3UgY29tZSFcbiAgICAgICAgICAgICAgICB1cGRhdGVEZWZhdWx0TG9jYXRpb24oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0RXZlbnRCb3VuZHNDaGFuZ2VkKClcbiAgICAgICAge1xuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwX29yaWdpbiwgJ2JvdW5kc19jaGFuZ2VkJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAvLyB3aGVuIG1hcCBjZW50ZXIgY2hhbmdlLCB1cGRhdGUgYm91bmRzIGluZm8gZm9yIG1hcFxuICAgICAgICAgICAgICAgIHVwZGF0ZUJvdW5kcygpOyAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldEV2ZW50RHJhZ0VuZCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcF9vcmlnaW4sICdkcmFnZW5kJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgbWFwIGFzIGRyYWcgZW5kXG4gICAgICAgICAgICAgICAgdXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG5cbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgd2F0Y2hsb2Mgd2hlbiBjZW50ZXIgY2hhbmdlZC5cbiAgICAgICAgICAgICAgICB1cGRhdGVXYXRjaExvY2F0aW9uKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldEV2ZW50UmVzaXplKClcbiAgICAgICAge1xuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwX29yaWdpbiwgJ3Jlc2l6ZScsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIG1hcCBhcyBkcmFnIGVuZFxuICAgICAgICAgICAgICAgIHVwZGF0ZUFuZERyYXdQb3N0cygpO1xuXG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIHdhdGNobG9jIHdoZW4gY2VudGVyIGNoYW5nZWQuXG4gICAgICAgICAgICAgICAgdXBkYXRlV2F0Y2hMb2NhdGlvbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRFdmVudFpvb21DaGFuZ2VkKClcbiAgICAgICAge1xuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwX29yaWdpbiwgJ3pvb21fY2hhbmdlZCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIG1hcCBhcyBkcmFnIGVuZFxuICAgICAgICAgICAgICAgIHVwZGF0ZUFuZERyYXdQb3N0cygpO1xuXG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIHdhdGNobG9jIHdoZW4gY2VudGVyIGNoYW5nZWQuXG4gICAgICAgICAgICAgICAgdXBkYXRlV2F0Y2hMb2NhdGlvbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBTRVRVUCBGT1IgTUFQXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIG1hcCBpbml0aWFsIGNvbmZpZ3NcbiAgICAgICAgZnVuY3Rpb24gaW5pdGlhbE1hcERhdGEoKXtcbiAgICAgICAgICAgIC8vIGlmIGxvY2FsU3RvcmFnZSByZW1lbWJlcnMgbGF0ZXN0IG1hcCBsb2NhdGlvbiwgdXNlIGl0LFxuICAgICAgICAgICAgaWYgKCFpc05hTih3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlKSAmJiAhaXNOYU4od2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGluaXRpYWxNYXBDZW50ZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUsIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmIHRoZXJlIGlzIG5vIGxhdGVzdCBtYXAgbG9jYXRpb24sIGdldCBjdXJyZW50IGxvY2F0aW9uXG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS51c2VyTG9jYXRpb24ubGF0ICE9IDAuMCAmJiBzY29wZS51c2VyTG9jYXRpb24ubG9uICE9IDAuMCkgXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gdGhpcyBtYXkgbm90IHdvcmsgZm9yIG5vdyBzaW5jZSBsb2NhdGlvbiBnZXRzIHNldCBhZnRlciBtYXAgaXMgZGVmaW5lZC4uIChUT0RPOiByZWZhY3RvciB0aGUgb3JkZXIpXG4gICAgICAgICAgICAgICAgaW5pdGlhbE1hcENlbnRlciA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoc2NvcGUudXNlckxvY2F0aW9uLmxhdCwgc2NvcGUudXNlckxvY2F0aW9uLmxvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBpZiBub25lIG9mIGFib3ZlIHdvcmtzLCB0cnkgdG8gc2V0IGl0IHRvIExBICg/ISlcbiAgICAgICAgICAgIGVsc2UgXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaW5pdGlhbE1hcENlbnRlciA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoMzQuMDUsIC0xMTguMjQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtYXBPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICBjZW50ZXIgICAgICA6IGluaXRpYWxNYXBDZW50ZXIsXG4gICAgICAgICAgICAgICAgICAgIHpvb20gICAgICAgIDogMTUsXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbHdoZWVsIDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgc3RyZWV0Vmlld0NvbnRyb2w6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBtYXBUeXBlQ29udHJvbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHBhbkNvbnRyb2w6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB6b29tQ29udHJvbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIG1hcFR5cGVDb250cm9sT3B0aW9uczoge1xuICAgICAgICAgICAgICAgICAgICAgIG1hcFR5cGVJZHM6IFtnb29nbGUubWFwcy5NYXBUeXBlSWQuUk9BRE1BUCwgQ0xPVURfTUFQX0lEXVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBtYXBUeXBlSWQ6IENMT1VEX01BUF9JRFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldE1hbnVhbEV2ZW50cygpe1xuICAgICAgICAgICAgZnVuY3Rpb24gQ2xvdWRNYXAob3B0aW9ucyl7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJJbml0aWFsaXppbmcgbWFwXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBpbnN0YW50aWF0ZSBnb29nbGUgbWFwXG4gICAgICAgICAgICBtYXBfb3JpZ2luID0gbmV3IGdvb2dsZS5tYXBzLk1hcChlbGVtZW50WzBdLCBtYXBPcHRpb25zKTtcblxuICAgICAgICAgICAgLy8gc2V0IHByb3RvdHlwZSBvZiBjdXN0b20gbWFwIHdpdGggb3JpZ2luIG1hcFxuICAgICAgICAgICAgQ2xvdWRNYXAucHJvdG90eXBlID0gbWFwX29yaWdpbjtcblxuICAgICAgICAgICAgLy8gZHJhdyB4IG1hcmtlclxuICAgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlRHJhd1hNYXJrZXIobG9jYXRpb24pe1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIodGhpcywgJ2RyYXdYTWFya2VyJywgbG9jYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQ2xvdWRNYXAucHJvdG90eXBlLmRyYXdYTWFya2VyID0gaGFuZGxlRHJhd1hNYXJrZXI7XG5cbiAgICAgICAgICAgIC8vIGRyYXcgY3VycmVudCBsb2NhdGlvbiBtYXJrZXJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYXdDdXJyTG9jYXRpb25NYXJrZXIobG9jYXRpb24pe1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIodGhpcywgJ2RyYXdDdXJyTG9jYXRpb25NYXJrZXInLCBsb2NhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBDbG91ZE1hcC5wcm90b3R5cGUuZHJhd0N1cnJMb2NhdGlvbk1hcmtlciA9IGhhbmRsZURyYXdDdXJyTG9jYXRpb25NYXJrZXI7XG5cbiAgICAgICAgICAgIC8vIGRyYXcgcG9zdHNcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZVVwZGF0ZUFuZERyYXdQb3N0cygpe1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIodGhpcywgJ3VwZGF0ZUFuZERyYXdQb3N0cycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQ2xvdWRNYXAucHJvdG90eXBlLnVwZGF0ZUFuZERyYXdQb3N0cyA9IGhhbmRsZVVwZGF0ZUFuZERyYXdQb3N0cztcblxuICAgICAgICAgICAgLy8gZHJhdyByZXNwb25zZXNcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYXdSZXNwb25zZXMocG9zdCl7XG4gICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcih0aGlzLCAnZHJhd1Jlc3BvbnNlcycsIHBvc3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQ2xvdWRNYXAucHJvdG90eXBlLmRyYXdSZXNwb25zZXMgPSBoYW5kbGVEcmF3UmVzcG9uc2VzO1xuXG4gICAgICAgICAgICAvLyB1bmRyYXcgcG9zdHNcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZVVuRHJhd1Bvc3QocG9zdGlkKXtcbiAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKHRoaXMsICd1bkRyYXdQb3N0JywgcG9zdGlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIENsb3VkTWFwLnByb3RvdHlwZS51bkRyYXdQb3N0ID0gaGFuZGxlVW5EcmF3UG9zdDtcblxuICAgICAgICAgICAgLy8gY3JlYXRlIGN1c3RvbSBtYXAgZm9yIGFwcFxuICAgICAgICAgICAgbWFwID0gbmV3IENsb3VkTWFwKCk7XG5cbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ2RyYXdYTWFya2VyJywgZnVuY3Rpb24obG9jYXRpb24pe1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShsb2NhdGlvbik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnZHJhd0N1cnJMb2NhdGlvbk1hcmtlcicsIGZ1bmN0aW9uKGxvY2F0aW9uKXtcbiAgICAgICAgICAgICAgICBkcmF3RHJvcERvd24obG9jYXRpb24pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ3VwZGF0ZUFuZERyYXdQb3N0cycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgdXBkYXRlQW5kRHJhd1Bvc3RzKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnZHJhd1Jlc3BvbnNlcycsIGZ1bmN0aW9uKHBvc3Qpe1xuICAgICAgICAgICAgICAgIGRyYXdSZXNwb25zZXMocG9zdCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAndW5EcmF3UG9zdCcsIGZ1bmN0aW9uKHBvc3RpZCl7XG4gICAgICAgICAgICAgICAgdW5EcmF3UG9zdChwb3N0aWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRTdHlsZUZvck1hcCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBmZWF0dXJlT3B0c19kYXkgPSBbe1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzYxOTVhMFwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJhZG1pbmlzdHJhdGl2ZS5wcm92aW5jZVwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwibGFuZHNjYXBlXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wibGlnaHRuZXNzXCI6XCIwXCJ9LHtcInNhdHVyYXRpb25cIjpcIjBcIn0se1wiY29sb3JcIjpcIiNmNWY1ZjJcIn0se1wiZ2FtbWFcIjpcIjFcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwibGFuZHNjYXBlLm1hbl9tYWRlXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcImxpZ2h0bmVzc1wiOlwiLTNcIn0se1wiZ2FtbWFcIjpcIjEuMDBcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwibGFuZHNjYXBlLm5hdHVyYWwudGVycmFpblwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9mZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJwb2kucGFya1wiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LmZpbGxcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiNiYWU1Y2VcIn0se1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJzYXR1cmF0aW9uXCI6LTEwMH0se1wibGlnaHRuZXNzXCI6NDV9LHtcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnkuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2ZhYzlhOVwifSx7XCJ2aXNpYmlsaXR5XCI6XCJzaW1wbGlmaWVkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuaGlnaHdheVwiLFwiZWxlbWVudFR5cGVcIjpcImxhYmVscy50ZXh0XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNGU0ZTRlXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNzg3ODc4XCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMuaWNvblwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJzaW1wbGlmaWVkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInRyYW5zaXQuc3RhdGlvbi5haXJwb3J0XCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLmljb25cIixcInN0eWxlcnNcIjpbe1wiaHVlXCI6XCIjMGEwMGZmXCJ9LHtcInNhdHVyYXRpb25cIjpcIi03N1wifSx7XCJnYW1tYVwiOlwiMC41N1wifSx7XCJsaWdodG5lc3NcIjpcIjBcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdC5zdGF0aW9uLnJhaWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNDMzMjFlXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInRyYW5zaXQuc3RhdGlvbi5yYWlsXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLmljb25cIixcInN0eWxlcnNcIjpbe1wiaHVlXCI6XCIjZmY2YzAwXCJ9LHtcImxpZ2h0bmVzc1wiOlwiNFwifSx7XCJnYW1tYVwiOlwiMC43NVwifSx7XCJzYXR1cmF0aW9uXCI6XCItNjhcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwid2F0ZXJcIixcImVsZW1lbnRUeXBlXCI6XCJhbGxcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiNlYWY2ZjhcIn0se1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwid2F0ZXJcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjYzdlY2VkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcIndhdGVyXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJsaWdodG5lc3NcIjpcIi00OVwifSx7XCJzYXR1cmF0aW9uXCI6XCItNTNcIn0se1wiZ2FtbWFcIjpcIjAuNzlcIn1dfV07XG5cbiAgICAgICAgICAgIHZhciBmZWF0dXJlT3B0c19uaWdodCA9IFt7XCJmZWF0dXJlVHlwZVwiOlwiYWxsXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2ZmZmZmZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJhbGxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5zdHJva2VcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn0se1wiY29sb3JcIjpcIiMzZTYwNmZcIn0se1wid2VpZ2h0XCI6Mn0se1wiZ2FtbWFcIjowLjg0fV19LHtcImZlYXR1cmVUeXBlXCI6XCJhbGxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMuaWNvblwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwiYWRtaW5pc3RyYXRpdmVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJ3ZWlnaHRcIjowLjZ9LHtcImNvbG9yXCI6XCIjMTgyYTNkXCJ9LHtcInZpc2liaWxpdHlcIjpcIm9uXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcImxhbmRzY2FwZVwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjMWE1MjhiXCJ9LHtcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiM0MDZkODBcIn0se1widmlzaWJpbGl0eVwiOlwib2ZmXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInBvaS5wYXJrXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiMyYzVhNzFcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjNjZhOWVlXCJ9LHtcImxpZ2h0bmVzc1wiOi0zN30se1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LmZpbGxcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5oaWdod2F5XCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHRcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib2ZmXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQubG9jYWxcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5zdHJva2VcIixcInN0eWxlcnNcIjpbe1wibGlnaHRuZXNzXCI6XCItMTFcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5XCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjZmY3ZTRlXCJ9LHtcInZpc2liaWxpdHlcIjpcInNpbXBsaWZpZWRcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdC5zdGF0aW9uLmFpcnBvcnRcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwid2F0ZXJcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzE4MmEzZFwifV19XTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gc2V0IG1hcCBkZXBlbmRzIG9uIGRheXRpbWUgb3IgbmlnaHR0aW1lXG4gICAgICAgICAgICB2YXIgY3VycmVudFRpbWUgPSBuZXcgRGF0ZSgpOyAvLyBmb3Igbm93XG4gICAgICAgICAgICB2YXIgY3VycmVudEhvdXIgPSBjdXJyZW50VGltZS5nZXRIb3VycygpO1xuICAgICAgICAgICAgdmFyIGZlYXR1cmVPcHRzO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRIb3VyIDwgNCB8fCBjdXJyZW50SG91ciA+IDE5KXtcbiAgICAgICAgICAgICAgICBmZWF0dXJlT3B0cyA9IGZlYXR1cmVPcHRzX25pZ2h0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmZWF0dXJlT3B0cyA9IGZlYXR1cmVPcHRzX2RheTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHN0eWxlZE1hcE9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ0N1c3RvbSBTdHlsZSdcbiAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGN1c3RvbU1hcFR5cGUgPSBuZXcgZ29vZ2xlLm1hcHMuU3R5bGVkTWFwVHlwZShmZWF0dXJlT3B0cywgc3R5bGVkTWFwT3B0aW9ucyk7XG4gICAgICAgICAgICBtYXAubWFwVHlwZXMuc2V0KENMT1VEX01BUF9JRCwgY3VzdG9tTWFwVHlwZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpbml0IHRoZSBtYXBcbiAgICAgICAgZnVuY3Rpb24gaW5pdE1hcCgpIHtcbiAgICAgICAgICAgIGlmIChtYXAgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIGluaXRpYWxNYXBEYXRhKCk7XG5cbiAgICAgICAgICAgICAgICBzZXRNYW51YWxFdmVudHMoKTtcblxuICAgICAgICAgICAgICAgIHNldFN0eWxlRm9yTWFwKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGJyb2FkY2FzdCB0byBzZW5kIG1hcCB0byBhcHBsaWNhdGlvbiBjdHJsXG4gICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0Om1hcCcsIG1hcCk7XG5cbiAgICAgICAgICAgIC8vIGFkZCBVSSBlbGVtZW50cyB0byBtYXBcbiAgICAgICAgICAgIHNldFVJU2VhcmNoTG9jYXRpb25Ub2dnbGUoKTtcbiAgICAgICAgICAgIHNldFVJU2VhcmNoQm94KCk7XG4gICAgICAgICAgICBzZXRVSU1vdmVUb0N1cnJMb2NCdG4oKTtcbiAgICAgICAgICAgIHNldFVJUG9zdEZvcm0oKTtcbiAgICAgICAgICAgIHNldFVJUG9zdEJ0bigpO1xuICAgICAgICAgICAgc2V0VUlUaW1lU2xpZGVyKCk7XG5cbiAgICAgICAgICAgIC8vIGFkZCBvcmlnaW4gbmF0aXZlIEV2ZW50IGhhbmRsZXJzIHRvIG1hcFxuICAgICAgICAgICAgc2V0RXZlbnRDbGljaygpO1xuICAgICAgICAgICAgc2V0RXZlbnRDZW50ZXJDaGFuZ2VkKCk7XG4gICAgICAgICAgICBzZXRFdmVudERyYWdFbmQoKTtcbiAgICAgICAgICAgIHNldEV2ZW50UmVzaXplKCk7XG4gICAgICAgICAgICBzZXRFdmVudFpvb21DaGFuZ2VkKCk7XG4gICAgICAgICAgICBzZXRFdmVudEJvdW5kc0NoYW5nZWQoKTtcblxuICAgICAgICAgICAgLy8gdXBkYXRlIHZlcnkgZmlyc3QgdGltZSBmb3IgYXBwXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHVwZGF0ZURlZmF1bHRMb2NhdGlvbigpO1xuICAgICAgICAgICAgICAgIHVwZGF0ZUJvdW5kcygpO1xuICAgICAgICAgICAgICAgIHVwZGF0ZVdhdGNoTG9jYXRpb24oKTtcbiAgICAgICAgICAgICAgICB1cGRhdGVBbmREcmF3UG9zdHMoKTtcbiAgICAgICAgICAgIH0sIDgwMCk7XG4gICAgICAgIH0gXG5cbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gRVhFQ1VURVxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICBpbml0TWFwKCk7XG4gICAgICAgIHNjb3BlLmluaXRTZXNzaW9uKCk7IC8vIHRoaXMgaGF2ZSB0byBydW4gYWx3YXlzIGFmdGVyIHRoZSBtYXAgaXMgaW5pdGlhbGl6ZWQuXG5cbiAgICAgICAgZHJhd0hlbHBlck1hcmtlcihpbml0aWFsTWFwQ2VudGVyKTtcbiAgICAgICAgc2V0UGxhY2UoaW5pdGlhbE1hcENlbnRlcik7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgaWQ9XCJtYXAtY2FudmFzXCI+PC9kaXY+JyxcbiAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgbGluazogbGlua1xuICAgIH07XG59KTtcblxuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5kaXJlY3RpdmUoJ21hcE1zZycsIGZ1bmN0aW9uICgkdGltZW91dCwgU2Vzc2lvblN2YywgUG9zdHNTdmMpIHtcblxuICAgIHZhciBsaW5rID0gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7ICAgXG5cbiAgICAgICAgc2NvcGUuZ2V0X2xvY2Fsc3RhdHVzID0gZnVuY3Rpb24obG9jYWxfc3RhdHVzKXtcbiAgICAgICAgICBpZiAobG9jYWxfc3RhdHVzKVxuICAgICAgICAgICAgcmV0dXJuIFwibG9jYWwtdGV4dFwiO1xuICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJldHVybiBcIm5vbi1sb2NhbC10ZXh0XCI7XG4gICAgICAgIH07ICAgICBcblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBDT1VQTElORyBDTEFTU1xuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvKiBjb3VwbGluZyBzdGF0dXNcbiAgICAgICAgICAwIC0gbm8gc3RhdHVzXG4gICAgICAgICAgMSAtIGkgbGlrZSB5b3VcbiAgICAgICAgICAyIC0geW91IGxpa2UgaVxuICAgICAgICAgIDQgLSB3ZSBsaWtlIGVhY2ggb3RoZXJcbiAgICAgICAgKi9cbiAgICAgICAgc2NvcGUuZ2V0X2NvdXBsaW5nID0gZnVuY3Rpb24oY291cGxpbmdfc3RhdHVzKXtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoY291cGxpbmdfc3RhdHVzID09IDQpe1xuICAgICAgICAgICAgcmV0dXJuIFwiY291cGxpbmcgY291cGxpbmctY291cGxlXCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKGNvdXBsaW5nX3N0YXR1cyA9PSAxKXtcbiAgICAgICAgICAgIHJldHVybiBcImNvdXBsaW5nIGNvdXBsaW5nLWlsaWtleW91XCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKGNvdXBsaW5nX3N0YXR1cyA9PSAyKXtcbiAgICAgICAgICAgIHJldHVybiBcImNvdXBsaW5nIGNvdXBsaW5nLXlvdWxpa2VpXCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFwiY291cGxpbmcgY291cGxpbmctbm9uZVwiO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyBET0NVTUVOVCBSRUFEWVxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgJHRpbWVvdXQodXBkYXRlR3VpZFRhcmdldCwgMTAwKTtcblxuICAgICAgICAgICR0aW1lb3V0KHVwZGF0ZVBvc3RUaW1lciwgMTApO1xuXG4gICAgICAgICAgJHRpbWVvdXQoY3VzdG9taXplSW5mb1dpbmRvdywgMTApO1xuXG4gICAgICAgICAgJHRpbWVvdXQoY3VzdG9taXplQ2xvc2VCdG4sIDEwKTtcblxuICAgICAgICAgIC8vY29uc29sZS5sb2coXCJwb3N0IGxvY2FsIHN0YXR1czpcIiwgc2NvcGUucG9zdGxvY2Fsc3RhdHVzKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlR3VpZFRhcmdldCgpe1xuICAgICAgICAgIC8vIHVwZGF0ZSBzdGF0dXMgZm9yIGd1aWQgdGFyZ2V0XG4gICAgICAgICAgdmFyIHBvc3RndWlkICA9IHNjb3BlLnBvc3RndWlkO1xuICAgICAgICAgIHZhciBteWd1aWQgICAgPSBzY29wZS4kcGFyZW50Lmd1aWQ7XG4gICAgICAgICAgdmFyIG15Z3VpZHRndCA9IHNjb3BlLiRwYXJlbnQuZ3VpZHRndDtcblxuICAgICAgICAgIGVsZW1lbnQuY2hpbGRyZW4oKS5vbignY2xpY2snLGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgIHZhciB1cGRhdGVfZ3VpZHRndCA9IHBvc3RndWlkO1xuXG4gICAgICAgICAgICAvLyBjbGlja2luZyBteSBtZXNzYWdlIHdpbmRvd1xuICAgICAgICAgICAgLy8gaWYgaXRzIG9uIGNvdXBsaW5nLCBicmVhayBpdCFcbiAgICAgICAgICAgIGlmIChwb3N0Z3VpZCA9PSBteWd1aWQpe1xuICAgICAgICAgICAgICBpZiAoc2NvcGUuJHBhcmVudC5ndWlkdGd0ICE9ICcwJyl7XG4gICAgICAgICAgICAgICAgdXBkYXRlX2d1aWR0Z3QgPSAnMCc7IFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBjbGlraW5nIHRoZSBvbmUgdGhhdCBJIGxpa2VkXG4gICAgICAgICAgICAvLyB0byBkaXNsaWtlIHRoZSBtZXNzYWdlIHdpbmRvd1xuICAgICAgICAgICAgaWYgKHBvc3RndWlkID09IG15Z3VpZHRndCkge1xuICAgICAgICAgICAgICB1cGRhdGVfZ3VpZHRndCA9ICcwJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gcHJvcGFnYXRlIHRvIHVwcGVyIHNjb3BlIGZvciBndWlkdGd0IHVwZGF0ZVxuICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldDpndWlkdGd0JywgdXBkYXRlX2d1aWR0Z3QpOyBcblxuICAgICAgICAgICAgLy8gdXBkYXRlIHNlc3Npb24gaW5mb3JtYXRpb24gb2YgbWluZSBzbyBteSBzZXNzaW9uIHRlbGxzIG1lIHRoYXQsXG4gICAgICAgICAgICAvLyBJIGxpa2UgdGhpcyBndWlkIGF0IHRoaXMgbW9tZW50IGluIHNlcnZlciBkYlxuICAgICAgICAgICAgU2Vzc2lvblN2Yy51cGRhdGVDb3VwbGluZyhteWd1aWQsIHVwZGF0ZV9ndWlkdGd0KVxuICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihkb2Mpe1xuICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIlN1Y2Nlc3NmdWxseSB1ZHBhdGVkIGNvdXBsaW5nXCIsIGRvYyk7XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIHVwZGF0ZSBteSBwb3N0J3MgZ3VpZHRndCB0byBiZSB0aGlzIHBvc3QncyBndWlkIGluIHNlcnZlciBkYlxuICAgICAgICAgICAgLy8gdGhpcyB1cGRhdGUgaXMgZm9yIHRoZSBwZW9wbGUgd2hvIGFyZSBsb29raW5nIGF0IG15IHBvc3RzXG4gICAgICAgICAgICB2YXIgdXBkYXRlcyA9IHtcbiAgICAgICAgICAgICAgZ3VpZCAgICA6IG15Z3VpZCxcbiAgICAgICAgICAgICAgZ3VpZHRndCA6IHVwZGF0ZV9ndWlkdGd0XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgUG9zdHNTdmMudXBkYXRlR3VpZHRndCh1cGRhdGVzKVxuICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihkb2Mpe1xuICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIlN1Y2Nlc3NmdWxseSB1ZHBhdGVkIHBvc3QncyBndWlkdGd0XCIsIGRvYyk7XG4gICAgICAgICAgICAgICAgICAvLyBhZnRlciBjb3VwbGluZyB1cGRhdGUsIG1hcCBoYXMgdG8gYmUgdXBkYXRlcyBhcyB3ZWxsXG4gICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAvLyBNSUdIVCBIQVZFIFRPIENPTUUgQkFDSyBGT1IgT1BUSU1JWkFUSU9OXG4gICAgICAgICAgICAvLyB0aGlzIGhhdmUgdG8gYmUgdXBkYXRlIHRvIGJlIGNvbW11bmljYXRlZCB0aHJvdWdoIHRoZSBzZXJ2ZXJcbiAgICAgICAgICAgIGlmIChzY29wZS4kcGFyZW50Lmd1aWR0Z3QgPT0gMCl7XG4gICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdzZXQ6Y291cGxpbmcnLCAxKTsgLy8gcHJvcGFnYXRlIHRvIHVwcGVyIHNjb3BlIGZvciBjb3VwbGluZyB1cGRhdGVcbiAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KCk7IC8vIGZvcmNlIHRvIHVwZGF0ZSBET01cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3Rjb3VwbGVzdGF0dXMgPT0gMSAmJiBzY29wZS4kcGFyZW50Lmd1aWR0Z3QgIT0gMCl7XG4gICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdzZXQ6Y291cGxpbmcnLCAwKTsgLy8gcHJvcGFnYXRlIHRvIHVwcGVyIHNjb3BlIGZvciBjb3VwbGluZyB1cGRhdGVcbiAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KCk7IC8vIGZvcmNlIHRvIHVwZGF0ZSBET01cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICovXG4gICAgICAgICAgICBcblxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlUG9zdFRpbWVyKCl7XG4gICAgICAgICAgLy9jb25zb2xlLmxvZyhcIkxpZmUgJTpcIiwgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlKTtcbiAgICAgICAgICAgIHZhciBkdXJhdGlvbiA9IHNjb3BlLnBvc3RsaWZlICsgXCJtc1wiO1xuXG4gICAgICAgICAgICB2YXIgcG9zdGJhcmxpZmUgPSBlbGVtZW50LmNoaWxkcmVuKCkuY2hpbGRyZW4oXCIucG9zdGxpZmViYXJcIik7XG5cbiAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLWR1cmF0aW9uJywgZHVyYXRpb24pO1xuICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1kdXJhdGlvbicsIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1kdXJhdGlvbicsIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tZHVyYXRpb24nLCBkdXJhdGlvbik7XG4gICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1kdXJhdGlvbicsIGR1cmF0aW9uKTtcblxuICAgICAgICAgICAgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuOTUpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2EnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2EnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9hJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2EnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA8PSAwLjk1ICYmIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuOSl7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9iJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2InKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlIDw9IDAuOSAmJiBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjg1KXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2MnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9jJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9jJyk7XG4gICAgICAgICAgICAgIHBvc3RsaWZlYmFyX2NzcyA9IHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fYycpO1xuICAgICAgICAgICAgICBwb3N0bGlmZWJhcl9jc3MgPSBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9jJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPD0gMC44NSAmJiBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjc1KXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2QnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9kJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9kJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZCcpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9kJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPD0gMC43NSAmJiBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjYpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2UnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2UnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9lJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2UnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA8PSAwLjYgJiYgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC41KXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2YnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9mJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9mJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9mJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPD0gMC41ICYmIHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA+IDAuMyl7XG4gICAgICAgICAgICAgIC8qIENocm9tZSwgU2FmYXJpLCBPcGVyYSAqL1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1vLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9nJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZycpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tcy1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZycpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2cnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCdhbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1fZycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlIDw9IDAuMyAmJiBzY29wZS5wb3N0bGlmZXBlcmNlbnRhZ2UgPiAwLjIpe1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faCcpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2gnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2gnKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9oJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2gnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlLnBvc3RsaWZlcGVyY2VudGFnZSA8PSAwLjIgJiYgc2NvcGUucG9zdGxpZmVwZXJjZW50YWdlID4gMC4xKXtcbiAgICAgICAgICAgICAgLyogQ2hyb21lLCBTYWZhcmksIE9wZXJhICovXG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW8tYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2knKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbW96LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9pJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLW1zLWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9pJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnLXdlYmtpdC1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faScpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJ2FuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9pJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAvKiBDaHJvbWUsIFNhZmFyaSwgT3BlcmEgKi9cbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctby1hbmltYXRpb24tbmFtZScsICdwb3N0bGlmZWFuaW1faicpO1xuICAgICAgICAgICAgICBwb3N0YmFybGlmZS5jc3MoJy1tb3otYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2onKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2onKTtcbiAgICAgICAgICAgICAgcG9zdGJhcmxpZmUuY3NzKCctd2Via2l0LWFuaW1hdGlvbi1uYW1lJywgJ3Bvc3RsaWZlYW5pbV9qJyk7XG4gICAgICAgICAgICAgIHBvc3RiYXJsaWZlLmNzcygnYW5pbWF0aW9uLW5hbWUnLCAncG9zdGxpZmVhbmltX2onKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGN1c3RvbWl6ZUluZm9XaW5kb3coKXtcbiAgICAgICAgICAvLyBSZWZlcmVuY2UgdG8gdGhlIERJViB0aGF0IHdyYXBzIHRoZSBib3R0b20gb2YgaW5mb3dpbmRvd1xuICAgICAgICAgIHZhciBpd091dGVyID0gJCgnLmdtLXN0eWxlLWl3Jyk7XG4gICAgICAgICAgXG4gICAgICAgICAgdmFyIGl3QmFja2dyb3VuZCA9IGl3T3V0ZXIucHJldigpO1xuXG4gICAgICAgICAgLy8gUmVtb3ZlIHRoZSBiYWNrZ3JvdW5kIHNoYWRvdyBESVZcbiAgICAgICAgICAgaXdCYWNrZ3JvdW5kLmNoaWxkcmVuKCc6bnRoLWNoaWxkKDIpJykuY3NzKHsnZGlzcGxheScgOiAnbm9uZSd9KTtcblxuICAgICAgICAgICAvLyBSZW1vdmUgdGhlIHdoaXRlIGJhY2tncm91bmQgRElWXG4gICAgICAgICAgIGl3QmFja2dyb3VuZC5jaGlsZHJlbignOm50aC1jaGlsZCg0KScpLmNzcyh7J2Rpc3BsYXknIDogJ25vbmUnfSk7XG5cbiAgICAgICAgICAvLyBDaGFuZ2VzIHRoZSBkZXNpcmVkIHRhaWwgc2hhZG93IGNvbG9yLlxuICAgICAgICAgIGl3QmFja2dyb3VuZC5jaGlsZHJlbignOm50aC1jaGlsZCgzKScpLmZpbmQoJ2RpdicpLmNoaWxkcmVuKCkuY3NzKHtcbiAgICAgICAgICAgICdib3gtc2hhZG93JzogJzAgMXB4IDZweCByZ2JhKDE3OCwgMTc4LCAxNzgsIDAuNiknLCBcbiAgICAgICAgICAgICd6LWluZGV4JyA6ICcxJyxcbiAgICAgICAgICAgICdib3JkZXInOiAnMHB4J30pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY3VzdG9taXplQ2xvc2VCdG4oKXtcbiAgICAgICAgICAvLyBSZWZlcmVuY2UgdG8gdGhlIERJViB0aGF0IHdyYXBzIHRoZSBib3R0b20gb2YgaW5mb3dpbmRvd1xuICAgICAgICAgIHZhciBpd091dGVyID0gJCgnLmdtLXN0eWxlLWl3Jyk7XG5cbiAgICAgICAgICB2YXIgaXdDbG9zZUJ0biA9IGl3T3V0ZXIubmV4dCgpO1xuXG4gICAgICAgICAgLypcbiAgICAgICAgICBjb25zb2xlLmxvZyhcInBvc3Rsb2NhbCBsZWFudGg6XCIsIGl3T3V0ZXIucGFyZW50KCkuZmluZCgnI3Bvc3Rsb2NhbCcpLmxlbmd0aCk7XG4gICAgICAgICAgaWYgKHNjb3BlLnBvc3Rsb2NhbHN0YXR1cyA9PSBmYWxzZSAmJiAwID09IGl3T3V0ZXIucGFyZW50KCkuZmluZCgnI3Bvc3Rsb2NhbCcpLmxlbmd0aCl7XG4gICAgICAgICAgICBpd0Nsb3NlQnRuLmFmdGVyKFwiPGltZyBpZD0ncG9zdGxvY2FsJyBzcmM9J2h0dHA6Ly9jZG4taW1nLmVhc3lpY29uLm5ldC9wbmcvMjQvMjQ0MC5wbmcnIHdpZHRoPScyMCcsIGhlaWdodD0nMjAnLz5cIik7XG4gICAgICAgICAgfVxuICAgICAgICAgICovXG5cbiAgICAgICAgICAvLyBBcHBseSB0aGUgZGVzaXJlZCBlZmZlY3QgdG8gdGhlIGNsb3NlIGJ1dHRvblxuICAgICAgICAgIGl3Q2xvc2VCdG4uY3NzKHtcbiAgICAgICAgICAgIG9wYWNpdHk6ICcwLjgnLCAvLyBieSBkZWZhdWx0IHRoZSBjbG9zZSBidXR0b24gaGFzIGFuIG9wYWNpdHkgb2YgMC43XG4gICAgICAgICAgICByaWdodDogJzIwcHgnLCB0b3A6ICcyMHB4JywgLy8gYnV0dG9uIHJlcG9zaXRpb25pbmdcbiAgICAgICAgICB9KTsgXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJy4vdGVtcGxhdGVzL3dpbmRvdy5odG1sJyxcbiAgICAgICAgbGluazogbGlua1xuICAgIH07XG59KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=