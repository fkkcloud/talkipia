angular.module("app",["ngRoute","duScroll"]),angular.module("app").controller("ApplicationCtrl",["$rootScope","$scope","$window","$http",function(o,t,e,n){function a(){function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}t.curr_platform=navigator.platform,t.guid=a(),t.guidtgt="0",t.$on("set:guidtgt",function(o,e){console.log("setting guidtgt",e),t.guidtgt=e}),t.pageId={post:0},t.navCollapsed=!0,t.collapse=function(){t.navCollapsed=!0},t.$on("ws:new_post",function(o,e){google.maps.event.trigger(t.map,"maptypeid_changed")}),t.moveToCurrentLocation=function(){function o(o){if(t.currentPageId==t.pageId.post){var e=o.coords;window.localStorage.latitude=e.latitude,window.localStorage.longitude=e.longitude;var n=new google.maps.LatLng(e.latitude,e.longitude);google.maps.event.trigger(t.map,"heading_changed",n),t.map.panTo(n),t.map.setZoom(15)}}function e(o){console.warn("ERROR("+o.code+"): "+o.message)}navigator.geolocation.getCurrentPosition(o,e),swal({title:"",text:"Moving to current location..",timer:1500,showConfirmButton:!1})},t.$on("pagechange",function(o,e){t.currentPageId=e}),t.$on("loc",function(o,e){console.log("IN:",e);var n=e.lat(),a=e.lng();t.postLocation={lat:n,lon:a},console.log("SAVED:",t.postLocation)}),t.$on("place",function(o,e){t.$apply(function(){t.postplace=e,console.log("SAVED:",t.postplace)})}),t.$on("mapInit",function(o,e){t.map=e,google.maps.event.trigger(t.map,"center_changed")})}]),angular.module("app").config(["$routeProvider",function(o){o.when("/",{controller:"PostsCtrl",templateUrl:"/templates/posts.html"}).otherwise({redirectTo:"/"})}]),angular.module("app").service("UtilSvc",function(){var o=this;o.deg2rad=function(o){return o*(Math.PI/180)},o.getDistanceFromLatLonInKm=function(t,e,n,a){var i=6371,l=o.deg2rad(n-t),s=o.deg2rad(a-e),c=Math.sin(l/2)*Math.sin(l/2)+Math.cos(o.deg2rad(t))*Math.cos(o.deg2rad(n))*Math.sin(s/2)*Math.sin(s/2),g=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),r=i*g;return r}}),angular.module("app").directive("appMap",["PostsSvc","UtilSvc","$compile","$timeout",function(o,t,e,n){var a=function(t,a,i,l){function s(o){for(var t,e=0;t=C[e];e++)t.setMap(null);C=[];var t=new google.maps.Marker({position:o,map:b,icon:_});C.push(t)}function c(){for(var o,t=0;o=C[t];t++)o.setMap(null);C=[]}function g(o){t.$emit("loc",o);var e=new google.maps.Geocoder;e.geocode({latLng:o},function(o,e){try{t.$emit("place",o[1].formatted_address)}catch(n){console.log(n),swal("","Location does not exists"),t.$emit("place","Location does not exists")}})}function r(o){s(o),g(o)}function u(){o.fetch().success(function(o){for(var n=0;n<o.length;n++){for(var a,i=o[n],l=0;a=T[l];l++)if(i._id==a.post._id){i=null;break}if(i&&i.hasOwnProperty("location")){var s=angular.fromJson(i.location),c=new google.maps.LatLng(s.lat,s.lon),g=0,r=t.guidtgt==i.guid,u=t.guid==i.guidtgt;if(g=r&&u?4:r&&!u?1:!r&&u?2:0,c.lat()<P.lat()&&c.lat()>L.lat()&&c.lng()<L.lng()&&c.lng()>P.lng()){var p={position:c,map:b,title:"Bubble",icon:$},a=new google.maps.Marker(p);setTimeout(function(o,t){return function(){o.setMap(null);for(var e,n=0;e=T[n];n++)t._id==e.post._id&&T.splice(n,1)}}(a,i),i.lifespan),T.push({marker:a,post:i});var d=t,m=d.$new(!0),f=function(o,t,n,a){return function(){var i={pixelOffset:new google.maps.Size(-41.5,10)},l=new google.maps.InfoWindow(i),s="<div map-msg></div>",c=e(s)(t);t.msg=n.body,t.postlife=n.lifespan,t.postguid=n.guid,t.postguidtgt=n.guidtgt,t.postcouplestatus=a,console.log("coupling_status",t.postcouplestatus),l.setContent(c[0]),l.open(b,o)}}(a,m,i,g);f()}}}})}function p(){var o=document.getElementById("pac-input"),t=document.getElementById("btn-curr");b.controls[google.maps.ControlPosition.TOP_LEFT].push(o),b.controls[google.maps.ControlPosition.TOP_RIGHT].push(t);var e=new google.maps.places.SearchBox(o);google.maps.event.addListener(e,"places_changed",function(){var o=e.getPlaces();if(0!=o.length){var t=o[0];r(t.geometry.location),window.localStorage.latitude=t.geometry.location.latitude,window.localStorage.longitude=t.geometry.location.longitude,b.panTo(t.geometry.location),b.setZoom(16)}})}function d(){google.maps.event.addListener(b,"click",function(o){r(o.latLng)})}function m(){google.maps.event.addListener(b,"heading_changed",function(o){r(o)})}function f(){google.maps.event.addListener(b,"center_changed",function(){window.localStorage.latitude=b.getCenter().lat(),window.localStorage.longitude=b.getCenter().lng(),v()})}function w(){google.maps.event.addListener(b,"dragend",function(){u()})}function v(){var o=b.getBounds(),t=o.getNorthEast(),e=o.getSouthWest();P=new google.maps.LatLng(t.lat(),e.lng()),L=new google.maps.LatLng(e.lat(),t.lng())}function h(){google.maps.event.addListener(b,"maptypeid_changed",function(){c(),u()})}function S(){void 0===b&&(b=new google.maps.Map(a[0],I)),h(),t.$emit("mapInit",b),d(),p(),f(),m(),w(),u(),n(function(){v()},800)}var b,P,L,$={url:"https://catchme.ifyoucan.com/images/pictures/IYC_Icons/IYC_Location_Icon_Small.png",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(17,25)},_={url:"http://www.clker.com/cliparts/U/P/j/M/I/i/x-mark-yellow-md.png",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)},y=new google.maps.LatLng(34.05,-118.24);isNaN(window.localStorage.latitude)||isNaN(window.localStorage.longitude)||(y=new google.maps.LatLng(window.localStorage.latitude,window.localStorage.longitude)),console.log("Initial Map Center:",y),g(y);var M=!0;"iPhone"==t.curr_platform&&(M=!1);var I={center:y,zoom:15,MapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!1,streetViewControl:!1,mapTypeControl:!1,panControl:!1,zoomControl:M},C=[],T=[];S()};return{restrict:"A",template:'<div id="map-canvas"></div>',replace:!0,link:a}}]),angular.module("app").directive("mapMsg",["$timeout",function(o){return{restrict:"A",templateUrl:"./templates/window.html",link:function(t,e){var n=t.postlife+"ms",a=t.postguid,i=t.msg;t.get_coupling=function(o){return 4==o?"bubblePost bubblePost_couple":1==o?"bubblePost bubblePost_ilikeyou":2==o?"bubblePost bubblePost_youlikei":"bubblePost bubblePost_none"},angular.element(document).ready(function(){o(function(){$("div div .postlifebar").css("animation-duration",n),console.log("Jquery called :"+n+" and msg:"+i),$("div div #bubbleClick").click(function(){a==t.guid&&console.log(""),t.postcouplestatus=1,console.log("emit set:guidtgt",a),t.$emit("set:guidtgt",a)})},2)})}}}]),angular.module("app").controller("PostsCtrl",["$rootScope","$scope","PostsSvc","$window","$document",function(o,t,e,n,a){t.$emit("pagechange",t.pageId.post),t.posts=[],t.$on("ws:new_post",function(o,e){t.requestFetch()}),t.moveToLoc=function(o){var e=t.posts[o],n=angular.fromJson(e.location),i=new google.maps.LatLng(n.lat,n.lon);t.map.panTo(i),t.map.setZoom(16);var l=0,s=480;a.scrollTop(l,s).then(function(){console&&console.log("You just scrolled to the top!")})},t.addPost=function(){var o=t.postplace,n=t.postLocation,a=JSON.stringify(n);console.log("POST location:",a),console.log("POST place:",o),console.log("POST guid:",t.guid),console.log("POST guidtgt:",t.guidtgt),e.create({body:t.content,location:a,place:o,guid:t.guid,guidtgt:t.guidtgt}).success(function(o){google.maps.event.trigger(t.map,"maptypeid_changed"),t.posts.unshift(o);var e=function(){for(var e=0;e<t.posts.length;++e)o._id==t.posts[e]._id&&t.posts.splice(e,1)};setTimeout(e,o.lifespan),t.content=null}).error(function(o,t){swal("Post failed","Please complete the from correctly","error")})},t.requestFetch=function(){e.fetch().success(function(o){t.posts=o})},t.requestFetch()}]),angular.module("app").service("PostsSvc",["$http",function(o){this.fetch=function(){return o.get("/api/posts")},this.create=function(t){return o.post("/api/posts",t)},this.remove=function(t){return console.log("deleting posting"),console.log("post._id:",t._id),o.put("/api/posts",t)}}]),angular.module("app").run(["$rootScope","$timeout",function(o,t){var e,n=document.location.hostname,a="192.168.0.4";e="localhost"==n?"ws://localhost:5000":n==a?"ws://192.168.0.4:5000":"wss://frozen-badlands-8649.herokuapp.com";var i=function(){connection=new WebSocket(e),connection.onopen=function(){console.log("WebSocket connected")},connection.onclose=function(){console.log("WebSocket closed. Reconecting..."),t(i,2e3)},connection.onmessage=function(t){console.log(t);var e=JSON.parse(t.data);o.$broadcast("ws:"+e.type,e.data)}};i()}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1dGlsLnN2Yy5qcyIsIm1hcHMvbWFwLmRpcmVjdGl2ZS5qcyIsIm1hcHMvbXNnLmRpcmVjdGl2ZS5qcyIsInBvc3RzL3Bvc3RzLmN0cmwuanMiLCJwb3N0cy9wb3N0cy5zdmMuanMiLCJhcHAuanMiLCJzb2NrZXRzL3dlYnNvY2tldHMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkcm9vdFNjb3BlIiwiJHNjb3BlIiwiJHdpbmRvdyIsIiRodHRwIiwiZ3VpZCIsInM0IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHJpbmciLCJjdXJyX3BsYXRmb3JtIiwibmF2aWdhdG9yIiwicGxhdGZvcm0iLCJndWlkdGd0IiwiJG9uIiwiXyIsImNvbnNvbGUiLCJsb2ciLCJwYWdlSWQiLCJwb3N0IiwibmF2Q29sbGFwc2VkIiwiY29sbGFwc2UiLCJnb29nbGUiLCJtYXBzIiwiZXZlbnQiLCJ0cmlnZ2VyIiwibWFwIiwibW92ZVRvQ3VycmVudExvY2F0aW9uIiwiZ2V0Q3VyckxvY1N1Y2Nlc3MiLCJwb3MiLCJjdXJyZW50UGFnZUlkIiwiY3JkIiwiY29vcmRzIiwid2luZG93IiwibG9jYWxTdG9yYWdlIiwibGF0aXR1ZGUiLCJsb25naXR1ZGUiLCJnb29nbGVMb2MiLCJMYXRMbmciLCJwYW5UbyIsInNldFpvb20iLCJnZXRDdXJyTG9jRXJyb3IiLCJlcnIiLCJ3YXJuIiwiY29kZSIsIm1lc3NhZ2UiLCJnZW9sb2NhdGlvbiIsImdldEN1cnJlbnRQb3NpdGlvbiIsInN3YWwiLCJ0aXRsZSIsInRleHQiLCJ0aW1lciIsInNob3dDb25maXJtQnV0dG9uIiwibG9jYXRpb24iLCJsYXQiLCJsb24iLCJsbmciLCJwb3N0TG9jYXRpb24iLCJwbGFjZSIsIiRhcHBseSIsInBvc3RwbGFjZSIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwid2hlbiIsInRlbXBsYXRlVXJsIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsInNlcnZpY2UiLCJzdmMiLCJ0aGlzIiwiZGVnMnJhZCIsImRlZyIsIlBJIiwiZ2V0RGlzdGFuY2VGcm9tTGF0TG9uSW5LbSIsImxhdDEiLCJsb24xIiwibGF0MiIsImxvbjIiLCJSIiwiZExhdCIsImRMb24iLCJhIiwic2luIiwiY29zIiwiYyIsImF0YW4yIiwic3FydCIsImQiLCJkaXJlY3RpdmUiLCJQb3N0c1N2YyIsIlV0aWxTdmMiLCIkY29tcGlsZSIsIiR0aW1lb3V0IiwibGluayIsInNjb3BlIiwiZWxlbWVudCIsImF0dHJzIiwicm9vdFNjb3BlIiwiZHJhd0hlbHBlck1hcmtlciIsIm1hcmtlciIsImkiLCJoZWxwZXJNYXJrZXJzIiwic2V0TWFwIiwiTWFya2VyIiwicG9zaXRpb24iLCJpY29uIiwiaW1hZ2VUYXJnZXQiLCJwdXNoIiwicmVtb3ZlSGVscGVyTWFya2VyIiwic2V0UGxhY2UiLCIkZW1pdCIsImdlb2NvZGVyIiwiR2VvY29kZXIiLCJnZW9jb2RlIiwibGF0TG5nIiwicmVzdWx0cyIsInN0YXR1cyIsImZvcm1hdHRlZF9hZGRyZXNzIiwiZHJhd0FuZFNldFBsYWNlIiwidXBkYXRlTWFwIiwiZmV0Y2giLCJzdWNjZXNzIiwicG9zdHMiLCJsZW5ndGgiLCJqIiwibWFya2VycyIsIl9pZCIsImhhc093blByb3BlcnR5IiwiZnJvbUpzb24iLCJjb3VwbGluZ19zdGF0dXMiLCJpbGlrZXlvdSIsInlvdWxpa2VpIiwiY3VycmVudF9tYXBfbnciLCJjdXJyZW50X21hcF9zZSIsIm1hcmtlck9wdGlvbnMiLCJpbWFnZVBvc3QiLCJzZXRUaW1lb3V0Iiwib2xkX21hcmtlciIsIm9sZF9wb3N0IiwiayIsInNwbGljZSIsImxpZmVzcGFuIiwicGFyZW50IiwiY2hpbGQiLCIkbmV3Iiwib3BlbkluZm9XaW5kb3ciLCJjaGlsZF9zY29wZSIsImluZm9XaW5kb3dPcHRpb25zIiwicGl4ZWxPZmZzZXQiLCJTaXplIiwiaW5mb1dpbmRvdyIsIkluZm9XaW5kb3ciLCJjb250ZW50IiwiY29tcGlsZWQiLCJtc2ciLCJib2R5IiwicG9zdGxpZmUiLCJwb3N0Z3VpZCIsInBvc3RndWlkdGd0IiwicG9zdGNvdXBsZXN0YXR1cyIsInNldENvbnRlbnQiLCJvcGVuIiwic2V0U2VhcmNoQm94IiwiaW5wdXQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY3VyckxvY0J0biIsImNvbnRyb2xzIiwiQ29udHJvbFBvc2l0aW9uIiwiVE9QX0xFRlQiLCJUT1BfUklHSFQiLCJzZWFyY2hCb3giLCJwbGFjZXMiLCJTZWFyY2hCb3giLCJhZGRMaXN0ZW5lciIsImdldFBsYWNlcyIsImdlb21ldHJ5Iiwic2V0Q2xpY2tNYXAiLCJzZXRNb3ZlVG9DdXJyZW50TG9jYXRpb24iLCJzZXRDZW50ZXJDaGFuZ2VkIiwiZ2V0Q2VudGVyIiwidXBkYXRlQm91bmRzIiwic2V0TWFwRHJhZ0VuZCIsImJvdW5kcyIsImdldEJvdW5kcyIsIm5lIiwiZ2V0Tm9ydGhFYXN0Iiwic3ciLCJnZXRTb3V0aFdlc3QiLCJzZXRMb2FkUG9zdE1hcmtlcnMiLCJpbml0TWFwIiwiTWFwIiwibWFwT3B0aW9ucyIsInVybCIsInNpemUiLCJvcmlnaW4iLCJQb2ludCIsImFuY2hvciIsInNjYWxlZFNpemUiLCJpbml0aWFsTWFwQ2VudGVyIiwiaXNOYU4iLCJ6b29tQ29udHJvbEJvb2wiLCJjZW50ZXIiLCJ6b29tIiwiTWFwVHlwZUlkIiwiUk9BRE1BUCIsInNjcm9sbHdoZWVsIiwic3RyZWV0Vmlld0NvbnRyb2wiLCJtYXBUeXBlQ29udHJvbCIsInBhbkNvbnRyb2wiLCJ6b29tQ29udHJvbCIsInJlc3RyaWN0IiwidGVtcGxhdGUiLCJyZXBsYWNlIiwiZHVyYXRpb24iLCJnZXRfY291cGxpbmciLCJyZWFkeSIsIiQiLCJjc3MiLCJjbGljayIsIiRkb2N1bWVudCIsInJlcXVlc3RGZXRjaCIsIm1vdmVUb0xvYyIsImlkIiwidG9wIiwic2Nyb2xsVG9wIiwidGhlbiIsImFkZFBvc3QiLCJsb2NhdGlvbkpTT04iLCJKU09OIiwic3RyaW5naWZ5IiwiY3JlYXRlIiwidW5zaGlmdCIsImZyb250RW5kUG9zdFJlbW92ZSIsImVycm9yIiwiZGF0YSIsImdldCIsInJlbW92ZSIsInB1dCIsInJ1biIsImhvc3RuYW1lIiwiZGV2ZWxvcG1lbnRJUCIsImNvbm5lY3QiLCJjb25uZWN0aW9uIiwiV2ViU29ja2V0Iiwib25vcGVuIiwib25jbG9zZSIsIm9ubWVzc2FnZSIsImUiLCJwYXlsb2FkIiwicGFyc2UiLCIkYnJvYWRjYXN0IiwidHlwZSJdLCJtYXBwaW5ncyI6IkFBQ0FBLFFBQUFDLE9BQUEsT0FDQSxVQUNBLGFDRkFELFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxtQkFBQSxhQUFBLFNBQUEsVUFBQSxRQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBS0EsUUFBQUMsS0FDQSxRQUFBQyxLQUNBLE1BQUFDLE1BQUFDLE1BQUEsT0FBQSxFQUFBRCxLQUFBRSxXQUNBQyxTQUFBLElBQ0FDLFVBQUEsR0FFQSxNQUFBTCxLQUFBQSxJQUFBLElBQUFBLElBQUEsSUFBQUEsSUFBQSxJQUFBQSxJQUFBLElBQUFBLElBQUFBLElBQUFBLElBVEFKLEVBQUFVLGNBQUFDLFVBQUFDLFNBWUFaLEVBQUFHLEtBQUFBLElBRUFILEVBQUFhLFFBQUEsSUFFQWIsRUFBQWMsSUFBQSxjQUFBLFNBQUFDLEVBQUFGLEdBQ0FHLFFBQUFDLElBQUEsa0JBQUFKLEdBQ0FiLEVBQUFhLFFBQUFBLElBR0FiLEVBQUFrQixRQUNBQyxLQUFBLEdBR0FuQixFQUFBb0IsY0FBQSxFQUNBcEIsRUFBQXFCLFNBQUEsV0FDQXJCLEVBQUFvQixjQUFBLEdBSUFwQixFQUFBYyxJQUFBLGNBQUEsU0FBQUMsRUFBQUksR0FDQUcsT0FBQUMsS0FBQUMsTUFBQUMsUUFBQXpCLEVBQUEwQixJQUFBLHVCQUlBMUIsRUFBQTJCLHNCQUFBLFdBQ0EsUUFBQUMsR0FBQUMsR0FFQSxHQUFBN0IsRUFBQThCLGVBQUE5QixF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V0FBWSxNQUFBRixFQUFXRyxLQUFBSCxFQUFBZCxPQUluQ08iLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG5hbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuXHQnbmdSb3V0ZScsXG5cdCdkdVNjcm9sbCdcbl0pO1xuIiwiXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkN0cmwnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICR3aW5kb3csICRodHRwKXtcblx0Ly8gZ2V0IGN1cnJlbnQgcGxhdGZvcm1cblx0JHNjb3BlLmN1cnJfcGxhdGZvcm0gPSBuYXZpZ2F0b3IucGxhdGZvcm07XG5cblx0Ly8g7KeA6riI7J2AIOuCnOyImOulvCDrp4zrk6Tqs6Ag7J6I7Jy864KYIEdVSUTsnpDssrTrpbwgZ3JhYu2VtOyEnCDsk7jsiJgg7J6I64+E66GdIOuwlOq+uOuKlOqyjCDsoovsnYTrk68g7ZWY64ukLlxuXHRmdW5jdGlvbiBndWlkKCkge1xuXHRcdGZ1bmN0aW9uIHM0KCkge1xuXHRcdCAgICByZXR1cm4gTWF0aC5mbG9vcigoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMClcblx0XHQgICAgICAudG9TdHJpbmcoMTYpXG5cdFx0ICAgICAgLnN1YnN0cmluZygxKTtcblx0XHR9XG5cdCAgXHRyZXR1cm4gczQoKSArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgczQoKSArIHM0KCk7XG5cdH1cblxuXHQkc2NvcGUuZ3VpZCA9IGd1aWQoKTtcblxuXHQkc2NvcGUuZ3VpZHRndCA9IFwiMFwiOyAvLyDquLDrs7jqsJLsnYAgMOycvOuhnCDtlbTshJwgMOydtOuptCDqtIDsi6zsg4HrjIBndWlk6rCAIOyXhuuKlCDsg4Htg5zsnbTri6QuIFxuXG5cdCRzY29wZS4kb24oJ3NldDpndWlkdGd0JywgZnVuY3Rpb24oXywgZ3VpZHRndCl7XG5cdFx0Y29uc29sZS5sb2coXCJzZXR0aW5nIGd1aWR0Z3RcIiwgZ3VpZHRndCk7XG5cdFx0JHNjb3BlLmd1aWR0Z3QgPSBndWlkdGd0O1xuXHR9KTtcblxuXHQkc2NvcGUucGFnZUlkID0geyBcblx0XHRwb3N0IDogMCxcblx0fTtcblxuXHQkc2NvcGUubmF2Q29sbGFwc2VkID0gdHJ1ZTtcblx0JHNjb3BlLmNvbGxhcHNlID0gZnVuY3Rpb24oKXtcblx0XHQkc2NvcGUubmF2Q29sbGFwc2VkID0gdHJ1ZTtcblx0fTtcblxuXHQvLyBhcyBzZXJ2ZXIgc29ja2V0IHNlbmQgJ3dzOm5ld19wb3N0JyAsIHdlIGNhbiB1cGRhdGUgdGhlIG1hcCFcblx0JHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbihfLCBwb3N0KXtcblx0XHRnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKCRzY29wZS5tYXAsICdtYXB0eXBlaWRfY2hhbmdlZCcpO1xuXHR9KTtcblxuXHQvKiBtb3ZlIHRvIGN1cnJlbnQgbG9jYXRpb24gKi9cblx0JHNjb3BlLm1vdmVUb0N1cnJlbnRMb2NhdGlvbiA9IGZ1bmN0aW9uKCl7XG5cdFx0ZnVuY3Rpb24gZ2V0Q3VyckxvY1N1Y2Nlc3MocG9zKSB7XG4gICAgICAgICAgICAvKiBtYWtlIHN1cmUgdG8gY2hlY2sgd2UgYXJlIG9uIHBvc3QgcGFnZSB3aXRoIG1hcCBmaXJzdCAqL1xuICAgICAgICAgICAgaWYgKCRzY29wZS5jdXJyZW50UGFnZUlkICE9ICRzY29wZS5wYWdlSWQucG9zdClcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIHZhciBjcmQgPSBwb3MuY29vcmRzO1xuXG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gY3JkLmxhdGl0dWRlO1xuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUgPSBjcmQubG9uZ2l0dWRlO1xuXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdMYXRpdHVkZSA6ICcgKyBjcmQubGF0aXR1ZGUpO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnTG9uZ2l0dWRlOiAnICsgY3JkLmxvbmdpdHVkZSk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdNb3JlIG9yIGxlc3MgJyArIGNyZC5hY2N1cmFjeSArICcgbWV0ZXJzLicpO1xuICAgICAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoY3JkLmxhdGl0dWRlLCBjcmQubG9uZ2l0dWRlKTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcigkc2NvcGUubWFwLCAnaGVhZGluZ19jaGFuZ2VkJywgZ29vZ2xlTG9jKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJHNjb3BlLm1hcC5wYW5Ubyhnb29nbGVMb2MpXG4gICAgICAgICAgICAkc2NvcGUubWFwLnNldFpvb20oMTUpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0Q3VyckxvY0Vycm9yKGVycikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdFUlJPUignICsgZXJyLmNvZGUgKyAnKTogJyArIGVyci5tZXNzYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGluaXQgbWFwIGFuZCBwbGFjZSBzb21lIG1hcmtlcnMsIHNvIGV2ZXJ5dGhpbmcgc3RhcnQgd2l0aCB0aGlzIGZ1bmN0aW9uLiAqL1xuICAgICAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGdldEN1cnJMb2NTdWNjZXNzLCBnZXRDdXJyTG9jRXJyb3IpO1xuXG4gICAgICAgIHN3YWwoeyAgIHRpdGxlOiBcIlwiLCAgIHRleHQ6IFwiTW92aW5nIHRvIGN1cnJlbnQgbG9jYXRpb24uLlwiLCAgIHRpbWVyOiAxNTAwLCAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSB9KTtcblx0fTtcblxuXHQkc2NvcGUuJG9uKCdwYWdlY2hhbmdlJywgZnVuY3Rpb24oXywgcGFnZUlkKXtcblx0XHQkc2NvcGUuY3VycmVudFBhZ2VJZCA9IHBhZ2VJZDtcblx0fSk7XG5cblx0JHNjb3BlLiRvbignbG9jJywgZnVuY3Rpb24oXywgbG9jYXRpb24pe1xuXHRcdGNvbnNvbGUubG9nKCdJTjonLGxvY2F0aW9uKTtcblx0XHR2YXIgbGF0ID0gbG9jYXRpb24ubGF0KCk7XG5cdFx0dmFyIGxvbiA9IGxvY2F0aW9uLmxuZygpO1xuXHRcdCRzY29wZS5wb3N0TG9jYXRpb24gPSB7XG5cdFx0XHRsYXQ6IGxhdCxcblx0XHRcdGxvbjogbG9uXG5cdFx0fTtcblx0XHRjb25zb2xlLmxvZygnU0FWRUQ6JywgJHNjb3BlLnBvc3RMb2NhdGlvbik7XG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ3BsYWNlJywgZnVuY3Rpb24oXywgcGxhY2Upe1xuXHRcdC8vIEZvcmNpbmcgdGhlIHVwZGF0ZSB3aXRoICRhcHBseSgpIG1ldGhvZCBvbiAkc2NvcGVcblx0XHQvLyBwcm9ibGVtIHJlbGF0ZWQgbm90ZTogaHR0cDovL3d3dy5qZWZmcnlob3VzZXIuY29tL2luZGV4LmNmbS8yMDE0LzYvMi9Ib3ctZG8tSS1ydW4tY29kZS13aGVuLWEtdmFyaWFibGUtY2hhbmdlcy13aXRoLUFuZ3VsYXJKU1xuXHRcdCRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKXtcblx0XHRcdFx0JHNjb3BlLnBvc3RwbGFjZSA9IHBsYWNlO1xuXHRcdFx0XHRjb25zb2xlLmxvZygnU0FWRUQ6JywgJHNjb3BlLnBvc3RwbGFjZSk7XG5cdFx0XHR9XG5cdFx0KTtcblx0fSk7XG5cblx0JHNjb3BlLiRvbignbWFwSW5pdCcsIGZ1bmN0aW9uKF8sIG1hcCl7XG5cdFx0JHNjb3BlLm1hcCA9IG1hcDtcblx0XHRcblx0XHQvLyB1cGRhdGUgbWFwIGJvdW5kcyBhcyBhcHAgbGF1bmNoZXNcblx0XHRnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKCRzY29wZS5tYXAsICdjZW50ZXJfY2hhbmdlZCcpO1xuXHR9KTtcblxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29uZmlnKGZ1bmN0aW9uICgkcm91dGVQcm92aWRlcil7XG5cdCRyb3V0ZVByb3ZpZGVyXG5cdC53aGVuKCcvJywgXG5cdFx0e1xuXHRcdFx0Y29udHJvbGxlcjogJ1Bvc3RzQ3RybCcsIFxuXHRcdFx0dGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL3Bvc3RzLmh0bWwnXG5cdFx0fSlcblx0Ly8gUmVkaXJlY3QgdG8gdGhlIHJvb3QgcGFnZS5cblx0Lm90aGVyd2lzZShcblx0XHR7XG4gICBcdFx0XHRyZWRpcmVjdFRvOiAnLydcblx0XHR9KTtcbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnVXRpbFN2YycsIGZ1bmN0aW9uKCl7XG5cdHZhciBzdmMgPSB0aGlzO1xuXG5cdHN2Yy5kZWcycmFkID0gZnVuY3Rpb24oZGVnKSB7XG5cdCAgcmV0dXJuIGRlZyAqIChNYXRoLlBJLzE4MCk7XG5cdH07XG5cblx0c3ZjLmdldERpc3RhbmNlRnJvbUxhdExvbkluS20gPSBmdW5jdGlvbiAobGF0MSxsb24xLGxhdDIsbG9uMikge1xuXHQgIHZhciBSID0gNjM3MTtcblx0ICB2YXIgZExhdCA9IHN2Yy5kZWcycmFkKGxhdDItbGF0MSk7XG5cdCAgdmFyIGRMb24gPSBzdmMuZGVnMnJhZChsb24yLWxvbjEpOyBcblx0ICB2YXIgYSA9IFxuXHQgICAgTWF0aC5zaW4oZExhdC8yKSAqIE1hdGguc2luKGRMYXQvMikgK1xuXHQgICAgTWF0aC5jb3Moc3ZjLmRlZzJyYWQobGF0MSkpICogTWF0aC5jb3Moc3ZjLmRlZzJyYWQobGF0MikpICogXG5cdCAgICBNYXRoLnNpbihkTG9uLzIpICogTWF0aC5zaW4oZExvbi8yKVxuXHQgICAgOyBcblx0ICB2YXIgYyA9IDIgKiBNYXRoLmF0YW4yKE1hdGguc3FydChhKSwgTWF0aC5zcXJ0KDEtYSkpOyBcblx0ICB2YXIgZCA9IFIgKiBjO1xuXHQgIHJldHVybiBkO1xuXHR9O1xufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uZGlyZWN0aXZlKCdhcHBNYXAnLCBmdW5jdGlvbihQb3N0c1N2YywgVXRpbFN2YywgJGNvbXBpbGUsICR0aW1lb3V0KSB7XG4gICAgLy8gZGlyZWN0aXZlIGxpbmsgZnVuY3Rpb25cbiAgICB2YXIgbGluayA9IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgcm9vdFNjb3BlKSB7XG4gICAgICAgIHZhciBtYXA7XG4gICAgICAgIHZhciBjdXJyZW50X21hcF9udztcbiAgICAgICAgdmFyIGN1cnJlbnRfbWFwX3NlO1xuICAgICAgICBcbiAgICAgICAgdmFyIGltYWdlUG9zdCA9IHtcbiAgICAgICAgICAgIHVybDogJ2h0dHBzOi8vY2F0Y2htZS5pZnlvdWNhbi5jb20vaW1hZ2VzL3BpY3R1cmVzL0lZQ19JY29ucy9JWUNfTG9jYXRpb25fSWNvbl9TbWFsbC5wbmcnLFxuICAgICAgICAgICAgc2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMTAwLCAxMDApLFxuICAgICAgICAgICAgb3JpZ2luOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMCwgMCksXG4gICAgICAgICAgICBhbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludCgxNywgMzQpLFxuICAgICAgICAgICAgc2NhbGVkU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMTcsIDI1KVxuICAgICAgICB9O1xuXG4gICAgICAgICB2YXIgaW1hZ2VUYXJnZXQgPSB7XG4gICAgICAgICAgICB1cmw6ICdodHRwOi8vd3d3LmNsa2VyLmNvbS9jbGlwYXJ0cy9VL1Avai9NL0kvaS94LW1hcmsteWVsbG93LW1kLnBuZycsXG4gICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICBvcmlnaW46IG5ldyBnb29nbGUubWFwcy5Qb2ludCgwLCAwKSxcbiAgICAgICAgICAgIGFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDE3LCAzNCksXG4gICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgyNSwgMjUpXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gbWFwIGNvbmZpZ1xuICAgICAgICB2YXIgaW5pdGlhbE1hcENlbnRlciA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoMzQuMDUsIC0xMTguMjQpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFpc05hTih3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlKSAmJiAhaXNOYU4od2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUpKVxuICAgICAgICB7XG4gICAgICAgICAgICBpbml0aWFsTWFwQ2VudGVyID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyh3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlLCB3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmxvZygnSW5pdGlhbCBNYXAgQ2VudGVyOicsIGluaXRpYWxNYXBDZW50ZXIpO1xuXG4gICAgICAgIHNldFBsYWNlKGluaXRpYWxNYXBDZW50ZXIpO1xuXG4gICAgICAgIHZhciB6b29tQ29udHJvbEJvb2wgPSB0cnVlO1xuICAgICAgICBpZiAoc2NvcGUuY3Vycl9wbGF0Zm9ybSA9PSBcImlQaG9uZVwiKVxuICAgICAgICAgICAgem9vbUNvbnRyb2xCb29sID0gZmFsc2U7XG5cbiAgICAgICAgdmFyIG1hcE9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgY2VudGVyICAgICAgOiBpbml0aWFsTWFwQ2VudGVyLFxuICAgICAgICAgICAgICAgIHpvb20gICAgICAgIDogMTUsXG4gICAgICAgICAgICAgICAgTWFwVHlwZUlkICAgOiBnb29nbGUubWFwcy5NYXBUeXBlSWQuUk9BRE1BUCxcbiAgICAgICAgICAgICAgICBzY3JvbGx3aGVlbCA6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHN0cmVldFZpZXdDb250cm9sOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBtYXBUeXBlQ29udHJvbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgcGFuQ29udHJvbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgem9vbUNvbnRyb2w6IHpvb21Db250cm9sQm9vbFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAvLyBkcmF3IG1hcCB3aXRoIGhlbHBlciBtYXJrZXJzXG4gICAgICAgIHZhciBoZWxwZXJNYXJrZXJzID0gW107XG4gICAgICAgIGZ1bmN0aW9uIGRyYXdIZWxwZXJNYXJrZXIobG9jYXRpb24pe1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG1hcmtlcjsgbWFya2VyID0gaGVscGVyTWFya2Vyc1tpXTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbWFya2VyLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGhlbHBlck1hcmtlcnMgPSBbXTtcbiAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogbG9jYXRpb24sIFxuICAgICAgICAgICAgICAgIG1hcDogbWFwLFxuICAgICAgICAgICAgICAgIGljb246IGltYWdlVGFyZ2V0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGhlbHBlck1hcmtlcnMucHVzaChtYXJrZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlSGVscGVyTWFya2VyKCl7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbWFya2VyOyBtYXJrZXIgPSBoZWxwZXJNYXJrZXJzW2ldOyBpKyspIHtcbiAgICAgICAgICAgICAgICBtYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGVscGVyTWFya2VycyA9IFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0UGxhY2UobG9jYXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGJyb2FkY2FzdCBsb2NhdGlvbiBpbmZvcihsb24sbGF0KVxuICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ2xvYycsIGxvY2F0aW9uKTtcblxuICAgICAgICAgICAgdmFyIGdlb2NvZGVyID0gbmV3IGdvb2dsZS5tYXBzLkdlb2NvZGVyKCk7XG5cbiAgICAgICAgICAgIC8vIGJyb2FkY2FzdCBwbGFjZSBmb3JtYXR0ZWRfYWRkcmVzcyBhbmQgZHJhdyBpY29uXG4gICAgICAgICAgICBnZW9jb2Rlci5nZW9jb2RlKCB7ICdsYXRMbmcnOiBsb2NhdGlvbiB9LCBmdW5jdGlvbihyZXN1bHRzLCBzdGF0dXMpIHtcbiAgICAgICAgICAgICAgICAvLyBhcyB1c2VyIGNsaWNrcyBvbiB0aGUgbWFwLFxuICAgICAgICAgICAgICAgIC8vIHdlIGhhdmUgdG8gc2F2ZSB0aGUgZm9ybWF0dGVkIGFkZHJlc3MgaW4gJHNjb3BlIGFuZFxuICAgICAgICAgICAgICAgIC8vIGl0IHdpbGwgYmUgdXNlZCB0aHJvdWdoIHBvc3RzLmN0cmxcbiAgICAgICAgICAgICAgICAvLyBlbWl0IGJyb2FkY2FzZSAncGxhY2UnIGFuZCBzZW5kIHRoaXMgdG8gYXBwbGljYXRpb24uY3RybFxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGJyb2FkY2FzdCBmb3JtYXR0ZWRfYWRkcmVzc1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kZW1pdCgncGxhY2UnLCByZXN1bHRzWzFdLmZvcm1hdHRlZF9hZGRyZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoKGVycikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgICAgICAgICBzd2FsKFwiXCIsXCJMb2NhdGlvbiBkb2VzIG5vdCBleGlzdHNcIik7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdwbGFjZScsIFwiTG9jYXRpb24gZG9lcyBub3QgZXhpc3RzXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZHJhd0FuZFNldFBsYWNlKGxvY2F0aW9uKVxuICAgICAgICB7XG4gICAgICAgICAgICBkcmF3SGVscGVyTWFya2VyKGxvY2F0aW9uKTtcbiAgICAgICAgICAgIHNldFBsYWNlKGxvY2F0aW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHBsYWNlIGEgbWFya2VyIGFuZCBpbmZvV2luZG93XG4gICAgICAgIHZhciBtYXJrZXJzID0gW107XG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZU1hcCgpIHsgICBcbiAgICAgICAgICAgIFBvc3RzU3ZjLmZldGNoKClcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKHBvc3RzKXtcblxuICAgICAgICAgICAgICAgIC8vIGRyYXcgbGF0ZXN0IHVwZGF0ZVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9zdHMubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcG9zdCA9IHBvc3RzW2ldO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBtYXJrZXJzIHBvc3QgaXMgZXhpc2l0aW5nIG9uZSwgd2UgZG9uJ3Qgd2FudCB0byBkcmF3IGl0IGFnYWluLlxuICAgICAgICAgICAgICAgICAgICAvLyBvbmx5IGRyYXcgbmV3IG9uZXMhXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwLCBtYXJrZXI7IG1hcmtlciA9IG1hcmtlcnNbal07IGorKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9zdC5faWQgPT0gbWFya2VyLnBvc3QuX2lkKVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc3QgPSBudWxsOyAvLyDsnbTrr7gg6re466Ck7KeEIO2PrOyKpO2KuOudvOuptCwgbnVsbOuhnC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsgLy8g7J20IGxvb3DsnYAgcG9zdC5faWTrp4wg6rKA7IKs7Jqp7J6E7Jy866GcLCDrp4zslb0g6rK57LmY66m0IOuwlOuhnCBsb29w7J2EIOupiOy2sOuPhCDqtJzssK7ri6QuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBwb3N06rCAIOybkOuemCDsnojsl4frjZjqsoPsnbTrqbQgcG9zdOqwgCBudWxs66GcIOyFiyDrkJjsl4jsnYTqsoPsnbTqs6AsIGxvY2F0aW9u7ZSE66Gc7Y287Yuw64+EIOyeiOuKlOyngCDtmZXsnbjtlZjsnpBcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwb3N0IHx8ICFwb3N0Lmhhc093blByb3BlcnR5KCdsb2NhdGlvbicpKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7IC8vIHNraXAgdGhpcyBwb3N0IC0gbm8gbmVlZCB0byBkcmF3XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2F0aW9uID0gYW5ndWxhci5mcm9tSnNvbihwb3N0LmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobG9jYXRpb24ubGF0LCBsb2NhdGlvbi5sb24pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8qIGNvdXBsaW5nIHN0YXR1c1xuICAgICAgICAgICAgICAgICAgICAgICAgMCAtIG5vIHN0YXR1c1xuICAgICAgICAgICAgICAgICAgICAgICAgMSAtIGkgbGlrZSB5b3VcbiAgICAgICAgICAgICAgICAgICAgICAgIDIgLSB5b3UgbGlrZSBpXG4gICAgICAgICAgICAgICAgICAgICAgICA0IC0gd2UgbGlrZSBlYWNoIG90aGVyXG4gICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cgKFwic2NvcGUuZ3VpZHRndDpcIiwgc2NvcGUuZ3VpZHRndCk7XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cgKFwic2NvcGUuZ3VpZDpcIiwgc2NvcGUuZ3VpZCk7XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cgKFwicG9zdC5ndWlkdGd0OlwiLCBwb3N0Lmd1aWR0Z3QpO1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nIChcInBvc3QuZ3VpZDpcIiwgcG9zdC5ndWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY291cGxpbmdfc3RhdHVzID0gMDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlsaWtleW91ID0gc2NvcGUuZ3VpZHRndCA9PSBwb3N0Lmd1aWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciB5b3VsaWtlaSA9IHNjb3BlLmd1aWQgPT0gcG9zdC5ndWlkdGd0O1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWxpa2V5b3UgJiYgeW91bGlrZWkpIC8vIDRcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY291cGxpbmdfc3RhdHVzID0gNDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpbGlrZXlvdSAmJiAheW91bGlrZWkpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdXBsaW5nX3N0YXR1cyA9IDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoIWlsaWtleW91ICYmIHlvdWxpa2VpKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VwbGluZ19zdGF0dXMgPSAyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY291cGxpbmdfc3RhdHVzID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIOuwlOyatOuNlOumrCDslYjsl5Ag7J6I64qU7KeA67aA7YSwIOyytO2BrOulvCDtlZjsnqUgXG4gICAgICAgICAgICAgICAgICAgIGlmICghKGdvb2dsZUxvYy5sYXQoKSA8IGN1cnJlbnRfbWFwX253LmxhdCgpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIShnb29nbGVMb2MubGF0KCkgPiBjdXJyZW50X21hcF9zZS5sYXQoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEoZ29vZ2xlTG9jLmxuZygpIDwgY3VycmVudF9tYXBfc2UubG5nKCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKGdvb2dsZUxvYy5sbmcoKSA+IGN1cnJlbnRfbWFwX253LmxuZygpKSApXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOyAvLyBza2lwIHRoaXMgcG9zdCAtIG5vIG5lZWQgdG8gZHJhd1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBtYXJrZXIgb3B0aW9uIHNldHRpbmdcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlck9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogZ29vZ2xlTG9jLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJCdWJibGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGljb246IGltYWdlUG9zdFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcihtYXJrZXJPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIHNldCB1cCBzZWxmIHJlbW92ZSBmb3IgbWFya2VyIGl0c2VsZiBhbmQgZnJvbSBtYXJrZXJzIGNvbGxlY3Rpb24gYXQgZnJvbnQtZW5kXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24ob2xkX21hcmtlciwgb2xkX3Bvc3Qpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGRfbWFya2VyLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDAsIG1hcmtlcjsgbWFya2VyID0gbWFya2Vyc1trXTsgaysrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvbGRfcG9zdC5faWQgPT0gbWFya2VyLnBvc3QuX2lkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlcnMuc3BsaWNlKGssIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9KG1hcmtlciwgcG9zdCkpLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc3QubGlmZXNwYW4pO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIG1hcmtlciB0byBhcnJheSwgdGhpcyBtZWFucyB0aGF0IGl0IGhhcyBiZWVuIGRyYXduIHRvIG1hcFxuICAgICAgICAgICAgICAgICAgICBtYXJrZXJzLnB1c2goXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyOiBtYXJrZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdCAgOiBwb3N0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vIERSQVdJTkcgTUVTU0FHRSBXSU5ET1cgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9ICc8ZGl2IGlkPVwiYnViYmxlUG9zdFwiPicgKyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdC5ib2R5ICsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj48ZGl2IGlkPVwiYnViYmxlTGlmZUJhclwiPjwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgLy8g7Iqk7L2U7ZSE7JeQ7ISc67aA7YSwIOyDiOuhnOyatCDssKjsnbzrk5wg7Iqk7L2U7ZSE66W8IOunjOuTpOyWtCBlYWNoIGZvciBsb29w7JeQ7IScIOyCrOyaqe2VnOuLpC5cbiAgICAgICAgICAgICAgICAgICAgLy8gLS0+IO2VtOyVvCwg6rCBIERPTeydtCDqsIHqsIHsnZggc2NvcGXrpbwg6rCA7KC47IScIHBvc3QgbXNn6rCAIOyViCDqsrnsuZzri6QuXG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBzY29wZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkID0gcGFyZW50LiRuZXcodHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wZW5JbmZvV2luZG93ID0gKGZ1bmN0aW9uKG1hcmtlciwgY2hpbGRfc2NvcGUsIHBvc3QsIGNvdXBsaW5nX3N0YXR1cyl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBuZXcgd2luZG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZm9XaW5kb3dPcHRpb25zID0geyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGl4ZWxPZmZzZXQ6IG5ldyBnb29nbGUubWFwcy5TaXplKC00MS41LCAxMC4wKSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5mb1dpbmRvdyA9IG5ldyBnb29nbGUubWFwcy5JbmZvV2luZG93KGluZm9XaW5kb3dPcHRpb25zKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbXBpbGUgaXQgYmVmb3JlIGxvYWRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0gJzxkaXYgbWFwLW1zZz48L2Rpdj4nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb21waWxlZCA9ICRjb21waWxlKGNvbnRlbnQpKGNoaWxkX3Njb3BlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdG8gbWFrZSBkYXRhIGF2YWlsYWJsZSB0byB0ZW1wbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLm1zZyA9IHBvc3QuYm9keTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0bGlmZSA9IHBvc3QubGlmZXNwYW47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUucG9zdGd1aWQgPSBwb3N0Lmd1aWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUucG9zdGd1aWR0Z3QgPSBwb3N0Lmd1aWR0Z3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUucG9zdGNvdXBsZXN0YXR1cyA9IGNvdXBsaW5nX3N0YXR1cztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY291cGxpbmdfc3RhdHVzXCIsIGNoaWxkX3Njb3BlLnBvc3Rjb3VwbGVzdGF0dXMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2cuZGlyZWN0aXZl7JeQ7IScIO2VmOuKlCDqs7zsoJXsnYQg7Jes6riw7ISc64+EIO2VoOyImCDsnojri6QuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIoaW5mb1dpbmRvdywgJ2RvbXJlYWR5JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCdkaXYgZGl2IC5wb3N0bGlmZWJhcicpLmNzcyhcImFuaW1hdGlvbi1kdXJhdGlvblwiLCBwb3N0LmxpZmVzcGFuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSnF1ZXJ5IGNhbGxlZCA6XCIgKyAgcG9zdC5saWZlc3BhbiArIFwiIGFuZCBtc2c6XCIgKyBwb3N0LmJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJ2RpdiAjYnViYmxlUG9zdCcpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInNlbmRpbmcgJGVtaXQgLSBzZXRfZ3VpZHRndFwiLCBwb3N0Lmd1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3NldF9ndWlkdGd0JywgcG9zdC5ndWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7ICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5zZXRDb250ZW50KCBjb21waWxlZFswXSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cub3BlbihtYXAgLCBtYXJrZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSkobWFya2VyLCBjaGlsZCwgcG9zdCwgY291cGxpbmdfc3RhdHVzKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIG9wZW5JbmZvV2luZG93KCk7XG4gICAgICAgICAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRU5EIG9mIERSQVdJTkcgTUVTU0FHRSBXSU5ET1cgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgICAgICAgICAgfSAvLyBlbmQgb2YgZm9yLWxvb3BcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0U2VhcmNoQm94KClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSBzZWFyY2ggYm94IGFuZCBsaW5rIGl0IHRvIHRoZSBVSSBlbGVtZW50LlxuICAgICAgICAgICAgdmFyIGlucHV0ID0gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYWMtaW5wdXQnKSk7IC8vIEB0eXBlIHtIVE1MSW5wdXRFbGVtZW50fSAgXG4gICAgICAgICAgICB2YXIgY3VyckxvY0J0biA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuLWN1cnInKSk7ICAgICAgXG4gICAgICAgICAgICBtYXAuY29udHJvbHNbZ29vZ2xlLm1hcHMuQ29udHJvbFBvc2l0aW9uLlRPUF9MRUZUXS5wdXNoKGlucHV0KTtcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uVE9QX1JJR0hUXS5wdXNoKGN1cnJMb2NCdG4pO1xuXG4gICAgICAgICAgICB2YXIgc2VhcmNoQm94ID0gbmV3IGdvb2dsZS5tYXBzLnBsYWNlcy5TZWFyY2hCb3goKGlucHV0KSk7IC8vIEB0eXBlIHtIVE1MSW5wdXRFbGVtZW50fSBcblxuICAgICAgICAgICAgLy8gTGlzdGVuIGZvciB0aGUgZXZlbnQgZmlyZWQgd2hlbiB0aGUgdXNlciBzZWxlY3RzIGFuIGl0ZW0gZnJvbSB0aGVcbiAgICAgICAgICAgIC8vIHBpY2sgbGlzdC4gUmV0cmlldmUgdGhlIG1hdGNoaW5nIHBsYWNlcyBmb3IgdGhhdCBpdGVtLlxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIoc2VhcmNoQm94LCAncGxhY2VzX2NoYW5nZWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGxhY2VzID0gc2VhcmNoQm94LmdldFBsYWNlcygpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHBsYWNlcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIHRha2Ugb25seSAxIHNwb3RcbiAgICAgICAgICAgICAgICB2YXIgcGxhY2UgPSBwbGFjZXNbMF07XG5cbiAgICAgICAgICAgICAgICAvLyB3aGVuIHNlYXJjaCBoYXBwZW5zLCBsb2NhdGlvbiB3aWxsIGJlIHVwZGF0ZWQgYXMgd2VsbCBmb3IgcG9zdFxuICAgICAgICAgICAgICAgIC8vIHNjb3BlLiRlbWl0KCdwbGFjZScsIHBsYWNlLmZvcm1hdHRlZF9hZGRyZXNzKTtcbiAgICAgICAgICAgICAgICBkcmF3QW5kU2V0UGxhY2UocGxhY2UuZ2VvbWV0cnkubG9jYXRpb24pO1xuXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sYXRpdHVkZSA9IHBsYWNlLmdlb21ldHJ5LmxvY2F0aW9uLmxhdGl0dWRlO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlID0gcGxhY2UuZ2VvbWV0cnkubG9jYXRpb24ubG9uZ2l0dWRlO1xuXG4gICAgICAgICAgICAgICAgbWFwLnBhblRvKHBsYWNlLmdlb21ldHJ5LmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICBtYXAuc2V0Wm9vbSgxNik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldENsaWNrTWFwKClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gY2xpY2sgZXZlbnQgb24gbWFwIHRvIGRyYXcgbWFya2VyXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgZHJhd0FuZFNldFBsYWNlKGV2ZW50LmxhdExuZyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldE1vdmVUb0N1cnJlbnRMb2NhdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIG1vdmluZyB0byBhIHBvc3QncyBsb2NhdGlvbiBhbmQgZHJhdyBhIG1hcmtlciB0aGVyZVxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnaGVhZGluZ19jaGFuZ2VkJywgZnVuY3Rpb24obG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICBkcmF3QW5kU2V0UGxhY2UobG9jYXRpb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRDZW50ZXJDaGFuZ2VkKClcbiAgICAgICAge1xuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnY2VudGVyX2NoYW5nZWQnLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUgPSBtYXAuZ2V0Q2VudGVyKCkubGF0KCk7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUgPSBtYXAuZ2V0Q2VudGVyKCkubG5nKCk7XG5cbiAgICAgICAgICAgICAgICB1cGRhdGVCb3VuZHMoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRNYXBEcmFnRW5kKClcbiAgICAgICAge1xuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnZHJhZ2VuZCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgdXBkYXRlTWFwKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlQm91bmRzKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGJvdW5kcyA9IG1hcC5nZXRCb3VuZHMoKTtcbiAgICAgICAgICAgIHZhciBuZSA9IGJvdW5kcy5nZXROb3J0aEVhc3QoKTsgLy8gTGF0TG5nIG9mIHRoZSBub3J0aC1lYXN0IGNvcm5lclxuICAgICAgICAgICAgdmFyIHN3ID0gYm91bmRzLmdldFNvdXRoV2VzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIHNvdXRoLXdlc3QgY29yZGVyXG4gICAgICAgICAgICAvL1lvdSBnZXQgbm9ydGgtd2VzdCBhbmQgc291dGgtZWFzdCBjb3JuZXJzIGZyb20gdGhlIHR3byBhYm92ZTpcblxuICAgICAgICAgICAgY3VycmVudF9tYXBfbncgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKG5lLmxhdCgpLCBzdy5sbmcoKSk7XG4gICAgICAgICAgICBjdXJyZW50X21hcF9zZSA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoc3cubGF0KCksIG5lLmxuZygpKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgZnVuY3Rpb24gc2V0TG9hZFBvc3RNYXJrZXJzKClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gbWFudWFsbHkgcmVsb2FkIG1hcmtlcnMgLyBSRUZSRVNIXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICdtYXB0eXBlaWRfY2hhbmdlZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJlbW92ZUhlbHBlck1hcmtlcigpO1xuICAgICAgICAgICAgICAgIHVwZGF0ZU1hcCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpbml0IHRoZSBtYXBcbiAgICAgICAgZnVuY3Rpb24gaW5pdE1hcCgpIHtcbiAgICAgICAgICAgIGlmIChtYXAgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZWxlbWVudFswXSwgbWFwT3B0aW9ucyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNldExvYWRQb3N0TWFya2VycygpO1xuXG4gICAgICAgICAgICAvLyBicm9hZGNhc3QgdG8gc2VuZCBtYXAgdG8gYXBwbGljYXRpb24gY3RybFxuICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ21hcEluaXQnLCBtYXApO1xuXG4gICAgICAgICAgICBzZXRDbGlja01hcCgpO1xuXG4gICAgICAgICAgICBzZXRTZWFyY2hCb3goKTtcblxuICAgICAgICAgICAgc2V0Q2VudGVyQ2hhbmdlZCgpO1xuXG4gICAgICAgICAgICBzZXRNb3ZlVG9DdXJyZW50TG9jYXRpb24oKTtcblxuICAgICAgICAgICAgc2V0TWFwRHJhZ0VuZCgpO1xuXG4gICAgICAgICAgICB1cGRhdGVNYXAoKTtcblxuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICB1cGRhdGVCb3VuZHMoKTtcbiAgICAgICAgICAgIH0sIDgwMCk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSBcbiAgICAgICAgaW5pdE1hcCgpO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IGlkPVwibWFwLWNhbnZhc1wiPjwvZGl2PicsXG4gICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgIGxpbms6IGxpbmtcbiAgICB9O1xufSk7XG5cbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmRpcmVjdGl2ZSgnbWFwTXNnJywgZnVuY3Rpb24gKCR0aW1lb3V0KSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vdGVtcGxhdGVzL3dpbmRvdy5odG1sJyxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgYXR0cnMpIHsgICAgICAgIFxuICAgICAgICB2YXIgZHVyYXRpb24gPSBzY29wZS5wb3N0bGlmZSArIFwibXNcIjtcbiAgICAgICAgdmFyIHBvc3RndWlkID0gc2NvcGUucG9zdGd1aWQ7XG4gICAgICAgIHZhciBtc2cgPSBzY29wZS5tc2c7XG5cbiAgICAgICAgLyogY291cGxpbmcgc3RhdHVzXG4gICAgICAgICAgMCAtIG5vIHN0YXR1c1xuICAgICAgICAgIDEgLSBpIGxpa2UgeW91XG4gICAgICAgICAgMiAtIHlvdSBsaWtlIGlcbiAgICAgICAgICA0IC0gd2UgbGlrZSBlYWNoIG90aGVyXG4gICAgICAgICovXG4gICAgICAgIHNjb3BlLmdldF9jb3VwbGluZyA9IGZ1bmN0aW9uKGNvdXBsaW5nX3N0YXR1cyl7XG4gICAgICAgICAgaWYgKGNvdXBsaW5nX3N0YXR1cyA9PSA0KXtcbiAgICAgICAgICAgIHJldHVybiBcImJ1YmJsZVBvc3QgYnViYmxlUG9zdF9jb3VwbGVcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZiAoY291cGxpbmdfc3RhdHVzID09IDEpe1xuICAgICAgICAgICAgcmV0dXJuIFwiYnViYmxlUG9zdCBidWJibGVQb3N0X2lsaWtleW91XCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKGNvdXBsaW5nX3N0YXR1cyA9PSAyKXtcbiAgICAgICAgICAgIHJldHVybiBcImJ1YmJsZVBvc3QgYnViYmxlUG9zdF95b3VsaWtlaVwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBcImJ1YmJsZVBvc3QgYnViYmxlUG9zdF9ub25lXCI7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIGFzIHRlbXBsYXRlVXJsIERPTSBpcyBsb2FkZWQsIHRoaXMgZnVuY3Rpb24gd2lsbCBnZXQgY2FsbGVkLlxuICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAkKCdkaXYgZGl2IC5wb3N0bGlmZWJhcicpLmNzcyhcImFuaW1hdGlvbi1kdXJhdGlvblwiLCBkdXJhdGlvbik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkpxdWVyeSBjYWxsZWQgOlwiICsgIGR1cmF0aW9uICsgXCIgYW5kIG1zZzpcIiArIG1zZyk7XG5cbiAgICAgICAgICAgICQoJ2RpdiBkaXYgI2J1YmJsZUNsaWNrJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgaWYgKHBvc3RndWlkID09IHNjb3BlLmd1aWQpe1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiXCIpXG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBzY29wZS5wb3N0Y291cGxlc3RhdHVzID0gMTsgLy8gMS0gaWxpa2V5b3VcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VtaXQgc2V0Omd1aWR0Z3QnLCBwb3N0Z3VpZCk7XG4gICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdzZXQ6Z3VpZHRndCcsIHBvc3RndWlkKTtcbiAgICAgICAgICAgIH0pOyAgICBcbiAgICAgICAgICB9LCAyKTsgICAgXG4gICAgICAgIH0pO1xuICAgIH0sXG4gIH1cbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyLmNvbnRyb2xsZXIoJ1Bvc3RzQ3RybCcsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkc2NvcGUsIFBvc3RzU3ZjLCAkd2luZG93LCAkZG9jdW1lbnQpe1xyXHJcdC8qIGVtaXQgYnJvYWRjYXN0IGZvciBjdXJyZW50IHBhZ2VJZCAqL1xyXHQkc2NvcGUuJGVtaXQoJ3BhZ2VjaGFuZ2UnLCAkc2NvcGUucGFnZUlkLnBvc3QpO1xyXHJcdCRzY29wZS5wb3N0cyA9IFtdO1xyXHIvKiDqsJXslYTsp4AgR0VU65WMIO2VhOyalO2WiOyXh+ydjC5cclx0JHNjb3BlLiRvbigncmVmZXRjaCcsIGZ1bmN0aW9uKF8sIG9iail7XHJcdFx0JHNjb3BlLnJlcXVlc3RGZXRjaCgpO1xyXHR9KTtcciovXHJcdFxyXHQvKiBhcyBzZXJ2ZXIgdGVsbHMgdGhlcmUgd2FzIG5ldyBwb3N0LCBsZXRzIHJlLWxvYWQgbGlzdCBkYXRhICovXHJcdCRzY29wZS4kb24oJ3dzOm5ld19wb3N0JywgZnVuY3Rpb24oXywgcG9zdCl7XHJcdFx0JHNjb3BlLnJlcXVlc3RGZXRjaCgpO1xyXHR9KTtcclxyXHQvKiBtb3ZlIHRvIHBvc3QncyBsb2NhdGlvbiAqL1xyXHQkc2NvcGUubW92ZVRvTG9jID0gZnVuY3Rpb24oaWQpe1xyXHRcdHZhciBwb3N0ID0gKCRzY29wZS5wb3N0c1tpZF0pO1xyXHJcdFx0dmFyIGxvY2F0aW9uID0gYW5ndWxhci5mcm9tSnNvbihwb3N0LmxvY2F0aW9uKTtcclx0XHR2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsb2NhdGlvbi5sYXQsIGxvY2F0aW9uLmxvbik7XHJcclx0XHQkc2NvcGUubWFwLnBhblRvKGdvb2dsZUxvYyk7XHJcdFx0JHNjb3BlLm1hcC5zZXRab29tKDE2KTtcclxyXHRcdC8qIHVzaW5nIGFuZ3VsYXItc2Nyb2xsIHRvIG1vdmUgdG8gdGhlIHRvcCBzbW9vdGhseSAqL1xyXHRcdHZhciB0b3AgPSAwO1xyICAgIFx0dmFyIGR1cmF0aW9uID0gNDgwO1xyICAgIFx0JGRvY3VtZW50LnNjcm9sbFRvcCh0b3AsIGR1cmF0aW9uKS50aGVuKGZ1bmN0aW9uKCkge1xyICAgICBcdFx0IGNvbnNvbGUgJiYgY29uc29sZS5sb2coJ1lvdSBqdXN0IHNjcm9sbGVkIHRvIHRoZSB0b3AhJyk7XHIgICAgXHR9KTtcclxyXHR9O1xyXHJcdCRzY29wZS5hZGRQb3N0ID0gZnVuY3Rpb24oKSB7XHJcdFx0LyogZ2V0IGF1dG9jb21wbGV0ZWQgcGxhY2UgYW5kIHJlc2V0KHNldCB0byB1bmRlZmluZWQpICovXHJcdFx0dmFyIHBsYWNlID0gJHNjb3BlLnBvc3RwbGFjZTtcclx0XHR2YXIgbG9jYXRpb24gPSAkc2NvcGUucG9zdExvY2F0aW9uO1xyXHJcdFx0dmFyIGxvY2F0aW9uSlNPTiA9IEpTT04uc3RyaW5naWZ5KGxvY2F0aW9uKTtcclxyXHRcdGNvbnNvbGUubG9nKFwiUE9TVCBsb2NhdGlvbjpcIiwgbG9jYXRpb25KU09OKTtcclx0XHRjb25zb2xlLmxvZyhcIlBPU1QgcGxhY2U6XCIsIHBsYWNlKTtcclx0XHRjb25zb2xlLmxvZyhcIlBPU1QgZ3VpZDpcIiwgJHNjb3BlLmd1aWQpO1xyXHRcdGNvbnNvbGUubG9nKFwiUE9TVCBndWlkdGd0OlwiLCAkc2NvcGUuZ3VpZHRndCk7XHJcclx0XHRQb3N0c1N2Yy5jcmVhdGUoXHJcdFx0e1xyXHRcdFx0Ym9keSAgICA6ICAkc2NvcGUuY29udGVudCxcclx0XHRcdGxvY2F0aW9uOiAgbG9jYXRpb25KU09OLFxyXHRcdFx0cGxhY2UgICA6ICBwbGFjZSxcclx0XHRcdGd1aWQgICAgOiAgJHNjb3BlLmd1aWQsXHJcdFx0XHRndWlkdGd0IDogICRzY29wZS5ndWlkdGd0XHJcdFx0fSlcclx0XHQuc3VjY2VzcyhmdW5jdGlvbihwb3N0KXtcclx0XHRcdC8qIG1hbnVhbGx5IHJlbG9hZCBtYXJrZXJzIFxyXHRcdFx0dXNpbmcgbWFwdHlwZWlkIHNpbmNlIGl0cyBtb3N0IGxlYXN0IHVzZWQgZXZlbnQsIC0ga2luZCBvZiBoYWNreSB3YXkgdG8gZG8gaXRcclx0XHRcdCovXHJcdFx0XHRnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKCRzY29wZS5tYXAsICdtYXB0eXBlaWRfY2hhbmdlZCcpO1xyXHJcdFx0XHQkc2NvcGUucG9zdHMudW5zaGlmdChwb3N0KTtcclxyXHRcdFx0LyogZnJvbnQgZW5kIHNpZGUgbGlzdCBwb3N0IHJlbW92ZSAqL1xyXHRcdFx0dmFyIGZyb250RW5kUG9zdFJlbW92ZSA9IGZ1bmN0aW9uKCl7IFxyXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8ICRzY29wZS5wb3N0cy5sZW5ndGg7ICsraSl7XHJcdFx0XHRcdGlmIChwb3N0Ll9pZCA9PSAkc2NvcGUucG9zdHNbaV0uX2lkKVxyXHRcdFx0XHRcdCRzY29wZS5wb3N0cy5zcGxpY2UoaSwgMSk7XHJcdFx0XHRcdH1cclx0XHRcdH07XHJcdFx0XHRzZXRUaW1lb3V0KGZyb250RW5kUG9zdFJlbW92ZSwgcG9zdC5saWZlc3Bhbik7XHJcclx0XHRcdC8qIHJlc2V0IGlucHV0IGZvcm1zICovXHJcdFx0XHQkc2NvcGUuY29udGVudCAgPSBudWxsO1xyXHRcdH0pXHJcdFx0LmVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cyl7XHJcdFx0XHRzd2FsKFwiUG9zdCBmYWlsZWRcIiwgXCJQbGVhc2UgY29tcGxldGUgdGhlIGZyb20gY29ycmVjdGx5XCIsIFwiZXJyb3JcIik7XHJcdFx0fSk7XHJcclx0fTtcclxyXHQvKiBhcyBzZXJ2ZXIgdGVsbHMgdGhlcmUgd2FzIG5ldyBwb3N0LCBsZXRzIHJlLWxvYWQgbGlzdCBkYXRhICovXHJcdCRzY29wZS5yZXF1ZXN0RmV0Y2ggPSBmdW5jdGlvbigpIHtcclx0XHRQb3N0c1N2Yy5mZXRjaCgpXHJcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24ocG9zdHMpe1xyXHRcdFx0JHNjb3BlLnBvc3RzID0gcG9zdHM7XHJcdFx0fSk7XHJcdH07XHJcclx0JHNjb3BlLnJlcXVlc3RGZXRjaCgpO1xyfSk7XHIiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdQb3N0c1N2YycsIGZ1bmN0aW9uKCRodHRwKXtcblx0dGhpcy5mZXRjaCA9IGZ1bmN0aW9uKCl7XG5cdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS9wb3N0cycpO1xuXHR9O1xuXG5cdHRoaXMuY3JlYXRlID0gZnVuY3Rpb24ocG9zdCl7XG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcG9zdHMnLCBwb3N0KTtcblx0fTtcblxuXHR0aGlzLnJlbW92ZSA9IGZ1bmN0aW9uKHBvc3Qpe1xuXHRcdGNvbnNvbGUubG9nKFwiZGVsZXRpbmcgcG9zdGluZ1wiKTtcblx0XHRjb25zb2xlLmxvZygncG9zdC5faWQ6JywgcG9zdC5faWQpO1xuXHRcdHJldHVybiAkaHR0cC5wdXQoJy9hcGkvcG9zdHMnLCBwb3N0KTtcblx0fTtcbn0pOyIsIlxuYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcblx0J25nUm91dGUnLFxuXHQnZHVTY3JvbGwnXG5dKTtcblxuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkN0cmwnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICR3aW5kb3csICRodHRwKXtcblx0Ly8gZ2V0IGN1cnJlbnQgcGxhdGZvcm1cblx0JHNjb3BlLmN1cnJfcGxhdGZvcm0gPSBuYXZpZ2F0b3IucGxhdGZvcm07XG5cblx0Ly8g7KeA6riI7J2AIOuCnOyImOulvCDrp4zrk6Tqs6Ag7J6I7Jy864KYIEdVSUTsnpDssrTrpbwgZ3JhYu2VtOyEnCDsk7jsiJgg7J6I64+E66GdIOuwlOq+uOuKlOqyjCDsoovsnYTrk68g7ZWY64ukLlxuXHRmdW5jdGlvbiBndWlkKCkge1xuXHRcdGZ1bmN0aW9uIHM0KCkge1xuXHRcdCAgICByZXR1cm4gTWF0aC5mbG9vcigoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMClcblx0XHQgICAgICAudG9TdHJpbmcoMTYpXG5cdFx0ICAgICAgLnN1YnN0cmluZygxKTtcblx0XHR9XG5cdCAgXHRyZXR1cm4gczQoKSArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgczQoKSArIHM0KCk7XG5cdH1cblxuXHQkc2NvcGUuZ3VpZCA9IGd1aWQoKTtcblxuXHQkc2NvcGUuZ3VpZHRndCA9IFwiMFwiOyAvLyDquLDrs7jqsJLsnYAgMOycvOuhnCDtlbTshJwgMOydtOuptCDqtIDsi6zsg4HrjIBndWlk6rCAIOyXhuuKlCDsg4Htg5zsnbTri6QuIFxuXG5cdCRzY29wZS4kb24oJ3NldDpndWlkdGd0JywgZnVuY3Rpb24oXywgZ3VpZHRndCl7XG5cdFx0Y29uc29sZS5sb2coXCJzZXR0aW5nIGd1aWR0Z3RcIiwgZ3VpZHRndCk7XG5cdFx0JHNjb3BlLmd1aWR0Z3QgPSBndWlkdGd0O1xuXHR9KTtcblxuXHQkc2NvcGUucGFnZUlkID0geyBcblx0XHRwb3N0IDogMCxcblx0fTtcblxuXHQkc2NvcGUubmF2Q29sbGFwc2VkID0gdHJ1ZTtcblx0JHNjb3BlLmNvbGxhcHNlID0gZnVuY3Rpb24oKXtcblx0XHQkc2NvcGUubmF2Q29sbGFwc2VkID0gdHJ1ZTtcblx0fTtcblxuXHQvLyBhcyBzZXJ2ZXIgc29ja2V0IHNlbmQgJ3dzOm5ld19wb3N0JyAsIHdlIGNhbiB1cGRhdGUgdGhlIG1hcCFcblx0JHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbihfLCBwb3N0KXtcblx0XHRnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKCRzY29wZS5tYXAsICdtYXB0eXBlaWRfY2hhbmdlZCcpO1xuXHR9KTtcblxuXHQvKiBtb3ZlIHRvIGN1cnJlbnQgbG9jYXRpb24gKi9cblx0JHNjb3BlLm1vdmVUb0N1cnJlbnRMb2NhdGlvbiA9IGZ1bmN0aW9uKCl7XG5cdFx0ZnVuY3Rpb24gZ2V0Q3VyckxvY1N1Y2Nlc3MocG9zKSB7XG4gICAgICAgICAgICAvKiBtYWtlIHN1cmUgdG8gY2hlY2sgd2UgYXJlIG9uIHBvc3QgcGFnZSB3aXRoIG1hcCBmaXJzdCAqL1xuICAgICAgICAgICAgaWYgKCRzY29wZS5jdXJyZW50UGFnZUlkICE9ICRzY29wZS5wYWdlSWQucG9zdClcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIHZhciBjcmQgPSBwb3MuY29vcmRzO1xuXG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gY3JkLmxhdGl0dWRlO1xuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUgPSBjcmQubG9uZ2l0dWRlO1xuXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdMYXRpdHVkZSA6ICcgKyBjcmQubGF0aXR1ZGUpO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnTG9uZ2l0dWRlOiAnICsgY3JkLmxvbmdpdHVkZSk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdNb3JlIG9yIGxlc3MgJyArIGNyZC5hY2N1cmFjeSArICcgbWV0ZXJzLicpO1xuICAgICAgICAgICAgdmFyIGdvb2dsZUxvYyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoY3JkLmxhdGl0dWRlLCBjcmQubG9uZ2l0dWRlKTtcblxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcigkc2NvcGUubWFwLCAnaGVhZGluZ19jaGFuZ2VkJywgZ29vZ2xlTG9jKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJHNjb3BlLm1hcC5wYW5Ubyhnb29nbGVMb2MpXG4gICAgICAgICAgICAkc2NvcGUubWFwLnNldFpvb20oMTUpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0Q3VyckxvY0Vycm9yKGVycikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdFUlJPUignICsgZXJyLmNvZGUgKyAnKTogJyArIGVyci5tZXNzYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGluaXQgbWFwIGFuZCBwbGFjZSBzb21lIG1hcmtlcnMsIHNvIGV2ZXJ5dGhpbmcgc3RhcnQgd2l0aCB0aGlzIGZ1bmN0aW9uLiAqL1xuICAgICAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGdldEN1cnJMb2NTdWNjZXNzLCBnZXRDdXJyTG9jRXJyb3IpO1xuXG4gICAgICAgIHN3YWwoeyAgIHRpdGxlOiBcIlwiLCAgIHRleHQ6IFwiTW92aW5nIHRvIGN1cnJlbnQgbG9jYXRpb24uLlwiLCAgIHRpbWVyOiAxNTAwLCAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSB9KTtcblx0fTtcblxuXHQkc2NvcGUuJG9uKCdwYWdlY2hhbmdlJywgZnVuY3Rpb24oXywgcGFnZUlkKXtcblx0XHQkc2NvcGUuY3VycmVudFBhZ2VJZCA9IHBhZ2VJZDtcblx0fSk7XG5cblx0JHNjb3BlLiRvbignbG9jJywgZnVuY3Rpb24oXywgbG9jYXRpb24pe1xuXHRcdGNvbnNvbGUubG9nKCdJTjonLGxvY2F0aW9uKTtcblx0XHR2YXIgbGF0ID0gbG9jYXRpb24ubGF0KCk7XG5cdFx0dmFyIGxvbiA9IGxvY2F0aW9uLmxuZygpO1xuXHRcdCRzY29wZS5wb3N0TG9jYXRpb24gPSB7XG5cdFx0XHRsYXQ6IGxhdCxcblx0XHRcdGxvbjogbG9uXG5cdFx0fTtcblx0XHRjb25zb2xlLmxvZygnU0FWRUQ6JywgJHNjb3BlLnBvc3RMb2NhdGlvbik7XG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ3BsYWNlJywgZnVuY3Rpb24oXywgcGxhY2Upe1xuXHRcdC8vIEZvcmNpbmcgdGhlIHVwZGF0ZSB3aXRoICRhcHBseSgpIG1ldGhvZCBvbiAkc2NvcGVcblx0XHQvLyBwcm9ibGVtIHJlbGF0ZWQgbm90ZTogaHR0cDovL3d3dy5qZWZmcnlob3VzZXIuY29tL2luZGV4LmNmbS8yMDE0LzYvMi9Ib3ctZG8tSS1ydW4tY29kZS13aGVuLWEtdmFyaWFibGUtY2hhbmdlcy13aXRoLUFuZ3VsYXJKU1xuXHRcdCRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKXtcblx0XHRcdFx0JHNjb3BlLnBvc3RwbGFjZSA9IHBsYWNlO1xuXHRcdFx0XHRjb25zb2xlLmxvZygnU0FWRUQ6JywgJHNjb3BlLnBvc3RwbGFjZSk7XG5cdFx0XHR9XG5cdFx0KTtcblx0fSk7XG5cblx0JHNjb3BlLiRvbignbWFwSW5pdCcsIGZ1bmN0aW9uKF8sIG1hcCl7XG5cdFx0JHNjb3BlLm1hcCA9IG1hcDtcblx0XHRcblx0XHQvLyB1cGRhdGUgbWFwIGJvdW5kcyBhcyBhcHAgbGF1bmNoZXNcblx0XHRnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKCRzY29wZS5tYXAsICdjZW50ZXJfY2hhbmdlZCcpO1xuXHR9KTtcblxufSk7XG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb25maWcoZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKXtcblx0JHJvdXRlUHJvdmlkZXJcblx0LndoZW4oJy8nLCBcblx0XHR7XG5cdFx0XHRjb250cm9sbGVyOiAnUG9zdHNDdHJsJywgXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvcG9zdHMuaHRtbCdcblx0XHR9KVxuXHQvLyBSZWRpcmVjdCB0byB0aGUgcm9vdCBwYWdlLlxuXHQub3RoZXJ3aXNlKFxuXHRcdHtcbiAgIFx0XHRcdHJlZGlyZWN0VG86ICcvJ1xuXHRcdH0pO1xufSk7XG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1V0aWxTdmMnLCBmdW5jdGlvbigpe1xuXHR2YXIgc3ZjID0gdGhpcztcblxuXHRzdmMuZGVnMnJhZCA9IGZ1bmN0aW9uKGRlZykge1xuXHQgIHJldHVybiBkZWcgKiAoTWF0aC5QSS8xODApO1xuXHR9O1xuXG5cdHN2Yy5nZXREaXN0YW5jZUZyb21MYXRMb25JbkttID0gZnVuY3Rpb24gKGxhdDEsbG9uMSxsYXQyLGxvbjIpIHtcblx0ICB2YXIgUiA9IDYzNzE7XG5cdCAgdmFyIGRMYXQgPSBzdmMuZGVnMnJhZChsYXQyLWxhdDEpO1xuXHQgIHZhciBkTG9uID0gc3ZjLmRlZzJyYWQobG9uMi1sb24xKTsgXG5cdCAgdmFyIGEgPSBcblx0ICAgIE1hdGguc2luKGRMYXQvMikgKiBNYXRoLnNpbihkTGF0LzIpICtcblx0ICAgIE1hdGguY29zKHN2Yy5kZWcycmFkKGxhdDEpKSAqIE1hdGguY29zKHN2Yy5kZWcycmFkKGxhdDIpKSAqIFxuXHQgICAgTWF0aC5zaW4oZExvbi8yKSAqIE1hdGguc2luKGRMb24vMilcblx0ICAgIDsgXG5cdCAgdmFyIGMgPSAyICogTWF0aC5hdGFuMihNYXRoLnNxcnQoYSksIE1hdGguc3FydCgxLWEpKTsgXG5cdCAgdmFyIGQgPSBSICogYztcblx0ICByZXR1cm4gZDtcblx0fTtcbn0pO1xuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5kaXJlY3RpdmUoJ2FwcE1hcCcsIGZ1bmN0aW9uKFBvc3RzU3ZjLCBVdGlsU3ZjLCAkY29tcGlsZSwgJHRpbWVvdXQpIHtcbiAgICAvLyBkaXJlY3RpdmUgbGluayBmdW5jdGlvblxuICAgIHZhciBsaW5rID0gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCByb290U2NvcGUpIHtcbiAgICAgICAgdmFyIG1hcDtcbiAgICAgICAgdmFyIGN1cnJlbnRfbWFwX253O1xuICAgICAgICB2YXIgY3VycmVudF9tYXBfc2U7XG4gICAgICAgIFxuICAgICAgICB2YXIgaW1hZ2VQb3N0ID0ge1xuICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9jYXRjaG1lLmlmeW91Y2FuLmNvbS9pbWFnZXMvcGljdHVyZXMvSVlDX0ljb25zL0lZQ19Mb2NhdGlvbl9JY29uX1NtYWxsLnBuZycsXG4gICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICBvcmlnaW46IG5ldyBnb29nbGUubWFwcy5Qb2ludCgwLCAwKSxcbiAgICAgICAgICAgIGFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDE3LCAzNCksXG4gICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxNywgMjUpXG4gICAgICAgIH07XG5cbiAgICAgICAgIHZhciBpbWFnZVRhcmdldCA9IHtcbiAgICAgICAgICAgIHVybDogJ2h0dHA6Ly93d3cuY2xrZXIuY29tL2NsaXBhcnRzL1UvUC9qL00vSS9pL3gtbWFyay15ZWxsb3ctbWQucG5nJyxcbiAgICAgICAgICAgIHNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDEwMCwgMTAwKSxcbiAgICAgICAgICAgIG9yaWdpbjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDAsIDApLFxuICAgICAgICAgICAgYW5jaG9yOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMTcsIDM0KSxcbiAgICAgICAgICAgIHNjYWxlZFNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDI1LCAyNSlcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBtYXAgY29uZmlnXG4gICAgICAgIHZhciBpbml0aWFsTWFwQ2VudGVyID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZygzNC4wNSwgLTExOC4yNCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWlzTmFOKHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUpICYmICFpc05hTih3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGluaXRpYWxNYXBDZW50ZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUsIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnNvbGUubG9nKCdJbml0aWFsIE1hcCBDZW50ZXI6JywgaW5pdGlhbE1hcENlbnRlcik7XG5cbiAgICAgICAgc2V0UGxhY2UoaW5pdGlhbE1hcENlbnRlcik7XG5cbiAgICAgICAgdmFyIHpvb21Db250cm9sQm9vbCA9IHRydWU7XG4gICAgICAgIGlmIChzY29wZS5jdXJyX3BsYXRmb3JtID09IFwiaVBob25lXCIpXG4gICAgICAgICAgICB6b29tQ29udHJvbEJvb2wgPSBmYWxzZTtcblxuICAgICAgICB2YXIgbWFwT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICBjZW50ZXIgICAgICA6IGluaXRpYWxNYXBDZW50ZXIsXG4gICAgICAgICAgICAgICAgem9vbSAgICAgICAgOiAxNSxcbiAgICAgICAgICAgICAgICBNYXBUeXBlSWQgICA6IGdvb2dsZS5tYXBzLk1hcFR5cGVJZC5ST0FETUFQLFxuICAgICAgICAgICAgICAgIHNjcm9sbHdoZWVsIDogZmFsc2UsXG4gICAgICAgICAgICAgICAgc3RyZWV0Vmlld0NvbnRyb2w6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG1hcFR5cGVDb250cm9sOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBwYW5Db250cm9sOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB6b29tQ29udHJvbDogem9vbUNvbnRyb2xCb29sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgXG4gICAgICAgIC8vIGRyYXcgbWFwIHdpdGggaGVscGVyIG1hcmtlcnNcbiAgICAgICAgdmFyIGhlbHBlck1hcmtlcnMgPSBbXTtcbiAgICAgICAgZnVuY3Rpb24gZHJhd0hlbHBlck1hcmtlcihsb2NhdGlvbil7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbWFya2VyOyBtYXJrZXIgPSBoZWxwZXJNYXJrZXJzW2ldOyBpKyspIHtcbiAgICAgICAgICAgICAgICBtYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGVscGVyTWFya2VycyA9IFtdO1xuICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBsb2NhdGlvbiwgXG4gICAgICAgICAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VUYXJnZXRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaGVscGVyTWFya2Vycy5wdXNoKG1hcmtlcik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZW1vdmVIZWxwZXJNYXJrZXIoKXtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBtYXJrZXI7IG1hcmtlciA9IGhlbHBlck1hcmtlcnNbaV07IGkrKykge1xuICAgICAgICAgICAgICAgIG1hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBoZWxwZXJNYXJrZXJzID0gW107XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRQbGFjZShsb2NhdGlvbilcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gYnJvYWRjYXN0IGxvY2F0aW9uIGluZm9yKGxvbixsYXQpXG4gICAgICAgICAgICBzY29wZS4kZW1pdCgnbG9jJywgbG9jYXRpb24pO1xuXG4gICAgICAgICAgICB2YXIgZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTtcblxuICAgICAgICAgICAgLy8gYnJvYWRjYXN0IHBsYWNlIGZvcm1hdHRlZF9hZGRyZXNzIGFuZCBkcmF3IGljb25cbiAgICAgICAgICAgIGdlb2NvZGVyLmdlb2NvZGUoIHsgJ2xhdExuZyc6IGxvY2F0aW9uIH0sIGZ1bmN0aW9uKHJlc3VsdHMsIHN0YXR1cykge1xuICAgICAgICAgICAgICAgIC8vIGFzIHVzZXIgY2xpY2tzIG9uIHRoZSBtYXAsXG4gICAgICAgICAgICAgICAgLy8gd2UgaGF2ZSB0byBzYXZlIHRoZSBmb3JtYXR0ZWQgYWRkcmVzcyBpbiAkc2NvcGUgYW5kXG4gICAgICAgICAgICAgICAgLy8gaXQgd2lsbCBiZSB1c2VkIHRocm91Z2ggcG9zdHMuY3RybFxuICAgICAgICAgICAgICAgIC8vIGVtaXQgYnJvYWRjYXNlICdwbGFjZScgYW5kIHNlbmQgdGhpcyB0byBhcHBsaWNhdGlvbi5jdHJsXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYnJvYWRjYXN0IGZvcm1hdHRlZF9hZGRyZXNzXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdwbGFjZScsIHJlc3VsdHNbMV0uZm9ybWF0dGVkX2FkZHJlc3MpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2goZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgIHN3YWwoXCJcIixcIkxvY2F0aW9uIGRvZXMgbm90IGV4aXN0c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3BsYWNlJywgXCJMb2NhdGlvbiBkb2VzIG5vdCBleGlzdHNcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkcmF3QW5kU2V0UGxhY2UobG9jYXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRyYXdIZWxwZXJNYXJrZXIobG9jYXRpb24pO1xuICAgICAgICAgICAgc2V0UGxhY2UobG9jYXRpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcGxhY2UgYSBtYXJrZXIgYW5kIGluZm9XaW5kb3dcbiAgICAgICAgdmFyIG1hcmtlcnMgPSBbXTtcbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlTWFwKCkgeyAgIFxuICAgICAgICAgICAgUG9zdHNTdmMuZmV0Y2goKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocG9zdHMpe1xuXG4gICAgICAgICAgICAgICAgLy8gZHJhdyBsYXRlc3QgdXBkYXRlXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb3N0cy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwb3N0ID0gcG9zdHNbaV07XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIG1hcmtlcnMgcG9zdCBpcyBleGlzaXRpbmcgb25lLCB3ZSBkb24ndCB3YW50IHRvIGRyYXcgaXQgYWdhaW4uXG4gICAgICAgICAgICAgICAgICAgIC8vIG9ubHkgZHJhdyBuZXcgb25lcyFcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIG1hcmtlcjsgbWFya2VyID0gbWFya2Vyc1tqXTsgaisrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb3N0Ll9pZCA9PSBtYXJrZXIucG9zdC5faWQpXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdCA9IG51bGw7IC8vIOydtOuvuCDqt7jroKTsp4Qg7Y+s7Iqk7Yq4652866m0LCBudWxs66GcLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOyAvLyDsnbQgbG9vcOydgCBwb3N0Ll9pZOunjCDqsoDsgqzsmqnsnoTsnLzroZwsIOunjOyVvSDqsrnsuZjrqbQg67CU66GcIGxvb3DsnYQg66mI7Law64+EIOq0nOywruuLpC5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIHBvc3TqsIAg7JuQ656YIOyeiOyXh+uNmOqyg+ydtOuptCBwb3N06rCAIG51bGzroZwg7IWLIOuQmOyXiOydhOqyg+ydtOqzoCwgbG9jYXRpb27tlITroZztjbzti7Drj4Qg7J6I64qU7KeAIO2ZleyduO2VmOyekFxuICAgICAgICAgICAgICAgICAgICBpZiAoIXBvc3QgfHwgIXBvc3QuaGFzT3duUHJvcGVydHkoJ2xvY2F0aW9uJykpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsgLy8gc2tpcCB0aGlzIHBvc3QgLSBubyBuZWVkIHRvIGRyYXdcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb24gPSBhbmd1bGFyLmZyb21Kc29uKHBvc3QubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsb2NhdGlvbi5sYXQsIGxvY2F0aW9uLmxvbik7XG5cbiAgICAgICAgICAgICAgICAgICAgLyogY291cGxpbmcgc3RhdHVzXG4gICAgICAgICAgICAgICAgICAgICAgICAwIC0gbm8gc3RhdHVzXG4gICAgICAgICAgICAgICAgICAgICAgICAxIC0gaSBsaWtlIHlvdVxuICAgICAgICAgICAgICAgICAgICAgICAgMiAtIHlvdSBsaWtlIGlcbiAgICAgICAgICAgICAgICAgICAgICAgIDQgLSB3ZSBsaWtlIGVhY2ggb3RoZXJcbiAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyAoXCJzY29wZS5ndWlkdGd0OlwiLCBzY29wZS5ndWlkdGd0KTtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyAoXCJzY29wZS5ndWlkOlwiLCBzY29wZS5ndWlkKTtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyAoXCJwb3N0Lmd1aWR0Z3Q6XCIsIHBvc3QuZ3VpZHRndCk7XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cgKFwicG9zdC5ndWlkOlwiLCBwb3N0Lmd1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb3VwbGluZ19zdGF0dXMgPSAwO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaWxpa2V5b3UgPSBzY29wZS5ndWlkdGd0ID09IHBvc3QuZ3VpZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHlvdWxpa2VpID0gc2NvcGUuZ3VpZCA9PSBwb3N0Lmd1aWR0Z3Q7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbGlrZXlvdSAmJiB5b3VsaWtlaSkgLy8gNFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VwbGluZ19zdGF0dXMgPSA0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGlsaWtleW91ICYmICF5b3VsaWtlaSlcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY291cGxpbmdfc3RhdHVzID0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICghaWxpa2V5b3UgJiYgeW91bGlrZWkpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdXBsaW5nX3N0YXR1cyA9IDI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VwbGluZ19zdGF0dXMgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8g67CU7Jq0642U66asIOyViOyXkCDsnojripTsp4DrtoDthLAg7LK07YGs66W8IO2VmOyepSBcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoZ29vZ2xlTG9jLmxhdCgpIDwgY3VycmVudF9tYXBfbncubGF0KCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAhKGdvb2dsZUxvYy5sYXQoKSA+IGN1cnJlbnRfbWFwX3NlLmxhdCgpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIShnb29nbGVMb2MubG5nKCkgPCBjdXJyZW50X21hcF9zZS5sbmcoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICEoZ29vZ2xlTG9jLmxuZygpID4gY3VycmVudF9tYXBfbncubG5nKCkpIClcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7IC8vIHNraXAgdGhpcyBwb3N0IC0gbm8gbmVlZCB0byBkcmF3XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIG1hcmtlciBvcHRpb24gc2V0dGluZ1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBnb29nbGVMb2MsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXA6IG1hcCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIkJ1YmJsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VQb3N0XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKG1hcmtlck9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gc2V0IHVwIHNlbGYgcmVtb3ZlIGZvciBtYXJrZXIgaXRzZWxmIGFuZCBmcm9tIG1hcmtlcnMgY29sbGVjdGlvbiBhdCBmcm9udC1lbmRcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChcbiAgICAgICAgICAgICAgICAgICAgICAgIChmdW5jdGlvbihvbGRfbWFya2VyLCBvbGRfcG9zdCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZF9tYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMCwgbWFya2VyOyBtYXJrZXIgPSBtYXJrZXJzW2tdOyBrKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9sZF9wb3N0Ll9pZCA9PSBtYXJrZXIucG9zdC5faWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2Vycy5zcGxpY2UoaywgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0obWFya2VyLCBwb3N0KSksIFxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zdC5saWZlc3Bhbik7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBhZGQgbWFya2VyIHRvIGFycmF5LCB0aGlzIG1lYW5zIHRoYXQgaXQgaGFzIGJlZW4gZHJhd24gdG8gbWFwXG4gICAgICAgICAgICAgICAgICAgIG1hcmtlcnMucHVzaChcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXI6IG1hcmtlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0ICA6IHBvc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRFJBV0lORyBNRVNTQUdFIFdJTkRPVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gJzxkaXYgaWQ9XCJidWJibGVQb3N0XCI+JyArIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0LmJvZHkgKyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvZGl2PjxkaXYgaWQ9XCJidWJibGVMaWZlQmFyXCI+PC9kaXY+JztcbiAgICAgICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgICAgICAvLyDsiqTsvZTtlITsl5DshJzrtoDthLAg7IOI66Gc7Jq0IOywqOydvOuTnCDsiqTsvZTtlITrpbwg66eM65Ok7Ja0IGVhY2ggZm9yIGxvb3Dsl5DshJwg7IKs7Jqp7ZWc64ukLlxuICAgICAgICAgICAgICAgICAgICAvLyAtLT4g7ZW07JW8LCDqsIEgRE9N7J20IOqwgeqwgeydmCBzY29wZeulvCDqsIDsoLjshJwgcG9zdCBtc2fqsIAg7JWIIOqyuey5nOuLpC5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHNjb3BlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSBwYXJlbnQuJG5ldyh0cnVlKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgb3BlbkluZm9XaW5kb3cgPSAoZnVuY3Rpb24obWFya2VyLCBjaGlsZF9zY29wZSwgcG9zdCwgY291cGxpbmdfc3RhdHVzKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY3JlYXRlIG5ldyB3aW5kb3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5mb1dpbmRvd09wdGlvbnMgPSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaXhlbE9mZnNldDogbmV3IGdvb2dsZS5tYXBzLlNpemUoLTQxLjUsIDEwLjApLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmZvV2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coaW5mb1dpbmRvd09wdGlvbnMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29tcGlsZSBpdCBiZWZvcmUgbG9hZGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSAnPGRpdiBtYXAtbXNnPjwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXBpbGVkID0gJGNvbXBpbGUoY29udGVudCkoY2hpbGRfc2NvcGUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy90byBtYWtlIGRhdGEgYXZhaWxhYmxlIHRvIHRlbXBsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfc2NvcGUubXNnID0gcG9zdC5ib2R5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX3Njb3BlLnBvc3RsaWZlID0gcG9zdC5saWZlc3BhbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Z3VpZCA9IHBvc3QuZ3VpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Z3VpZHRndCA9IHBvc3QuZ3VpZHRndDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZS5wb3N0Y291cGxlc3RhdHVzID0gY291cGxpbmdfc3RhdHVzO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjb3VwbGluZ19zdGF0dXNcIiwgY2hpbGRfc2NvcGUucG9zdGNvdXBsZXN0YXR1cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZy5kaXJlY3RpdmXsl5DshJwg7ZWY64qUIOqzvOygleydhCDsl6zquLDshJzrj4Qg7ZWg7IiYIOyeiOuLpC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihpbmZvV2luZG93LCAnZG9tcmVhZHknLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJ2RpdiBkaXYgLnBvc3RsaWZlYmFyJykuY3NzKFwiYW5pbWF0aW9uLWR1cmF0aW9uXCIsIHBvc3QubGlmZXNwYW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJKcXVlcnkgY2FsbGVkIDpcIiArICBwb3N0LmxpZmVzcGFuICsgXCIgYW5kIG1zZzpcIiArIHBvc3QuYm9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnZGl2ICNidWJibGVQb3N0JykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic2VuZGluZyAkZW1pdCAtIHNldF9ndWlkdGd0XCIsIHBvc3QuZ3VpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0X2d1aWR0Z3QnLCBwb3N0Lmd1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93LnNldENvbnRlbnQoIGNvbXBpbGVkWzBdICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5vcGVuKG1hcCAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9KShtYXJrZXIsIGNoaWxkLCBwb3N0LCBjb3VwbGluZ19zdGF0dXMpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgb3BlbkluZm9XaW5kb3coKTtcbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBFTkQgb2YgRFJBV0lORyBNRVNTQUdFIFdJTkRPVyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgICAgICAgICB9IC8vIGVuZCBvZiBmb3ItbG9vcFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRTZWFyY2hCb3goKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgdGhlIHNlYXJjaCBib3ggYW5kIGxpbmsgaXQgdG8gdGhlIFVJIGVsZW1lbnQuXG4gICAgICAgICAgICB2YXIgaW5wdXQgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhYy1pbnB1dCcpKTsgLy8gQHR5cGUge0hUTUxJbnB1dEVsZW1lbnR9ICBcbiAgICAgICAgICAgIHZhciBjdXJyTG9jQnRuID0gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4tY3VycicpKTsgICAgICBcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uVE9QX0xFRlRdLnB1c2goaW5wdXQpO1xuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5UT1BfUklHSFRdLnB1c2goY3VyckxvY0J0bik7XG5cbiAgICAgICAgICAgIHZhciBzZWFyY2hCb3ggPSBuZXcgZ29vZ2xlLm1hcHMucGxhY2VzLlNlYXJjaEJveCgoaW5wdXQpKTsgLy8gQHR5cGUge0hUTUxJbnB1dEVsZW1lbnR9IFxuXG4gICAgICAgICAgICAvLyBMaXN0ZW4gZm9yIHRoZSBldmVudCBmaXJlZCB3aGVuIHRoZSB1c2VyIHNlbGVjdHMgYW4gaXRlbSBmcm9tIHRoZVxuICAgICAgICAgICAgLy8gcGljayBsaXN0LiBSZXRyaWV2ZSB0aGUgbWF0Y2hpbmcgcGxhY2VzIGZvciB0aGF0IGl0ZW0uXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihzZWFyY2hCb3gsICdwbGFjZXNfY2hhbmdlZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBwbGFjZXMgPSBzZWFyY2hCb3guZ2V0UGxhY2VzKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAocGxhY2VzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gdGFrZSBvbmx5IDEgc3BvdFxuICAgICAgICAgICAgICAgIHZhciBwbGFjZSA9IHBsYWNlc1swXTtcblxuICAgICAgICAgICAgICAgIC8vIHdoZW4gc2VhcmNoIGhhcHBlbnMsIGxvY2F0aW9uIHdpbGwgYmUgdXBkYXRlZCBhcyB3ZWxsIGZvciBwb3N0XG4gICAgICAgICAgICAgICAgLy8gc2NvcGUuJGVtaXQoJ3BsYWNlJywgcGxhY2UuZm9ybWF0dGVkX2FkZHJlc3MpO1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbik7XG5cbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gcGxhY2UuZ2VvbWV0cnkubG9jYXRpb24ubGF0aXR1ZGU7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUgPSBwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sb25naXR1ZGU7XG5cbiAgICAgICAgICAgICAgICBtYXAucGFuVG8ocGxhY2UuZ2VvbWV0cnkubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgIG1hcC5zZXRab29tKDE2KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0Q2xpY2tNYXAoKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBjbGljayBldmVudCBvbiBtYXAgdG8gZHJhdyBtYXJrZXJcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBkcmF3QW5kU2V0UGxhY2UoZXZlbnQubGF0TG5nKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0TW92ZVRvQ3VycmVudExvY2F0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gbW92aW5nIHRvIGEgcG9zdCdzIGxvY2F0aW9uIGFuZCBkcmF3IGEgbWFya2VyIHRoZXJlXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICdoZWFkaW5nX2NoYW5nZWQnLCBmdW5jdGlvbihsb2NhdGlvbikge1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShsb2NhdGlvbik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldENlbnRlckNoYW5nZWQoKVxuICAgICAgICB7XG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICdjZW50ZXJfY2hhbmdlZCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sYXRpdHVkZSA9IG1hcC5nZXRDZW50ZXIoKS5sYXQoKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSA9IG1hcC5nZXRDZW50ZXIoKS5sbmcoKTtcblxuICAgICAgICAgICAgICAgIHVwZGF0ZUJvdW5kcygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldE1hcERyYWdFbmQoKVxuICAgICAgICB7XG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICdkcmFnZW5kJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICB1cGRhdGVNYXAoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVCb3VuZHMoKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgYm91bmRzID0gbWFwLmdldEJvdW5kcygpO1xuICAgICAgICAgICAgdmFyIG5lID0gYm91bmRzLmdldE5vcnRoRWFzdCgpOyAvLyBMYXRMbmcgb2YgdGhlIG5vcnRoLWVhc3QgY29ybmVyXG4gICAgICAgICAgICB2YXIgc3cgPSBib3VuZHMuZ2V0U291dGhXZXN0KCk7IC8vIExhdExuZyBvZiB0aGUgc291dGgtd2VzdCBjb3JkZXJcbiAgICAgICAgICAgIC8vWW91IGdldCBub3J0aC13ZXN0IGFuZCBzb3V0aC1lYXN0IGNvcm5lcnMgZnJvbSB0aGUgdHdvIGFib3ZlOlxuXG4gICAgICAgICAgICBjdXJyZW50X21hcF9udyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobmUubGF0KCksIHN3LmxuZygpKTtcbiAgICAgICAgICAgIGN1cnJlbnRfbWFwX3NlID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhzdy5sYXQoKSwgbmUubG5nKCkpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBmdW5jdGlvbiBzZXRMb2FkUG9zdE1hcmtlcnMoKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBtYW51YWxseSByZWxvYWQgbWFya2VycyAvIFJFRlJFU0hcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ21hcHR5cGVpZF9jaGFuZ2VkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlSGVscGVyTWFya2VyKCk7XG4gICAgICAgICAgICAgICAgdXBkYXRlTWFwKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGluaXQgdGhlIG1hcFxuICAgICAgICBmdW5jdGlvbiBpbml0TWFwKCkge1xuICAgICAgICAgICAgaWYgKG1hcCA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICAgICAgbWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChlbGVtZW50WzBdLCBtYXBPcHRpb25zKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc2V0TG9hZFBvc3RNYXJrZXJzKCk7XG5cbiAgICAgICAgICAgIC8vIGJyb2FkY2FzdCB0byBzZW5kIG1hcCB0byBhcHBsaWNhdGlvbiBjdHJsXG4gICAgICAgICAgICBzY29wZS4kZW1pdCgnbWFwSW5pdCcsIG1hcCk7XG5cbiAgICAgICAgICAgIHNldENsaWNrTWFwKCk7XG5cbiAgICAgICAgICAgIHNldFNlYXJjaEJveCgpO1xuXG4gICAgICAgICAgICBzZXRDZW50ZXJDaGFuZ2VkKCk7XG5cbiAgICAgICAgICAgIHNldE1vdmVUb0N1cnJlbnRMb2NhdGlvbigpO1xuXG4gICAgICAgICAgICBzZXRNYXBEcmFnRW5kKCk7XG5cbiAgICAgICAgICAgIHVwZGF0ZU1hcCgpO1xuXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHVwZGF0ZUJvdW5kcygpO1xuICAgICAgICAgICAgfSwgODAwKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9IFxuICAgICAgICBpbml0TWFwKCk7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgaWQ9XCJtYXAtY2FudmFzXCI+PC9kaXY+JyxcbiAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgbGluazogbGlua1xuICAgIH07XG59KTtcblxuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5kaXJlY3RpdmUoJ21hcE1zZycsIGZ1bmN0aW9uICgkdGltZW91dCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgdGVtcGxhdGVVcmw6ICcuL3RlbXBsYXRlcy93aW5kb3cuaHRtbCcsXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGF0dHJzKSB7ICAgICAgICBcbiAgICAgICAgdmFyIGR1cmF0aW9uID0gc2NvcGUucG9zdGxpZmUgKyBcIm1zXCI7XG4gICAgICAgIHZhciBwb3N0Z3VpZCA9IHNjb3BlLnBvc3RndWlkO1xuICAgICAgICB2YXIgbXNnID0gc2NvcGUubXNnO1xuXG4gICAgICAgIC8qIGNvdXBsaW5nIHN0YXR1c1xuICAgICAgICAgIDAgLSBubyBzdGF0dXNcbiAgICAgICAgICAxIC0gaSBsaWtlIHlvdVxuICAgICAgICAgIDIgLSB5b3UgbGlrZSBpXG4gICAgICAgICAgNCAtIHdlIGxpa2UgZWFjaCBvdGhlclxuICAgICAgICAqL1xuICAgICAgICBzY29wZS5nZXRfY291cGxpbmcgPSBmdW5jdGlvbihjb3VwbGluZ19zdGF0dXMpe1xuICAgICAgICAgIGlmIChjb3VwbGluZ19zdGF0dXMgPT0gNCl7XG4gICAgICAgICAgICByZXR1cm4gXCJidWJibGVQb3N0IGJ1YmJsZVBvc3RfY291cGxlXCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKGNvdXBsaW5nX3N0YXR1cyA9PSAxKXtcbiAgICAgICAgICAgIHJldHVybiBcImJ1YmJsZVBvc3QgYnViYmxlUG9zdF9pbGlrZXlvdVwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmIChjb3VwbGluZ19zdGF0dXMgPT0gMil7XG4gICAgICAgICAgICByZXR1cm4gXCJidWJibGVQb3N0IGJ1YmJsZVBvc3RfeW91bGlrZWlcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gXCJidWJibGVQb3N0IGJ1YmJsZVBvc3Rfbm9uZVwiO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBhcyB0ZW1wbGF0ZVVybCBET00gaXMgbG9hZGVkLCB0aGlzIGZ1bmN0aW9uIHdpbGwgZ2V0IGNhbGxlZC5cbiAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcbiAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgJCgnZGl2IGRpdiAucG9zdGxpZmViYXInKS5jc3MoXCJhbmltYXRpb24tZHVyYXRpb25cIiwgZHVyYXRpb24pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJKcXVlcnkgY2FsbGVkIDpcIiArICBkdXJhdGlvbiArIFwiIGFuZCBtc2c6XCIgKyBtc2cpO1xuXG4gICAgICAgICAgICAkKCdkaXYgZGl2ICNidWJibGVDbGljaycpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgIGlmIChwb3N0Z3VpZCA9PSBzY29wZS5ndWlkKXtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlwiKVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgc2NvcGUucG9zdGNvdXBsZXN0YXR1cyA9IDE7IC8vIDEtIGlsaWtleW91XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlbWl0IHNldDpndWlkdGd0JywgcG9zdGd1aWQpO1xuICAgICAgICAgICAgICBzY29wZS4kZW1pdCgnc2V0Omd1aWR0Z3QnLCBwb3N0Z3VpZCk7XG4gICAgICAgICAgICB9KTsgICAgXG4gICAgICAgICAgfSwgMik7ICAgIFxuICAgICAgICB9KTtcbiAgICB9LFxuICB9XG59KTtcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyLmNvbnRyb2xsZXIoJ1Bvc3RzQ3RybCcsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkc2NvcGUsIFBvc3RzU3ZjLCAkd2luZG93LCAkZG9jdW1lbnQpe1xyXHJcdC8qIGVtaXQgYnJvYWRjYXN0IGZvciBjdXJyZW50IHBhZ2VJZCAqL1xyXHQkc2NvcGUuJGVtaXQoJ3BhZ2VjaGFuZ2UnLCAkc2NvcGUucGFnZUlkLnBvc3QpO1xyXHJcdCRzY29wZS5wb3N0cyA9IFtdO1xyXHIvKiDqsJXslYTsp4AgR0VU65WMIO2VhOyalO2WiOyXh+ydjC5cclx0JHNjb3BlLiRvbigncmVmZXRjaCcsIGZ1bmN0aW9uKF8sIG9iail7XHJcdFx0JHNjb3BlLnJlcXVlc3RGZXRjaCgpO1xyXHR9KTtcciovXHJcdFxyXHQvKiBhcyBzZXJ2ZXIgdGVsbHMgdGhlcmUgd2FzIG5ldyBwb3N0LCBsZXRzIHJlLWxvYWQgbGlzdCBkYXRhICovXHJcdCRzY29wZS4kb24oJ3dzOm5ld19wb3N0JywgZnVuY3Rpb24oXywgcG9zdCl7XHJcdFx0JHNjb3BlLnJlcXVlc3RGZXRjaCgpO1xyXHR9KTtcclxyXHQvKiBtb3ZlIHRvIHBvc3QncyBsb2NhdGlvbiAqL1xyXHQkc2NvcGUubW92ZVRvTG9jID0gZnVuY3Rpb24oaWQpe1xyXHRcdHZhciBwb3N0ID0gKCRzY29wZS5wb3N0c1tpZF0pO1xyXHJcdFx0dmFyIGxvY2F0aW9uID0gYW5ndWxhci5mcm9tSnNvbihwb3N0LmxvY2F0aW9uKTtcclx0XHR2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsb2NhdGlvbi5sYXQsIGxvY2F0aW9uLmxvbik7XHJcclx0XHQkc2NvcGUubWFwLnBhblRvKGdvb2dsZUxvYyk7XHJcdFx0JHNjb3BlLm1hcC5zZXRab29tKDE2KTtcclxyXHRcdC8qIHVzaW5nIGFuZ3VsYXItc2Nyb2xsIHRvIG1vdmUgdG8gdGhlIHRvcCBzbW9vdGhseSAqL1xyXHRcdHZhciB0b3AgPSAwO1xyICAgIFx0dmFyIGR1cmF0aW9uID0gNDgwO1xyICAgIFx0JGRvY3VtZW50LnNjcm9sbFRvcCh0b3AsIGR1cmF0aW9uKS50aGVuKGZ1bmN0aW9uKCkge1xyICAgICBcdFx0IGNvbnNvbGUgJiYgY29uc29sZS5sb2coJ1lvdSBqdXN0IHNjcm9sbGVkIHRvIHRoZSB0b3AhJyk7XHIgICAgXHR9KTtcclxyXHR9O1xyXHJcdCRzY29wZS5hZGRQb3N0ID0gZnVuY3Rpb24oKSB7XHJcdFx0LyogZ2V0IGF1dG9jb21wbGV0ZWQgcGxhY2UgYW5kIHJlc2V0KHNldCB0byB1bmRlZmluZWQpICovXHJcdFx0dmFyIHBsYWNlID0gJHNjb3BlLnBvc3RwbGFjZTtcclx0XHR2YXIgbG9jYXRpb24gPSAkc2NvcGUucG9zdExvY2F0aW9uO1xyXHJcdFx0dmFyIGxvY2F0aW9uSlNPTiA9IEpTT04uc3RyaW5naWZ5KGxvY2F0aW9uKTtcclxyXHRcdGNvbnNvbGUubG9nKFwiUE9TVCBsb2NhdGlvbjpcIiwgbG9jYXRpb25KU09OKTtcclx0XHRjb25zb2xlLmxvZyhcIlBPU1QgcGxhY2U6XCIsIHBsYWNlKTtcclx0XHRjb25zb2xlLmxvZyhcIlBPU1QgZ3VpZDpcIiwgJHNjb3BlLmd1aWQpO1xyXHRcdGNvbnNvbGUubG9nKFwiUE9TVCBndWlkdGd0OlwiLCAkc2NvcGUuZ3VpZHRndCk7XHJcclx0XHRQb3N0c1N2Yy5jcmVhdGUoXHJcdFx0e1xyXHRcdFx0Ym9keSAgICA6ICAkc2NvcGUuY29udGVudCxcclx0XHRcdGxvY2F0aW9uOiAgbG9jYXRpb25KU09OLFxyXHRcdFx0cGxhY2UgICA6ICBwbGFjZSxcclx0XHRcdGd1aWQgICAgOiAgJHNjb3BlLmd1aWQsXHJcdFx0XHRndWlkdGd0IDogICRzY29wZS5ndWlkdGd0XHJcdFx0fSlcclx0XHQuc3VjY2VzcyhmdW5jdGlvbihwb3N0KXtcclx0XHRcdC8qIG1hbnVhbGx5IHJlbG9hZCBtYXJrZXJzIFxyXHRcdFx0dXNpbmcgbWFwdHlwZWlkIHNpbmNlIGl0cyBtb3N0IGxlYXN0IHVzZWQgZXZlbnQsIC0ga2luZCBvZiBoYWNreSB3YXkgdG8gZG8gaXRcclx0XHRcdCovXHJcdFx0XHRnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKCRzY29wZS5tYXAsICdtYXB0eXBlaWRfY2hhbmdlZCcpO1xyXHJcdFx0XHQkc2NvcGUucG9zdHMudW5zaGlmdChwb3N0KTtcclxyXHRcdFx0LyogZnJvbnQgZW5kIHNpZGUgbGlzdCBwb3N0IHJlbW92ZSAqL1xyXHRcdFx0dmFyIGZyb250RW5kUG9zdFJlbW92ZSA9IGZ1bmN0aW9uKCl7IFxyXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8ICRzY29wZS5wb3N0cy5sZW5ndGg7ICsraSl7XHJcdFx0XHRcdGlmIChwb3N0Ll9pZCA9PSAkc2NvcGUucG9zdHNbaV0uX2lkKVxyXHRcdFx0XHRcdCRzY29wZS5wb3N0cy5zcGxpY2UoaSwgMSk7XHJcdFx0XHRcdH1cclx0XHRcdH07XHJcdFx0XHRzZXRUaW1lb3V0KGZyb250RW5kUG9zdFJlbW92ZSwgcG9zdC5saWZlc3Bhbik7XHJcclx0XHRcdC8qIHJlc2V0IGlucHV0IGZvcm1zICovXHJcdFx0XHQkc2NvcGUuY29udGVudCAgPSBudWxsO1xyXHRcdH0pXHJcdFx0LmVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cyl7XHJcdFx0XHRzd2FsKFwiUG9zdCBmYWlsZWRcIiwgXCJQbGVhc2UgY29tcGxldGUgdGhlIGZyb20gY29ycmVjdGx5XCIsIFwiZXJyb3JcIik7XHJcdFx0fSk7XHJcclx0fTtcclxyXHQvKiBhcyBzZXJ2ZXIgdGVsbHMgdGhlcmUgd2FzIG5ldyBwb3N0LCBsZXRzIHJlLWxvYWQgbGlzdCBkYXRhICovXHJcdCRzY29wZS5yZXF1ZXN0RmV0Y2ggPSBmdW5jdGlvbigpIHtcclx0XHRQb3N0c1N2Yy5mZXRjaCgpXHJcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24ocG9zdHMpe1xyXHRcdFx0JHNjb3BlLnBvc3RzID0gcG9zdHM7XHJcdFx0fSk7XHJcdH07XHJcclx0JHNjb3BlLnJlcXVlc3RGZXRjaCgpO1xyfSk7XHJcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1Bvc3RzU3ZjJywgZnVuY3Rpb24oJGh0dHApe1xuXHR0aGlzLmZldGNoID0gZnVuY3Rpb24oKXtcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJyk7XG5cdH07XG5cblx0dGhpcy5jcmVhdGUgPSBmdW5jdGlvbihwb3N0KXtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHBvc3QpO1xuXHR9O1xuXG5cdHRoaXMucmVtb3ZlID0gZnVuY3Rpb24ocG9zdCl7XG5cdFx0Y29uc29sZS5sb2coXCJkZWxldGluZyBwb3N0aW5nXCIpO1xuXHRcdGNvbnNvbGUubG9nKCdwb3N0Ll9pZDonLCBwb3N0Ll9pZCk7XG5cdFx0cmV0dXJuICRodHRwLnB1dCgnL2FwaS9wb3N0cycsIHBvc3QpO1xuXHR9O1xufSk7XG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5ydW4oZnVuY3Rpb24oJHJvb3RTY29wZSwgJHRpbWVvdXQpe1xuXG5cdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0dmFyIHVybDtcblxuXHR2YXIgaG9zdG5hbWUgPSBkb2N1bWVudC5sb2NhdGlvbi5ob3N0bmFtZTtcblx0dmFyIGRldmVsb3BtZW50SVAgPSBcIjE5Mi4xNjguMC40XCI7XG5cblx0aWYgKGhvc3RuYW1lID09IFwibG9jYWxob3N0XCIpe1xuXHRcdHVybCA9IFwid3M6Ly9sb2NhbGhvc3Q6NTAwMFwiO1xuXHR9XG5cdGVsc2UgaWYgKGhvc3RuYW1lID09IGRldmVsb3BtZW50SVApIHtcblx0XHR1cmwgPSAnd3M6Ly8xOTIuMTY4LjAuNDo1MDAwJzsgLy8gZGV2ZWxvcG1ldCBvbiBzb2NrZXQgbG9jYWxseSBcblx0fVxuXHRlbHNlIHtcblx0XHR1cmwgPSAnd3NzOi8vZnJvemVuLWJhZGxhbmRzLTg2NDkuaGVyb2t1YXBwLmNvbSc7IC8vIHByb2R1Y3Rpb24gZGVwbG95IHZlcnNpb24gLSBzdGlsbCBkZWJ1ZyBtb2RlXG5cdH1cblxuXHQvKiDqsJzrsJzqs7zsoJXsnbQg64Gd64KY6rOgIOuwsO2PrOyLnOyXkOuKlCDsnITrtoDrtoTsnYQg7KeA7Jqw6rOgIOyVhOuemCDsvZTrk5zrp4wg64Ko6rKo64+EIOuQnOuLpC5cblx0dXJsID0gJ3dzczovL2Zyb3plbi1iYWRsYW5kcy04NjQ5Lmhlcm9rdWFwcC5jb20nO1xuXHQqL1xuXG5cdHZhciBjb25uZWN0ID0gZnVuY3Rpb24oKSB7XG5cdFx0Y29ubmVjdGlvbiA9IG5ldyBXZWJTb2NrZXQodXJsKTtcblxuXHRcdGNvbm5lY3Rpb24ub25vcGVuID0gZnVuY3Rpb24oKXtcblx0XHRcdGNvbnNvbGUubG9nKCdXZWJTb2NrZXQgY29ubmVjdGVkJyk7XG5cdFx0fTtcblxuXHRcdGNvbm5lY3Rpb24ub25jbG9zZSA9IGZ1bmN0aW9uKCl7XG5cdFx0XHRjb25zb2xlLmxvZygnV2ViU29ja2V0IGNsb3NlZC4gUmVjb25lY3RpbmcuLi4nKTtcblx0XHRcdCR0aW1lb3V0KGNvbm5lY3QsIDIwMDApO1xuXHRcdH07XG5cblx0XHRjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGUpe1xuXHRcdFx0Y29uc29sZS5sb2coZSk7XG5cdFx0XHR2YXIgcGF5bG9hZCA9IEpTT04ucGFyc2UoZS5kYXRhKTtcblxuXHRcdFx0Ly8g7IOI66Gc7Jq0IO2PrOyKpO2KuOqwgCDsmKzrnbzsmZTsnYTrlYwgZnJvbnQtZW5k7JeQ7IScIOunteydtCDri6Tsi5wg7JeF642w7J207Yq4IO2VtOyVvCDrkJzri6Tqs6Ag7JWM66Ck7KSA64ukIVxuXHRcdFx0Ly8g66ek7Jqw7KSR7JqUIVxuXHRcdFx0JHJvb3RTY29wZS4kYnJvYWRjYXN0KCd3czonICsgcGF5bG9hZC50eXBlLCBwYXlsb2FkLmRhdGEpO1xuXHRcdH07XG5cdH07XG5cblx0Y29ubmVjdCgpO1xufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4ucnVuKGZ1bmN0aW9uKCRyb290U2NvcGUsICR0aW1lb3V0KXtcblxuXHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdHZhciB1cmw7XG5cblx0dmFyIGhvc3RuYW1lID0gZG9jdW1lbnQubG9jYXRpb24uaG9zdG5hbWU7XG5cdHZhciBkZXZlbG9wbWVudElQID0gXCIxOTIuMTY4LjAuNFwiO1xuXG5cdGlmIChob3N0bmFtZSA9PSBcImxvY2FsaG9zdFwiKXtcblx0XHR1cmwgPSBcIndzOi8vbG9jYWxob3N0OjUwMDBcIjtcblx0fVxuXHRlbHNlIGlmIChob3N0bmFtZSA9PSBkZXZlbG9wbWVudElQKSB7XG5cdFx0dXJsID0gJ3dzOi8vMTkyLjE2OC4wLjQ6NTAwMCc7IC8vIGRldmVsb3BtZXQgb24gc29ja2V0IGxvY2FsbHkgXG5cdH1cblx0ZWxzZSB7XG5cdFx0dXJsID0gJ3dzczovL2Zyb3plbi1iYWRsYW5kcy04NjQ5Lmhlcm9rdWFwcC5jb20nOyAvLyBwcm9kdWN0aW9uIGRlcGxveSB2ZXJzaW9uIC0gc3RpbGwgZGVidWcgbW9kZVxuXHR9XG5cblx0Lyog6rCc67Cc6rO87KCV7J20IOuBneuCmOqzoCDrsLDtj6zsi5zsl5DripQg7JyE67aA67aE7J2EIOyngOyasOqzoCDslYTrnpgg7L2U65Oc66eMIOuCqOqyqOuPhCDrkJzri6QuXG5cdHVybCA9ICd3c3M6Ly9mcm96ZW4tYmFkbGFuZHMtODY0OS5oZXJva3VhcHAuY29tJztcblx0Ki9cblxuXHR2YXIgY29ubmVjdCA9IGZ1bmN0aW9uKCkge1xuXHRcdGNvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0KHVybCk7XG5cblx0XHRjb25uZWN0aW9uLm9ub3BlbiA9IGZ1bmN0aW9uKCl7XG5cdFx0XHRjb25zb2xlLmxvZygnV2ViU29ja2V0IGNvbm5lY3RlZCcpO1xuXHRcdH07XG5cblx0XHRjb25uZWN0aW9uLm9uY2xvc2UgPSBmdW5jdGlvbigpe1xuXHRcdFx0Y29uc29sZS5sb2coJ1dlYlNvY2tldCBjbG9zZWQuIFJlY29uZWN0aW5nLi4uJyk7XG5cdFx0XHQkdGltZW91dChjb25uZWN0LCAyMDAwKTtcblx0XHR9O1xuXG5cdFx0Y29ubmVjdGlvbi5vbm1lc3NhZ2UgPSBmdW5jdGlvbihlKXtcblx0XHRcdGNvbnNvbGUubG9nKGUpO1xuXHRcdFx0dmFyIHBheWxvYWQgPSBKU09OLnBhcnNlKGUuZGF0YSk7XG5cblx0XHRcdC8vIOyDiOuhnOyatCDtj6zsiqTtirjqsIAg7Jis65287JmU7J2E65WMIGZyb250LWVuZOyXkOyEnCDrp7XsnbQg64uk7IucIOyXheuNsOydtO2KuCDtlbTslbwg65Cc64uk6rOgIOyVjOugpOykgOuLpCFcblx0XHRcdC8vIOunpOyasOykkeyalCFcblx0XHRcdCRyb290U2NvcGUuJGJyb2FkY2FzdCgnd3M6JyArIHBheWxvYWQudHlwZSwgcGF5bG9hZC5kYXRhKTtcblx0XHR9O1xuXHR9O1xuXG5cdGNvbm5lY3QoKTtcbn0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==