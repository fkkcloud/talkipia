angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$scope","UserSvc",function(e,o){e.loginLabel="Login",e.$on("login",function(o,t){e.currentUser=t}),e.logout=function(){e.currentUser=void 0,o.logout()}}]),angular.module("app").controller("LoginCtrl",["$scope","$location","UserSvc",function(e,o,t){e.login=function(n,r){t.login(n,r).then(function(t){o.path("/"),e.$emit("login",t)})}}]),angular.module("app").directive("appMap",function(){var e=function(e,o,t){function n(){void 0===r&&(r=new google.maps.Map(o[0],a));var e=document.getElementById("pac-input");r.controls[google.maps.ControlPosition.TOP_LEFT].push(e);var t=new google.maps.places.SearchBox(e);google.maps.event.addListener(t,"places_changed",function(){var e=t.getPlaces();if(0!=e.length){{var o=e[0],n=new google.maps.LatLngBounds,a={url:"https://maps.google.com/mapfiles/ms/icons/green-dot.png",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)};new google.maps.Marker({map:r,icon:a,title:o.name,position:o.geometry.location})}n.extend(o.geometry.location),r.fitBounds(n)}})}var r,a={center:new google.maps.LatLng(50,2),zoom:4,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!1};n()};return{restrict:"A",template:'<div id="map-canvas"></div>',replace:!0,link:e}}),angular.module("app").controller("PostsCtrl",["$scope","PostsSvc",function(e,o){e.addPost=function(){e.postBody&&o.create({userid:void 0,username:void 0,sexPlace:e.sexPlace,sexTime:e.sexTime}).success(function(o){e.posts.unshift(o),e.sexPlace=void 0,e.sexTime=void 0,e.sexTarget=void 0}).error(function(e){alert("Please log in")})},o.fetch().success(function(o){console.log(o),e.posts=o})}]),angular.module("app").service("PostsSvc",["$http",function(e){this.fetch=function(){return e.get("/api/posts")},this.create=function(o){return e.post("/api/posts",o)}}]),angular.module("app").controller("RegisterCtrl",["$scope","$location","UserSvc",function(e,o,t){e.register=function(n,r){t.register(n,r).then(function(t){alert("Successfully registered."),o.path("/"),e.$emit("login",t)})}}]),angular.module("app").config(["$routeProvider",function(e){e.when("/",{controller:"PostsCtrl",templateUrl:"/templates/posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"/templates/register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"/templates/login.html"}).otherwise({redirectTo:"/"})}]),angular.module("app").service("UserSvc",["$http",function(e){var o=this;o.getUser=function(){return e.get("/api/users",{headers:{"X-Auth":window.localStorage.token}}).then(function(e){return e.data})},o.login=function(t,n){return e.post("/api/sessions",{username:t,password:n}).then(function(t){return window.localStorage.token=t.data,e.defaults.headers.common["X-Auth"]=t.data,o.getUser()})},o.register=function(t,n){return e.post("/api/users",{username:t,password:n}).then(function(){return o.login(t,n)})},o.logout=function(){window.localStorage.token=void 0,e.defaults.headers.common["X-Auth"]=void 0}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJsb2dpbi5jdHJsLmpzIiwibWFwLmRpcmVjdGl2ZS5qcyIsImFwcC5qcyIsInBvc3RzLmN0cmwuanMiLCJwb3N0cy5zdmMuanMiLCJyZWdpc3Rlci5jdHJsLmpzIiwicm91dGVzLmpzIiwidXNlci5zdmMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCJVc2VyU3ZjIiwibG9naW5MYWJlbCIsIiRvbiIsIl8iLCJ1c2VyIiwiY3VycmVudFVzZXIiLCJsb2dvdXQiLCJ1bmRlZmluZWQiLCIkbG9jYXRpb24iLCJsb2dpbiIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJ0aGVuIiwicGF0aCIsIiRlbWl0IiwiZGlyZWN0aXZlIiwibGluayIsInNjb3BlIiwiZWxlbWVudCIsImF0dHJzIiwiaW5pdE1hcCIsIm1hcCIsImdvb2dsZSIsIm1hcHMiLCJNYXAiLCJtYXBPcHRpb25zIiwiaW5wdXQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY29udHJvbHMiLCJDb250cm9sUG9zaXRpb24iLCJUT1BfTEVGVCIsInB1c2giLCJzZWFyY2hCb3giLCJwbGFjZXMiLCJTZWFyY2hCb3giLCJldmVudCIsImFkZExpc3RlbmVyIiwiZ2V0UGxhY2VzIiwibGVuZ3RoIiwicGxhY2UiLCJib3VuZHMiLCJMYXRMbmdCb3VuZHMiLCJpbWFnZSIsInVybCIsInNpemUiLCJTaXplIiwib3JpZ2luIiwiUG9pbnQiLCJhbmNob3IiLCJzY2FsZWRTaXplIiwiTWFya2VyIiwiaWNvbiIsInRpdGxlIiwibmFtZSIsInBvc2l0aW9uIiwiZ2VvbWV0cnkiLCJsb2NhdGlvbiIsImV4dGVuZCIsImZpdEJvdW5kcyIsImNlbnRlciIsIkxhdExuZyIsInpvb20iLCJtYXBUeXBlSWQiLCJNYXBUeXBlSWQiLCJST0FETUFQIiwic2Nyb2xsd2hlZWwiLCJyZXN0cmljdCIsInRlbXBsYXRlIiwicmVwbGFjZSIsIlBvc3RzU3ZjIiwiYWRkUG9zdCIsInBvc3RCb2R5IiwiY3JlYXRlIiwidXNlcmlkIiwic2V4UGxhY2UiLCJzZXhUaW1lIiwic3VjY2VzcyIsInBvc3QiLCJwb3N0cyIsInVuc2hpZnQiLCJzZXhUYXJnZXQiLCJlcnJvciIsImVyciIsImFsZXJ0IiwiZmV0Y2giLCJjb25zb2xlIiwibG9nIiwic2VydmljZSIsIiRodHRwIiwidGhpcyIsImdldCIsInJlZ2lzdGVyIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwic3ZjIiwiZ2V0VXNlciIsImhlYWRlcnMiLCJYLUF1dGgiLCJ3aW5kb3ciLCJsb2NhbFN0b3JhZ2UiLCJ0b2tlbiIsInJlc3BvbnNlIiwiZGF0YSIsImRlZmF1bHRzIiwiY29tbW9uIl0sIm1hcHBpbmdzIjoiQUFBQUEsUUFBQUMsT0FBQSxPQUNBLFlDREFELFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxtQkFBQSxTQUFBLFVBQUEsU0FBQUMsRUFBQUMsR0FDQUQsRUFBQUUsV0FBQSxRQUVBRixFQUFBRyxJQUFBLFFBQUEsU0FBQUMsRUFBQUMsR0FDQUwsRUFBQU0sWUFBQUQsSUFHQUwsRUFBQU8sT0FBQSxXQUNBUCxFQUFBTSxZQUFBRSxPQUNBUCxFQUFBTSxhQ1ZBVixRQUFBQyxPQUFBLE9BQ0FDLFdBQUEsYUFBQSxTQUFBLFlBQUEsVUFBQSxTQUFBQyxFQUFBUyxFQUFBUixHQUdBRCxFQUFBVSxNQUFBLFNBQUFDLEVBQUFDLEdBQ0FYLEVBQUFTLE1BQUFDLEVBQUFDLEdBQ0FDLEtBQUEsU0FBQVIsR0FDQUksRUFBQUssS0FBQSxLQUNBZCxFQUFBZSxNQUFBLFFBQUFWLFNDUkFSLFFBQUFDLE9BQUEsT0FDQWtCLFVBQUEsU0FBQSxXQUVBLEdBQUFDLEdBQUEsU0FBQUMsRUFBQUMsRUFBQUMsR0FhQSxRQUFBQyxLQUNBLFNBQUFDLElBQ0FBLEVBQUEsR0FBQUMsUUFBQUMsS0FBQUMsSUFB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QUFBQyxTQUVBN0YsS0FBQSxTQUFBOEYsR0FDQSxNQUFBQSxHQUFBQyxRQVFBUixFQUFBMUYsTUFBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUE4RSxHQUFBWCxLQUFBLGlCQUVBcEUsU0FBQUEsRUFDQUMsU0FBQUEsSUFFQUMsS0FBQSxTQUFBOEYsR0FHQSxNQUZBSCxRQUFBQyxhQUFBQyxNQUFBQyxFQUFBQyxLQUNBbEIsRUFBQW1CLFNBQUFQLFFBQUFRLE9BQUEsVUFBQUgsRUFBQUMsS0FDQVIsRUFBQUMsYUFJQUQsRUFBQVAsU0FBQSxTQUFBbEYsRUFBQUMsR0FDQSxNQUFBOEUsR0FBQVgsS0FBQSxjQUVBcEUsU0FBQUEsRUFDQUMsU0FBQUEsSUFFQUMsS0FBQSxXQUNBLE1BQUF1RixHQUFBMUYsTUFBQUMsRUFBQUMsTUFJQXdGLEVBQUE3RixPQUFBLFdBQ0FpRyxPQUFBQyxhQUFBQyxNQUFBbEcsT0FDQWtGLEVBQUFtQixTQUFBUCxRQUFBUSxPQUFBLFVBQUF0RyIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuXHQnbmdSb3V0ZSdcbl0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignQXBwbGljYXRpb25DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBVc2VyU3ZjKXtcblx0JHNjb3BlLmxvZ2luTGFiZWwgPSAnTG9naW4nO1xuXG5cdCRzY29wZS4kb24oJ2xvZ2luJywgZnVuY3Rpb24oXywgdXNlcil7XG5cdFx0JHNjb3BlLmN1cnJlbnRVc2VyID0gdXNlcjtcblx0fSk7XG5cblx0JHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCl7XG5cdFx0JHNjb3BlLmN1cnJlbnRVc2VyID0gdW5kZWZpbmVkO1xuXHRcdFVzZXJTdmMubG9nb3V0KCk7XG5cdH07XG5cblx0Ly8gVE9ETyA6IGhhdmUgdG8gdGhpbmsgYWJvdXQgYSB3YXkgdG8ga2VlcCB0aGUgbG9nLWluIGRhdGEgYXMgbG9uZyBhcyB3aW5kb3cgaXMgdXAgYW5kIGxvZ2dlZC1pblxuXHQvLyB1c2luZyB3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRsb2NhdGlvbiwgVXNlclN2Yyl7XG5cdC8vIFVzZXJTdmPshJzruYTsiqTsnZggbG9naW7tlajsiJjsl5DshJwg67Cb7J2AIOycoOyggOygleuztOulvFxuXHQvLyDstZzsg4HsnIQg7L2Y7Yq466Gk65+s7J24IEFwcGxpY2F0aW9uQ3RybOydmCAkc2NvcGXroZwg6rCS7J2EIOuztOuCtOq4sCDsnITtlZwg7KCE7YyM66W8IOuztOuCuOuLpC5cblx0JHNjb3BlLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKXtcblx0XHRVc2VyU3ZjLmxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZClcblx0XHQudGhlbihmdW5jdGlvbiAodXNlcil7XG5cdFx0XHQkbG9jYXRpb24ucGF0aCgnLycpO1xuXHRcdFx0JHNjb3BlLiRlbWl0KCdsb2dpbicsIHVzZXIpO1xuXHRcdH0pO1xuXHR9O1xufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uZGlyZWN0aXZlKCdhcHBNYXAnLCBmdW5jdGlvbigpIHtcbiAgICAvLyBkaXJlY3RpdmUgbGluayBmdW5jdGlvblxuICAgIHZhciBsaW5rID0gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgIHZhciBtYXAsIGluZm9XaW5kb3c7XG4gICAgICAgIHZhciBtYXJrZXJzID0gW107XG4gICAgICAgIFxuICAgICAgICAvLyBtYXAgY29uZmlnXG4gICAgICAgIHZhciBtYXBPcHRpb25zID0ge1xuICAgICAgICAgICAgY2VudGVyOiBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKDUwLCAyKSxcbiAgICAgICAgICAgIHpvb206IDQsXG4gICAgICAgICAgICBtYXBUeXBlSWQ6IGdvb2dsZS5tYXBzLk1hcFR5cGVJZC5ST0FETUFQLFxuICAgICAgICAgICAgc2Nyb2xsd2hlZWw6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICAvLyBpbml0IHRoZSBtYXBcbiAgICAgICAgZnVuY3Rpb24gaW5pdE1hcCgpIHtcbiAgICAgICAgICAgIGlmIChtYXAgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZWxlbWVudFswXSwgbWFwT3B0aW9ucyk7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgIC8vIENyZWF0ZSB0aGUgc2VhcmNoIGJveCBhbmQgbGluayBpdCB0byB0aGUgVUkgZWxlbWVudC5cbiAgICAgICAgICB2YXIgaW5wdXQgPSAvKiogQHR5cGUge0hUTUxJbnB1dEVsZW1lbnR9ICovKFxuICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFjLWlucHV0JykpO1xuICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uVE9QX0xFRlRdLnB1c2goaW5wdXQpO1xuXG4gICAgICAgICAgdmFyIHNlYXJjaEJveCA9IG5ldyBnb29nbGUubWFwcy5wbGFjZXMuU2VhcmNoQm94KFxuICAgICAgICAgICAgLyoqIEB0eXBlIHtIVE1MSW5wdXRFbGVtZW50fSAqLyhpbnB1dCkpO1xuXG4gICAgICAgICAgICAvLyBMaXN0ZW4gZm9yIHRoZSBldmVudCBmaXJlZCB3aGVuIHRoZSB1c2VyIHNlbGVjdHMgYW4gaXRlbSBmcm9tIHRoZVxuICAgICAgICAgICAgLy8gcGljayBsaXN0LiBSZXRyaWV2ZSB0aGUgbWF0Y2hpbmcgcGxhY2VzIGZvciB0aGF0IGl0ZW0uXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihzZWFyY2hCb3gsICdwbGFjZXNfY2hhbmdlZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBwbGFjZXMgPSBzZWFyY2hCb3guZ2V0UGxhY2VzKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAocGxhY2VzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gdGFrZSBvbmx5IDEgc3BvdFxuICAgICAgICAgICAgICAgIHZhciBwbGFjZSA9IHBsYWNlc1swXTtcblxuICAgICAgICAgICAgICAgIHZhciBib3VuZHMgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nQm91bmRzKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgaW1hZ2UgPSB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJ2h0dHBzOi8vbWFwcy5nb29nbGUuY29tL21hcGZpbGVzL21zL2ljb25zL2dyZWVuLWRvdC5wbmcnLFxuICAgICAgICAgICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDAsIDApLFxuICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludCgxNywgMzQpLFxuICAgICAgICAgICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgyNSwgMjUpXG4gICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgICAgICBtYXA6IG1hcCxcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogaW1hZ2UsXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBwbGFjZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogcGxhY2UuZ2VvbWV0cnkubG9jYXRpb25cbiAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgYm91bmRzLmV4dGVuZChwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbik7XG5cbiAgICAgICAgICAgICAgICBtYXAuZml0Qm91bmRzKGJvdW5kcyk7XG5cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gICAgXG4gICAgICAgIFxuICAgICAgICBcbiAgICAgICAgLy8gcGxhY2UgYSBtYXJrZXJcbiAgICAgICAgZnVuY3Rpb24gc2V0TWFya2VyKG1hcCwgcG9zaXRpb24sIHRpdGxlLCBjb250ZW50KSB7XG4gICAgICAgICAgICB2YXIgbWFya2VyO1xuICAgICAgICAgICAgdmFyIG1hcmtlck9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHBvc2l0aW9uLFxuICAgICAgICAgICAgICAgIG1hcDogbWFwLFxuICAgICAgICAgICAgICAgIHRpdGxlOiB0aXRsZSxcbiAgICAgICAgICAgICAgICBpY29uOiAnaHR0cHM6Ly9tYXBzLmdvb2dsZS5jb20vbWFwZmlsZXMvbXMvaWNvbnMvZ3JlZW4tZG90LnBuZydcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIobWFya2VyT3B0aW9ucyk7XG4gICAgICAgICAgICBtYXJrZXJzLnB1c2gobWFya2VyKTsgLy8gYWRkIG1hcmtlciB0byBhcnJheVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyBjbG9zZSB3aW5kb3cgaWYgbm90IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIGlmIChpbmZvV2luZG93ICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBjcmVhdGUgbmV3IHdpbmRvd1xuICAgICAgICAgICAgICAgIHZhciBpbmZvV2luZG93T3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogY29udGVudFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaW5mb1dpbmRvdyA9IG5ldyBnb29nbGUubWFwcy5JbmZvV2luZG93KGluZm9XaW5kb3dPcHRpb25zKTtcbiAgICAgICAgICAgICAgICBpbmZvV2luZG93Lm9wZW4obWFwLCBtYXJrZXIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIHNob3cgdGhlIG1hcCBhbmQgcGxhY2Ugc29tZSBtYXJrZXJzXG4gICAgICAgIGluaXRNYXAoKTtcbiAgICAgICAgXG4gICAgICAgIC8qXG4gICAgICAgIHNldE1hcmtlcihtYXAsIG5ldyBnb29nbGUubWFwcy5MYXRMbmcoNTEuNTA4NTE1LCAtMC4xMjU0ODcpLCAnTG9uZG9uJywgJ0p1c3Qgc29tZSBjb250ZW50Jyk7XG4gICAgICAgIHNldE1hcmtlcihtYXAsIG5ldyBnb29nbGUubWFwcy5MYXRMbmcoNTIuMzcwMjE2LCA0Ljg5NTE2OCksICdBbXN0ZXJkYW0nLCAnTW9yZSBjb250ZW50Jyk7XG4gICAgICAgIHNldE1hcmtlcihtYXAsIG5ldyBnb29nbGUubWFwcy5MYXRMbmcoNDguODU2NjE0LCAyLjM1MjIyMiksICdQYXJpcycsICdUZXh0IGhlcmUnKTtcbiAgICAgICAgKi9cbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgIHRlbXBsYXRlOiAnPGRpdiBpZD1cIm1hcC1jYW52YXNcIj48L2Rpdj4nLFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICBsaW5rOiBsaW5rXG4gICAgfTtcbn0pO1xuXG4iLG51bGwsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ1Bvc3RzQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFBvc3RzU3ZjKXtcblx0XG5cdCRzY29wZS5hZGRQb3N0ID0gZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCRzY29wZS5wb3N0Qm9keSl7XG5cdFx0XHRQb3N0c1N2Yy5jcmVhdGUoXG5cdFx0XHR7XG5cdFx0XHRcdHVzZXJpZDogICB1bmRlZmluZWQsXG5cdFx0XHRcdHVzZXJuYW1lOiB1bmRlZmluZWQsXG5cdFx0XHRcdHNleFBsYWNlOiAkc2NvcGUuc2V4UGxhY2UsXG5cdFx0XHRcdHNleFRpbWU6ICAkc2NvcGUuc2V4VGltZVxuXHRcdFx0XHRcblx0XHRcdH0pXG5cdFx0XHQuc3VjY2VzcyhmdW5jdGlvbihwb3N0KXtcblx0XHRcdFx0JHNjb3BlLnBvc3RzLnVuc2hpZnQocG9zdCk7XG5cdFx0XHRcdFxuXHRcdFx0XHQkc2NvcGUuc2V4UGxhY2UgPSB1bmRlZmluZWQ7XG5cdFx0XHRcdCRzY29wZS5zZXhUaW1lICA9IHVuZGVmaW5lZDtcblx0XHRcdFx0JHNjb3BlLnNleFRhcmdldCA9IHVuZGVmaW5lZDtcblx0XHRcdH0pXG5cdFx0XHQuZXJyb3IoZnVuY3Rpb24oZXJyKXtcblx0XHRcdFx0YWxlcnQoJ1BsZWFzZSBsb2cgaW4nKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fTtcblxuXHRQb3N0c1N2Yy5mZXRjaCgpXG5cdC5zdWNjZXNzKGZ1bmN0aW9uKHBvc3RzKXtcblx0XHRjb25zb2xlLmxvZyhwb3N0cyk7XG5cdFx0JHNjb3BlLnBvc3RzID0gcG9zdHM7XG5cdH0pO1xuXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdQb3N0c1N2YycsIGZ1bmN0aW9uKCRodHRwKXtcblx0dGhpcy5mZXRjaCA9IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcG9zdHMnKTtcblx0fTtcblxuXHR0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uKHBvc3Qpe1xuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Bvc3RzJywgcG9zdCk7XG5cdH07XG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdSZWdpc3RlckN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRsb2NhdGlvbiwgVXNlclN2Yyl7XG5cdC8vIFVzZXJTdmPshJzruYTsiqTsnZggcmVnaXN0ZXLtlajsiJjsl5DshJwg67Cb7J2AIOycoOyggOygleuztOulvCAtIGFwaeyXkOyEnCDrs7TrgrTsoYzquLAg65WM66y47JeQIC5kYXRh66GcIOygkeq3vFxuXHQvLyDstZzsg4HsnIQg7L2Y7Yq466Gk65+s7J24IEFwcGxpY2F0aW9uQ3RybOydmCAkc2NvcGXroZwg6rCS7J2EIOuztOuCtOq4sCDsnITtlZwg7KCE7YyM66W8IOuztOuCuOuLpC5cblx0JHNjb3BlLnJlZ2lzdGVyID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKXtcblx0XHRVc2VyU3ZjLnJlZ2lzdGVyKHVzZXJuYW1lLCBwYXNzd29yZClcblx0XHQudGhlbihmdW5jdGlvbiAodXNlcil7XG5cdFx0XHRhbGVydCgnU3VjY2Vzc2Z1bGx5IHJlZ2lzdGVyZWQuJylcblx0XHRcdCRsb2NhdGlvbi5wYXRoKCcvJyk7XG5cdFx0XHQkc2NvcGUuJGVtaXQoJ2xvZ2luJywgdXNlcik7XG5cdFx0fSk7XG5cdH1cdFxufSk7XG4iLCJcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbmZpZyhmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIpe1xuXHQkcm91dGVQcm92aWRlclxuXHQud2hlbignLycsIFxuXHRcdHtcblx0XHRcdGNvbnRyb2xsZXI6ICdQb3N0c0N0cmwnLCBcblx0XHRcdHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9wb3N0cy5odG1sJ1xuXHRcdH0pXG5cdC53aGVuKCcvcmVnaXN0ZXInLCBcblx0XHR7XG5cdFx0XHRjb250cm9sbGVyOiAnUmVnaXN0ZXJDdHJsJyxcblx0XHRcdHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9yZWdpc3Rlci5odG1sJ1xuXHRcdH0pXG5cdC53aGVuKCcvbG9naW4nLFxuXHRcdHtcblx0XHRcdGNvbnRyb2xsZXI6ICdMb2dpbkN0cmwnLFxuXHRcdFx0dGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL2xvZ2luLmh0bWwnXG5cdFx0fSlcblx0Ly8gUmVkaXJlY3QgdG8gdGhlIHJvb3QgcGFnZS5cblx0Lm90aGVyd2lzZShcblx0XHR7XG4gICBcdFx0XHRyZWRpcmVjdFRvOiAnLydcblx0XHR9KTtcbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnVXNlclN2YycsIGZ1bmN0aW9uKCRodHRwKXtcblx0dmFyIHN2YyA9IHRoaXM7XG5cblx0Ly8gc3ZjLnRva2VuICh0aGlzLnRva2VuKSDqsJLsnLzroZwgL2FwaS91c2VyIOulvCDtmLjstpxcblx0c3ZjLmdldFVzZXIgPSBmdW5jdGlvbigpe1xuXHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMnLCBcblx0XHR7XG5cdFx0XHRoZWFkZXJzOiB7J1gtQXV0aCc6IHdpbmRvdy5sb2NhbFN0b3JhZ2UudG9rZW59XG5cdFx0fSlcblx0XHQudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG5cdFx0XHRyZXR1cm4gcmVzcG9uc2UuZGF0YTsgIC8vIC0gYXBp7JeQ7IScIOuztOuCtOyhjOq4sCDrlYzrrLjsl5AgLmRhdGHroZwg7KCR6re8XG5cdFx0fSk7XG5cdH07XG5cblx0Ly8gc2Vzc2lvbiDsnYQg7J207Jqp7ZW07IScLCDtjKjsiqTsm4zrk5zqsIAg7J287LmY7ZWY64qU7KeAIOqygOyCrO2VmOqzoCxcblx0Ly8g7J287LmY7ZWY66m0IOuwm+ydgCBqd3QgZW5jb2RlZOuQnCB1c2VybmFtZSwg7KaJIO2GoO2BsOydhCDqsIDsp4Dqs6AsXG5cdC8vIHZhbOydtOudvOuKlCDrs4DsiJjsl5Ag64Sj6rOgLCDsnbTqsoPsnZgg642w7J207YSw66W8IHN2Yy50b2tlbuyXkOuPhCDsoIDsnqXtlZjqs6AsXG5cdC8vIHN2Yy5nZXRVc2Vy7ZWo7IiY66W8IO2YuOy2nO2VnOuLpC5cblx0c3ZjLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKXtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucycsIFxuXHRcdHtcblx0XHRcdHVzZXJuYW1lOiB1c2VybmFtZSwgXG5cdFx0XHRwYXNzd29yZDogcGFzc3dvcmRcblx0XHR9KVxuXHRcdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSl7XG5cdFx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuID0gcmVzcG9uc2UuZGF0YTsgLy8gYXBp7JeQ7IScIOuztOuDiOq4sOuVjOusuOyXkCwgLmRhdGHroZwg7KCR6re8XG5cdFx0XHQkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSByZXNwb25zZS5kYXRhOyAvLyDrqqjrk6Ag7JqU7LKt7JeQIOuMgO2VtCDtlbTri7kg7Zek642U66W8IOyghOyXreycvOuhnCDrtpnsnoQuXG5cdFx0XHRyZXR1cm4gc3ZjLmdldFVzZXIoKTtcblx0XHR9KTtcblx0fTtcblxuXHRzdmMucmVnaXN0ZXIgPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpe1xuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzJywgXG5cdFx0e1xuXHRcdFx0dXNlcm5hbWU6IHVzZXJuYW1lLFxuXHRcdFx0cGFzc3dvcmQ6IHBhc3N3b3JkXG5cdFx0fSlcblx0XHQudGhlbihmdW5jdGlvbiAoKXtcblx0XHRcdHJldHVybiBzdmMubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKTtcblx0XHR9KTtcblx0fTtcblxuXHRzdmMubG9nb3V0ID0gZnVuY3Rpb24oKXtcblx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuID0gdW5kZWZpbmVkO1xuXHRcdCRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXSA9IHVuZGVmaW5lZDsgLy8g66qo65OgIOyalOyyreyXkCDrjIDtlbQg7ZW064u5IO2XpOuNlOulvCDsoITsl63snLzroZwg67aZ7J6ELlxuXHR9XG59KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=úÚ¿Ë